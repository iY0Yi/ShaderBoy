!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/app_test/js/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);class r{constructor(e){this.type=e.type?e.type:null,this.name=e.name?e.name:null,this.render=e.render?e.render:null,this.args=e.args?e.args:null,this.members=e.members?e.members:null,this.snippet=e.snippet?e.snippet:null}getData(){return{type:this.type,name:this.name,render:this.render,args:this.args,members:this.members,snippet:this.snippet}}isFunction(){return null!==this.snippet&&null!==this.args}isStruct(){return null!==this.snippet&&null!==this.members}isVariable(){return!this.isFunction()&&!this.isStruct()}}const s="float vec2 vec3 vec4 int ivec2 ivec3 ivec4 bool bvec2 bvec3 bvec4 mat2 mat3 mat4 void".split(" "),i="break continue do for while if else true false lowp mediump highp precision discard return".split(" "),o="in out inout const".split(" "),a="#define #undef #if #ifdef #ifndef #else #elif #endif".split(" "),l="sin cos tan asin acos atan atan radians degrees pow exp log exp2 log2 sqrt inversesqrt abs ceil clamp floor fract max min mix mod sign smoothstep step ftransform cross distance dot faceforward length normalize reflect refract dFdx dFdy fwidth matrixCompMult all any equal greaterThan greaterThanEqual lessThan lessThanEqual notEqual texelFetch texture textureLod".split(" "),c="iResolution iTime iTimeDelta iFrame iFrameRate iDate iMouse iChannel0 iChannel1 iChannel2 iChannel3 iSampleRate".split(" "),p="fragColor fragCoord".split(" "),u="mainImage mainSound mainCubemap mainVR".split(" "),m=s.concat();m.push("#define");const f=m.concat();var d={init(){this.dictionary=new h("Builtins");const e=(e,t,n)=>{for(const s of e)this.dictionary.add(new r({type:"fixed",name:s,render:'<span class="autocomp-name">'+s+'</span><div class="icon-code-'+n+'"></div><span class="autocomp-type">'+t+"</span>"}))};e(s,"types","gl"),e(i,"keywords","gl"),e(o,"type qualifier","gl"),e(a,"pre processor","gl"),e(l,"builtin","gl"),e(c,"uniform","st"),e(p,"variable","st")},isType(e){for(const t of f)if(e===t)return!0;return!1},isExclusionWord(e){for(const t of u)if(e===t)return!0;return!1}};class h{constructor(e){this.name=e,this.renderWords={}}search(e){const t=e.type+"_"+e.name;return this.renderWords.hasOwnProperty(t)}filter(e){const t=Object.keys(this.renderWords).filter(t=>{if(void 0!==t&&void 0!==e){const n=t.indexOf("_")+1;return t.toUpperCase().indexOf(e.toUpperCase(),n)===n&&t.toUpperCase()!==e.toUpperCase()}});let n=[];return t.forEach(t=>{const r=t.substring(t.indexOf("_")+1);e===r||d.isExclusionWord(r)||n.push(this.renderWords[t].getData())}),n}add(e){const t=e.type+"_"+e.name;this.renderWords[t]=e}remove(e){if(void 0===e.type||void 0===e.name)return;const t=e.type+"_"+e.name;delete this.renderWords[t]}}var g={removePrecisions(e){const t="lowp mediump highp".split(" ");for(const n of t)e=e.replace(new RegExp(n,"g")," ");return e},removePreProcessor(e){const t="#undef #ifdef #ifndef #else #elif #endif #if".split(" ");for(const n of t)e=this.removeAllBetween(e,new RegExp(n,"g"),n,"\n");return e},getBetweenStr(e,t,n){const r=e.indexOf(t),s=e.indexOf(n,r);return e.substr(r,s-r+n.length)},removeStr:(e,t)=>e.replace(t,""),removeAllBetween(e,t,n,r){let s=e+"";for(;s.match(t);){const e=this.getBetweenStr(s,n,r);s=s.replace(e,"")}return s},removeAllNested(e,t,n,r){let s=e+"",i=e.lastIndexOf(n),o=e.indexOf(r,i);for(;s.match(t);)i=(s=s.replace(s.substr(i,o-i+1),"")).lastIndexOf(n),o=s.indexOf(r,i);return s},removeInlineComment(e){return this.removeAllBetween(e,/\/\//g,"//","\n")},removeBlockComment(e){return this.removeAllBetween(e,/\/\*/g,"/*","*/")},sanitizeLinesForStructs(e){let t="",n=(t=e.replace(/(?=[ ]+)\,/g,","))+"";return t="",n.split(/\r\n|\r|\n/g).forEach(e=>{""!==(e=e.split(/\/\//g)[0].trim())&&(t+=e)}),t},parseStructs(e,t){let n=[];if(!(e=this.sanitizeLinesForStructs(e)).match(/struct/g))return[];{let t=[];for(;e.match(/struct/g);){t.push(this.getBetweenStr(e,"struct","}"));let s=t[t.length-1];e=this.removeStr(e,s);let i=this.getBetweenStr(s,"{","}");s=this.removeStr(s,i);const o=(i=(i=(i=this.removeStr(i,/\{|\}/g)).replace(/; |;| ;/g,";")).replace(/[ ]+/g," ")).split(";");let a=[];for(let e=0;e<o.length;e++){let t=o[e].split(" ");t[0]&&t[1]&&a.push(new r({type:t[0],name:t[1],render:'<span class="autocomp-name">'+t[1]+'</span><div class="icon-code-user"></div><span class="autocomp-type">'+t[0]+"</span>"}))}const l=s.split(" "),c=l[1];let p=c;p+=" var_name = ",p+=c,p+="(";for(let e=0;e<a.length;e++)p+=a[e].type,p+="_",p+=a[e].name,p+=e<a.length-1?", ":"";p+=");",n.push(new r({type:l[0],name:c,members:a,render:'<span class="autocomp-name">'+c+'</span><div class="icon-code-user"></div><span class="autocomp-type">'+l[0]+"</span>",snippet:p}))}}return n},sanitizeLinesForMacroFunctionsVariables(e){let t="";return(e=this.removeAllBetween(e,/struct/g,"struct","}")).split(/\r\n|\r|\n/g).forEach(e=>{e=e.replace(/\{/g,"{;"),e=this.removeStr(e,/\}/g),(e=(e=(e=this.removeStr(e,/(?<=[.])([xyz]+)/g)).replace(/[ ]+/g," ")).trim()).match(/\/\//g)&&(e=""),e.match(/precision/g)&&(e=""),e.match(/#define/g)&&(e+=";"),""!==e&&(t+=e)}),t},parseMacroLine(e,t){let n=[];const s=(e=this.removeAllBetween(e,/\(/g,"(",")").trim()).split(" ");return n.push(new r({type:s[0],name:s[1],render:'<span class="autocomp-name">'+s[1]+'</span><div class="icon-code-user"></div><span class="autocomp-type">'+s[0]+"</span>"})),n},parseFunctionLine(e,t){let n=[];e=(e=(e=e.replace(/\s/g," ")).replace(/[ ]+/g," ")).trim();let s=[],i=this.getBetweenStr(e,"(",")");i=(i=(i=(i=(i=(i=(i=(i=(i=(i=this.removeStr(i,/[()]/g)).trim()).replace(/\s/g," ")).replace(/	',/g," ")).replace(/inout/g," ")).replace(/const/g," ")).replace(/in/g," ")).replace(/out/g," ")).replace(/[ ]+/g," ")).split(",");for(let e=0;e<i.length;e++){let t=i[e].trim().split(/ /g);t[0]&&t[1]&&s.push(new r({type:t[0],name:t[1],render:'<span class="autocomp-name">'+t[1]+'</span><div class="icon-code-user"></div><span class="autocomp-type">'+t[0]+"</span>"}))}const o=e.split(/[ (]/g);let a=o[1]+"(";for(let e=0;e<s.length;e++)a+=s[e].type,a+="_",a+=s[e].name,a+=e<s.length-1?", ":"";return a+=")",n.push(new r({type:o[0],name:o[1],args:s,render:'<span class="autocomp-name">'+o[1]+'</span><div class="icon-code-user"></div><span class="autocomp-type">'+o[0]+"</span>",snippet:a})),n},parseVariables(e,t){let n=[],s=(e=this.removeAllNested(e,/\(|\)/g,"(",")")).indexOf("="),i=e.indexOf(/,/g);for(i=-1===i?e.length:i;e.match("=");)s=(e=e.replace(e.substr(s,i-s+1),"")).indexOf("="),i=-1===(i=e.indexOf(/,/g))?e.length:i;const o=(e=e.replace(/ ,|, |,/g,",")).split(/[ ,]/g),a=o[0];for(let e=1;e<o.length;e++)""!==o[e]&&n.push(new r({type:a,name:o[e],render:'<span class="autocomp-name">'+o[e]+'</span><div class="icon-code-user"></div><span class="autocomp-type">'+a+"</span>"}));return n},getLinesArray(e){let t=[];return e.split(";").forEach(e=>{e.match(/if|else|switch|for|return/g)||t.push(e)}),t},parseMacrosFunctionsVariables(e,t){e=this.sanitizeLinesForStructs(e);let n=[];const r=this.getLinesArray(e);for(let e=0;e<r.length;e++){const s=r[e].trim(),i=s.match(/#define/g),o=s.match(/{/g);d.isType(s.split(" ")[0])&&(i?n.push(this.parseMacroLine(s,t)):o?n.push(this.parseFunctionLine(s,t)):n.push(this.parseVariables(s,t)))}return n}};let v=[];const y={};y.Builtins=new h("Builtins"),y.BufferA=new h("BufferA"),y.BufferB=new h("BufferB"),y.BufferC=new h("BufferC"),y.BufferD=new h("BufferD"),y.Image=new h("Image"),y.Sound=new h("Sound"),y.Common=new h("Common");let b="",w=[""];const x=(e,t)=>{const n=g.sanitizeLinesForMacroFunctionsVariables(t),r=(e=>{let t=[];const n=e.split(";"),r=Math.max(w.length,n.length);for(let e=0;e<r;e++)void 0===w[e]&&(w[e]=""),void 0===n[e]&&(n[e]=""),w[e]!==n[e]&&t.push(e);return w=n,t})(n);if(""!==b){const t=b.split(/\;/);for(let n=0;n<t.length;n++)if(r.some(e=>e===n)){const r=g.parseMacrosFunctionsVariables(t[n]);for(let t=0;t<r.length;t++)for(let n=0;n<r[t].length;n++)y[e].remove(r[t][n])}}if(""!==n){const t=n.split(/\;/);for(let n=0;n<t.length;n++)if(r.some(e=>e===n)){const r=g.parseMacrosFunctionsVariables(t[n]);for(let t=0;t<r.length;t++)for(let n=0;n<r[t].length;n++)y[e].add(r[t][n])}}b=n},S=(e,t)=>{t=g.removeInlineComment(t),t=g.removeBlockComment(t),t=g.removePrecisions(t),((e,t)=>{const n=g.parseStructs(t);if(n.length>=1){if(v.length>0)for(let t=0;t<v.length;t++)for(let r=0;r<v[t].length;r++)y[e].remove(n[t][r]);v=n.concat();for(let t=0;t<n.length;t++)y[e].add(n[t])}})(e,t=g.removePreProcessor(t)),x(e,t)};onmessage=(e=>{const t=JSON.parse(e.data);switch(t.name){case"initBltinDict":d.init(),y.Builtins=d.dictionary;break;case"syncUserDict":S(t.content.dictName,t.content.strCode);break;case"filterDictByWord":((e,t)=>{const n=y.Builtins.filter(t),r=y[e].filter(t),s=n.concat(r);(s.length>=1||void 0!==s[0]&&void 0!==s[0].text&&1===s.length&&s[0].text.toUpperCase()!==t.toUpperCase())&&s.sort(function(e,t){const n=e.name.toUpperCase(),r=t.name.toUpperCase();let s=0;return n>r?s=1:n<r&&(s=-1),s}),postMessage(JSON.stringify({name:"filter_succeed",content:{list:s}},null,"\t"))})(t.content.dictName,t.content.curWord);break;case"filterStructByWord":((e,t)=>{let n=y[e].filter(t);1===n.length&&null!==(n=y[e].filter(n[0].type))[0].members&&postMessage(JSON.stringify({name:"filter_succeed",content:{list:n[0].members}},null,"\t")),postMessage(JSON.stringify({name:"filter_failed",content:null},null,"\t"))})(t.content.dictName,t.content.curWord)}})}]);