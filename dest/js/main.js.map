{"version":3,"sources":["webpack:///./src/js/main.js","webpack:///./src/js/shaderboy.js","webpack:///./src/js/time.js","webpack:///./~/collect-fps/index.js","webpack:///./~/collect-fps/dist/index.js","webpack:///./src/js/io.js","webpack:///./src/js/shader/shaderlib.js","webpack:///./src/js/gui.js","webpack:///./~/keymaster/keymaster.js","webpack:///./src/js/renderer.js","webpack:///./src/js/shader/shader.js","webpack:///./src/js/util/AssetLoader.js","webpack:///./src/js/util/parsehdr.js","webpack:///./src/js/editor.js","webpack:///./~/codemirror/keymap/sublime.js","webpack:///./~/codemirror/lib/codemirror.js","webpack:///./~/codemirror/addon/search/searchcursor.js","webpack:///./~/codemirror/addon/edit/matchbrackets.js","webpack:///./~/codemirror/mode/clike/clike.js","webpack:///./src/js/codemirror/mode/glsl/glsl.js","webpack:///(webpack)/buildin/module.js","webpack:///./src/js/codemirror/lib/codemirror.js","webpack:///./src/js/codemirror/addon/selection/active-line.js","webpack:///./src/js/codemirror/addon/edit/closebrackets.js","webpack:///./src/js/codemirror/lib/util/formatting.js","webpack:///./src/js/codemirror/addon/search/match-highlighter.js","webpack:///./src/js/codemirror/addon/search/matchesonscrollbar.js","webpack:///./src/js/codemirror/addon/search/searchcursor.js","webpack:///./src/js/codemirror/addon/scroll/annotatescrollbar.js","webpack:///./src/js/codemirror/addon/comment/comment.js","webpack:///./src/js/codemirror/addon/hint/anyword-hint.js","webpack:///./src/js/codemirror/addon/hint/show-hint.js","webpack:///./src/js/codemirror/addon/hint/glsl-hint.js","webpack:///./src/js/codemirror/addon/dialog/dialog.js","webpack:///./src/js/codemirror/addon/search/search.js","webpack:///./src/js/codemirror/addon/search/jump-to-line.js","webpack:///./src/js/codemirror/addon/selection/selection-pointer.js","webpack:///./src/js/codemirror/addon/selection/mark-selection.js","webpack:///./src/js/codemirror/addon/fold/foldcode.js","webpack:///./src/js/codemirror/addon/fold/foldgutter.js","webpack:///./src/js/codemirror/addon/fold/brace-fold.js","webpack:///./src/js/util.js","webpack:///./src/js/buffer_data_container.js","webpack:///./src/js/shader/shaderlist.js"],"names":["ShaderBoy","init","glCanvasDom","document","getElementById","style","width","window","innerWidth","height","innerHeight","canvas","createElement","id","appendChild","gl","opts","alpha","depth","stencil","styleActiveLine","premultipliedAlpha","antialias","preserveDrawingBuffer","powerPreference","getContext","e","buffers","BufferDataContainer","gui","editor","io","loadShader","renderer","selectBuffer","recompile","setupInteraction","time","update","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","isPlaying","needUpdate","uniforms","iTime","appTime","iResolution","clientWidth","render","redrawHeader","iFrame","mouse","down","prev","curr","position","onload","ShaderLib","loadShaders","ShaderList","isEditorHide","needRecompile","needStatusInfo","settings","iTimeDelta","iDate","iMouse","FPS","FPS_INTERVAL","pnow","undefined","getGlobalTime","time_then","time_elapsed","startTime","pausedTime","offsetTime","Date","now","performance","mozNow","msNow","oNow","webkitNow","call","getTime","endCollection","setInterval","fps","toFixed","reset","pause","newShader","active","textData","shader","imageFS","commonFS","header","contents","innerText","base","domElement","backgroundColor","saveShader","localStorage","mainActive","commonActive","mainText","util","deepcopy","commonText","renderScale","codemirror","getValue","loaded","loadedNum","shaderNum","shaderInitialized","name","url","request","XMLHttpRequest","open","setRequestHeader","root","onreadystatechange","readyState","status","shaderTxt","responseText","console","log","send","ref","length","i","content","setting","buttonHeight","float","top","left","display","border","zIndex","color","fontSize","fontFamily","letterSpacing","marginTop","marginLeft","scrollMul","OS","navigator","appVersion","indexOf","elementPos","element","x","y","offsetParent","offsetLeft","offsetTop","eventPos","event","clientX","body","scrollLeft","documentElement","clientY","scrollTop","canvasMousePos","mousePos","canvasPos","onmousedown","button","clientHeight","mouseLeftDownCur","onmouseup","onmousemove","mousePositionCur","contextmenu","preventDefault","opacity","getExtension","shaders","mainFragCode","uniformFS","commonfooterFS","main","Shader","commonVS","screen","screenFS","createBuffer","commonCode","fragmentCode","recompileFragment","setFloatTextureParams","texture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA32F","RGBA","FLOAT","setUnsignedByteTextureParams","LINEAR","UNSIGNED_BYTE","mainFramebuffer","createFramebuffer","deleteTexture","mainTextures","push","createTexture","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","clearColor","clearDepth","clear","COLOR_BUFFER_BIT","viewport","begin","iChannel0","setUniforms","setTexture2d","drawTexture","end","frameTexture","drawScreen","flush","reverse","gGl","vertexSource","fragmentSource","regexMap","regex","text","result","exec","compileSource","type","source","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","Error","getShaderInfoLog","attributes","uniformLocations","program","createProgram","quadVBO","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","triVBO","attachShader","VERTEX_SHADER","FRAGMENT_SHADER","linkProgram","vertAttLocation","getAttribLocation","enableVertexAttribArray","getProgramParameter","LINK_STATUS","getProgramInfoLog","isSampler","groups","replace","deleteProgram","useProgram","disableVertexAttribArray","isArray","obj","str","Object","prototype","toString","isNumber","location","getUniformLocation","uniform1i","realName","value","v","m","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniformMatrix3fv","uniformMatrix4fv","uniform1f","eval","TEXTURE_CUBE_MAP","vertexAttribPointer","drawArrays","TRIANGLES","fbo","AssetLoader","envMapTexture","isPowerOf2","level","internalFormat","srcFormat","srcType","pixel","Uint8Array","image","Image","src","HDRParser","loadBinary","err","hdr","imgHdr","parseHdr","shape","data","radiancePattern","commentPattern","exposurePattern","formatPattern","widthHeightPattern","scope","responseType","response","ldexp","mantissa","exponent","Math","pow","readPixelsRawRLE","buffer","offset","fileOffset","scanlineWidth","numScanlines","rgbe","Array","scanlineBuffer","ptr","ptrEnd","count","buf","bufferLength","readBuf","bytesRead","readBufOffset","readPixelsRaw","numpixels","numExpected","numRead","ArrayBuffer","NEW_LINE","readLine","b","String","fromCharCode","exposure","gamma","rle","line","match","Number","floatData","r","g","f","floatOffset","oldCursor","ch","setAttribute","textAlign","textArea","CodeMirror","fromTextArea","lineNumbers","smartIndent","mode","indentWithTabs","keyMap","autoCloseBrackets","matchBrackets","showCursorWhenSelecting","theme","foldGutter","continuousScanning","styleCursor","indentUnit","showInvisibles","maxInvisibles","selectionPointer","styleSelectedText","cm","somethingSelected","indentSelection","replaceSelection","getOption","join","getSelectedRange","from","getCursor","to","range","autoFormatRange","parent","setSize","save","isInit","doc","getDoc","cursor","curCursor","setValue","setCursor","refresh","w","h","mod","exports","module","require","define","defineMode","config","parserConfig","keywords","builtins","blockKeywords","atoms","hooks","multiLineStrings","isOperatorChar","curPunc","tokenBase","stream","state","next","tokenize","tokenString","test","eatWhile","eat","tokenComment","skipToEnd","cur","current","propertyIsEnumerable","quote","escaped","maybeEnd","Context","indented","column","align","pushContext","col","context","popContext","t","startState","basecolumn","startOfLine","token","ctx","sol","indentation","eatSpace","indent","textAfter","firstChar","charAt","closing","electricChars","words","split","glslKeywords","glslBuiltins","cppHook","tokenAtString","defineMIME","global","factory","userAgent","platform","gecko","ie_upto10","ie_11up","edge","ie","ie_version","documentMode","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","flipCtrlCmd","captureRightClick","classTest","cls","RegExp","rmClass","node","className","after","slice","index","removeChildren","childNodes","removeChild","firstChild","removeChildrenAndAdd","elt","tag","cssText","createTextNode","eltP","createRange","start","endNode","setEnd","setStart","createTextRange","moveToElementText","parentNode","collapse","moveEnd","moveStart","contains","child","nodeType","host","activeElt","activeElement","shadowRoot","addClass","joinClasses","a","as","selectInput","select","selectionStart","selectionEnd","_e","bind","args","arguments","apply","copyObj","target","overwrite","prop","hasOwnProperty","countColumn","string","tabSize","startIndex","startValue","search","n","nextTab","Delayed","set","ms","clearTimeout","array","scrollerGap","Pass","sel_dontScroll","scroll","sel_mouse","origin","sel_move","findColumn","goal","pos","skipped","min","spaceStrs","spaceStr","lst","arr","map","out","insertSorted","score","priority","splice","nothing","createObj","props","inst","create","nonASCIISingleCaseWordChar","isWordCharBasic","toUpperCase","toLowerCase","isWordChar","helper","isEmpty","extendingChars","isExtendingChar","charCodeAt","skipExtendingChars","dir","findFirst","pred","abs","mid","floor","Display","place","input","d","scrollbarFiller","gutterFiller","lineDiv","selectionDiv","cursorDiv","measure","lineMeasure","lineSpace","lines","mover","sizer","sizerWidth","heightForcer","gutters","lineGutter","scroller","wrapper","paddingRight","draggable","viewFrom","viewTo","first","reportedViewFrom","reportedViewTo","view","renderedView","externalMeasured","viewOffset","lastWrapHeight","lastWrapWidth","updateLineNumbers","nativeBarWidth","barHeight","barWidth","scrollbarsClipped","lineNumWidth","lineNumInnerWidth","lineNumChars","alignWidgets","cachedCharWidth","cachedTextHeight","cachedPaddingH","maxLine","maxLineLength","maxLineChanged","wheelDX","wheelDY","wheelStartX","wheelStartY","shift","selForContextMenu","activeTouch","getLine","size","chunk","children","sz","chunkSize","getBetween","iter","getLines","updateLineHeight","diff","lineNo","no","lineAtHeight","outer","i$1","lh","isLine","l","lineNumberFor","options","lineNumberFormatter","firstLineNumber","Pos","sticky","cmp","equalCursorPos","copyPos","maxPos","minPos","clipLine","max","clipPos","last","clipToLen","linelen","clipPosArray","sawReadOnlySpans","sawCollapsedSpans","seeReadOnlySpans","seeCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","addMarkedSpan","markedSpans","concat","attachLine","markedSpansBefore","old","startCh","isInsert","nw","startsBefore","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","markedSpansAfter","endCh","stretchSpansOverChange","change","full","oldFirst","oldLast","sameLine","found","span$1","found$1","clearEmptySpans","newMarkers","gap","gapMarkers","i$2","i$3","clearWhenEmpty","removeReadOnlyRanges","markers","mark","readOnly","parts","mk","find","j","p","newParts","dfrom","dto","detachMarkedSpans","detachLine","attachMarkedSpans","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","conflictingCollapsedRange","lineNo$$1","visualLine","merged","visualLineEnd","visualLineContinued","visualLineNo","lineN","vis","visualLineEndNo","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","lineLength","len","findMaxLine","iterateBidiSections","order","part","bidiOther","getBidiPartAt","bidiOrdering","lowTypes","arabicTypes","charType","code","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","direction","outerType","types","type$1","prev$1","type$2","i$4","type$3","i$5","cur$1","type$4","i$6","end$1","before","replace$1","j$1","i$7","at","j$2","nstart","unshift","getOrder","moveCharLogically","moveLogically","endOfLine","visually","moveInStorageOrder","prep","prepareMeasureForLine","targetTop","measureCharPrepared","moveVisually","bidi","partPos","mv","getWrappedLineExtent","lineWrapping","wrappedLineExtentChar","wrappedLineExtent","searchInVisualLine","getRes","res","nextCh","noHandlers","on","emitter","addEventListener","attachEvent","map$$1","_handlers","getHandlers","off","removeEventListener","detachEvent","signal","handlers","signalDOMEvent","override","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","e_preventDefault","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","which","ctrlKey","dragAndDrop","div","zwspSupported","zeroWidthElement","offsetHeight","offsetWidth","badBidiRects","hasBadBidiRects","txt","r0","getBoundingClientRect","r1","right","splitLinesAuto","nl","rt","hasSelection","getSelection","te","range$$1","ownerDocument","selection","parentElement","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","hasBadZoomedRects","normal","fromRange","modes","mimeModes","dependencies","mime","spec","resolveMode","getMode","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","copyState","nstate","val","innerMode","info","a1","a2","StringStream","lastColumnPos","lastColumnValue","lineStart","eol","peek","ok","this$1","skipTo","backUp","pattern","consume","caseInsensitive","cased","substr","hideFirstChars","inner","highlightLine","forceToEnd","st","modeGen","lineClasses","runMode","loop","o","overlay","overlays","i_end","opaque","styles","classes","bgClass","textClass","getLineStyles","updateFrontier","getStateBefore","maxHighlightLength","stateAfter","styleClasses","frontier","precise","findStartLine","processLine","startAt","callBlankLine","readToken","blankLine","takeToken","asArray","getObj","copy","tokens","extractLineClasses","output","lineClass","flattenSpans","curStart","curStyle","addModeClass","mName","minindent","minline","lim","Line","estimateHeight","updateLine","estHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","rest","addToken","buildToken","buildTokenBadBidi","allowFrontierUpdate","insertLineContent","maps","caches","lastChild","querySelector","defaultSpecialCharPlaceholder","title","startStyle","endStyle","css","displayText","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","specialCharPlaceholder","fullStyle","trailingBefore","spaceBefore","buildCollapsedSpan","ignoreWidget","widget","needsContentAttribute","setUneditable","allText","nextChange","spanStyle","spanEndStyle","spanStartStyle","Infinity","foundBookmarks","endStyles","upto","tokenText","LineView","hidden","buildViewArray","nextPos","operationGroup","pushOperation","op","ops","ownsGroup","delayedCallbacks","fireCallbacksForOps","group","callbacks","cursorActivityCalled","finishOperation","endCb","orphanDelayedCallbacks","signalLater","list","fireOrphanDelayed","delayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","updateLineBackground","background","wrap","insertBefore","getLineContent","ext","built","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","gutterMarkers","wrap$1","gutterWrap","lineNumber","gutterLeft","k","gutterWidth","alignable","nextSibling","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","noHScroll","wrapperWidth","coverGutter","paddingLeft","widgetHeight","parentStyle","eventInWidget","getAttribute","paddingTop","paddingVert","paddingH","getComputedStyle","currentStyle","parseInt","isNaN","scrollGap","displayWidth","displayHeight","ensureLineHeights","rect","wrapping","curWidth","heights","rects","getClientRects","bottom","mapFromLineView","updateExternalMeasurement","measureChar","bias","findViewForLine","findViewIndex","getDimensions","forceUpdate","hasHeights","prepared","varHeight","key","measureCharInner","bogus","rtop","rbottom","nullRect","nodeAndOffsetInLineMap","mStart","mEnd","coverStart","coverEnd","getUsefulRect","maybeUpdateRectForZooming","rSpan","charWidth","rbot","bot","singleCursorHeightPerLine","logicalXDPI","deviceXDPI","scaleX","scaleY","logicalYDPI","deviceYDPI","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","pageScrollX","pageXOffset","pageScrollY","pageYOffset","intoCoordSystem","includeWidgets","yOff","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","charCoords","cursorCoords","preparedMeasure","get","getBidi","invert","other","estimateCoords","PosWithInfo","outside","xRel","coordsChar","coordsCharInner","mergedPos","assign","beginLeft","prevDiff","prevPos","box","measureText","textHeight","anchor","clientLeft","compensateForHScroll","th","perLine","widgetsHeight","ceil","estimateLineHeights","est","posFromMouse","liberal","forRect","space","colDiff","round","updateSelection","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","sel","ranges","primIndex","empty","drawSelectionCursor","head","drawSelectionRange","cursorHeight","otherCursor","fragment","padding","leftSide","rightSide","add","drawForLine","fromArg","toArg","lineLen","leftPos","rightPos","tmp","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","focused","clearInterval","blinker","visibility","cursorBlinkRate","ensureFocus","focus","onFocus","delayBlurEvent","delayingBlurEvent","onBlur","receivedFocus","updateHeightsInViewport","prevBottom","updateWidgetHeight","visibleLines","ensure","ensureFrom","ensureTo","alignHorizontally","comp","gutterW","maybeUpdateLineNumberWidth","innerW","updateGutterSpace","maybeScrollWindow","doScroll","scrollNode","scrollIntoView","scrollPosIntoView","margin","limit","changed","endCoords","scrollPos","calculateScrollPos","startTop","startLeft","updateScrollTop","setScrollLeft","snapMargin","screentop","docBottom","atTop","atBottom","newTop","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","scrollToPos","cursorScrollMargin","scrollToCoords","scrollToRange","scrollToCoordsRange","sPos","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","isScroller","scrollWidth","measureForScrollbars","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","checkedZeroWidth","minHeight","minWidth","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","delay","maybeDisable","elt$$1","elementFromPoint","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","borderBottom","coverGutterNextToScrollbar","scrollbarModel","initScrollbars","scrollbarStyle","axis","nextOpId","startOperation","viewChanged","updateInput","typing","changeObjs","selectionChanged","updateMaxLine","endOperation","endOperations","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","maybeClipScrollbars","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","hasFocus","setDocumentHeight","postUpdateDisplay","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","operation","methodOp","docMethodOp","regChange","lendiff","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","adjustView","countDirtyView","dirty","highlight","highlightWorker","workTime","changedLines","oldStyles","tooLong","highlighted","oldCls","newCls","ischange","workDelay","force","visible","editorIsHidden","wrapperHeight","oldDisplayWidth","events","marginBottom","borderRightWidth","selectionSnapshot","anchorNode","extend","anchorOffset","focusNode","focusOffset","restoreSelection","snapshot","removeAllRanges","addRange","viewportMargin","different","toUpdate","selSnapshot","patchDisplay","updateNumbersFrom","container","rm","currentWheelTarget","updateNumber","updateGutters","specs","gElt","setGuttersForLineNumbers","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","delta","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","equals","here","there","deepCopy","Range","normalizeSelection","prim","sort","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","computeReplacedSel","hint","oldPrev","newPrev","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","estimateHeight$$1","spansFor","linesFor","firstLine","lastText","lastSpans","nlines","insert","remove","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","shared","attachDoc","setDirectionClass","directionChanged","History","startGen","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","pop","lastChangeEvent","hist","addChangeToHistory","selAfter","opId","history","historyEventDelay","pushSelectionToHistory","selectionEventCanBeMerged","addSelectionToHistory","clearRedo","dest","existing","removeClearedSpans","explicitlyCleared","getOldSpans","mergeOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","newGroup","instantiateSel","newChanges","extendRange","posBefore","extendSelection","setSelection","extendSelections","heads","newSel","replaceOneSelection","setSimpleSelection","filterSelectionChange","setSelectionReplaceHistory","setSelectionNoUndo","NaN","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","atomic","near","movePos","far","cantEdit","selectAll","filterChange","canceled","cancel","makeChange","ignoreReadOnly","suppressEdits","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","antiChanges","filter","returned","shiftDoc","distance","removed","makeChangeSingleDocInEditor","recomputeMaxLength","checkWidthStart","changesHandler","changeHandler","replaceRange","splitLines","rebaseHistSelSingle","rebaseHistArray","sub","copied","changeLine","handle","changeType","LeafChunk","removeInner","insertInner","iterN","BranchChunk","oldHeight","remaining","leaf","maybeSpill","me","spilled","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","oldH","addLineWidget","insertAt","aboveVisible","nextMarkerId","TextMarker","withOp","visual","side","dHeight","markText","markTextShared","replacedWith","addToHistory","curLine","clearOnEnter","clearHistory","SharedTextMarker","cloneNode","isParent","findSharedMarkers","findMarks","copySharedMarkers","mFrom","mTo","subMark","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","constructor","lineSeparator","getRange","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","listSelections","extendSelectionsBy","setSelections","addSelection","getSelections","dup","replaceSelections","undo","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","where","removeLineClass","removeLineWidget","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","unlinkDoc","CodeMirror$1","link","splitIds","iterLinkedDocs","getEditor","setDirection","eachLine","lastDrop","onDrop","clearDragCursor","files","dataTransfer","isReadOnly","FileReader","File","read","loadFile","file","allowDropFileTypes","reader","readAsText","draggingText","text$1","getData","selected","onDragStart","setData","effectAllowed","setDragImage","img","_top","onDragOver","frag","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","globalsRegistered","ensureGlobalHandlers","registerGlobalHandlers","resizeTimer","onResize","keyNames","basic","pcDefault","fallthrough","emacsy","macDefault","normalizeKeyName","alt","ctrl","cmd","normalizeKeyMap","keymap","keyname","keys","lookupKey","getKeyMap","isModifierKey","keyCode","keyName","noShift","altGraphKey","altKey","metaKey","shiftKey","deleteNearSelection","compute","kill","toKill","replaced","commands","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","lineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","execCommand","transposeChars","newlineAndIndent","sels","indentLine","openLine","toggleOverwrite","firstNonWS","inWS","doHandleBinding","bound","dropShift","ensurePolled","prevShift","lookupKeyForEditor","keyMaps","extraKeys","stopSeq","dispatchKey","seq","keySeq","handleKeyBinding","motion","handleCharBinding","lastStoppedKey","onKeyDown","handled","showCrossHair","up","onKeyUp","onKeyPress","charCode","onMouseDown","supportsTouch","clickInGutter","selectingText","leftButtonDown","lastMiddleDown","onContextMenu","lastClick","lastDoubleClick","modifier","contained","dragDrop","leftButtonStartDrag","leftButtonSelect","moved","dragEnd","mouseMove","dragStart","e2","addNew","ourRange","ourIndex","startSel","word","findWordAt","lastPos","extendTo","startCol","posCol","oldRange","ranges$1","editorSize","counter","curCount","move","gutterEvent","prevent","mX","mY","lineBox","contextMenuInGutter","themeChanged","Init","defaults","optionHandlers","defineOptions","option","deflt","notOnInit","defineOption","newBreaks","getInputField","spellcheck","guttersChanged","detach","attach","wrappingChanged","integer","blur","disabled","readOnlyChanged","dragDropChanged","resetPosition","getField","tabIndex","wasOn","funcs","dragFunctions","toggle","enter","over","leave","drop","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","registerEventHandlers","finishInit","initHooks","textRendering","touchFinished","prevTouch","finishTouch","isMouseLikeTouchEvent","touches","touch","radiusX","radiusY","farAway","pageX","pageY","inp","defineInitHook","how","aggressive","curSpace","curSpaceString","indentString","pos$1","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","paste","textLines","multiPaste","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","getModeAt","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","hiddenTextarea","addEditorMethods","helpers","setOption","addKeyMap","removeKeyMap","addOverlay","modeSpec","removeOverlay","newRanges","getTokenAt","getLineTokens","getTokenTypeAt","getHelper","getHelpers","help","_global","getStateAfter","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","findPosH","amount","unit","hitSide","rtlMoveVisually","findPosV","goalColumn","goals","headPos","startChar","check","scrollTo","getScrollInfo","interpret","swapDoc","getWrapperElement","getScrollerElement","getGutterElement","registerHelper","registerGlobalHelper","predicate","origDir","findNextLine","moveOnce","boundToLine","sawType","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","updateFromDOM","readFromDOMSoon","forceCompositionEnd","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","showMultipleSelections","curAnchor","domToPos","curFocus","bad","posToDOM","rangeCount","getRangeAt","rng","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","pollSelection","poll","pollInterval","isInGutter","pollContent","fromIndex","fromNode","toIndex","toNode","previousSibling","newText","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","scan","badPos","recognizeMarker","close","addText","walk","cmText","textContent","markerID","isBlock","nodeName","nodeValue","lineNode","locateNodeInLineView","textNode","topNode","curNode","dist","dist$1","TextareaInput","prevInput","pollingFast","inaccurateSelection","textarea","fastPoll","prepareCopyCut","moveInputWithCursor","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","minimal","slowPoll","missed","same","resetSelectionOnContextMenu","oldCSS","oldWrapperCSS","wrapperBox","oldScrollY","scrollY","detectingSelectAll","prepareSelectAllHack","extval","rehide","mouseup","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","addLegacyProps","cmpPos","dontDelegate","method","defineExtension","func","defineDocExtension","version","WRAP_CLASS","BACK_CLASS","GUTT_CLASS","selectionChange","clearActiveLines","activeLines","updateActiveLines","sameArray","nonEmpty","pairs","triples","explode","closeBrackets","ensureBound","conf","Backspace","handleBackspace","Enter","handleEnter","chars","handler","handleChar","getConfig","around","charsAround","linesep","contractSelection","inverted","identical","opening","curType","stringStartsAfter","commentStart","commentEnd","newlineAfterToken","jsonMode","lexical","isComment","curMode","selText","endIndex","lastIndexOf","substring","cmInstance","atSol","newline","minChars","wordsOnly","annotateScrollbar","showToken","trim","State","timeout","matchesonscroll","matchHighlighter","highlightMatches","scheduleHighlight","query","hasBoundary","makeOverlay","showMatchesOnScrollbar","searchFor","re","isWord","chr","boundariesAround","caseFold","SearchAnnotation","annotateOptions","listenForChanges","annotation","matches","findMatches","self","_cm","onChange","MAX_MATCHES","getSearchCursor","maxMatches","findNext","offsetLine","changeStart","sizeChange","startLine","endLine","newFrom","newTo","updateAfterChange","regexpFlags","regexp","flags","ignoreCase","multiline","ensureFlags","maybeMultiline","searchRegexpForward","searchRegexpForwardMultiline","inside","lastMatchIn","cutOff","newMatch","searchRegexpBackward","searchRegexpBackwardMultiline","doFold","noFold","normalize","adjustPos","orig","folded","foldFunc","searchStringForward","fold","cutFrom","endString","searchStringBackward","topString","SearchCursor","atOccurrence","findPrevious","Annotation","scrollButtonHeight","annotations","doRedraw","doUpdate","computeScale","scheduleRedraw","redraw","resizeHandler","hScale","anns","singleLineH","curLineObj","getY","topY","nextTop","ann","noOptions","nonWS","toggleComment","minLine","uncomment","lineComment","probablyInsideString","useInnerComments","commentString","blockCommentStart","fullLines","blockComment","pad","blankLines","commentBlankLines","baseString","whitespace","startString","blockCommentEnd","lastLineHasText","lead","blockCommentLead","lineString","didSomething","endPos","insideStart","insideEnd","lastStart","firstEnd","almostLastStart","openEnd","foundEnd","WORD","RANGE","curWord","seen","HINT_ELEMENT_CLASS","ACTIVE_HINT_ELEMENT_CLASS","showHint","getHints","async","newOpts","parseOptions","selections","supportsSelection","completionActive","completion","Completion","debounce","tick","startPos","startLen","activityFunc","fn","cancelAnimationFrame","pick","getText","closeCharacters","disable","myTick","fetchHints","finishUpdate","picked","completeSingle","Widget","hintOptions","defaultOptions","resolve","buildKeyMap","baseMap","Up","moveFocus","Down","PageUp","menuSize","PageDown","Home","setFocus","End","Tab","Esc","custom","customKeys","ourMap","addBinding","extra","getHintElement","hintsElement","el","hints","selectedHint","completions","hintId","alignWithWord","below","winW","winH","overlapY","scrolls","startScroll","curTop","overlapX","avoidWrap","changeActive","screenAmount","closeOnUnfocus","closingOnBlur","onScroll","curScroll","point","completeOnSingleClick","applicableHelpers","then","resolveAutoHints","resolved","app","run","fromList","anyword","term","autocomplete","auto","forEach","arrayContains","item","glslTypes","glslTypesQualifiers","glslPreProcessor","scriptHint","getToken","tprop","variableNames","lineContent","containsType","typeIndex","variableName","getCompletions","glslHint","maybeAdd","dialogDiv","template","dialog","innerHTML","closeNotification","newVal","currentNotificationClose","closed","onClose","getElementsByTagName","selectValueOnOpen","onInput","closeOnEnter","closeOnBlur","buttons","blurring","doneTimer","duration","searchOverlay","SearchState","posFrom","posTo","lastQuery","getSearchState","queryCaseInsensitive","persistentDialog","onEnter","openDialog","clearSearch","shortText","prompt","confirmDialog","fs","openConfirm","confirm","parseString","_","parseQuery","isRE","startSearch","queryText","annotate","doSearch","rev","persistent","immediate","q","hiding","searchNext","getQueryDialog","phrase","getReplaceQueryDialog","getReplacementQueryDialog","getDoReplaceConfirm","replaceAll","all","dialogText","advance","doReplace","findPersistent","findPersistentNext","findPersistentPrev","findPrev","getJumpDialog","interpretLine","num","jumpToLine","posStr","mousemove","mouseout","windowScroll","mouseX","mouseY","willUpdate","scheduleUpdate","relatedTarget","markedSelection","markedSelectionStyle","onCursorActivity","CHUNK_SIZE","coverRange","addAt","atEnd","finder","minSize","allowFolded","marks","__isFold","cleared","myWidget","makeWidget","myRange","newFoldFunction","rangeFinder","toggleFold","foldCode","unfold","foldAll","unfoldAll","minFoldSize","scanUp","editorOptions","foldOptions","onGutterClick","onViewportChange","onFold","updateInViewport","indicatorOpen","indicatorFolded","isFolded","updateFoldInfo","foldOption","vp","changeUpdate","foldOnChangeTimeSpan","updateViewportTimeSpan","lineText","tokenType","findOpening","openCh","pass","startToken","endToken","nextOpen","nextClose","hasImport","semi","has","hasInclude","newstr","isCommon","textures","framebuffer"],"mappings":"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AkB;AAClB,cAAa,6CAA6C;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;;AAEA,WAAU,KAAK;;AAEf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,eAAe;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,gBAAe,2BAA2B;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,4EAA4E;AACvG;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,gBAAe,yBAAyB;AACxC;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,2BAA2B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,4BAA2B;AAC3B,uBAAsB;;AAEtB;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;;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CA;AACA;AACA;AACA;AACA,EAAC;AACD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAkE,UAAU;AAC5E;AACA;AACA;AACA;AACA,0BAAyB,cAAc,YAAY;AACnD,QAAO;AACP;AACA;AACA,sDAAqD,YAAY,UAAU;AAC3E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA,sCAAqC,qBAAqB;AAC1D,uCAAsC,oBAAoB;;AAE1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA,iCAAgC,iBAAiB;AACjD;AACA,4BAA2B;AAC3B,mEAAkE;AAClE;AACA;AACA;;AAEA;AACA;AACA,gDAA+C,cAAc;AAC7D;;AAEA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA,sBAAqB;AACrB,wDAAuD;AACvD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA,4BAA2B,qBAAqB;AAChD;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA,wCAAuC,8BAA8B;;AAErE,yCAAwC,6BAA6B;;AAErE;AACA;AACA;AACA;AACA,aAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA,4CAA2C,8BAA8B;AACzE,4CAA2C,6BAA6B;;AAExE;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA;;AAEA,qBAAoB;AACpB;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,6BAA4B,oCAAoC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA,qBAAoB;AACpB,mEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,wBAAwB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA,oCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,QAAQ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA,uBAAsB,eAAe;AACrC;;AAEA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA,oBAAmB,uDAAuD;AAC1E;AACA;AACA;AACA,sBAAqB,mBAAmB;AACxC;AACA;AACA,mCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,mCAAmC;AACxD;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA,sBAAqB,gBAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;;AAGA;AACA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,QAAQ,QAAQ;AAC3C;AACA,YAAW;AACX;AACA,oCAAmC,oCAAoC;AACvE;AACA;AACA,MAAK;AACL;;AAEA,kCAAiC,qBAAqB;AACtD,6CAA4C,sBAAsB;;AAElE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA,sBAAqB,kBAAkB;AACvC;AACA;AACA,0BAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,6CAA6C;AACvF;AACA;;AAEA;AACA;AACA,+BAA8B,kBAAkB;AAChD;AACA;;AAEA;AACA;AACA,+BAA8B,kBAAkB;AAChD;AACA;AACA;AACA;AACA,sBAAqB,mCAAmC;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,mBAAmB;AACxC;AACA,6BAA4B,iBAAiB,uBAAuB;AACpE;AACA;AACA;AACA,2CAA0C,QAAQ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,uCAAsC,QAAQ;AAC9C;AACA,0CAAyC,yBAAyB;AAClE;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA,sCAAqC,QAAQ;AAC7C;AACA;AACA,MAAK;AACL;;AAEA;AACA,8CAA6C,0BAA0B,EAAE;AACzE;AACA;AACA,8CAA6C,0BAA0B,EAAE;AACzE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C,cAAc,WAAW,YAAY;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,uBAAuB;AACxD,0CAAyC,uBAAuB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,mCAAmC;AACvD;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;;;;;;AClrBD;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAC,qBAAqB;;AAEtB;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAoC,GAAG;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAqB,4CAA4C;AACjE,8CAA6C,gBAAgB,eAAe;AAC5E;AACA;AACA;;AAEA,0BAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAuC,WAAW;AAClD,MAAK,6BAA6B;AAClC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB,yBAAyB;AAC3C,eAAc,yBAAyB;AACvC,oCAAmC,iDAAiD;AACpF,sBAAqB,gBAAgB,oBAAoB,OAAO,2BAA2B,EAAE;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4BAA2B;AAC3B;AACA;AACA;AACA;AACA,GAAE;AACF,OAAM;AACN;AACA,QAAO,sCAAsC;AAC7C,aAAY;AACZ;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA,MAAK,0BAA0B;AAC/B;AACA,MAAK;AACL;AACA,gCAA+B,oBAAoB;AACnD,2BAA0B;AAC1B,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK,wDAAwD;AAC7D;AACA;;AAEA;AACA;AACA,uCAAsC,8CAA8C;AACpF;AACA;AACA;AACA,kBAAiB,eAAe;AAChC,MAAK,0CAA0C,kBAAkB,EAAE;AACnE;AACA;;AAEA,mCAAkC,eAAe;AACjD;AACA,IAAG,+BAA+B,yBAAyB,uCAAuC,GAAG;AACrG;AACA,IAAG,+BAA+B,MAAM,eAAe,EAAE,aAAa,GAAG;;AAEzE;AACA;AACA,qBAAoB;AACpB;;AAEA;AACA,iBAAgB,aAAa;AAC7B;AACA,MAAK;AACL,QAAO,0BAA0B,EAAE;AACnC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAoB,qBAAqB;AACzC;AACA,sDAAqD;AACrD;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,2BAA0B;AAC1B;AACA;AACA;AACA;;AAEA;AACA,kBAAiB,kBAAkB;AACnC,MAAK,uBAAuB,WAAW;AACvC;AACA;;AAEA;AACA;;AAEA;AACA;AACA,aAAY,qBAAqB;;AAEjC;AACA,uBAAsB;AACtB,kBAAiB;AACjB,iBAAgB;;AAEhB;AACA;AACA;AACA,8BAA6B;AAC7B;AACA,yBAAwB,yBAAyB;AACjD;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA,MAAK,sCAAsC;AAC3C;AACA;;AAEA,oBAAmB;;AAEnB;AACA;AACA,kBAAiB,kBAAkB,OAAO,yBAAyB;AACnE;AACA;;AAEA;AACA;AACA,gEAA+D,OAAO;AACtE;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,eAAc,sBAAsB;AACpC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB,kEAAiE;AACjE;AACA;;AAEA;AACA,uBAAsB,uCAAuC,eAAe;AAC5E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B;;AAE9B,yCAAwC;AACxC;AACA,uFAAsF,YAAY;AAClG;AACA;;AAEA,6CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,sBAAqB;AACrB;AACA,uBAAsB;AACtB,qBAAoB,UAAU;AAC9B,WAAU,kBAAkB;AAC5B;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA8D,+BAA+B,YAAY;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA6B,6BAA6B,mCAAmC;AAC7F,uCAAsC,6BAA6B;;AAEnE;AACA,6BAA4B,8BAA8B;AAC1D,WAAU,kBAAkB;AAC5B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA;AACA,qBAAoB;AACpB;AACA,oBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,8BAA8B;AACtD,2BAA0B,6BAA6B;AACvD;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,uCAAsC,qBAAqB,EAAE,EAAE;AAC/D;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,mBAAmB,GAAG,gBAAgB,kBAAkB,EAAE;AACvE;;AAEA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA,+BAA8B,OAAO;AACrC,qBAAoB;AACpB,sCAAqC;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,6BAA6B;AAClD;AACA,oBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,SAAQ,wBAAwB;AAChC;AACA,kBAAiB;AACjB;AACA;AACA;AACA;;AAEA,0BAAyB;;AAEzB;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gCAA+B;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAoB;;AAEpB,gCAA+B;;AAE/B,sBAAqB;AACrB,wBAAuB;AACvB,wBAAuB;;AAEvB;AACA;AACA,4BAA2B;AAC3B;AACA,8BAA6B;AAC7B;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA,oCAAmC;AACnC,qBAAoB;AACpB,SAAQ;AACR;AACA;AACA;AACA,kBAAiB,kBAAkB,OAAO,iCAAiC;AAC3E;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,oBAAmB;AACnB;;AAEA;AACA;AACA,eAAc,gBAAgB,kBAAkB;AAChD;AACA,iCAAgC;AAChC,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC,MAAK,wBAAwB,gCAAgC,EAAE;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,gBAAgB,gBAAgB;AAC5C;AACA;AACA;AACA,2GAA0G;AAC1G;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,aAAY,gBAAgB,gBAAgB;AAC5C;AACA;AACA;AACA,+GAA8G;AAC9G;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA,+BAA8B;;AAE9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,kBAAkB;AACrC;AACA;AACA;AACA,sBAAqB,mBAAmB;AACxC,6BAA4B,uDAAuD;AACnF;AACA;AACA;AACA;AACA;AACA,sBAAqB,mBAAmB;AACxC;AACA,+BAA8B,qBAAqB;AACnD;AACA;AACA;AACA;AACA,0BAAyB,sCAAsC;AAC/D;AACA,QAAO;AACP;AACA,wBAAuB,sCAAsC;AAC7D;AACA;AACA;AACA;AACA,eAAc,gCAAgC;AAC9C,+BAA8B,8BAA8B;;AAE5D;AACA;AACA;AACA;AACA;AACA,QAAO,kBAAkB,oBAAoB;AAC7C,UAAS;AACT,YAAW,uFAAuF,EAAE,EAAE;AACtG,sBAAqB,WAAW;AAChC,QAAO,6BAA6B;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC;AACA;AACA,QAAO,sBAAsB;AAC7B;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA2B,gBAAgB,6BAA6B;AACxE;AACA;AACA,UAAS,wCAAwC;AACjD,MAAK;AACL,IAAG;AACH,kBAAiB;AACjB,iBAAgB,mBAAmB;AACnC,kBAAiB,oBAAoB;AACrC;AACA,oBAAmB,kBAAkB;AACrC;AACA,4DAA2D;AAC3D;AACA;AACA,UAAS,gBAAgB,yBAAyB,EAAE;AACpD;AACA,UAAS,gBAAgB,qBAAqB,EAAE;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe;AACf,kBAAiB,kBAAkB;AACnC,MAAK,kCAAkC;AACvC;AACA;AACA;AACA,gBAAe;AACf,kBAAiB,kBAAkB;AACnC,MAAK,kCAAkC;AACvC;AACA;;AAEA;AACA;AACA,6BAA4B;AAC5B,8BAA6B;;AAE7B;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,iBAAgB;AAChB;AACA,eAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,+BAA+B,gBAAgB;AAC3D;AACA;AACA;AACA,QAAO,mBAAmB;AAC1B,IAAG;AACH;AACA;AACA,sCAAqC;AACrC,oCAAmC;;AAEnC;AACA;AACA,aAAY,gBAAgB,gBAAgB;AAC5C;AACA;AACA,qEAAoE,mBAAmB;AACvF,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,gBAAgB,gBAAgB;AAC5C;AACA,gCAA+B;AAC/B;AACA;AACA;AACA,oEAAmE;AACnE;AACA;AACA,QAAO;AACP,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,mCAAmC;AACxC;AACA;;AAEA;AACA;AACA;AACA,MAAK,kCAAkC;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;;AAEA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA,kCAAiC;AACjC;AACA,MAAK,kCAAkC;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,+BAA+B,gBAAgB;AAC3D;AACA,gCAA+B;AAC/B,2BAA0B;AAC1B,gCAA+B;AAC/B;AACA,QAAO;AACP,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,iCAAgC,6BAA6B;AAC7D;AACA;AACA;AACA;AACA,4CAA2C;AAC3C;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB,wBAAwB;AACzC;AACA,2BAA0B;AAC1B,WAAU,kBAAkB;AAC5B;AACA,6BAA4B,GAAG;AAC/B,sBAAqB,yBAAyB;AAC9C;AACA,0BAAyB;AACzB,aAAY,iBAAiB;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA,gBAAe;AACf;AACA,kBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,oBAAoB;AACnC;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC;AACA,wCAAuC;AACvC;AACA,sDAAqD,WAAW;AAChE,aAAY,eAAe;AAC3B;AACA;AACA,sDAAqD,WAAW;AAChE,aAAY,eAAe;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB,+CAA8C;AAC9C,+CAA8C;AAC9C,+CAA8C;AAC9C,iDAAgD;AAChD,+BAA8B;AAC9B,WAAU;AACV;;AAEA;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA;;AAEA,sEAAqE;AACrE;AACA,oBAAmB,SAAS;AAC5B,QAAO,yCAAyC;;AAEhD;AACA;AACA;AACA;AACA,wCAAuC,WAAW;AAClD;AACA,yBAAwB,mBAAmB;AAC3C,aAAY,aAAa;AACzB;;AAEA;AACA;AACA;AACA;AACA;AACA,uCAAsC,WAAW;AACjD;AACA,yCAAwC,kBAAkB;AAC1D,wCAAuC,cAAc,qBAAqB,kBAAkB,EAAE;AAC9F;;AAEA;AACA;AACA;AACA,yCAAwC,eAAe;AACvD;AACA,mEAAkE,kBAAkB;AACpF;AACA,mDAAkD,qBAAqB;AACvE;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB,WAAW;AAChC;AACA,2BAA0B,kBAAkB;AAC5C;AACA;AACA,4BAA2B,gCAAgC;AAC3D;AACA,0BAAyB,SAAS,OAAO,oBAAoB;AAC7D;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAwC,WAAW;AACnD;AACA,2CAA0C,kBAAkB;AAC5D,wCAAuC,gBAAgB;AACvD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,WAAW;AAChC;AACA;AACA,8BAA6B,6CAA6C;AAC1E;AACA;AACA;AACA,4BAA2B,aAAa,SAAS,wBAAwB;AACzE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,WAAW;AAChC;AACA;AACA,oBAAmB,4CAA4C;AAC/D;AACA,QAAO;AACP;AACA,oBAAmB,gCAAgC;AACnD,4BAA2B,WAAW;AACtC;AACA,6BAA4B,gDAAgD;AAC5E;AACA,wBAAuB,2CAA2C;AAClE;AACA;AACA,YAAW,OAAO,OAAO;AACzB;AACA,yBAAwB,gDAAgD;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,uBAAsB,yDAAyD;AAC/E;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH,8DAA6D;AAC7D;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,UAAS,iEAAiE;AAC1E;AACA;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA,kBAAiB,qBAAqB,OAAO,+BAA+B;AAC5E;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK,MAAM,qCAAqC,8BAA8B,IAAI;AAClF;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA,kBAAiB,gBAAgB,OAAO;AACxC,MAAK,kBAAkB,EAAE;AACzB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,0CAAyC;AACzC,2CAA0C;AAC1C;;AAEA;AACA;;AAEA;AACA,0BAAyB,oBAAoB;AAC7C,SAAQ,uBAAuB;AAC/B;AACA;AACA,2BAA0B,qBAAqB;AAC/C,SAAQ,uBAAuB;AAC/B;AACA;AACA;AACA;AACA,qBAAoB,oBAAoB;;AAExC,uBAAsB;AACtB;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B,6BAA4B,OAAO;AACnC,6BAA4B,OAAO;AACnC;AACA,oCAAmC,OAAO;AAC1C;AACA;;AAEA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,2FAA2F;AAClG;AACA;AACA,wDAAuD,YAAY;AACnE;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA,oCAAmC,eAAe;AAClD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAC,sBAAsB,iCAAiC;;AAExD;AACA,QAAO;AACP,aAAY;AACZ,EAAC;AACD;AACA,QAAO;AACP;AACA,qDAAoD;AACpD;AACA;;AAEA;AACA;AACA,uBAAsB;AACtB,oCAAmC;AACnC;AACA,EAAC;;AAED;AACA;AACA,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK,8DAA8D;AACnE;AACA;;AAEA;AACA;AACA;;AAEA,0BAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,oCAAmC,UAAU,aAAa;AAC1D;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,iCAAgC,SAAS,WAAW;AACpD,SAAQ,iBAAiB,aAAa;AACtC;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA,wCAAuC;AACvC,0CAAyC,qCAAqC;AAC9E;AACA;AACA;AACA;AACA,yBAAwB,sCAAsC;AAC9D,wBAAuB;AACvB,MAAK,0CAA0C,EAAE;;AAEjD;AACA;;AAEA;AACA;AACA;AACA;AACA,qGAAoG;AACpG;AACA;;AAEA;AACA,wBAAuB;AACvB,wBAAuB;AACvB;AACA;AACA;AACA,gCAA+B,sBAAsB;AACrD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA;AACA;AACA,mBAAkB;AAClB;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2CAA0C;AAC1C,2CAA0C;AAC1C,4CAA2C;AAC3C;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,kCAAiC,kBAAkB;AACnD,SAAQ,sDAAsD;AAC9D,YAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4DAA2D,cAAc;AACzE;AACA;AACA,iDAAgD;AAChD;AACA;AACA,oBAAmB,iBAAiB;AACpC;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,kDAAkD;AAClF;AACA;AACA,+BAA8B,4BAA4B;AAC1D;AACA;AACA,IAAG;AACH;AACA,oCAAmC;AACnC,sCAAqC,6BAA6B;AAClE;AACA;AACA;AACA,8CAA6C;AAC7C;AACA;AACA,QAAO;AACP,YAAW,qBAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+CAA8C,uBAAuB;AACrE;AACA;;AAEA;AACA;;AAEA,0BAAyB;AACzB;AACA,MAAK,0BAA0B;AAC/B;AACA,WAAU;AACV;AACA;;AAEA;AACA;AACA,+BAA8B,qBAAqB;AACnD;;AAEA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAsE,4BAA4B,EAAE;AACpG;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,sCAAsC;AACjD;AACA;AACA;AACA,oBAAmB;AACnB;AACA;AACA;AACA,QAAO;AACP,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA,kBAAiB,8BAA8B;;AAE/C,WAAU;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,4BAA4B;AACjD;AACA;AACA,0BAAyB,oCAAoC;AAC7D,kCAAiC,0BAA0B;AAC3D;AACA,QAAO,iFAAiF;AACxF;AACA;AACA;;AAEA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,iBAAgB,iCAAiC;AACjD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,oCAAoC;AACvD;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAuB;AACvB,yBAAwB;AACxB;AACA,8BAA6B;AAC7B;;AAEA;AACA,kBAAiB,QAAQ;AACzB,iBAAgB,wCAAwC;AACxD;AACA,qCAAoC;AACpC;AACA;AACA;;AAEA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA,mBAAkB,2EAA2E;AAC7F;AACA;AACA;;AAEA;AACA,cAAa,QAAQ;AACrB;AACA,sBAAqB;AACrB;AACA;AACA;AACA,QAAO,6BAA6B;AACpC;AACA,QAAO,oCAAoC;AAC3C,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,8BAA6B,wCAAwC;AACrE;AACA;AACA;AACA,oBAAmB,qEAAqE;AACxF;AACA;AACA;AACA,wBAAuB,4CAA4C;AACnE;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,mBAAkB,sDAAsD;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,cAAc;AACpC,+BAA8B;AAC9B;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAuC;AACvC;AACA,yBAAwB,cAAc;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sCAAqC;AACrC;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAwB,wBAAwB;AAChD,qBAAoB,oBAAoB;AACxC,4BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA,kCAAiC,mCAAmC;AACpE;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA,kBAAiB,iDAAiD;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,+DAA+D;AACtE;AACA;AACA;AACA;AACA;AACA,UAAS,iFAAiF;AAC1F;AACA,UAAS,uFAAuF;AAChG;;AAEA;AACA;AACA,QAAO,2FAA2F;;AAElG;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,QAAO,mEAAmE;AAC1E;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO,gDAAgD;AACvD;;AAEA;AACA;AACA,MAAK,iFAAiF;;AAEtF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,iBAAiB;AAChD;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,yCAAyC;AAC5E,eAAc,0BAA0B;AACxC;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,oCAAmC,2CAA2C;AAC9E,eAAc,4BAA4B;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,yBAAyB;AAC9C,oBAAmB,uBAAuB;AAC1C;AACA,iBAAgB,qBAAqB;AACrC;AACA;AACA;AACA;;AAEA;AACA,6CAA4C;AAC5C;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA,QAAO,eAAe;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA,sBAAqB,kBAAkB;AACvC;AACA,qDAAoD;AACpD;AACA,4BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAe,2DAA2D;AAC1E;AACA;AACA,QAAO,sEAAsE;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,qBAAqB;AAC1C,QAAO,wHAAwH;AAC/H;AACA;;AAEA;AACA;AACA,UAAS;AACT,6BAA4B;AAC5B;AACA,wBAAuB;AACvB;AACA,sBAAqB,kBAAkB;AACvC;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,6BAA4B,gCAAgC;AAC5D,uBAAsB,sBAAsB,gBAAgB;AAC5D,gDAA+C,sCAAsC;AACrF,mDAAkD,yDAAyD;AAC3G,mCAAkC,iBAAiB;AACnD;AACA,cAAa,gBAAgB;AAC7B,UAAS;AACT;AACA;AACA;AACA,uBAAsB,kBAAkB,wBAAwB;AAChE,UAAS,wCAAwC,sCAAsC,EAAE,EAAE;;AAE3F,iDAAgD,kBAAkB,6BAA6B;AAC/F,UAAS,qDAAqD,EAAE;AAChE;AACA;AACA;AACA,oCAAmC;AACnC,mCAAkC,mBAAmB;AACrD;AACA;AACA,sBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,8BAA8B,YAAY;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB,UAAU;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAU,sBAAsB;AAChC,QAAO,yBAAyB;AAChC,oBAAmB,sBAAsB;AACzC;AACA;AACA,UAAS;AACT,YAAW,wEAAwE,EAAE;AACrF;AACA,IAAG;AACH;;AAEA;AACA;AACA,gBAAe;;AAEf,QAAO,4BAA4B;AACnC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,4BAA2B,iCAAiC,EAAE;AAC9D;;AAEA,kBAAiB,gBAAgB;AACjC;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,oBAAoB,OAAO,cAAc;AAC1D;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,6BAA6B;AAC9C;AACA,0BAAyB,8BAA8B;AACvD,iCAAgC,6CAA6C;AAC7E,gCAA+B,iCAAiC;AAChE,iCAAgC,uCAAuC;AACvE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,qEAAqE;AAC5E;AACA,gCAA+B,gCAAgC;AAC/D;AACA;AACA;;AAEA;AACA;AACA,aAAY,qCAAqC;AACjD;AACA,eAAc,qCAAqC;AACnD,WAAU,iEAAiE,4BAA4B;AACvG,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,2BAA2B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK,iEAAiE;AACtE;AACA,MAAK,8BAA8B;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yHAAwH;AACxH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,yDAAyD;AAChE;AACA,QAAO;AACP;AACA;AACA,2EAA0E,qDAAqD;AAC/H,mBAAkB,gBAAgB,+BAA+B;AACjE;AACA;AACA,UAAS;AACT,4EAA2E,6CAA6C;AACxH,MAAK;AACL;AACA;;AAEA;AACA,4BAA2B,2BAA2B;AACtD,6DAA4D,MAAM;AAClE;AACA;AACA,QAAO,iCAAiC;AACxC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB,kCAAkC;AACxD,yBAAwB,sCAAsC;;AAE9D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB,gBAAgB,0BAA0B;AAChE,MAAK,mEAAmE,EAAE;AAC1E;;AAEA;AACA,uBAAsB;AACtB;AACA,qCAAoC,eAAe;AACnD;AACA,qCAAoC,+CAA+C;AACnF;AACA;AACA;AACA,QAAO,2DAA2D;AAClE;AACA,QAAO,wBAAwB;AAC/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,uDAAuD;AACnF;AACA;;AAEA;AACA,+BAA8B;AAC9B;AACA,aAAY;AACZ;AACA,2CAA0C;AAC1C;AACA,QAAO,wEAAwE,EAAE;AACjF;AACA,QAAO,iEAAiE,EAAE;AAC1E;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA2B,sBAAsB;AACjD;AACA;AACA,QAAO;AACP;AACA;;AAEA;;AAEA,+BAA8B;AAC9B,gCAA+B;AAC/B;AACA,gCAA+B;AAC/B;AACA;AACA,eAAc;AACd,iDAAgD,+BAA+B;AAC/E;AACA;;AAEA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,sBAAsB;AAC3C;AACA;AACA,YAAW,sDAAsD;AACjE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK,SAAS,yDAAyD;AACvE,kBAAiB,0BAA0B;AAC3C,MAAK;AACL,QAAO,SAAS,iEAAiE,EAAE;AACnF,oBAAmB,4BAA4B;AAC/C,MAAK;AACL,QAAO,SAAS,mFAAmF,EAAE;AACrG;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAU,yBAAyB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK,4CAA4C;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAwB,SAAS;AACjC;AACA;AACA;AACA,IAAG;AACH;AACA,QAAO,4DAA4D;AACnE;AACA;AACA;AACA;AACA;AACA,wBAAuB,6BAA6B;AACpD;AACA,WAAU;AACV;AACA;AACA;;AAEA,iBAAgB;;AAEhB;AACA;AACA;AACA;AACA,kBAAiB,mBAAmB;AACpC;AACA;AACA;AACA,iBAAgB;AAChB;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,wBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA,UAAS,iBAAiB;AAC1B;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,WAAU;AACV;;AAEA;AACA;AACA,wBAAuB,gBAAgB,kBAAkB;AACzD,gDAA+C;AAC/C,IAAG,EAAE,OAAO,iCAAiC,UAAU;AACvD,kDAAiD;AACjD,IAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA,4BAA2B;AAC3B,sBAAqB,SAAS,SAAS;AACvC,8FAA6F,SAAS;AACtG,8HAA6H,OAAO;AACpI;AACA,UAAS,gDAAgD;AACzD;AACA,UAAS,sEAAsE;AAC/E,mDAAkD;AAClD;AACA;AACA;AACA;AACA,iCAAgC,4DAA4D;AAC5F,IAAG,OAAO;AACV,qBAAoB,2BAA2B;AAC/C;AACA;AACA,QAAO,sDAAsD;AAC7D;AACA,QAAO,qCAAqC;AAC5C;AACA;AACA;AACA;AACA,QAAO,SAAS,mGAAmG;AACnH;AACA,QAAO,iBAAiB;AACxB;;AAEA;AACA;AACA;AACA;AACA,SAAQ,wBAAwB;AAChC,MAAK,wBAAwB,QAAQ;AACrC;AACA,iBAAgB;AAChB;AACA;AACA,mCAAkC,qBAAqB;AACvD,+CAA8C,oBAAoB,uBAAuB;;AAEzF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,WAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAwB,gBAAgB,0BAA0B;AAClE,QAAO,iCAAiC,EAAE;AAC1C;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,4BAA4B;AAC7C,MAAK,kDAAkD;AACvD;;AAEA;AACA;AACA;AACA,kCAAiC,kCAAkC;AACnE;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA,2BAA0B;AAC1B;AACA;;AAEA;AACA;AACA,yBAAwB,gBAAgB,4BAA4B,OAAO;AAC3E,MAAK,4CAA4C,EAAE,EAAE;AACrD;AACA;;AAEA,gBAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA,2BAA0B;AAC1B,kBAAiB,mBAAmB;AACpC;AACA,4BAA2B,gCAAgC;AAC3D,SAAQ,+BAA+B;AACvC;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA,oBAAmB;AACnB;AACA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,WAAU;AACV;;AAEA;AACA,kBAAiB,qCAAqC;AACtD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,sDAAsD;AAC/E;AACA;AACA,iBAAgB,kBAAkB,EAAE,OAAO,kBAAkB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,gBAAe;;AAEf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,oDAAoD;AAC1E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kCAAiC,uCAAuC;AACxE;AACA;AACA,WAAU;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,oBAAoB;AACpC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA,MAAK;AACL,eAAc,OAAO;;AAErB;AACA,UAAS;AACT;AACA;AACA,sBAAqB;AACrB;AACA,kCAAiC;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA,wCAAuC,qEAAqE,EAAE;AAC9G,kCAAiC,6DAA6D,EAAE;AAChG,WAAU;AACV;;AAEA;AACA,0BAAyB,sDAAsD;AAC/E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B;AAC/B,yCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,8CAA6C,MAAM;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,yBAAyB;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAgD,OAAO;AACvD;AACA,kBAAiB,kBAAkB;AACnC;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,gCAAgC;AAC9C;AACA,2BAA0B,SAAS,6CAA6C;AAChF,uBAAsB,SAAS,6CAA6C;AAC5E;AACA;;AAEA;AACA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD;AACA;AACA;;AAEA;AACA;AACA,yCAAwC;AACxC;AACA;AACA;AACA;AACA,mBAAkB,iCAAiC;AACnD;AACA;;AAEA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA,4CAA2C,GAAG;AAC9C;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;;AAErC;AACA,wBAAuB,gBAAgB,yBAAyB;AAChE,oCAAmC,yCAAyC;AAC5E,MAAK;;AAEL;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAmC,mCAAmC;AACtE,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAAyE;;AAEzE;AACA;AACA,QAAO,4BAA4B,2BAA2B;AAC9D,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA,eAAc;AACd;AACA,kBAAiB,iBAAiB;AAClC;AACA,iBAAgB;AAChB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,kBAAiB,2BAA2B;AAC5C,8CAA6C;AAC7C;AACA,iGAAgG;AAChG;AACA;AACA,QAAO,qDAAqD;AAC5D;AACA,QAAO,+CAA+C;AACtD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2BAA0B;;AAE1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAkB,SAAS;AAC3B;AACA;AACA,uFAAsF,sBAAsB,kDAAkD,6DAA6D;AAC3N;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA,QAAO,OAAO;AACd;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC,gDAAgD;AACzF;AACA;;AAEA,qDAAoD,iBAAiB;AACrE,yCAAwC,eAAe;AACvD,iDAAgD,eAAe;AAC/D,uCAAsC,aAAa;AACnD,MAAK;AACL,aAAY;AACZ;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,QAAO,qDAAqD;AAC5D;;AAEA;AACA;;AAEA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA,MAAK,4CAA4C,wEAAwE,EAAE;AAC3H,mCAAkC;AAClC;AACA,MAAK,+CAA+C;AACpD;;AAEA;AACA,2BAA0B,0BAA0B,aAAa;AACjE;;AAEA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA,IAAG,EAAE;AACL;;AAEA;AACA,oCAAmC,oCAAoC;;AAEvE,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,yBAAyB,qCAAqC,EAAE,MAAM,EAAE;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC;;AAEnC;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,yBAAyB,0BAA0B,EAAE,EAAE;AACjF;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,yBAAyB;AAC1C;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,sBAAqB,8BAA8B;AACnD;AACA;AACA;AACA,sBAAqB,gBAAgB,qBAAqB;AAC1D,UAAS,iCAAiC,EAAE;AAC5C;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,gBAAgB,yBAAyB;AAC9D;AACA,kBAAiB,gCAAgC;AACjD,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAkB,OAAO,SAAS,OAAO,UAAU;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,WAAU;AACV;;AAEA;AACA;AACA;AACA;AACA,2FAA0F;AAC1F;AACA;AACA,kBAAiB,iBAAiB,OAAO;AACzC;AACA;AACA,UAAS,kCAAkC;AAC3C;AACA,UAAS,4CAA4C;AACrD;AACA;AACA,iBAAgB,gBAAgB,kBAAkB;AAClD,QAAO,4BAA4B,EAAE;AACrC,IAAG;AACH;AACA,MAAK,sDAAsD;AAC3D;;AAEA;AACA;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,oDAAmD;;AAEnD;AACA,gCAA+B,iBAAiB;AAChD,oGAAmG,kBAAkB;AACrH;AACA,sEAAqE,mGAAmG,0GAA0G,uDAAuD,wDAAwD;AACjY;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,WAAW;AAChC;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAsD,gBAAgB;AACtE;AACA;AACA;AACA,yDAAwD,gBAAgB;AACxE;AACA,oBAAmB;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA,qCAAoC,0CAA0C;AAC9E,sCAAqC,yCAAyC;AAC9E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,cAAc;AACnC;AACA;AACA,yCAAwC,iCAAiC;AACzE;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,+BAA8B,2BAA2B;AACzD;;AAEA;AACA;AACA;AACA,iBAAgB,kCAAkC;AAClD;AACA,MAAK,uBAAuB;AAC5B;AACA,MAAK,iEAAiE;AACtE;AACA,MAAK,+DAA+D;AACpE;AACA;;AAEA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA0B;AAC1B;;AAEA;AACA,gCAA+B,wBAAwB;AACvD,mBAAkB,yBAAyB;AAC3C,mBAAkB,wBAAwB;AAC1C;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,8CAA6C;AAC7C,gBAAe,0BAA0B,SAAS,EAAE;AACpD;AACA,eAAc,yBAAyB;AACvC;AACA;;AAEA;AACA;AACA,8DAA6D;AAC7D;AACA;AACA,8CAA6C,qCAAqC;AAClF;;AAEA;AACA;AACA;AACA;AACA,yGAAwG;AACxG;AACA;AACA,+CAA8C,sCAAsC;AACpF;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6EAA4E;AAC5E;AACA,eAAc;;AAEd;AACA,6BAA4B,oCAAoC;AAChE,IAAG;AACH;AACA,6BAA4B,wCAAwC;AACpE,IAAG;;AAEH;AACA;AACA,8BAA6B,gEAAgE;AAC7F;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA,uBAAsB,sBAAsB;AAC5C;AACA;;AAEA,WAAU;AACV;;AAEA;AACA,sCAAqC,6BAA6B;AAClE,2BAA0B,iEAAiE;AAC3F;;AAEA;AACA,oCAAmC,2BAA2B;AAC9D,0BAAyB,8DAA8D;AACvF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,kCAAkC;AAC1D,WAAU,+BAA+B;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,gDAA+C,SAAS,oBAAoB;AAC5E;AACA;AACA;;AAEA;AACA,kBAAiB,oCAAoC;AACrD;AACA;AACA,kBAAiB,mFAAmF;AACpG;AACA,QAAO,6BAA6B;AACpC;AACA,sCAAqC;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG,OAAO,sCAAsC;AAChD;AACA;AACA;AACA;AACA,IAAG,OAAO,mCAAmC;AAC7C;;AAEA,uBAAsB;;AAEtB;AACA;AACA;AACA;AACA,QAAO,6DAA6D;AACpE;;AAEA;AACA;AACA;AACA;AACA,8BAA6B,yBAAyB,iCAAiC,EAAE,KAAK;AAC9F,MAAK;AACL;AACA,IAAG;AACH,gCAA+B,wBAAwB;AACvD,WAAU,0BAA0B;AACpC,IAAG;AACH;AACA,MAAK,8DAA8D;AACnE;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC,QAAO,8BAA8B;AACrC;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,gBAAgB;AACjC,MAAK,yBAAyB;AAC9B,oBAAmB,kBAAkB;AACrC,MAAK,2BAA2B;AAChC,oBAAmB,kBAAkB;AACrC,MAAK,2BAA2B;AAChC,oBAAmB,kBAAkB;AACrC,MAAK,2BAA2B;AAChC,oBAAmB,kBAAkB;AACrC,MAAK,+BAA+B;AACpC;;AAEA;AACA;AACA;AACA,0BAAyB,iBAAiB;;AAE1C;AACA;AACA;AACA;AACA;AACA,6CAA4C,0CAA0C;AACtF;;AAEA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,6BAA6B;;AAEvD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK,yDAAyD;AAC9D;;AAEA;AACA;;AAEA;AACA;AACA;AACA,QAAO,qFAAqF;AAC5F;AACA;;AAEA;AACA;AACA,MAAK,iEAAiE;AACtE;AACA,MAAK,qCAAqC;AAC1C;AACA,MAAK,sCAAsC;;AAE3C,6BAA4B,kBAAkB;;AAE9C;AACA,MAAK,mCAAmC;AACxC,mBAAkB,oBAAoB;AACtC;;AAEA;AACA;;AAEA,2BAA0B,kCAAkC;;AAE5D;AACA;AACA,MAAK,kDAAkD;;AAEvD;AACA,8BAA6B,gDAAgD;;AAE7E,+BAA8B,8CAA8C;AAC5E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,gBAAgB,mBAAmB;AAClD,MAAK,+BAA+B,2BAA2B,EAAE,EAAE;AACnE,kBAAiB,kBAAkB,uBAAuB;AAC1D,MAAK,kCAAkC,iCAAiC,EAAE,EAAE;;AAE5E;AACA,MAAK,+CAA+C;;AAEpD;AACA;AACA,MAAK,0CAA0C;AAC/C;AACA,MAAK,oBAAoB;AACzB;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA,QAAO;AACP,YAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA,oBAAmB;AACnB;AACA,UAAS;AACT,cAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,UAAS;AACT,cAAa,oBAAoB;AACjC;AACA;AACA;AACA;AACA;AACA,2BAA0B;AAC1B;AACA,UAAS;AACT,cAAa,kBAAkB;AAC/B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,qBAAqB;AAC1C,oBAAmB,iCAAiC;AACpD,kBAAiB,aAAa;;AAE9B;AACA;AACA;AACA,MAAK,kCAAkC;;AAEvC;;AAEA,gCAA+B;AAC/B;AACA,QAAO,eAAe;AACtB,IAAG,mCAAmC;AACtC;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG,6DAA6D;AAChE;AACA,IAAG,qCAAqC;AACxC;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG,iCAAiC;AACpC;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG,OAAO;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO,sBAAsB;AAC7B;AACA,QAAO,iCAAiC;AACxC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,iCAAiC;;AAEtC,2DAA0D;AAC1D;AACA,+BAA8B;AAC9B;AACA,kCAAiC,gBAAgB;AACjD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK,SAAS,0BAA0B;AACxC;AACA,kBAAiB,WAAW;AAC5B,MAAK,mBAAmB;AACxB;AACA;AACA,sCAAqC;AACrC;AACA;AACA,MAAK;AACL;AACA;AACA,kBAAiB;AACjB;AACA;AACA,oDAAmD;AACnD;AACA;AACA;AACA,WAAU;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,QAAO,gFAAgF;AACvF;AACA,QAAO,4DAA4D;AACnE;AACA;AACA,QAAO,4EAA4E;AACnF;AACA,QAAO,6DAA6D;AACpE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA,oEAAmE,SAAS;AAC5E;AACA;AACA;;AAEA;;AAEA;AACA;AACA,MAAK,yDAAyD;AAC9D;;AAEA;AACA;AACA,oDAAmD;AACnD;AACA;AACA;;AAEA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA,wBAAuB,4BAA4B;AACnD;AACA;AACA,oBAAmB,4BAA4B;AAC/C,yBAAwB,0BAA0B;AAClD;AACA;AACA,sBAAqB,mCAAmC,OAAO,2CAA2C;AAC1G,sBAAqB,iCAAiC;AACtD;AACA;AACA,MAAK;AACL;AACA,UAAS,qCAAqC;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,6BAA4B;AAC5B,oBAAmB,yBAAyB;AAC5C,QAAO,4CAA4C;AACnD,IAAG,EAAE;AACL;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK,6BAA6B;AAClC;AACA;AACA;;AAEA,kBAAiB,wBAAwB;AACzC,MAAK,sCAAsC;AAC3C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAsB;AACtB;AACA,0DAAyD;AACzD,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+EAA8E;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iEAAgE,8CAA8C;AAC9G,yDAAwD,oCAAoC;AAC5F;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,sBAAqB,wCAAwC;AAC7D;AACA,sBAAqB,oCAAoC;AACzD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA,0BAAyB;AACzB;AACA;AACA;AACA,UAAS,aAAa,0FAA0F;AAChH;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,8CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uDAAsD;AACtD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO,6BAA6B;AACpC;AACA,QAAO,mCAAmC;AAC1C;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA,MAAK,oEAAoE;AACzE;AACA;AACA,MAAK,OAAO;AACZ,qCAAoC,eAAe;AACnD;AACA;AACA;AACA,wDAAuD,sBAAsB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,2BAA2B;AACpC,kBAAiB,yBAAyB;AAC1C,mBAAkB,0BAA0B;AAC5C,mBAAkB,2BAA2B;;AAE7C;AACA;AACA,+DAA8D,eAAe;AAC7E,6DAA4D,eAAe;AAC3E,yBAAwB,mBAAmB;AAC3C,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,iDAAgD;;AAEhD;AACA;AACA;AACA;AACA;AACA,yDAAwD,eAAe;AACvE,sBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,8EAA8E;AACrF;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,qBAAqB;AAC5B,gCAA+B;AAC/B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,sCAAsC;AAC3D,WAAU,kDAAkD;AAC5D,8BAA6B,sBAAsB;AACnD;;AAEA;AACA;AACA,+CAA8C;AAC9C,4BAA2B;AAC3B;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA,QAAO;AACP,MAAK;AACL,6BAA4B;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA2C;;AAE3C;AACA;;AAEA,uBAAsB;AACtB,wFAAuF;AACvF,kBAAiB,wBAAwB;AACzC;AACA,gGAA+F;AAC/F;AACA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAiB,wBAAwB;AACzC,MAAK,sFAAsF;AAC3F;AACA;;AAEA;AACA;;AAEA,kBAAiB,wBAAwB;AACzC,MAAK,iCAAiC,cAAc;AACpD;AACA;;AAEA;AACA;;AAEA,cAAa,WAAW;AACxB,kBAAiB,wBAAwB;AACzC;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA,wBAAuB;AACvB;;AAEA,qCAAoC;AACpC,mCAAkC;AAClC,sCAAqC;;AAErC;AACA;AACA;AACA;AACA;AACA,gCAA+B,gCAAgC,EAAE;AACjE;AACA,kBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA,4BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAkC;AAClC,kCAAiC;;AAEjC;AACA,oCAAmC,2CAA2C;AAC9E;AACA;;AAEA;AACA;AACA,kBAAiB,2BAA2B;AAC5C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,wBAAwB;AAClD,uBAAsB,oBAAoB;AAC1C,IAAG;AACH;AACA;AACA;AACA,kBAAiB,eAAe;AAChC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,SAAS;AAChC,QAAO,gEAAgE;AACvE;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,kBAAiB,+BAA+B;AAChD,wBAAuB,8BAA8B;AACrD,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,sBAAqB,uCAAuC;AAC5D;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB,gBAAgB,uBAAuB;AAC5D;AACA,6BAA4B;AAC5B;AACA,uCAAsC;AACtC;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA,kCAAiC,iBAAiB;AAClD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB;AACpB;AACA,mCAAkC,gFAAgF,EAAE;AACpH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAsB,aAAa;AACnC,WAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,QAAO,4CAA4C;AACnD,YAAW;AACX;AACA;AACA;AACA;AACA,kCAAiC,mBAAmB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAc,6BAA6B;AAC3C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,uCAAuC;AAC5C;AACA,MAAK,wCAAwC;;AAE7C;AACA;AACA;AACA;AACA,MAAK,mCAAmC;AACxC;;AAEA;AACA;AACA;AACA,MAAK,gBAAgB;AACrB;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO,wDAAwD,yBAAyB;AACxF;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,gBAAe;AACf;AACA,kBAAiB,kBAAkB;AACnC,6CAA4C,YAAY,yBAAyB,EAAE;AACnF,oBAAmB,oBAAoB;AACvC;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe;AACf;AACA,kBAAiB,wBAAwB;AACzC,MAAK,uCAAuC;AAC5C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,oBAAmB;;AAEnB,kBAAiB,gBAAgB;AACjC;AACA;AACA,6BAA4B,uBAAuB;AACnD;AACA,wBAAuB,mBAAmB;AAC1C,YAAW,uCAAuC,iBAAiB;AACnE;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,oBAAoB;AACnC,oBAAmB,oBAAoB;AACvC;AACA,wBAAuB,oDAAoD;AAC3E,sBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA,QAAO,EAAE;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,yDAAyD;AAChF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,2BAA2B;AAC5C,MAAK,iEAAiE;AACtE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAqB,mBAAmB;AACxC,UAAS;AACT,kEAAiE;AACjE,MAAK;AACL;AACA;AACA;AACA,gBAAe,sDAAsD;AACrE,kCAAiC;AACjC,SAAQ;AACR;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK,gDAAgD;;AAErD;AACA;AACA;;AAEA;AACA,MAAK,6BAA6B;AAClC;;AAEA;AACA,6BAA4B;;AAE5B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA,kBAAiB,8BAA8B;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAAyB,gBAAgB,6BAA6B;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC,iBAAgB,IAAI;AACpB;AACA;AACA,uBAAsB;;AAEtB;AACA;AACA;AACA,YAAW,8EAA8E;AACzF;AACA,YAAW;AACX;;AAEA;AACA;AACA,UAAS,kEAAkE;AAC3E;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gCAA+B;AAC/B,WAAU;AACV,IAAG;AACH,+CAA8C;AAC9C,WAAU;AACV,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,4BAA4B;AACrD;AACA,gBAAe;AACf,gBAAe,+BAA+B;AAC9C,cAAa,2BAA2B;AACxC,gBAAe,iBAAiB;AAChC,gCAA+B,qBAAqB;AACpD,KAAI;AACJ;AACA,gBAAe,6CAA6C;;AAE5D,sBAAqB;AACrB,WAAU;AACV;;AAEA;AACA;AACA;AACA;AACA,yBAAwB;AACxB,sCAAqC;AACrC;;AAEA;AACA;AACA,mBAAkB;AAClB;;AAEA;AACA;AACA;AACA;AACA,mCAAkC,QAAQ;AAC1C,QAAO,uBAAuB,0FAA0F,EAAE;AAC1H,IAAG;AACH;AACA;AACA;;AAEA;AACA,6FAA4F;AAC5F;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,yCAAwC;;AAExC;AACA;;AAEA;AACA;AACA;AACA,SAAQ,mBAAmB;AAC3B;AACA;AACA,QAAO;AACP;AACA,4BAA2B;AAC3B;;AAEA,UAAS;AACT;AACA;AACA;AACA;AACA,mCAAkC,iBAAiB;AACnD;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK,OAAO;AACZ;;AAEA;AACA;AACA;AACA;AACA,cAAa,kDAAkD;AAC/D;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,wBAAuB,wBAAwB,yCAAyC,EAAE;AAC1F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA,2CAA0C,UAAU;AACpD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA,iEAAgE;AAChE;AACA;AACA,KAAI,EAAE;AACN;AACA;AACA,iDAAgD,cAAc;AAC9D,QAAO,oCAAoC;AAC3C;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,2CAA0C;;AAE1C;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;;AAEA;;AAEA,mBAAkB,+CAA+C;AACjE,gBAAe,oDAAoD;AACnE,SAAQ,+BAA+B;AACvC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA,MAAK,0BAA0B;;AAE/B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,8BAA6B,+BAA+B;AAC5D;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAK,eAAe;AACpB;AACA,MAAK,sCAAsC;AAC3C;AACA,MAAK,gDAAgD;;AAErD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,oCAAoC;AAC5D,0BAAyB,+DAA+D;AACxF;AACA;AACA;;AAEA;AACA,aAAY,WAAW;AACvB,2BAA0B;AAC1B,6DAA4D;AAC5D,iCAAgC,6BAA6B;AAC7D,oBAAmB,+CAA+C;AAClE;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC;AACA;AACA,yBAAwB,iCAAiC,mBAAmB;AAC5E,sBAAqB,uBAAuB;AAC5C;AACA;AACA;AACA;AACA;AACA,sBAAqB,0BAA0B;AAC/C;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAkC,4CAA4C;AAC9E,SAAQ,qBAAqB;AAC7B,oBAAmB;AACnB,gCAA+B,uCAAuC;AACtE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB,2BAA2B;;AAEpD;AACA;AACA;;AAEA,iCAAgC,OAAO;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,kBAAkB,OAAO,0BAA0B;AACtE,IAAG;;AAEH;AACA;AACA;;AAEA,yBAAwB,QAAQ;AAChC,QAAO,4BAA4B,cAAc;AACjD;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kBAAiB,qBAAqB;AACtC;AACA,4BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB,mBAAmB;;AAE5C;AACA;;AAEA;AACA,oBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA,wBAAuB,gCAAgC,qBAAqB;AAC5E,8BAA6B;AAC7B;AACA,QAAO,OAAO,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA,oBAAmB,0BAA0B,OAAO,oCAAoC;AACxF,IAAG;;AAEH;AACA;;AAEA;AACA;AACA,oBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,0BAA0B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,sCAAqC;AACrC;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;;AAEH;AACA;;AAEA,oBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA,yCAAwC;AACxC,gCAA+B;AAC/B;AACA,QAAO,OAAO,UAAU;AACxB;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,iBAAgB,2BAA2B;AAC3C,MAAK,4BAA4B,EAAE,EAAE;AACrC;AACA;AACA;;AAEA;AACA;;AAEA;AACA,2BAA0B;AAC1B,kBAAiB,eAAe,OAAO,uBAAuB,mBAAmB,EAAE;AACnF,oBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,eAAc;AACd,uCAAsC,4CAA4C;AAClF;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,MAAK,0BAA0B;AAC/B;;AAEA;AACA;AACA;AACA,gCAA+B,gCAAgC;AAC/D;AACA;AACA,mCAAkC,sBAAsB;AACxD,WAAU,uFAAuF;AACjG;AACA;AACA;AACA;AACA,0BAAyB,mCAAmC;AAC5D;AACA;AACA;AACA,IAAG;AACH,YAAW,qGAAqG;AAChH;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAI,iBAAiB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gCAA+B;AAC/B;AACA,gBAAe,oBAAoB;AACnC;AACA;AACA,iBAAgB,kDAAkD;AAClE;AACA;AACA,kBAAiB,uBAAuB;AACxC;AACA;AACA,mCAAkC,yCAAyC;AAC3E;AACA,6BAA4B,oBAAoB;AAChD,+BAA8B,oBAAoB;AAClD;AACA;AACA;AACA,QAAO,gDAAgD;AACvD;AACA,0DAAyD,kBAAkB,yBAAyB;AACpG;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH,6CAA4C,6BAA6B;AACzE;AACA;AACA;AACA;AACA,cAAa,0BAA0B;AACvC;AACA,YAAW,sDAAsD;AACjE,gBAAe,kBAAkB;AACjC,qBAAoB,qBAAqB;AACzC;;AAEA,gEAA+D;AAC/D,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA,iDAAgD,UAAU;AAC1D;AACA,kBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA,mBAAkB;AAClB;;AAEA;AACA;AACA;AACA;;AAEA;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,+CAA+C;AACxD;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,QAAO,wEAAwE;AAC/E;AACA;AACA;;AAEA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC;AACA,iCAAgC;;AAEhC;AACA,iBAAgB,iCAAiC;AACjD;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,sCAAqC,4DAA4D;AACjG,8BAA6B,qCAAqC;AAClE;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA,MAAK,0BAA0B,uCAAuC,gBAAgB;;AAEtF;AACA;AACA;AACA,QAAO,sBAAsB;AAC7B,oDAAmD,2BAA2B;AAC9E;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,0BAAyB;AACzB,mCAAkC,2BAA2B;AAC7D,IAAG,EAAE;;AAEL,6BAA4B,8CAA8C,uBAAuB,EAAE,EAAE;;AAErG;AACA;AACA;AACA,QAAO,oBAAoB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,+BAA+B;AACvD;AACA,QAAO,uCAAuC;AAC9C;AACA,QAAO,wBAAwB,cAAc,OAAO,8BAA8B,EAAE;AACpF,yBAAwB,0BAA0B;AAClD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,oB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E;AACA,wCAAuC,2BAA2B;AAClE;AACA,MAAK;AACL,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,6CAA4C,2BAA2B;AACvE;AACA,UAAS;AACT;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA,mBAAkB;AAClB,MAAK;AACL;AACA,uBAAsB;AACtB;AACA,aAAY;AACZ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,yBAAwB,kBAAkB;AAC1C,kDAAiD;AACjD,aAAY,yBAAyB;AACrC;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,8BAA6B,mBAAmB;AAChD;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA,IAAG;AACH,uCAAsC,gBAAgB,EAAE;;AAExD;AACA;AACA,IAAG;AACH;AACA,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,iBAAgB,gBAAgB,kBAAkB;AAClD;AACA;AACA;AACA,UAAS,iDAAiD;AAC1D,MAAK;AACL;AACA,IAAG;AACH;AACA,gCAA+B;AAC/B;AACA;AACA;AACA,mBAAkB,gBAAgB,kBAAkB;AACpD;AACA;AACA;AACA;AACA;AACA,YAAW,+CAA+C;AAC1D,QAAO;AACP;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,iBAAgB,gBAAgB,gBAAgB;AAChD,UAAS,2BAA2B,6BAA6B,EAAE,EAAE;AACrE,MAAK;AACL;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,sBAAqB,UAAU;AAC/B;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA,qDAAoD;AACpD;AACA,yDAAwD;AACxD;AACA,MAAK;AACL;AACA,IAAG;;AAEH;AACA;AACA;AACA,oCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,oBAAmB,cAAc;AACjC;AACA,uDAAsD,qBAAqB;AAC3E,iDAAgD,iBAAiB;AACjE;AACA,8BAA6B;AAC7B,MAAK,EAAE,0CAA0C,0CAA0C;AAC3F,qBAAoB,0DAA0D;AAC9E;AACA;AACA,IAAG;AACH;AACA;;AAEA,yCAAwC,mBAAmB;AAC3D,uBAAsB,gBAAgB,wBAAwB;AAC9D;AACA,+BAA8B;AAC9B;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,yCAAwC,8BAA8B,EAAE;AACxE;AACA;AACA;AACA;AACA,IAAG;AACH,gCAA+B,qBAAqB;;AAEpD,wBAAuB,iBAAiB;AACxC,0BAAyB,eAAe;;AAExC;AACA,wBAAuB;AACvB;AACA,IAAG;AACH,8BAA6B,8BAA8B;;AAE3D;AACA,wBAAuB,aAAa;AACpC,iCAAgC;AAChC;AACA,gCAA+B,0BAA0B,EAAE;AAC3D,mBAAkB,2BAA2B;AAC7C,IAAG;AACH,EAAC;;AAED;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,YAAW,sBAAsB;AACjC;AACA,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,mCAAkC,EAAE,kBAAkB,cAAc;AACpE;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,oBAAmB,OAAO,OAAO,uBAAuB;AACxD,IAAG,OAAO;AACV;AACA;AACA;AACA;AACA,+BAA8B,iCAAiC,EAAE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,gCAAgC;AAC3C;AACA,wBAAuB,kBAAkB,uBAAuB;AAChE,YAAW,4EAA4E,EAAE;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sEAAqE,WAAW;AAChF,+DAA8D;;AAE9D;AACA;;AAEA;AACA;AACA;AACA,uDAAsD,SAAS,QAAQ;AACvE,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,iCAAiC;AAClD;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,0CAAyC;AACzC;AACA,kBAAiB,oBAAoB;AACrC;AACA,cAAa,OAAO;AACpB;AACA;;AAEA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;AACA;AACA,MAAK,OAAO;AACZ,IAAG;AACH;AACA,mCAAkC,kCAAkC,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA,oBAAmB;AACnB;AACA;AACA;;AAEA;AACA,gBAAe,QAAQ,OAAO,iDAAiD;AAC/E;AACA,mBAAkB,WAAW,SAAS,0CAA0C;AAChF;AACA,kBAAiB,WAAW,SAAS,yDAAyD;;AAE9F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,sBAAsB;AACvC;AACA,uCAAsC,YAAY;AAClD,sCAAqC,YAAY;AACjD,gDAA+C,aAAa;AAC5D,wCAAuC,cAAc;AACrD,WAAU;AACV;AACA,aAAY,sBAAsB;AAClC,cAAa,uBAAuB;AACpC,aAAY,sBAAsB;AAClC,eAAc,wBAAwB;AACtC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA,4DAA2D;AAC3D,0BAAyB,wBAAwB;;AAEjD;AACA,oBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,mBAAkB,kBAAkB;AACpC,8BAA6B;AAC7B;AACA;AACA,IAAG;AACH,2BAA0B,2BAA2B;AACrD;AACA;;AAEA;AACA;AACA;AACA,yBAAwB;AACxB,yBAAwB;AACxB,wCAAuC;;AAEvC;AACA;AACA,QAAO;AACP,oBAAmB,+BAA+B;AAClD;AACA,oBAAmB;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAsC,sBAAsB;AAC5D,yEAAwE,uBAAuB;AAC/F,wEAAuE,sBAAsB;AAC7F,uDAAsD,wBAAwB;AAC9E;AACA;;AAEA;AACA;AACA,wDAAuD;AACvD;AACA,2CAA0C;AAC1C;AACA;AACA,0CAAyC,mBAAmB;AAC5D;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,QAAQ;AACzC,QAAO,+DAA+D;AACtE;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,2DAA2D,EAAE;AACnG,kCAAiC,wCAAwC;AACzE,QAAO,OAAO,oCAAoC;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iCAAgC,wEAAwE;AACxG;AACA;AACA,oCAAmC,SAAS,gCAAgC;AAC5E;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,qDAAoD;AACpD;AACA,0CAAyC;;AAEzC,WAAU,uCAAuC;AACjD;AACA;AACA;AACA,6CAA4C;AAC5C;AACA,yEAAwE;AACxE;AACA;;AAEA;AACA;AACA,aAAY;;AAEZ;AACA;AACA;AACA;AACA,eAAc;AACd;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mCAAkC,sFAAs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AAO;AACP;AACA;AACA;AACA;AACA,QAAO,EAAE;AACT,6DAA4D;AAC5D;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK,wBAAwB;AAC7B;AACA,MAAK,4CAA4C;;AAEjD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,eAAc;;AAEd;AACA;AACA;AACA;AACA,8DAA6D,qCAAqC,EAAE;AACpG;AACA;AACA,iBAAgB;AAChB,aAAY;AACZ,IAAG;AACH,mDAAkD,+BAA+B,EAAE;AACnF;AACA;;AAEA;AACA;AACA,2DAA0D,qCAAqC,EAAE;AACjG;;AAEA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;AACA,kDAAiD,uBAAuB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,sCAAsC;AAC7C;;AAEA;AACA;AACA,MAAK,mBAAmB;AACxB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAwB,4BAA4B;AACpD;AACA;;AAEA;AACA;AACA,6GAA4G;AAC5G;AACA,6CAA4C,sBAAsB,qBAAqB;AACvF,2EAA0E;AAC1E;AACA;AACA,sBAAqB;AACrB,sCAAqC;AACrC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAsF;AACtF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA8B,0CAA0C,EAAE;AAC1E;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;;AAEA;AACA;AACA,MAAK,2BAA2B;;AAEhC,+DAA8D;;AAE9D;AACA,eAAc,oCAAoC;AAClD,gDAA+C,qBAAqB;AACpE,IAAG;AACH,eAAc,8BAA8B;AAC5C,6BAA4B,8BAA8B,EAAE;AAC5D,IAAG;AACH,6BAA4B,sBAAsB;AAClD,WAAU,oBAAoB;AAC9B;AACA;;AAEA;AACA;AACA,4BAA2B,wBAAwB;AACnD,iCAAgC,wBAAwB;AACxD;;AAEA;AACA,oCAAmC,yBAAyB;AAC5D,kBAAiB;AACjB;AACA;AACA,6BAA4B,+BAA+B;AAC3D;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,gDAAgD;AAC9F,8BAA6B,oDAAoD;AACjF,kCAAiC,0DAA0D;AAC3F;AACA;;AAEA;AACA,YAAW,sCAAsC;AACjD,SAAQ,8BAA8B;;AAEtC;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK,+CAA+C;AACpD;AACA,MAAK,4CAA4C;AACjD;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,oCAAoC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,2DAA2D;AACpE;AACA;AACA,UAAS,yBAAyB,2CAA2C,wBAAwB,MAAM;AAC3G;AACA,UAAS,uBAAuB;AAChC;AACA,IAAG;AACH;AACA;AACA;AACA,gCAA+B,qBAAqB;AACpD;AACA,gBAAe,mCAAmC;AAClD;AACA;AACA;AACA,mCAAkC,6BAA6B;AAC/D;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,8BAA8B,EAAE;AAC1D;;AAEA;AACA,wBAAuB;AACvB,wBAAuB;AACvB,wBAAuB;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO,6BAA6B;AACpC;AACA,QAAO,oCAAoC;AAC3C,IAAG;AACH;AACA;AACA;;AAEA;AACA,4BAA2B,oCAAoC;AAC/D;AACA;AACA,IAAG;AACH;AACA;AACA,QAAO,mFAAmF;AAC1F;AACA,QAAO,qBAAqB;AAC5B;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,mBAAkB,gCAAgC;AAClD,IAAG;AACH;AACA,mBAAkB,gCAAgC;AAClD;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA,kCAAiC;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA,YAAW,gEAAgE;AAC3E;AACA,YAAW,yFAAyF;AACpG;AACA,4BAA2B,sCAAsC;AACjE;AACA,qBAAoB,gCAAgC;AACpD;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA,UAAS,uCAAuC,0BAA0B,WAAW,GAAG,QAAQ;AAChG,MAAK;AACL;AACA,qBAAoB;AACpB,mCAAkC;AAClC;AACA;AACA,QAAO,OAAO;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2CAA0C,SAAS;AACnD,WAAU,WAAW;AACrB,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D;AAC/D;AACA,gBAAe;AACf;AACA,wDAAuD;AACvD;AACA,mDAAkD;;AAElD;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,QAAO,oBAAoB;AAC3B;AACA,QAAO,oBAAoB;AAC3B;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,UAAS,gBAAgB,gBAAgB;AACzC,eAAc;AACd;AACA,4EAA2E;AAC3E,iBAAgB,qBAAqB;;AAErC;AACA;;AAEA,sDAAqD;AACrD;;AAEA,kBAAiB,+BAA+B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,oEAAmE;AACnE,8CAA6C;AAC7C;AACA;;AAEA;AACA,8CAA6C;AAC7C;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,aAAY,qBAAqB;;AAEjC;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kBAAiB;AACjB,4CAA2C,kBAAkB,sBAAsB,GAAG,UAAU;AAChG;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,2CAA0C,yBAAyB,EAAE;AACrE;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,gBAAe;AACf;AACA;AACA,yBAAwB;AACxB;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;AACA,MAAK;AACL,uCAAsC,QAAQ;AAC9C,QAAO,+FAA+F;AACtG,IAAG;AACH;AACA;AACA,uBAAsB,cAAc;AACpC,IAAG;AACH,kFAAiF,qBAAqB,EAAE;AACxG;AACA;AACA;AACA,IAAG;AACH,mDAAkD,4CAA4C,EAAE;AAChG;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,+BAA8B,uBAAuB;AACrD,uBAAsB,+BAA+B;AACrD,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH,8DAA6D,6BAA6B,EAAE;AAC5F;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA,qDAAoD,gBAAgB,EAAE;AACtE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,qDAAoD,WAAW,0BAA0B,GAAG;AAC5F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAA+C,uCAAuC,EAAE;AACxF;AACA,+CAA8C,qBAAqB,EAAE;AACrE;AACA;AACA,gBAAe,kCAAkC;AACjD,IAAG;;AAEH,gDAA+C,yDAAyD,EAAE;AAC1G;AACA,kDAAiD,iCAAiC,EAAE;AACpF;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,6BAA6B,EAAE;AACzD;;AAEA;AACA;;AAEA;AACA;;AAEA,yCAAwC;;AAExC;AACA;AACA;AACA;;AAEA;AACA,gCAA+B,kFAAkF;AACjH,2BAA0B,+BAA+B;AACzD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,sDAAsD;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sCAAqC,uBAAuB;;AAE5D;AACA;AACA,+BAA8B,yBAAyB,yCAAyC,EAAE,MAAM;;AAExG;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK,qCAAqC;AAC1C;AACA,MAAK,cAAc;;AAEnB,oCAAmC;AACnC,MAAK,iDAAiD,EAAE;AACxD;AACA,4BAA2B,0BAA0B;AACrD,kBAAiB,sBAAsB,OAAO,sBAAsB;AACpE;AACA;AACA;AACA;AACA;AACA,MAAK,8CAA8C;AACnD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,mCAAkC;AAClC;AACA,0EAAyE;AACzE;AACA;AACA;AACA,MAAK,GAAG;AACR;AACA,MAAK,0CAA0C,qDAAqD,EAAE,EAAE;AACxG;AACA;AACA;AACA,4BAA2B,6CAA6C,6BAA6B,EAAE,EAAE;;AAEzG;AACA,mCAAkC;AAClC;AACA;AACA,+CAA8C,6BAA6B,EAAE;AAC7E;AACA;AACA;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,yBAAwB,4BAA4B;AACpD,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,6BAA6B;AACtC;AACA,UAAS,4BAA4B;AACrC;AACA,UAAS,4EAA4E;AACrF;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,8CAA6C,6BAA6B,EAAE;AAC5E,kDAAiD,6BAA6B,EAAE;;AAEhF;AACA,wCAAuC,uDAAuD,EAAE;;AAEhG;AACA,0BAAyB,6BAA6B,WAAW,GAAG;AACpE,yBAAwB,6BAA6B,mBAAmB,WAAW,GAAG;AACtF,0BAAyB,2BAA2B,EAAE;AACtD;AACA,0BAAyB,6BAA6B,qBAAqB;AAC3E;;AAEA;AACA,kCAAiC,4BAA4B,EAAE;AAC/D;AACA;AACA,kCAAiC,uBAAuB,EAAE;AAC1D,iCAAgC,sBAAsB,EAAE;AACxD;;AAEA;AACA,6CAA4C,0BAA0B;;AAEtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA,4BAA2B,cAAc;AACzC,WAAU,uCAAuC;AACjD;;AAEA;AACA;AACA,yBAAwB,wBAAwB;AAChD;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA,yBAAwB,kEAAkE;AAC1F,WAAU,iBAAiB;AAC3B,IAAG;AACH;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,MAAK,gDAAgD,GAAG,OAAO,eAAe,uBAAuB;AACrG,2BAA0B,6CAA6C;;AAEvE;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,sBAAqB,6BAA6B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2BAA0B,+BAA+B;AACzD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,eAAe;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,4BAA4B;AACnD,YAAW,qDAAqD;AAChE;AACA,MAAK;AACL,iDAAgD,YAAY,EAAE;AAC9D;AACA;;AAEA;AACA;AACA,wCAAuC,UAAU;AACjD;AACA;AACA;AACA;AACA,UAAS,0CAA0C;AACnD;AACA,UAAS,+FAA+F;AACxG;AACA,UAAS,+BAA+B;AACxC;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,MAAK,+BAA+B;;AAEpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO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AEA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;;AAEL;AACA;;AAEA,uCAAsC,+EAA+E;AACrH,2BAA0B,qDAAqD;AAC/E,4BAA2B,uDAAuD;AAClF,uCAAsC,iCAAiC;AACvE;AACA;AACA,4BAA2B,gBAAgB,yBAAyB;AACpE,YAAW,iCAAiC,4CAA4C,QAAQ,EAAE;AAClG;AACA,QAAO;AACP;AACA;AACA,MAAK;;AAEL,4BAA2B,wBAAwB;AACnD,gCAA+B,4BAA4B;AAC3D,8BAA6B,0BAA0B;;AAEvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,2BAA2B;AACpC;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL,+BAA8B,qCAAqC;AACnE,mCAAkC,4BAA4B;AAC9D,oCAAmC,6BAA6B;AAChE,kCAAiC;AACjC;AACA;;AAEA;AACA,yCAAwC,qCAAqC,aAAa;AAC1F;AACA;AACA;AACA;AACA,iCAAgC,4BAA4B;AAC5D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,UAAS,2DAA2D;AACpE;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,4BAA2B;AAC3B,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA,sCAAqC,YAAY;AACjD;AACA,uBAAsB,QAAQ,YAAY;AAC1C;AACA;;AAEA,kBAAiB,gBAAgB;AACjC,0CAAyC;AACzC;AACA;AACA;AACA,wCAAuC,uBAAuB;AAC9D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA,UAAS;AACT;AACA,2BAA0B;AAC1B,8CAA6C,uBAAuB;AACpE;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uDAAsD;AACtD;AACA,4BAA2B,uCAAuC,+BAA+B,EAAE,OAAO;AAC1G,IAAG;;AAEH;AACA,yBAAwB;AACxB,IAAG;AACH;AACA,6BAA4B,qBAAqB,2BAA2B;AAC5E,IAAG;AACH;AACA;AACA,6CAA4C,0BAA0B;AACtE;AACA;AACA,IAAG;;AAEH,sCAAqC,oCAAoC,EAAE;;AAE3E;AACA,6BAA4B,0BAA0B;AACtD,IAAG;;AAEH;AACA,iCAAgC;AAChC;AACA,sBAAqB,0CAA0C;AAC/D,6BAA4B,sCAAsC;AAClE,MAAK;AACL;AACA,MAAK;AACL;AACA,sBAAqB,kCAAkC;AACvD;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,8BAA8B;AAC1D,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,+CAA8C;AAC9C,iCAAgC,6BAA6B;AAC7D;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,YAAW;AACX;;AAEA;AACA;AACA;AACA;;AAEA;AACA,QAAO,6DAA6D;AACpE,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,yCAAwC,mBAAmB;AAC3D,sBAAqB,yBAAyB;AAC9C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO,kCAAkC,gDAAgD,EAAE,EAAE;AAC7F,IAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAuC;AACvC,sCAAqC;AACrC;;AAEA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO,mDAAmD;AAC1D;AACA;AACA;AACA,oDAAmD,iBAAiB;AACpE,wDAAuD;;AAEvD,6DAA4D;;AAE5D;AACA;AACA;AACA,MAAK,sBAAsB;AAC3B;AACA,MAAK,+BAA+B,+CAA+C,EAAE,EAAE;;AAEvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,qFAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,sDAAsD;AACpF;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA,wBAAuB;AACvB;AACA,kCAAiC,kCAAkC;AACnE,IAAG,EAAE;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK,kEAAkE;AACvE;AACA,MAAK,0BAA0B;AAC/B,sEAAqE;;AAErE;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA,mBAAkB;AAClB;AACA;AACA;AACA,wCAAuC,eAAe,eAAe,UAAU;AAC/E,yCAAwC,iBAAiB,iBAAiB,YAAY;AACtF,WAAU;AACV;;AAEA;AACA;AACA;AACA,MAAK,YAAY;AACjB;AACA;AACA;AACA;AACA;AACA,MAAK,UAAU;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAoC;AACpC;AACA;AACA;AACA,mCAAkC,yBAAyB;AAC3D,aAAY;AACZ;AACA;AACA,IAAG;AACH;;AAEA;AACA;;AAEA;AACA,MAAK,+BAA+B,6BAA6B,EAAE,EAAE;AACrE;;AAEA;AACA;AACA;;AAEA;AACA,2CAA0C;AAC1C;AACA;AACA,MAAK,kHAAkH;AACvH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,8BAA6B;AAC7B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAuB,MAAM;AAC7B,MAAK,wDAAwD,cAAc;AAC3E;AACA;;AAEA,4BAA2B,WAAW,gBAAgB,EAAE;;AAExD;AACA;AACA,iCAAgC,2BAA2B,wBAAwB,EAAE;AACrF;AACA;AACA;AACA,4BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,uEAAuE;AAClF;AACA;AACA,6DAA4D;AAC5D;AACA,0EAAyE;;AAEzE,qBAAoB,SAAS;AAC7B,sBAAqB,4BAA4B;AACjD,UAAS,0BAA0B;;AAEnC,8CAA6C,uBAAuB;AACpE,qBAAoB,gBAAgB;AACpC,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAoB;AACpB,iBAAgB;AAChB,IAAG;AACH,2BAA0B;AAC1B,yDAAwD;AACxD,8EAA6E;AAC7E;AACA;AACA,kBAAiB,4BAA4B;AAC7C;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB,oCAAoC;AACrD;AACA,0CAAyC,8BAA8B;AACvE;;AAEA;AACA,qBAAoB,8BAA8B;AAClD;AACA,sBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA,mDAAkD,mCAAmC;AACrF;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;;AAEd;AACA,kGAAiG,OAAO;AACxG;AACA;AACA,QAAO;AACP;AACA,QAAO,kCAAkC;AACzC;AACA,8DAA6D,QAAQ;AACrE;AACA;AACA,QAAO;AACP;AACA,QAAO,qCAAqC;AAC5C;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,aAAY,wBAAwB;;AAEpC;AACA,wDAAuD,4BAA4B;AACnF;AACA,IAAG;;AAEH;AACA,uDAAsD;;AAEtD;AACA;AACA,IAAG;;AAEH;AACA,iCAAgC;AAChC;AACA,sBAAqB,0CAA0C;AAC/D,MAAK;AACL;AACA,MAAK;AACL;AACA,sBAAqB,kCAAkC;AACvD;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,2BAA0B,6BAA6B;AACvD;AACA;AACA;;AAEA;AACA,8DAA6D;AAC7D;AACA;AACA,IAAG;;AAEH;AACA;AACA,sCAAqC,qBAAqB;AAC1D,IAAG;;AAEH;AACA;AACA,2BAA0B,+BAA+B;AACzD;AACA;AACA,sDAAqD,kCAAkC;AACvF;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA,4BAA2B,4BAA4B;AACvD,iCAAgC,6BAA6B;AAC7D,IAAG;AACH;AACA,iCAAgC,0BAA0B;AAC1D;AACA;;AAEA,iDAAgD;;AAEhD,sDAAqD;;AAErD;AACA;AACA,UAAS,uBAAuB;AAChC,iBAAgB;AAChB;AACA;;AAEA,6CAA4C,sBAAsB;;AAElE;AACA;AACA;;AAEA,sDAAqD,iBAAiB;;AAEtE;AACA;AACA;AACA;;AAEA,0BAAyB;AACzB;AACA;AACA,mCAAkC,mBAAmB;AACrD,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,cAAc;AAC5C,WAAU,0BAA0B;AACpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,sDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yCAAwC,sBAAsB;AAC9D,2BAA0B,cAAc;AACxC;AACA;AACA;AACA,4EAA2E,QAAQ;;AAEnF;AACA;AACA;;AAEA;AACA,yDAAwD,qCAAqC;AAC7F,WAAU,yBAAyB;;AAEnC;AACA;AACA;AACA,2CAA0C,kCAAkC;AAC5E;AACA,IAAG;AACH;AACA;;AAEA;AACA,yCAAwC,0BAA0B;AAClE;;AAEA;AACA,+BAA8B,0BAA0B;AACxD;AACA;;AAEA;AACA;AACA;AACA,wBAAuB,SAAS;;AAEhC;AACA;AACA;AACA;AACA,MAAK,2EAA2E;;AAEhF;AACA;AACA;AACA,0CAAyC,aAAa,cAAc,wDAAwD,mDAAmD,sBAAsB,uEAAuE,sBAAsB,iBAAiB,eAAe,kBAAkB,cAAc,0BAA0B;AAC5X;AACA,gBAAe,6BAA6B,EAAE;AAC9C;AACA,gBAAe,mCAAmC;AAClD;AACA;AACA,iCAAgC,kCAAkC;AAClE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,yEAAyE;;AAExG;AACA;AACA,2CAA0C,wBAAwB;AAClE;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA8B,wBAAwB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA,cAAa,cAAc;AAC3B;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK,sCAAsC;AAC3C;AACA,MAAK,4CAA4C;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB;;AAEnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA,mCAAkC,iBAAiB;AACnD;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,mCAAmC;AAC9C;AACA;AACA;;AAEA;AACA,0CAAyC,qEAAqE,EAAE;AAChH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,kCAAiC;AACjC,IAAG;AACH,wBAAuB;AACvB,IAAG,uBAAuB,EAAE;;AAE5B;;AAEA;;AAEA,6BAA4B;;AAE5B;;AAEA;AACA;AACA;AACA;AACA,uDAAsD,mCAAmC;AACzF;AACA;;AAEA;;AAEA;AACA,8CAA6C,UAAU,0BAA0B,2BAA2B,GAAG,EAAE,EAAE;AACnH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,EAAC;;;;;;;ACr+SD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,kBAAkB;AACrC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,sEAAqE,cAAc;AACnF;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,uDAAsD,cAAc;AACpE;AACA;AACA;AACA;AACA;AACA,sBAAqB,WAAW;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wEAAuE,eAAe;AACtF;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yDAAwD,eAAe;AACvE,sBAAqB,WAAW;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6BAA4B;AAC5B,6BAA4B;AAC5B,IAAG;AACH,6BAA4B;AAC5B,6BAA4B;AAC5B;;AAEA;AACA;AACA;AACA;AACA,6EAA4E;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iGAAgG,cAAc;AAC9G;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA,QAAO;AACP;AACA;AACA,wBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,mGAAkG,eAAe;AACjH;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA,QAAO;AACP;AACA;AACA,yDAAwD,sBAAsB;AAC9E;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB;;AAEhB;AACA;AACA;AACA,MAAK,OAAO;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,wBAAwB;AAClD,+BAA8B,uBAAuB;;AAErD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,qBAAoB;AACpB;AACA;AACA,MAAK;;AAEL,uBAAsB,4CAA4C;AAClE,qBAAoB,0CAA0C;;AAE9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,oBAAmB,mCAAmC;AACtD;AACA;AACA;AACA,IAAG;AACH,EAAC;;;;;;;ACpSD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;;AAEA;;AAEA,mBAAkB,8CAA8C,KAAK,MAAM,KAAK;;AAEhF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0EAAyE;AACzE;AACA;AACA,kCAAiC,mBAAmB;AACpD;AACA;AACA;AACA;AACA;AACA,aAAY,YAAY;AACxB;AACA;AACA;AACA;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA;AACA,sFAAqF,iBAAiB;AACtG;AACA,kFAAiF,iBAAiB;AAClG;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAAyB,kBAAkB;AAC3C,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH,2DAA0D,2BAA2B;AACrF;AACA;AACA;AACA;AACA,4BAA2B,aAAa;AACxC,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH,EAAC;;;;;;;AChJD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;AACT;AACA,2BAA0B;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6CAA4C;AAC5C,uCAAsC;AACtC,2CAA0C;AAC1C,uDAAsD;AACtD,mDAAkD;AAClD,uCAAsC;AACtC,uCAAsC;AACtC;AACA;AACA;AACA;AACA,qEAAoE,MAAM;AAC1E;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yCAAwC,WAAW;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,yBAAyB,aAAa;AACpE;AACA;AACA;AACA;;AAEA,wBAAuB;AACvB;AACA,6BAA4B,yCAAyC;AACrE;AACA;AACA,6BAA4B;AAC5B;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;AACA,iCAAgC,wCAAwC;AACxE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,qDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAA+C;AAC/C,mDAAkD;AAClD;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL,gEAA+D,EAAE,IAAI,cAAc;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA,iBAAgB;AAChB,oBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8BAA6B,oBAAoB;AACjD;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6CAA4C,KAAK;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,kBAAkB;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,+BAA+B;AAC3C,iBAAgB;AAChB,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC,mCAAkC;AAClC;AACA;AACA;AACA,MAAK;AACL;AACA,iBAAgB;AAChB,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL,iBAAgB;AAChB,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,0BAAyB;AACzB;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,iBAAgB,gBAAgB;AAChC,IAAG;;AAEH;AACA;AACA;AACA;AACA,+DAA8D,WAAW;AACzE,mDAAkD,WAAW;AAC7D;AACA,sDAAqD;AACrD,2BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,mCAAkC;AAClC;AACA,6DAA4D;AAC5D;AACA,iCAAgC;AAChC;AACA,wCAAuC;AACvC;AACA;AACA,MAAK;AACL,iBAAgB,gBAAgB;AAChC,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB,iBAAgB;AAChB,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB,iBAAgB;AAChB,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL,iBAAgB;AAChB,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB,iBAAgB;AAChB,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,yBAAwB;AACxB;AACA,IAAG;;AAEH,EAAC;;;;;;;;;;;ACj0BD;AACA;;AAEA,EAAC,UAAUC,GAAV,EAAe;AACZ,SAAI,gCAAOC,OAAP,MAAkB,QAAlB,IAA8B,gCAAOC,MAAP,MAAiB,QAAnD,EAA6D;AACzDF,aAAI,mBAAAG,CAAQ,EAAR,CAAJ,EADJ,KAEK,IAAI,IAAJ,EAA+C;AAChDC,SAAA,iCAAO,CAAC,uBAAD,CAAP,oCAAiCJ,GAAjC,6SADC,KAEA;AACDA,aAAI5C,UAAJ;AACP,EAPD,EAOG,UAAUA,UAAV,EAAsB;AACrBA,gBAAWiD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","file":"main.js","sourcesContent":["//\n//                          \n//  /'\\_/`\\        _        \n//  |     |   _ _ (_)  ___  \n//  | (_) | /'_` )| |/' _ `\\\n//  | | | |( (_| || || ( ) |\n//  (_) (_)`\\__,_)(_)(_) (_)\n//                          \n//                          \n\nimport ShaderBoy from './shaderboy';\nimport time from './time';\nimport io from './io';\nimport gui from './gui';\nimport renderer from './renderer';\nimport editor from './editor';\nimport util from './util';\nimport BufferDataContainer from './buffer_data_container';\n\nimport ShaderLib from './shader/shaderlib';\nimport ShaderList from './shader/shaderlist';\n\n// ShaderBoy init\n//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nShaderBoy.init = function () {\n\tShaderBoy.glCanvasDom = document.getElementById('main');\n\tShaderBoy.glCanvasDom.style.width = window.innerWidth + 'px';\n\tShaderBoy.glCanvasDom.style.height = window.innerHeight + 'px';\n\tif (ShaderBoy.glCanvasDom === null) { throw 'Could not get canvas. No element such a name.'; }\n\tShaderBoy.canvas = document.createElement('canvas');\n\tShaderBoy.canvas.id = 'mainCan';\n\tShaderBoy.canvas.width = window.innerWidth;\n\tShaderBoy.canvas.height = window.innerHeight;\n\tShaderBoy.glCanvasDom.appendChild(ShaderBoy.canvas);\n\tShaderBoy.gl = null;\n\ttry {\n\t\tlet opts = {\n\t\t\talpha: true,\n\t\t\tdepth: true,\n\t\t\tstencil: false,\n\t\t\tstyleActiveLine: true,\n\t\t\tpremultipliedAlpha: false,\n\t\t\tantialias: true,\n\t\t\tpreserveDrawingBuffer: true,\n\t\t\tpowerPreference: 'high-performance'\n\t\t}; // 'low_power', 'high_performance', 'default'\n\t\tif (ShaderBoy.gl == null) ShaderBoy.gl = ShaderBoy.canvas.getContext('webgl2', opts);\n\t\tif (ShaderBoy.gl == null) ShaderBoy.gl = ShaderBoy.canvas.getContext('experimental-webgl2', opts);\n\t\tif (ShaderBoy.gl == null) ShaderBoy.gl = ShaderBoy.canvas.getContext('webgl', opts);\n\t\tif (ShaderBoy.gl == null) ShaderBoy.gl = ShaderBoy.canvas.getContext('experimental-webgl', opts);\n\t}\n\tcatch (e) {\n\t\tthrow e;\n\t}\n\n\tif (ShaderBoy.gl) {\n\t\tShaderBoy.buffers['Common'] = new BufferDataContainer(false);\n\t\tShaderBoy.buffers['MainImage'] = new BufferDataContainer(true);\n\n\t\tShaderBoy.gui.init();\n\t\tShaderBoy.editor.init();\n\n\t\tShaderBoy.io.loadShader(function () {\n\t\t\tShaderBoy.renderer.init();\n\t\t\tShaderBoy.editor.selectBuffer('MainImage', true);\n\t\t\tShaderBoy.editor.selectBuffer('Common', true);\n\t\t\tShaderBoy.editor.selectBuffer('MainImage', false);\n\t\t\tShaderBoy.io.recompile();\n\t\t\tShaderBoy.gui.setupInteraction();\n\t\t\tShaderBoy.time.init();\n\t\t\tShaderBoy.update();\n\t\t});\n\t}\n\telse {\n\t\tthrow 'Sorry! Your browser does not support WEBGL2.0!';\n\t}\n};\n\n// Update\n//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nvar requestAnimationFrame = (function () {\n\treturn window.requestAnimationFrame ||\n\t\twindow.webkitRequestAnimationFrame ||\n\t\twindow.mozRequestAnimationFrame ||\n\t\twindow.oRequestAnimationFrame ||\n\t\twindow.msRequestAnimationFrame ||\n\t\tfunction (callback) {\n\t\t\twindow.setTimeout(callback, 1000.0 / 60.0);\n\t\t};\n})();\n\nShaderBoy.update = function () {\n\trequestAnimationFrame(ShaderBoy.update);\n\tif (ShaderBoy.isPlaying) {\n\t\tif (ShaderBoy.time.needUpdate()) {\n\t\t\tShaderBoy.uniforms.iTime = ShaderBoy.time.appTime;\n\t\t\tShaderBoy.uniforms.iResolution = [ShaderBoy.gl.canvas.clientWidth, window.innerHeight];\n\t\t\tShaderBoy.renderer.render();\n\t\t\tShaderBoy.gui.redrawHeader();\n\t\t\tShaderBoy.uniforms.iFrame++;\n\t\t}\n\t\tShaderBoy.gui.mouse.down.prev = ShaderBoy.gui.mouse.down.curr;\n\t\tShaderBoy.gui.mouse.position.prev = [ShaderBoy.gui.mouse.position.curr[0], ShaderBoy.gui.mouse.position.curr[1]];\n\t}\n};\n\n// Entry point\n//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nwindow.onload = function () { ShaderLib.loadShaders(ShaderList, ShaderBoy.init); };\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/main.js","//\n//\n//   ___    _                 _               ___                 \n//  (  _`\\ ( )               ( )             (  _`\\               \n//  | (_(_)| |__     _ _    _| |   __   _ __ | (_) )   _    _   _ \n//  `\\__ \\ |  _ `\\ /'_` ) /'_` | /'__`\\( '__)|  _ <' /'_`\\ ( ) ( )\n//  ( )_) || | | |( (_| |( (_| |(  ___/| |   | (_) )( (_) )| (_) |\n//  `\\____)(_) (_)`\\__,_)`\\__,_)`\\____)(_)   (____/'`\\___/'`\\__, |\n//                                                         ( )_| |\n//                                                         `\\___/'\n//\n\nlet ShaderBoy = {\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    editor: null,\n    isPlaying: true,\n    isEditorHide: false,\n    needRecompile: false,\n    needStatusInfo: false,\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    style: {\n\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    settings: {\n\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    buffers: {\n\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    uniforms: {\n        iResolution: [0, 0],\n        iTime: 1,\n        iTimeDelta: 1,\n        iFrame: 0,\n        iDate: 0,\n        // iChannelTime:[0, 0, 0, 0],\n        // iChannelResolution:[0, 0, 0, 0],\n        iMouse: [0, 0, 0, 0],\n    }\n};\nexport default ShaderBoy;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/shaderboy.js","//\n//   _____                     \n//  (_   _)_                   \n//    | | (_)  ___ ___     __  \n//    | | | |/' _ ` _ `\\ /'__`\\\n//    | | | || ( ) ( ) |(  ___/\n//    (_) (_)(_) (_) (_)`\\____)\n//                             \n//                             \n\nimport ShaderBoy from \"./shaderboy\";\nimport collectFPS from 'collect-fps';\n\nexport default ShaderBoy.time = {\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    FPS: 60.0,\n    FPS_INTERVAL: 1000 / 60,\n    pnow: undefined,\n    getGlobalTime: undefined,\n    time_then: undefined,\n    time_elapsed: undefined,\n    startTime: undefined,\n    pausedTime: 0,\n    offsetTime: 0,\n    appTime: 0,\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    init: function () {\n        this.time_then = Date.now();\n        this.pnow = window.performance && (performance.now || performance.mozNow || performance.msNow || performance.oNow || performance.webkitNow);\n        this.getGlobalTime = function () { return (this.pnow && this.pnow.call(performance)) * 0.001 || (new Date().getTime()) * 0.001; }\n        this.startTime = this.getGlobalTime();\n\n        //FPS counter\n        this.endCollection = collectFPS();\n        setInterval(() => {\n            this.fps = this.endCollection().toFixed(0);\n            this.endCollection = collectFPS();\n        }, 1000);\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    needUpdate: function () {\n        let now = Date.now();\n        this.time_elapsed = now - this.time_then;\n        if (this.time_elapsed > this.FPS_INTERVAL) {\n            this.time_then = now - (this.time_elapsed % this.FPS_INTERVAL);\n            this.appTime = this.getGlobalTime() - this.offsetTime - this.startTime;\n            return true;\n        }\n        else {\n            false;\n        }\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    reset: function () {\n        this.startTime = this.getGlobalTime();\n        this.pausedTime = 0;\n        this.offsetTime = 0;\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    pause: function () {\n        if (ShaderBoy.isPlaying !== true) {\n            this.pausedTime = this.getGlobalTime();\n        }\n        else {\n            if (this.pausedTime !== 0 && this.offsetTime !== 0)\n                this.offsetTime += this.getGlobalTime() - this.pausedTime;\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/time.js","module.exports = require('./dist').default\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/collect-fps/index.js\n// module id = 3\n// module chunks = 0","module.exports=function(r){function e(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return r[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var t={};return e.m=r,e.c=t,e.p=\"\",e(0)}([function(r,e,t){\"use strict\";function n(r){return r&&r.__esModule?r:{default:r}}function i(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;if(!r.requestAnimationFrame)throw new Error(\"requestAnimationFrame is not available\");var e=[],t=function(){return e.push([!document.hidden,Date.now()])};document.addEventListener(\"visibilitychange\",t);var n=!0,i=[],u=function r(){n&&(i.push(Date.now()),window.requestAnimationFrame(r))};return window.requestAnimationFrame(u),function(){return n=!1,document.removeEventListener(\"visibilitychange\",t),(0,o.default)(i,e)}}Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=i;var u=t(1),o=n(u)},function(r,e){\"use strict\";function t(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}Object.defineProperty(e,\"__esModule\",{value:!0});var n=function(){function r(r,e){var t=[],n=!0,i=!1,u=void 0;try{for(var o,a=r[Symbol.iterator]();!(n=(o=a.next()).done)&&(t.push(o.value),!e||t.length!==e);n=!0);}catch(r){i=!0,u=r}finally{try{!n&&a.return&&a.return()}finally{if(i)throw u}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}();e.default=function(r,e){var t=r.length;if(t<2)return 0;var n=r[r.length-1]-r[0],u=n-i(e),o=u/(t-1),a=1e3/o;return a};var i=e.getTotalHiddenTime=function(r){return r.reduce(u,[]).filter(o).map(a).reduce(c,0)},u=function(r,e){var i=n(e,2),u=i[0],o=i[1];if(u&&0===r.length)return r;var a=r[r.length-1],c=r.slice(0,-1);return u?[].concat(t(c),[[a[0],o]]):[].concat(t(r),[[o]])},o=function(r){var e=n(r,2),t=(e[0],e[1]);return null!=t},a=function(r){var e=n(r,2),t=e[0],i=e[1];return i-t},c=function(r,e){return r+e}}]);\n//# sourceMappingURL=index.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/collect-fps/dist/index.js\n// module id = 4\n// module chunks = 0","//\n//   _  _____ \n//  (_)(  _  )\n//  | || ( ) |\n//  | || | | |\n//  | || (_) |\n//  (_)(_____)\n//            \n//            \n\nimport ShaderBoy from './shaderboy';\nimport ShaderLib from './shader/shaderlib';\n\nexport default ShaderBoy.io = {\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tnewShader: function () {\n\t\tShaderBoy.buffers['MainImage'].active = true;\n\t\tShaderBoy.buffers['Common'].active = false;\n\t\tShaderBoy.buffers['MainImage'].textData = ShaderLib.shader.imageFS;\n\t\tShaderBoy.buffers['Common'].textData = ShaderLib.shader.commonFS;\n\t\tShaderBoy.editor.selectBuffer('MainImage', true);\n\t\tShaderBoy.gui.header.needUpdate = true;\n\t\tShaderBoy.gui.header.contents.innerText = 'new.'\n\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#fcbd00';\n\t\tsetTimeout(function () {\n\t\t\tShaderBoy.gui.header.needUpdate = false;\n\t\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#00000066';\n\t\t}, 1500);\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tsaveShader: function () {\n\t\tlocalStorage.mainActive = ShaderBoy.buffers['MainImage'].active;\n\t\tlocalStorage.commonActive = ShaderBoy.buffers['Common'].active;\n\t\tlocalStorage.mainText = ShaderBoy.util.deepcopy(ShaderBoy.buffers['MainImage'].textData);\n\t\tlocalStorage.commonText = ShaderBoy.util.deepcopy(ShaderBoy.buffers['Common'].textData);\n\t\tlocalStorage.renderScale = ShaderBoy.renderScale;\n\t\tShaderBoy.gui.header.needUpdate = true;\n\t\tShaderBoy.gui.header.contents.innerText = 'saved.';\n\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#1794be';\n\t\tsetTimeout(function () {\n\t\t\tShaderBoy.gui.header.needUpdate = false;\n\t\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#00000066';\n\t\t}, 1500);\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\trecompile: function () {\n\t\tif (ShaderBoy.buffers['MainImage'].active) {\n\t\t\tShaderBoy.buffers['MainImage'].textData = ShaderBoy.editor.codemirror.getValue();\n\t\t}\n\t\tif (ShaderBoy.buffers['Common'].active) {\n\t\t\tShaderBoy.buffers['Common'].textData = ShaderBoy.editor.codemirror.getValue();\n\t\t}\n\t\tShaderBoy.renderer.recompile(\n\t\t\tShaderBoy.util.deepcopy(ShaderBoy.buffers['Common'].textData),\n\t\t\tShaderBoy.util.deepcopy(ShaderBoy.buffers['MainImage'].textData)\n\t\t);\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tloadShader: function (callback) {\n\t\tShaderBoy.renderScale = (localStorage.renderScale !== undefined) ? localStorage.renderScale : 2;\n\t\tShaderBoy.buffers['MainImage'].loaded = false;\n\t\tShaderBoy.buffers['Common'].loaded = false;\n\t\tShaderBoy.buffers['MainImage'].active = (localStorage.mainActive !== undefined) ? localStorage.mainActive : true;\n\t\tShaderBoy.buffers['Common'].active = (localStorage.commonActive !== undefined) ? localStorage.commonActive : false;\n\t\tShaderBoy.buffers['MainImage'].textData = (localStorage.mainText !== undefined) ? localStorage.mainText : ShaderLib.shader.imageFS;\n\t\tShaderBoy.buffers['Common'].textData = (localStorage.commonText !== undefined) ? localStorage.commonText : ShaderLib.shader.commonFS;\n\t\tShaderBoy.renderScale = (localStorage.renderScale !== undefined) ? localStorage.renderScale : 2;\n\n\t\tShaderBoy.editor.selectBuffer('MainImage', true);\n\t\tShaderBoy.gui.header.needUpdate = true;\n\t\tShaderBoy.gui.header.contents.innerText = 'loaded.'\n\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#fcbd00';\n\t\tsetTimeout(function () {\n\t\t\tShaderBoy.gui.header.needUpdate = false;\n\t\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#00000066';\n\t\t}, 1500);\n\t\tcallback();\n\t}\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/io.js","////////////////////////////////////////////////////////////////////////////////\n// singleton ShaderLib\n////////////////////////////////////////////////////////////////////////////////\n\nvar ShaderLib = {\n\tshader:\n\t\t{},\n\tloadedNum: 0,\n\tshaderNum: 0,\n\tshaderInitialized: false,\n\n\tloadShader: function (name, url) {\n\t\t// Set up an asynchronous request\n\t\tlet request = new XMLHttpRequest();\n\t\trequest.open('GET', url, true);\n\t\trequest.setRequestHeader('Pragma', 'no-cache');\n\t\trequest.setRequestHeader('Cache-Control', 'no-cache');\n\t\trequest.setRequestHeader('If-Modified-Since', 'Thu, 01 Jun 1970 00:00:00 GMT');\n\t\trequest.root = this;\n\t\t// Hook the event that gets called as the request progresses\n\t\trequest.onreadystatechange = function () {\n\t\t\t// If the request is \"DONE\" (completed or failed)\n\t\t\tif (request.readyState === 4) {\n\t\t\t\t// If we got HTTP status 200 (OK)\n\t\t\t\tif (request.status === 200) {\n\t\t\t\t\tlet root = this.root;\n\t\t\t\t\tlet shaderTxt = request.responseText;\n\t\t\t\t\t// if (debug.SHADER) console.log('loadedShader: ' + name);\n\t\t\t\t\troot.loadedNum++;\n\t\t\t\t\tif (root.shader[name] !== null) {\n\t\t\t\t\t\troot.shader[name] = null;\n\t\t\t\t\t}\n\t\t\t\t\troot.shader[name] = shaderTxt;\n\t\t\t\t\tif (root.loadedNum === root.shaderNum) {\n\t\t\t\t\t\tif (root.shaderInitialized === true) {\n\t\t\t\t\t\t\t// if (debug.SHADER) {\n\t\t\t\t\t\t\t// console.log(shaderTxt);\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\troot.shaderInitialized = true;\n\t\t\t\t\t\t\troot.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t\troot.loadedNum = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // Failed\n\t\t\t\t\tconsole.log('Failed to load the shader\"' + url + '\"');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\trequest.send(null);\n\t},\n\n\tloadShaders: function (ref, callback) {\n\t\tthis.callback = callback;\n\t\tthis.shaderNum = ref.length;\n\n\t\tfor (let i = 0; i < this.shaderNum; i++) {\n\t\t\tlet name = ref[i].name;\n\t\t\tlet url = ref[i].url;\n\t\t\tthis.loadShader(name, url);\n\t\t}\n\t}\n};\n\nexport default ShaderLib;\n\n\n// WEBPACK FOOTER //\n// ./src/js/shader/shaderlib.js","//\n//   ___    _   _  _ \n//  (  _`\\ ( ) ( )(_)\n//  | ( (_)| | | || |\n//  | |___ | | | || |\n//  | (_, )| (_) || |\n//  (____/'(_____)(_)\n//                   \n//                   \n\nimport ShaderBoy from './shaderboy';\nimport key from 'keymaster';\n\nexport default ShaderBoy.gui = {\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\theader: {\n\t\tbase: { domElement: null },\n\t\tcontent: null,\n\t\tneedUpdate: false\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tsetting: {\n\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tmouse: {\n\t\tdown:\n\t\t{\n\t\t\tcurr: false,\n\t\t\tprev: false\n\t\t},\n\t\tposition:\n\t\t{\n\t\t\tcurr: [ShaderBoy.uniforms.iMouse[0], ShaderBoy.uniforms.iMouse[1]],\n\t\t\tprev: [ShaderBoy.uniforms.iMouse[0], ShaderBoy.uniforms.iMouse[1]]\n\t\t}\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tinit: function () {\n\t\tShaderBoy.style.buttonHeight = 35;\n\n\t\tthis.header.base.domElement = document.getElementById('ctrl');\n\t\tif (this.header.base.domElement === null) { throw 'Could not get canvas. No element such a name.'; }\n\t\tthis.header.base.domElement.style.backgroundColor = '#00000066';\n\t\tthis.header.base.domElement.style.float = 'left';\n\t\tthis.header.base.domElement.style.position = 'absolute';\n\t\t// this.header.base.domElement.style.top = window.innerHeight - ShaderBoy.style.buttonHeight + 'px';\n\t\tthis.header.base.domElement.style.top = '0px';\n\t\tthis.header.base.domElement.style.left = '0px';\n\t\tthis.header.base.domElement.style.width = window.innerWidth + 'px';\n\t\tthis.header.base.domElement.style.height = ShaderBoy.style.buttonHeight + 'px';\n\t\tthis.header.base.domElement.style.display = 'table';\n\t\tthis.header.base.domElement.style.border = '0px solid #FFF';\n\t\tthis.header.base.domElement.style.zIndex = '81';\n\n\t\t// iTime / iFrame / FPS info\n\t\tthis.header.contents = document.createElement(\"div\");\n\t\tthis.header.base.domElement.appendChild(this.header.contents);\n\t\tthis.header.contents.innerText = 378892.0.toFixed(3) + ' sec' + ' / ' + 4382.0.toFixed(0) + ' frms' + ' / ' + 43.0.toFixed(0) + ' fps';\n\t\tthis.header.contents.style.float = 'left';\n\t\tthis.header.contents.style.position = 'absolute';\n\t\tthis.header.contents.style.height = ShaderBoy.style.buttonHeight + 'px';\n\t\tthis.header.contents.style.color = '#FFF'\n\t\tthis.header.contents.style.top = '0px';\n\t\tthis.header.contents.style.left = '0px';\n\t\tthis.header.contents.style.fontSize = '14px';\n\t\tthis.header.contents.style.fontFamily = 'Arial, monospace';\n\t\tthis.header.contents.style.letterSpacing = '1px';\n\t\tthis.header.contents.style.marginTop = '9px';\n\t\tthis.header.contents.style.marginLeft = 15 + 'px';\n\t\t// this.header.contents.style.marginLeft = ShaderBoy.style.buttonHeight + 5 + 'px';\n\t},\n\n\tredrawHeader: function () {\n\t\tif (this.header.needUpdate !== true)\n\t\t\tthis.header.contents.innerText = ShaderBoy.uniforms.iTime.toFixed(3) + ' sec' + ' / ' + ShaderBoy.uniforms.iFrame.toFixed(0) + ' frms' + ' / ' + ShaderBoy.time.fps + ' fps';\n\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tsetupInteraction: function () {\n\t\tlet scrollMul = 1;\n\t\tShaderBoy.OS = 'Unknown OS';\n\t\tif (navigator.appVersion.indexOf('Win') != -1) ShaderBoy.OS = 'Windows';\n\t\tif (navigator.appVersion.indexOf('Mac') != -1) ShaderBoy.OS = 'MacOS';\n\t\tif (navigator.appVersion.indexOf('X11') != -1) ShaderBoy.OS = 'UNIX';\n\t\tif (navigator.appVersion.indexOf('Linux') != -1) ShaderBoy.OS = 'Linux';\n\t\tif (ShaderBoy.OS === 'Windows') { scrollMul = 100.0; }\n\n\t\tlet elementPos = function (element) {\n\t\t\tif (element !== undefined) {\n\t\t\t\tvar x = 0,\n\t\t\t\t\ty = 0;\n\t\t\t\twhile (element.offsetParent) {\n\t\t\t\t\tx += element.offsetLeft;\n\t\t\t\t\ty += element.offsetTop;\n\t\t\t\t\telement = element.offsetParent;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tlet eventPos = function (event) {\n\t\t\treturn {\n\t\t\t\tx: event.clientX + document.body.scrollLeft + document.documentElement.scrollLeft,\n\t\t\t\ty: event.clientY + document.body.scrollTop + document.documentElement.scrollTop\n\t\t\t};\n\t\t};\n\n\t\tlet canvasMousePos = function (event) {\n\t\t\tlet mousePos = eventPos(event);\n\t\t\tlet canvasPos = elementPos(ShaderBoy.gl.canvas);\n\t\t\treturn {\n\t\t\t\tx: mousePos.x - canvasPos.x,\n\t\t\t\ty: mousePos.y - canvasPos.y\n\t\t\t};\n\t\t};\n\n\t\tShaderBoy.gl.canvas.onmousedown = function (event) {\n\t\t\tif (event.button == 2) return false;\n\n\t\t\tlet mouse = canvasMousePos(event);\n\t\t\tif (mouse.x >= 0 && mouse.x < ShaderBoy.gl.canvas.clientWidth && mouse.y >= 0 && mouse.y < ShaderBoy.gl.canvas.clientHeight) {\n\t\t\t\tio.mouseLeftDownCur = true;\n\t\t\t\tiMouse[2] = 1;\n\t\t\t}\n\t\t};\n\n\t\tShaderBoy.gl.canvas.onmouseup = function (event) {\n\t\t\tio.mouseLeftDownCur = false;\n\t\t\tlet mouse = canvasMousePos(event);\n\t\t\tiMouse[2] = 0;\n\t\t};\n\n\t\tShaderBoy.gl.canvas.onmousemove = function (event) {\n\t\t\tif (!io.mouseLeftDownCur) return;\n\t\t\tlet mouse = canvasMousePos(event);\n\t\t\tio.mousePositionCur = [mouse.x, mouse.y];\n\t\t\tiMouse[0] = mouse.x;\n\t\t\tiMouse[1] = mouse.y;\n\t\t};\n\n\t\tShaderBoy.gl.canvas.contextmenu = function (event) {\n\t\t\tevent.preventDefault();\n\t\t};\n\n\t\tkey('alt+h', function () {\n\t\t\tShaderBoy.isEditorHide = !ShaderBoy.isEditorHide;\n\t\t\tif (ShaderBoy.isEditorHide) {\n\t\t\t\tShaderBoy.editor.domElement.style.opacity = '0.0';\n\t\t\t\tthis.header.base.domElement.style.opacity = '0.0';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tShaderBoy.editor.domElement.style.opacity = '1.0';\n\t\t\t\tShaderBoy.gui.header.base.domElement.style.opacity = '1.0';\n\t\t\t}\n\t\t});\n\t}\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/gui.js","//     keymaster.js\n//     (c) 2011-2013 Thomas Fuchs\n//     keymaster.js may be freely distributed under the MIT license.\n\n;(function(global){\n  var k,\n    _handlers = {},\n    _mods = { 16: false, 18: false, 17: false, 91: false },\n    _scope = 'all',\n    // modifier keys\n    _MODIFIERS = {\n      '': 16, shift: 16,\n      '': 18, alt: 18, option: 18,\n      '': 17, ctrl: 17, control: 17,\n      '': 91, command: 91\n    },\n    // special keys\n    _MAP = {\n      backspace: 8, tab: 9, clear: 12,\n      enter: 13, 'return': 13,\n      esc: 27, escape: 27, space: 32,\n      left: 37, up: 38,\n      right: 39, down: 40,\n      del: 46, 'delete': 46,\n      home: 36, end: 35,\n      pageup: 33, pagedown: 34,\n      ',': 188, '.': 190, '/': 191,\n      '`': 192, '-': 189, '=': 187,\n      ';': 186, '\\'': 222,\n      '[': 219, ']': 221, '\\\\': 220\n    },\n    code = function(x){\n      return _MAP[x] || x.toUpperCase().charCodeAt(0);\n    },\n    _downKeys = [];\n\n  for(k=1;k<20;k++) _MAP['f'+k] = 111+k;\n\n  // IE doesn't support Array#indexOf, so have a simple replacement\n  function index(array, item){\n    var i = array.length;\n    while(i--) if(array[i]===item) return i;\n    return -1;\n  }\n\n  // for comparing mods before unassignment\n  function compareArray(a1, a2) {\n    if (a1.length != a2.length) return false;\n    for (var i = 0; i < a1.length; i++) {\n        if (a1[i] !== a2[i]) return false;\n    }\n    return true;\n  }\n\n  var modifierMap = {\n      16:'shiftKey',\n      18:'altKey',\n      17:'ctrlKey',\n      91:'metaKey'\n  };\n  function updateModifierKey(event) {\n      for(k in _mods) _mods[k] = event[modifierMap[k]];\n  };\n\n  // handle keydown event\n  function dispatch(event) {\n    var key, handler, k, i, modifiersMatch, scope;\n    key = event.keyCode;\n\n    if (index(_downKeys, key) == -1) {\n        _downKeys.push(key);\n    }\n\n    // if a modifier key, set the key.<modifierkeyname> property to true and return\n    if(key == 93 || key == 224) key = 91; // right command on webkit, command on Gecko\n    if(key in _mods) {\n      _mods[key] = true;\n      // 'assignKey' from inside this closure is exported to window.key\n      for(k in _MODIFIERS) if(_MODIFIERS[k] == key) assignKey[k] = true;\n      return;\n    }\n    updateModifierKey(event);\n\n    // see if we need to ignore the keypress (filter() can can be overridden)\n    // by default ignore key presses if a select, textarea, or input is focused\n    if(!assignKey.filter.call(this, event)) return;\n\n    // abort if no potentially matching shortcuts found\n    if (!(key in _handlers)) return;\n\n    scope = getScope();\n\n    // for each potential shortcut\n    for (i = 0; i < _handlers[key].length; i++) {\n      handler = _handlers[key][i];\n\n      // see if it's in the current scope\n      if(handler.scope == scope || handler.scope == 'all'){\n        // check if modifiers match if any\n        modifiersMatch = handler.mods.length > 0;\n        for(k in _mods)\n          if((!_mods[k] && index(handler.mods, +k) > -1) ||\n            (_mods[k] && index(handler.mods, +k) == -1)) modifiersMatch = false;\n        // call the handler and stop the event if neccessary\n        if((handler.mods.length == 0 && !_mods[16] && !_mods[18] && !_mods[17] && !_mods[91]) || modifiersMatch){\n          if(handler.method(event, handler)===false){\n            if(event.preventDefault) event.preventDefault();\n              else event.returnValue = false;\n            if(event.stopPropagation) event.stopPropagation();\n            if(event.cancelBubble) event.cancelBubble = true;\n          }\n        }\n      }\n    }\n  };\n\n  // unset modifier keys on keyup\n  function clearModifier(event){\n    var key = event.keyCode, k,\n        i = index(_downKeys, key);\n\n    // remove key from _downKeys\n    if (i >= 0) {\n        _downKeys.splice(i, 1);\n    }\n\n    if(key == 93 || key == 224) key = 91;\n    if(key in _mods) {\n      _mods[key] = false;\n      for(k in _MODIFIERS) if(_MODIFIERS[k] == key) assignKey[k] = false;\n    }\n  };\n\n  function resetModifiers() {\n    for(k in _mods) _mods[k] = false;\n    for(k in _MODIFIERS) assignKey[k] = false;\n  };\n\n  // parse and assign shortcut\n  function assignKey(key, scope, method){\n    var keys, mods;\n    keys = getKeys(key);\n    if (method === undefined) {\n      method = scope;\n      scope = 'all';\n    }\n\n    // for each shortcut\n    for (var i = 0; i < keys.length; i++) {\n      // set modifier keys if any\n      mods = [];\n      key = keys[i].split('+');\n      if (key.length > 1){\n        mods = getMods(key);\n        key = [key[key.length-1]];\n      }\n      // convert to keycode and...\n      key = key[0]\n      key = code(key);\n      // ...store handler\n      if (!(key in _handlers)) _handlers[key] = [];\n      _handlers[key].push({ shortcut: keys[i], scope: scope, method: method, key: keys[i], mods: mods });\n    }\n  };\n\n  // unbind all handlers for given key in current scope\n  function unbindKey(key, scope) {\n    var multipleKeys, keys,\n      mods = [],\n      i, j, obj;\n\n    multipleKeys = getKeys(key);\n\n    for (j = 0; j < multipleKeys.length; j++) {\n      keys = multipleKeys[j].split('+');\n\n      if (keys.length > 1) {\n        mods = getMods(keys);\n        key = keys[keys.length - 1];\n      }\n\n      key = code(key);\n\n      if (scope === undefined) {\n        scope = getScope();\n      }\n      if (!_handlers[key]) {\n        return;\n      }\n      for (i = 0; i < _handlers[key].length; i++) {\n        obj = _handlers[key][i];\n        // only clear handlers if correct scope and mods match\n        if (obj.scope === scope && compareArray(obj.mods, mods)) {\n          _handlers[key][i] = {};\n        }\n      }\n    }\n  };\n\n  // Returns true if the key with code 'keyCode' is currently down\n  // Converts strings into key codes.\n  function isPressed(keyCode) {\n      if (typeof(keyCode)=='string') {\n        keyCode = code(keyCode);\n      }\n      return index(_downKeys, keyCode) != -1;\n  }\n\n  function getPressedKeyCodes() {\n      return _downKeys.slice(0);\n  }\n\n  function filter(event){\n    var tagName = (event.target || event.srcElement).tagName;\n    // ignore keypressed in any elements that support keyboard data input\n    return !(tagName == 'INPUT' || tagName == 'SELECT' || tagName == 'TEXTAREA');\n  }\n\n  // initialize key.<modifier> to false\n  for(k in _MODIFIERS) assignKey[k] = false;\n\n  // set current scope (default 'all')\n  function setScope(scope){ _scope = scope || 'all' };\n  function getScope(){ return _scope || 'all' };\n\n  // delete all handlers for a given scope\n  function deleteScope(scope){\n    var key, handlers, i;\n\n    for (key in _handlers) {\n      handlers = _handlers[key];\n      for (i = 0; i < handlers.length; ) {\n        if (handlers[i].scope === scope) handlers.splice(i, 1);\n        else i++;\n      }\n    }\n  };\n\n  // abstract key logic for assign and unassign\n  function getKeys(key) {\n    var keys;\n    key = key.replace(/\\s/g, '');\n    keys = key.split(',');\n    if ((keys[keys.length - 1]) == '') {\n      keys[keys.length - 2] += ',';\n    }\n    return keys;\n  }\n\n  // abstract mods logic for assign and unassign\n  function getMods(key) {\n    var mods = key.slice(0, key.length - 1);\n    for (var mi = 0; mi < mods.length; mi++)\n    mods[mi] = _MODIFIERS[mods[mi]];\n    return mods;\n  }\n\n  // cross-browser events\n  function addEvent(object, event, method) {\n    if (object.addEventListener)\n      object.addEventListener(event, method, false);\n    else if(object.attachEvent)\n      object.attachEvent('on'+event, function(){ method(window.event) });\n  };\n\n  // set the handlers globally on document\n  addEvent(document, 'keydown', function(event) { dispatch(event) }); // Passing _scope to a callback to ensure it remains the same by execution. Fixes #48\n  addEvent(document, 'keyup', clearModifier);\n\n  // reset modifiers to false whenever the window is (re)focused.\n  addEvent(window, 'focus', resetModifiers);\n\n  // store previously defined key\n  var previousKey = global.key;\n\n  // restore previously defined key and return reference to our key object\n  function noConflict() {\n    var k = global.key;\n    global.key = previousKey;\n    return k;\n  }\n\n  // set window.key and window.key.set/get/deleteScope, and the default filter\n  global.key = assignKey;\n  global.key.setScope = setScope;\n  global.key.getScope = getScope;\n  global.key.deleteScope = deleteScope;\n  global.key.filter = filter;\n  global.key.isPressed = isPressed;\n  global.key.getPressedKeyCodes = getPressedKeyCodes;\n  global.key.noConflict = noConflict;\n  global.key.unbind = unbindKey;\n\n  if(typeof module !== 'undefined') module.exports = assignKey;\n\n})(this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/keymaster/keymaster.js\n// module id = 8\n// module chunks = 0","//\n//   ___                      _                          \n//  |  _`\\                   ( )                         \n//  | (_) )   __    ___     _| |   __   _ __   __   _ __ \n//  | ,  /  /'__`\\/' _ `\\ /'_` | /'__`\\( '__)/'__`\\( '__)\n//  | |\\ \\ (  ___/| ( ) |( (_| |(  ___/| |  (  ___/| |   \n//  (_) (_)`\\____)(_) (_)`\\__,_)`\\____)(_)  `\\____)(_)   \n//                                                       \n//                                                       \n\nimport ShaderBoy from './shaderboy';\nimport ShaderLib from './shader/shaderlib';\nimport Shader from './shader/shader';\nimport AssetLoader from './util/AssetLoader';\n\nlet gl = null;\n\nexport default ShaderBoy.renderer = {\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tinit: function () {\n\t\tgl = ShaderBoy.gl;\n\t\tconsole.log(\"Float32Filter=\" + gl.getExtension('OES_texture_float_linear'));\n\t\tconsole.log(\"Float16Filter=\" + gl.getExtension('OES_texture_half_float_linear'));\n\t\tconsole.log(\"Anisotropic=\" + gl.getExtension('EXT_texture_filter_anisotropic'));\n\t\tconsole.log(\"RenderToFloat32F=\" + gl.getExtension('EXT_color_buffer_float'));\n\n\t\tthis.shaders = {};\n\n\t\tlet mainFragCode = '';\n\t\tmainFragCode =\n\t\t\tShaderLib.shader.uniformFS +\n\t\t\tShaderLib.shader.commonFS +\n\t\t\tShaderLib.shader.imageFS +\n\t\t\tShaderLib.shader.commonfooterFS;\n\t\tthis.shaders.main = new Shader(gl, ShaderLib.shader.commonVS, mainFragCode);\n\t\tthis.shaders.main.uniforms = {\n\t\t\t'iResolution': ShaderBoy.uniforms.iResolution,           // viewport resolution (in pixels)\n\t\t\t'iTime': ShaderBoy.uniforms.iTime,                 // shader playback time (in seconds)\n\t\t\t'iTimeDelta': 0,            // render time (in seconds)\n\t\t\t'iFrame': ShaderBoy.uniforms.iFrame,                // shader playback frame\n\t\t\t// 'iDate': iDate,                 // (year, month, day, time in seconds)\n\t\t\t// 'iChannelTime': [iTime, iTime, iTime, iTime],\t\t\t // channel playback time (in seconds)\n\t\t\t// 'iChannelResolution':[iResolution, iResolution, iResolution, iResolution],    // channel resolution (in pixels)\n\t\t\t'iMouse': ShaderBoy.uniforms.iMouse,                // mouse pixel coords. xy: current (if MLB down), zw: click\n\t\t\t'iChannel0': 0,             // input channel. XX = 2D/Cube\n\t\t\t// 'iChannel1': 1,             // input channel. XX = 2D/Cube\n\t\t\t// 'iChannel2': 2,             // input channel. XX = 2D/Cube\n\t\t\t// 'iChannel3': 3,             // input channel. XX = 2D/Cube\n\t\t};\n\n\t\tthis.shaders.screen = new Shader(gl, ShaderLib.shader.commonVS, ShaderLib.shader.screenFS + ShaderLib.shader.commonfooterFS);\n\t\tthis.shaders.screen.uniforms = {\n\t\t\t'iResolution': ShaderBoy.uniforms.iResolution,\n\t\t\t'frameTexture': 0\n\t\t};\n\n\t\tthis.createBuffer(true);\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\trecompile: function (commonCode, fragmentCode) {\n\t\tlet mainFragCode = '';\n\t\tmainFragCode =\n\t\t\tShaderLib.shader.uniformFS +\n\t\t\tcommonCode +\n\t\t\tfragmentCode +\n\t\t\tShaderLib.shader.commonfooterFS;\n\t\tthis.shaders.main.recompileFragment(mainFragCode);\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tcreateBuffer: function (init) {\n\t\tfunction setFloatTextureParams(gl, texture, width, height) {\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA32F, width, height, 0, gl.RGBA, gl.FLOAT, null);\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\t}\n\n\t\tfunction setUnsignedByteTextureParams(gl, texture, width, height) {\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\t}\n\n\t\t// create mainFramebuffer\n\t\tthis.mainFramebuffer = gl.createFramebuffer();\n\t\tif (init === false) {\n\t\t\tgl.deleteTexture(this.mainTextures[0]);\n\t\t\tgl.deleteTexture(this.mainTextures[1]);\n\t\t}\n\n\t\t// create textures\n\t\tthis.mainTextures = [];\n\t\tfor (let i = 0; i < 2; i++) {\n\t\t\tthis.mainTextures.push(gl.createTexture());\n\t\t\tsetFloatTextureParams(gl, this.mainTextures[i], window.innerWidth / ShaderBoy.renderScale, window.innerHeight / ShaderBoy.renderScale);\n\t\t}\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.mainFramebuffer);\n\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.mainTextures[0], 0);\n\t\tgl.clearColor(1.0, 1.0, 1.0, 1.0);\n\t\tgl.clearDepth(1.0);\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, this.mainFramebuffer);\n\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.mainTextures[1], 0);\n\t\tgl.clearColor(1.0, 1.0, 1.0, 1.0);\n\t\tgl.clearDepth(1.0);\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t},\n\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\trender: function () {\n\t\tgl.viewport(0, 0, gl.canvas.clientWidth / ShaderBoy.renderScale, window.innerHeight / ShaderBoy.renderScale);\n\t\tthis.shaders.main.begin();\n\t\tthis.shaders.main.uniforms.iResolution = [ShaderBoy.uniforms.iResolution[0] / ShaderBoy.renderScale, ShaderBoy.uniforms.iResolution[1] / ShaderBoy.renderScale];\n\t\tthis.shaders.main.uniforms.iTime = ShaderBoy.uniforms.iTime;\n\t\tthis.shaders.main.uniforms.iTimeDelta = ShaderBoy.uniforms.iTimeDelta;\n\t\tthis.shaders.main.uniforms.iFrame = ShaderBoy.uniforms.iFrame;\n\t\tthis.shaders.main.uniforms.iChannel0 = 0;\n\t\tthis.shaders.main.uniforms.iMouse = ShaderBoy.uniforms.iMouse;\n\t\tthis.shaders.main.setUniforms();\n\t\tthis.shaders.main.setTexture2d(0, this.mainTextures[0]);\n\t\tthis.shaders.main.drawTexture(this.mainFramebuffer, this.mainTextures[1]);\n\t\tthis.shaders.main.end();\n\n\t\tgl.viewport(0, 0, gl.canvas.clientWidth, window.innerHeight);\n\t\tthis.shaders.screen.begin();\n\t\tthis.shaders.screen.uniforms.iResolution = ShaderBoy.uniforms.iResolution;\n\t\tthis.shaders.screen.uniforms.frameTexture = 0;\n\t\tthis.shaders.screen.setUniforms();\n\t\tthis.shaders.screen.setTexture2d(0, this.mainTextures[0]);\n\t\tthis.shaders.screen.drawScreen();\n\t\tthis.shaders.screen.end();\n\n\t\tgl.flush();\n\n\t\tthis.mainTextures.reverse();\n\t}\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/renderer.js","import ShaderBoy from '../shaderboy';\n\nlet gl = null;\nexport default class Shader {\n\tconstructor(gGl, vertexSource, fragmentSource) {\n\t\tgl = gGl;\n\t\tfunction regexMap(regex, text, callback) {\n\t\t\tlet result;\n\t\t\twhile ((result = regex.exec(text)) != null) {\n\t\t\t\tcallback(result);\n\t\t\t}\n\t\t}\n\n\t\tfunction compileSource(gl, type, source) {\n\t\t\tvar shader = gl.createShader(type);\n\t\t\tgl.shaderSource(shader, source);\n\t\t\tgl.compileShader(shader);\n\t\t\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\t\t\tthrow new Error('compile error: ' + gl.getShaderInfoLog(shader));\n\t\t\t}\n\t\t\treturn shader;\n\t\t}\n\n\t\tthis.vertexSource = vertexSource;\n\t\tthis.fragmentSource = fragmentSource;\n\t\tthis.source = vertexSource + fragmentSource;\n\t\tthis.attributes = {};\n\t\tthis.uniforms = {};\n\t\tthis.uniformLocations = {};\n\t\tthis.program = gl.createProgram();\n\n\t\tthis.quadVBO = gl.createBuffer();\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadVBO);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0]), gl.STATIC_DRAW);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n\t\tthis.triVBO = gl.createBuffer();\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.triVBO);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1.0, -1.0, 3.0, -1.0, -1.0, 3.0]), gl.STATIC_DRAW);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n\t\tgl.attachShader(this.program, compileSource(gl, gl.VERTEX_SHADER, vertexSource));\n\t\tgl.attachShader(this.program, compileSource(gl, gl.FRAGMENT_SHADER, fragmentSource));\n\t\tgl.linkProgram(this.program);\n\t\tthis.vertAttLocation = gl.getAttribLocation(this.program, 'a_position');\n\t\tgl.enableVertexAttribArray(this.vertAttLocation);\n\n\t\tif (!gl.getProgramParameter(this.program, gl.LINK_STATUS)) {\n\t\t\tthrow new Error('link error: ' + gl.getProgramInfoLog(this.program));\n\t\t}\n\n\t\t// Sampler uniforms need to be uploaded using `gl.uniform1i()` instead of `gl.uniform1f()`.\n\t\t// To do this automatically, we detect and remember all uniform samplers in the source code.\n\t\tlet isSampler = {};\n\t\tregexMap(/uniform\\s+sampler(1D|2D|3D|Cube)\\s+(\\w+)\\s*;/g, vertexSource + fragmentSource, function (groups) {\n\t\t\tisSampler[groups[2]] = 1;\n\t\t});\n\t\tthis.isSampler = isSampler;\n\t}\n\n\trecompileFragment(fragmentSource) {\n\t\tfragmentSource = fragmentSource.replace('', ' ');\n\t\tfragmentSource = fragmentSource.replace('\t', ' ');\n\t\tfragmentSource = fragmentSource.replace(/[^\\x00-\\x7F]/g, '');\n\n\t\tthis.attributes = {};\n\t\tthis.uniforms = {};\n\t\tthis.uniformLocations = {};\n\t\tgl.deleteProgram(this.program);\n\t\tthis.program = null;\n\t\tthis.program = gl.createProgram();\n\t\tfunction compileSource(gl, type, source) {\n\t\t\tvar shader = gl.createShader(type);\n\t\t\tgl.shaderSource(shader, source);\n\t\t\tgl.compileShader(shader);\n\n\t\t\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\t\t\t// throw new Error('compile error: ' + gl.getShaderInfoLog(shader));\n\n\t\t\t\tShaderBoy.gui.header.needUpdate = true;\n\t\t\t\tShaderBoy.gui.header.contents.innerText = 'error: ' + gl.getShaderInfoLog(shader);\n\t\t\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#FF0000';\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tShaderBoy.gui.header.needUpdate = false;\n\t\t\t\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#00000066';\n\t\t\t\t}, 6000);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tShaderBoy.gui.header.needUpdate = true;\n\t\t\t\tShaderBoy.gui.header.contents.innerText = 'compiled.';\n\t\t\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#3ca403';\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tShaderBoy.gui.header.needUpdate = false;\n\t\t\t\t\tShaderBoy.gui.header.base.domElement.style.backgroundColor = '#00000066';\n\t\t\t\t}, 1500);\n\t\t\t}\n\t\t\treturn shader;\n\t\t}\n\t\tthis.fragmentSource = fragmentSource;\n\t\tthis.source = this.vertexSource + fragmentSource;\n\t\tgl.attachShader(this.program, compileSource(gl, gl.VERTEX_SHADER, this.vertexSource));\n\t\tgl.attachShader(this.program, compileSource(gl, gl.FRAGMENT_SHADER, this.fragmentSource));\n\t\tgl.linkProgram(this.program);\n\t\tthis.vertAttLocation = gl.getAttribLocation(this.program, 'a_position');\n\t\tgl.enableVertexAttribArray(this.vertAttLocation);\n\n\t\tif (!gl.getProgramParameter(this.program, gl.LINK_STATUS)) {\n\t\t\tthrow new Error('link error: ' + gl.getProgramInfoLog(this.program));\n\t\t}\n\t}\n\n\tbegin() {\n\t\tgl.useProgram(this.program);\n\t\t// gl.clearColor(1.0, 1.0, 1.0, 1.0);\n\t\tgl.clearDepth(1.0);\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\n\t}\n\n\tend() {\n\t\t// gl.clearColor(1.0, 1.0, 1.0, 1.0);\n\t\t// gl.clearDepth(1.0);\n\t\t// gl.clear(gl.COLOR_BUFFER_BIT);\n\t\tgl.disableVertexAttribArray(this.vertAttLocation);\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, null);\n\t\tgl.useProgram(null);\n\t}\n\n\tsetUniforms() {\n\t\tlet isArray = function (obj) {\n\t\t\tlet str = Object.prototype.toString.call(obj);\n\t\t\treturn str == '[object Array]' || str == '[object Float32Array]';\n\t\t};\n\n\t\tlet isNumber = function (obj) {\n\t\t\tlet str = Object.prototype.toString.call(obj);\n\t\t\treturn str == '[object Number]' || str == '[object Boolean]';\n\t\t};\n\t\t// if(name==='iChannel0')\n\t\t{\n\t\t\tlet location = this.uniformLocations['iChannel0'] || gl.getUniformLocation(this.program, 'iChannel0');\n\t\t\tgl.uniform1i(location, 0);\n\t\t}\n\n\t\tlet location = this.uniformLocations['iChannel0'] || gl.getUniformLocation(this.program, 'iChannel0');\n\n\t\tfor (let name in this.uniforms) {\n\t\t\t// console.log(name);\n\t\t\tlet realName = name.replace(/\\\"/g, '');\n\t\t\tlet location = this.uniformLocations[realName] || gl.getUniformLocation(this.program, realName);\n\t\t\tif (realName == 'iFrame') {\n\t\t\t\tlet value = this.uniforms[name];\n\t\t\t\tgl.uniform1i(location, value);\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tif (!location) continue;\n\t\t\tthis.uniformLocations[realName] = location;\n\t\t\tlet value = this.uniforms[name];\n\n\t\t\tif (isArray(value)) {\n\t\t\t\tlet v, m;\n\t\t\t\tswitch (value.length) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tv = new Float32Array(value);\n\t\t\t\t\t\tgl.uniform1fv(location, v);\n\t\t\t\t\t\tv = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tv = new Float32Array(value);\n\t\t\t\t\t\tgl.uniform2fv(location, v);\n\t\t\t\t\t\tv = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tv = new Float32Array(value);\n\t\t\t\t\t\tgl.uniform3fv(location, v);\n\t\t\t\t\t\tv = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tv = new Float32Array(value);\n\t\t\t\t\t\tgl.uniform4fv(location, v);\n\t\t\t\t\t\tv = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t// Matrices are automatically transposed, since WebGL uses column-major\n\t\t\t\t\t// indices instead of row-major indices.\n\t\t\t\t\tcase 9:\n\t\t\t\t\t\tm = [\n\t\t\t\t\t\t\tvalue[0], value[3], value[6],\n\t\t\t\t\t\t\tvalue[1], value[4], value[7],\n\t\t\t\t\t\t\tvalue[2], value[5], value[8]\n\t\t\t\t\t\t];\n\t\t\t\t\t\tv = new Float32Array(m);\n\t\t\t\t\t\tgl.uniformMatrix3fv(location, false, v);\n\t\t\t\t\t\tm = null;\n\t\t\t\t\t\tv = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 16:\n\t\t\t\t\t\tm = [\n\t\t\t\t\t\t\tvalue[0], value[4], value[8], value[12],\n\t\t\t\t\t\t\tvalue[1], value[5], value[9], value[13],\n\t\t\t\t\t\t\tvalue[2], value[6], value[10], value[14],\n\t\t\t\t\t\t\tvalue[3], value[7], value[11], value[15]\n\t\t\t\t\t\t];\n\t\t\t\t\t\tv = new Float32Array(m);\n\t\t\t\t\t\tgl.uniformMatrix4fv(location, false, v);\n\t\t\t\t\t\tm = null;\n\t\t\t\t\t\tv = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// console.log(value);\n\t\t\t\t\t\tgl.uniform1fv(location, value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t// throw new Error('don\\'t know how to load uniform \"' + name + '\" of length ' + value.length);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (isNumber(value)) {\n\t\t\t\t(this.isSampler[name] ? gl.uniform1i : gl.uniform1f).call(gl, location, value);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error('attempted to set uniform \"' + name + '\" to invalid value ' + value);\n\t\t\t}\n\t\t\tlocation = null;\n\t\t\tvalue = null;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsetTexture2d(id, texture) {\n\t\tthis.gl = gl;\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\teval('this.gl.activeTexture(this.gl.TEXTURE' + id + ');');\n\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\t}\n\n\tsetTexture3d(id, texture) {\n\t\tthis.gl = gl;\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\teval('this.gl.activeTexture(this.gl.TEXTURE' + id + ');');\n\t\tgl.bindTexture(gl.TEXTURE_CUBE_MAP, texture);\n\t}\n\n\tdrawScreen() {\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.quadVBO);\n\t\tgl.vertexAttribPointer(this.vertAttLocation, 2, gl.FLOAT, false, 0, 0);\n\t\tgl.enableVertexAttribArray(this.vertAttLocation);\n\t\tgl.drawArrays(gl.TRIANGLES, 0, 6);\n\t}\n\n\tdrawTexture(fbo, texture) {\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\n\t\tif (texture !== undefined) gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.triVBO);\n\t\tgl.vertexAttribPointer(this.vertAttLocation, 2, gl.FLOAT, false, 0, 0);\n\t\tgl.enableVertexAttribArray(this.vertAttLocation);\n\t\tgl.drawArrays(gl.TRIANGLES, 0, 3);\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/shader/shader.js","import HDRParser from '../util/parsehdr';\n\nexport default class AssetLoader {\n\tconstructor() {\n\t\tthis.envMapTexture = null;\n\t}\n\n\t//\n\t// Initialize a texture and load an image.\n\t// When the image finished loading copy it into the texture.\n\t//\n\tloadTexture(gl, url) {\n\t\tfunction isPowerOf2(value) {\n\t\t\treturn (value & (value - 1)) == 0;\n\t\t}\n\t\tconst texture = gl.createTexture();\n\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\n\t\t// Because images have to be download over the internet\n\t\t// they might take a moment until they are ready.\n\t\t// Until then put a single pixel in the texture so we can\n\t\t// use it immediately. When the image has finished downloading\n\t\t// we'll update the texture with the contents of the image.\n\t\tconst level = 0;\n\t\tconst internalFormat = gl.RGBA;\n\t\tconst width = 1;\n\t\tconst height = 1;\n\t\tconst border = 0;\n\t\tconst srcFormat = gl.RGBA;\n\t\tconst srcType = gl.UNSIGNED_BYTE;\n\t\tconst pixel = new Uint8Array([0, 0, 255, 255]);  // opaque blue\n\t\tgl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\n\t\t\twidth, height, border, srcFormat, srcType,\n\t\t\tpixel);\n\n\t\tconst image = new Image();\n\t\timage.onload = function () {\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\t\t\tgl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\n\t\t\t\tsrcFormat, srcType, image);\n\t\t\tif (isPowerOf2(image.width) && isPowerOf2(image.height)) {\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\t\t\t}\n\t\t};\n\t\timage.src = url;\n\n\t\treturn texture;\n\t}\n\n\tloadHdrEnvMap(url) {\n\t\t// load HDR texture\n\t\tHDRParser.loadBinary(url, this, function (err, hdr) {\n\t\t\tlet imgHdr = HDRParser.parseHdr(hdr);\n\t\t\tAssetLoader.envMapTexture = gl.createTexture();\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, AssetLoader.envMapTexture);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\t\tgl.texImage2D(\n\t\t\t\tgl.TEXTURE_2D, 0, gl.RGBA, imgHdr.shape[0], imgHdr.shape[1], 0,\n\t\t\t\tgl.RGBA, gl.FLOAT, imgHdr.data\n\t\t\t);\n\t\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\t\tconsole.log('HDR is OK.');\n\t\t});\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/util/AssetLoader.js","////////////////////////////////////////////////////////////////////////////////\n// class HDRParser\n////////////////////////////////////////////////////////////////////////////////\n\n//Code ported by Marcin Ignac (2014)\n//Based on Java implementation from\n//https://code.google.com/r/cys12345-research/source/browse/hdr/image_processor/RGBE.java?r=7d84e9fd866b24079dbe61fa0a966ce8365f5726\n\nvar HDRParser = {\n\tradiancePattern: '#\\\\?RADIANCE',\n\tcommentPattern: '#.*',\n\t// gammaPattern: 'GAMMA=',\n\texposurePattern: 'EXPOSURE=\\\\s*([0-9]*[.][0-9]*)',\n\tformatPattern: 'FORMAT=32-bit_rle_rgbe',\n\twidthHeightPattern: '-Y ([0-9]+) \\\\+X ([0-9]+)',\n\n\tloadBinary: function (url, scope, callback)\n\t{\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open('GET', url, true);\n\t\trequest.responseType = 'arraybuffer';\n\t\trequest.onreadystatechange = function (e)\n\t\t{\n\t\t\tif (request.readyState === 4)\n\t\t\t{\n\t\t\t\tif (request.status === 200)\n\t\t\t\t{\n\t\t\t\t\tcallback(null, request.response, scope);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcallback('loadBinaryFile error : ' + request.response + e.toString(), null);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\trequest.send(null);\n\t},\n\n\t//http://croquetweak.blogspot.co.uk/2014/08/deconstructing-floats-frexp-and-ldexp.html\n\tldexp: function (mantissa, exponent)\n\t{\n\t\treturn exponent > 1023 // avoid multiplying by infinity\n\t\t\t? mantissa * Math.pow(2, 1023) * Math.pow(2, exponent - 1023) : exponent < -1074 // avoid multiplying by zero\n\t\t\t? mantissa * Math.pow(2, -1074) * Math.pow(2, exponent + 1074) : mantissa * Math.pow(2, exponent);\n\t},\n\n\treadPixelsRawRLE: function (buffer, data, offset, fileOffset, scanlineWidth, numScanlines)\n\t{\n\t\tvar rgbe = new Array(4);\n\t\tvar scanlineBuffer = null;\n\t\tvar ptr;\n\t\tvar ptrEnd;\n\t\tvar count;\n\t\tvar buf = new Array(2);\n\t\tvar bufferLength = buffer.length;\n\n\t\tfunction readBuf(buf)\n\t\t{\n\t\t\tvar bytesRead = 0;\n\t\t\tdo {\n\t\t\t\tbuf[bytesRead++] = buffer[fileOffset];\n\t\t\t} while (++fileOffset < bufferLength && bytesRead < buf.length);\n\t\t\treturn bytesRead;\n\t\t}\n\n\t\tfunction readBufOffset(buf, offset, length)\n\t\t{\n\t\t\tvar bytesRead = 0;\n\t\t\tdo {\n\t\t\t\tbuf[offset + bytesRead++] = buffer[fileOffset];\n\t\t\t} while (++fileOffset < bufferLength && bytesRead < length);\n\t\t\treturn bytesRead;\n\t\t}\n\n\t\tfunction readPixelsRaw(buffer, data, offset, numpixels)\n\t\t{\n\t\t\tvar numExpected = 4 * numpixels;\n\t\t\tvar numRead = readBufOffset(data, offset, numExpected);\n\t\t\tif (numRead < numExpected)\n\t\t\t{\n\t\t\t\tthrow new Error('Error reading raw pixels: got ' + numRead + ' bytes, expected ' + numExpected);\n\t\t\t}\n\t\t}\n\n\t\twhile (numScanlines > 0)\n\t\t{\n\t\t\tif (readBuf(rgbe) < rgbe.length)\n\t\t\t{\n\t\t\t\tthrow new Error('Error reading bytes: expected ' + rgbe.length);\n\t\t\t}\n\n\t\t\tif ((rgbe[0] !== 2) || (rgbe[1] !== 2) || ((rgbe[2] & 0x80) !== 0))\n\t\t\t{\n\t\t\t\t//this file is not run length encoded\n\t\t\t\tdata[offset++] = rgbe[0];\n\t\t\t\tdata[offset++] = rgbe[1];\n\t\t\t\tdata[offset++] = rgbe[2];\n\t\t\t\tdata[offset++] = rgbe[3];\n\t\t\t\treadPixelsRaw(buffer, data, offset, scanlineWidth * numScanlines - 1);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ((((rgbe[2] & 0xFF) << 8) | (rgbe[3] & 0xFF)) !== scanlineWidth)\n\t\t\t{\n\t\t\t\tthrow new Error('Wrong scanline width ' + (((rgbe[2] & 0xFF) << 8) | (rgbe[3] & 0xFF)) + ', expected ' + scanlineWidth);\n\t\t\t}\n\n\t\t\tif (scanlineBuffer === null)\n\t\t\t{\n\t\t\t\tscanlineBuffer = new Array(4 * scanlineWidth);\n\t\t\t}\n\n\t\t\tptr = 0;\n\t\t\t/* read each of the four channels for the scanline into the buffer */\n\t\t\tfor (var i = 0; i < 4; i++)\n\t\t\t{\n\t\t\t\tptrEnd = (i + 1) * scanlineWidth;\n\t\t\t\twhile (ptr < ptrEnd)\n\t\t\t\t{\n\t\t\t\t\tif (readBuf(buf) < buf.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tthrow new Error('Error reading 2-byte buffer');\n\t\t\t\t\t}\n\t\t\t\t\tif ((buf[0] & 0xFF) > 128)\n\t\t\t\t\t{\n\t\t\t\t\t\t/* a run of the same value */\n\t\t\t\t\t\tcount = (buf[0] & 0xFF) - 128;\n\t\t\t\t\t\tif ((count === 0) || (count > ptrEnd - ptr))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthrow new Error('Bad scanline data');\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (count-- > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tscanlineBuffer[ptr++] = buf[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t/* a non-run */\n\t\t\t\t\t\tcount = buf[0] & 0xFF;\n\t\t\t\t\t\tif ((count === 0) || (count > ptrEnd - ptr))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthrow new Error('Bad scanline data');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscanlineBuffer[ptr++] = buf[1];\n\t\t\t\t\t\tif (--count > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (readBufOffset(scanlineBuffer, ptr, count) < count)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthrow new Error('Error reading non-run data');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tptr += count;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* copy byte data to output */\n\t\t\tfor (i = 0; i < scanlineWidth; i++)\n\t\t\t{\n\t\t\t\tdata[offset + 0] = scanlineBuffer[i];\n\t\t\t\tdata[offset + 1] = scanlineBuffer[i + scanlineWidth];\n\t\t\t\tdata[offset + 2] = scanlineBuffer[i + 2 * scanlineWidth];\n\t\t\t\tdata[offset + 3] = scanlineBuffer[i + 3 * scanlineWidth];\n\t\t\t\toffset += 4;\n\t\t\t}\n\n\t\t\tnumScanlines--;\n\t\t}\n\n\t},\n\n\t//Returns data as floats and flipped along Y by default\n\tparseHdr: function (buffer)\n\t{\n\t\tif (buffer instanceof ArrayBuffer)\n\t\t{\n\t\t\tbuffer = new Uint8Array(buffer);\n\t\t}\n\n\t\tvar fileOffset = 0;\n\t\tvar bufferLength = buffer.length;\n\n\t\tvar NEW_LINE = 10;\n\n\t\tfunction readLine()\n\t\t{\n\t\t\tvar buf = '';\n\t\t\tdo {\n\t\t\t\tvar b = buffer[fileOffset];\n\t\t\t\tif (b === NEW_LINE)\n\t\t\t\t{\n\t\t\t\t\t++fileOffset;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbuf += String.fromCharCode(b);\n\t\t\t} while (++fileOffset < bufferLength);\n\t\t\treturn buf;\n\t\t}\n\n\t\tvar width = 0;\n\t\tvar height = 0;\n\t\tvar exposure = 1;\n\t\tvar gamma = 1;\n\t\tvar rle = false;\n\n\t\tfor (var i = 0; i < 20; i++)\n\t\t{\n\t\t\tvar line = readLine();\n\t\t\tvar match;\n\t\t\tif (line.match(this.radiancePattern))\n\t\t\t{\n\t\t\t\tmatch = line.match(this.radiancePattern);\n\t\t\t}\n\t\t\telse if (line.match(this.formatPattern))\n\t\t\t{\n\t\t\t\tmatch = line.match(this.formatPattern);\n\t\t\t\trle = true;\n\t\t\t}\n\t\t\telse if (line.match(this.exposurePattern))\n\t\t\t{\n\t\t\t\tmatch = line.match(this.exposurePattern);\n\t\t\t\texposure = Number(match[1]);\n\t\t\t}\n\t\t\telse if (line.match(this.commentPattern))\n\t\t\t{\n\t\t\t\tmatch = line.match(this.commentPattern);\n\t\t\t}\n\t\t\telse if (line.match(this.widthHeightPattern))\n\t\t\t{\n\t\t\t\tmatch = line.match(this.widthHeightPattern);\n\t\t\t\theight = Number(match[1]);\n\t\t\t\twidth = Number(match[2]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!rle)\n\t\t{\n\t\t\tthrow new Error('File is not run length encoded!');\n\t\t}\n\n\t\tvar data = new Uint8Array(width * height * 4);\n\t\tvar scanlineWidth = width;\n\t\tvar numScanlines = height;\n\n\t\tthis.readPixelsRawRLE(buffer, data, 0, fileOffset, scanlineWidth, numScanlines);\n\n\t\t//TODO: Should be Float16\n\t\tvar floatData = new Float32Array(width * height * 4);\n\t\tfor (var offset = 0; offset < data.length; offset += 4)\n\t\t{\n\t\t\tvar r = data[offset + 0] / 255;\n\t\t\tvar g = data[offset + 1] / 255;\n\t\t\tvar b = data[offset + 2] / 255;\n\t\t\tvar e = data[offset + 3];\n\t\t\tvar f = Math.pow(2.0, e - 128.0);\n\n\t\t\tr *= f;\n\t\t\tg *= f;\n\t\t\tb *= f;\n\n\t\t\tvar floatOffset = offset;\n\n\t\t\tfloatData[floatOffset + 0] = r;\n\t\t\tfloatData[floatOffset + 1] = g;\n\t\t\tfloatData[floatOffset + 2] = b;\n\t\t\tfloatData[floatOffset + 3] = 1.0;\n\t\t}\n\n\t\treturn {\n\t\t\tshape: [width, height],\n\t\t\texposure: exposure,\n\t\t\tgamma: gamma,\n\t\t\tdata: floatData\n\t\t};\n\t}\n};\nexport default HDRParser;\n\n\n// WEBPACK FOOTER //\n// ./src/js/util/parsehdr.js","//\n//   ___        _     _                \n//  (  _`\\     ( ) _ ( )_              \n//  | (_(_)   _| |(_)| ,_)   _    _ __ \n//  |  _)_  /'_` || || |   /'_`\\ ( '__)\n//  | (_( )( (_| || || |_ ( (_) )| |   \n//  (____/'`\\__,_)(_)`\\__)`\\___/'(_)   \n//                                     \n//                                     \n\nimport ShaderBoy from './shaderboy';\n\nimport 'codemirror/keymap/sublime';\nimport 'codemirror/mode/clike/clike';\nimport './codemirror/mode/glsl/glsl';\nimport './codemirror/addon/selection/active-line';\nimport './codemirror/addon/edit/closebrackets';\nimport './codemirror/lib/util/formatting';\nimport './codemirror/addon/search/match-highlighter';\nimport './codemirror/addon/comment/comment';\nimport './codemirror/addon/hint/anyword-hint';\nimport './codemirror/addon/hint/show-hint';\nimport './codemirror/addon/hint/glsl-hint';\nimport './codemirror/addon/dialog/dialog';\nimport './codemirror/addon/search/searchcursor';\nimport './codemirror/addon/search/search';\nimport './codemirror/addon/scroll/annotatescrollbar';\nimport './codemirror/addon/search/matchesonscrollbar';\nimport './codemirror/addon/search/matchesonscrollbar';\nimport './codemirror/addon/search/jump-to-line';\nimport './codemirror/addon/selection/selection-pointer';\nimport './codemirror/addon/selection/mark-selection';\nimport './codemirror/addon/fold/foldcode';\nimport './codemirror/addon/fold/foldgutter';\nimport './codemirror/addon/fold/brace-fold';\nimport CodeMirror from 'codemirror/lib/codemirror';\n\nexport default ShaderBoy.editor = {\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    init: function () {\n        this.buffers = { \"main\": null, \"common\": null };\n        this.oldCursor = { line: 0, ch: 0 };\n\n        this.domElement = document.createElement('div');\n        this.domElement.setAttribute('id', 'code');\n        this.domElement.style.float = 'left';\n        this.domElement.style.position = 'absolute';\n        this.domElement.style.top = ShaderBoy.style.buttonHeight + 'px';\n        this.domElement.style.left = '0px';\n        this.domElement.style.width = window.innerWidth + 'px';\n        this.domElement.style.height = window.innerHeight - ShaderBoy.style.buttonHeight + 'px';\n        this.domElement.style.display = 'table';\n        this.domElement.style.border = '0px solid #FFF';\n        this.domElement.style.zIndex = '80';\n        this.domElement.style.textAlign = 'left';\n        this.domElement.style.backgroundColor = '#00000055';\n        ShaderBoy.glCanvasDom.appendChild(this.domElement);\n\n        this.textArea = document.createElement('div');\n        this.textArea.setAttribute('id', 'editor');\n        this.textArea.setAttribute('rows', '200');\n        this.textArea.setAttribute('cols', '50');\n        this.textArea.style.float = 'left';\n        this.textArea.style.position = 'absolute';\n        this.textArea.style.top = '0px';\n        this.textArea.style.left = '0px';\n        this.textArea.style.width = this.domElement.style.width;\n        this.textArea.style.height = this.domElement.style.height;\n        this.textArea.value = ShaderBoy.buffers['MainImage'].textData;\n        this.domElement.appendChild(this.textArea);\n\n        this.codemirror = CodeMirror.fromTextArea(this.textArea, {\n            lineNumbers: true,\n            smartIndent: true,\n            mode: 'x-shader/x-fragment',\n            // mode: 'glsl',\n            indentWithTabs: false,\n            keyMap: 'sublime',\n            autoCloseBrackets: true,\n            matchBrackets: true,\n            showCursorWhenSelecting: true,\n            theme: '3024-night',\n            foldGutter: true,\n            continuousScanning: 500,\n            styleActiveLine: true,\n            styleCursor: true,\n            indentUnit: 4,\n            showInvisibles: true,\n            maxInvisibles: 16,\n            selectionPointer: true,\n            styleSelectedText: true,\n            foldGutter: true,\n            gutters: [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"],\n            Tab: function (cm) { //tab as space\n                if (cm.somethingSelected()) {\n                    cm.indentSelection(\"add\");\n                } else {\n                    cm.replaceSelection(cm.getOption(\"indentWithTabs\") ? \"\\t\" :\n                        Array(cm.getOption(\"indentUnit\") + 1).join(\" \"), \"end\", \"+input\");\n                }\n            },\n            extraKeys: {\n                \"Ctrl-J\": 'fold',\n                \"Alt-J\": 'unfold',\n                \"Ctrl-K\": 'foldAll',\n                \"Alt-K\": 'unfoldAll',\n                'Alt-Right': function () {\n                    ShaderBoy.editor.selectBuffer('MainImage', false);\n                },\n                'Alt-Left': function () {\n                    ShaderBoy.editor.selectBuffer('Common', false);\n                },\n                'Alt-Up': function () {\n                    ShaderBoy.isPlaying = !ShaderBoy.isPlaying;\n                    ShaderBoy.time.pause();\n                },\n                'Alt-Down': function () {\n                    ShaderBoy.time.reset();\n                    ShaderBoy.uniforms.iFrame = 0;\n                },\n                'Ctrl-1': function () {\n                    ShaderBoy.isPlaying = false;\n                    ShaderBoy.renderScale = 1;\n                    ShaderBoy.renderer.createBuffer(false);\n                    ShaderBoy.isPlaying = true;\n                },\n                'Ctrl-2': function () {\n                    ShaderBoy.isPlaying = false;\n                    ShaderBoy.renderScale = 2;\n                    ShaderBoy.renderer.createBuffer(false);\n                    ShaderBoy.isPlaying = true;\n                },\n                'Ctrl-3': function () {\n                    ShaderBoy.isPlaying = false;\n                    ShaderBoy.renderScale = 3;\n                    ShaderBoy.renderer.createBuffer(false);\n                    ShaderBoy.isPlaying = true;\n                },\n                'Ctrl-4': function () {\n                    ShaderBoy.isPlaying = false;\n                    ShaderBoy.renderScale = 4;\n                    ShaderBoy.renderer.createBuffer(false);\n                    ShaderBoy.isPlaying = true;\n                },\n                'Alt-Space': function (cm) { ShaderBoy.io.recompile(); },\n                'Ctrl-S': function (cm) { ShaderBoy.io.saveShader(); },\n                'Ctrl-Alt-L': function () { ShaderBoy.io.loadShader(); },\n                'Ctrl-Alt-N': function () { ShaderBoy.io.newShader(); },\n                'Ctrl-F': 'findPersistent',\n                'Ctrl-Space': 'autocomplete',\n                'Ctrl-Alt-F': function (cm) {\n                    function getSelectedRange() {\n                        return {\n                            from: cm.getCursor(true),\n                            to: cm.getCursor(false),\n                        };\n                    }\n                    let range = getSelectedRange();\n                    cm.autoFormatRange(range.from, range.to);\n                },\n            },\n        });\n\n        this.codemirror.parent = this;\n        this.setSize(this.domElement.style.width, this.domElement.style.height);\n        this.save();\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    selectBuffer: function (name, isInit) {\n        this.codemirror.save();\n        var doc = this.codemirror.getDoc();\n        var cursor = doc.getCursor();\n        let curCursor = { line: this.oldCursor.line, ch: this.oldCursor.ch };\n        this.oldCursor = { line: cursor.line, ch: cursor.ch };\n\n        if (name === 'MainImage') {\n            ShaderBoy.buffers['MainImage'].active = true;\n            ShaderBoy.buffers['Common'].active = false;\n            if (!isInit) {\n                ShaderBoy.buffers['Common'].textData = this.codemirror.getValue();\n            }\n            this.codemirror.setValue(ShaderBoy.util.deepcopy(ShaderBoy.buffers['MainImage'].textData));\n        }\n        if (name === 'Common') {\n            ShaderBoy.buffers['MainImage'].active = false;\n            ShaderBoy.buffers['Common'].active = true;\n            if (!isInit) {\n                ShaderBoy.buffers['MainImage'].textData = this.codemirror.getValue();\n            }\n            this.codemirror.setValue(ShaderBoy.util.deepcopy(ShaderBoy.buffers['Common'].textData));\n        }\n        this.codemirror.setCursor({ line: curCursor.line, ch: curCursor.ch });\n        this.codemirror.refresh();\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    save: function () {\n        this.codemirror.save();\n    },\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    setSize: function (w, h) {\n        this.codemirror.setSize(w, h);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// A rough approximation of Sublime Text's keybindings\n// Depends on addon/search/searchcursor.js and optionally addon/dialog/dialogs.js\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../lib/codemirror\"), require(\"../addon/search/searchcursor\"), require(\"../addon/edit/matchbrackets\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../lib/codemirror\", \"../addon/search/searchcursor\", \"../addon/edit/matchbrackets\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var cmds = CodeMirror.commands;\n  var Pos = CodeMirror.Pos;\n\n  // This is not exactly Sublime's algorithm. I couldn't make heads or tails of that.\n  function findPosSubword(doc, start, dir) {\n    if (dir < 0 && start.ch == 0) return doc.clipPos(Pos(start.line - 1));\n    var line = doc.getLine(start.line);\n    if (dir > 0 && start.ch >= line.length) return doc.clipPos(Pos(start.line + 1, 0));\n    var state = \"start\", type;\n    for (var pos = start.ch, e = dir < 0 ? 0 : line.length, i = 0; pos != e; pos += dir, i++) {\n      var next = line.charAt(dir < 0 ? pos - 1 : pos);\n      var cat = next != \"_\" && CodeMirror.isWordChar(next) ? \"w\" : \"o\";\n      if (cat == \"w\" && next.toUpperCase() == next) cat = \"W\";\n      if (state == \"start\") {\n        if (cat != \"o\") { state = \"in\"; type = cat; }\n      } else if (state == \"in\") {\n        if (type != cat) {\n          if (type == \"w\" && cat == \"W\" && dir < 0) pos--;\n          if (type == \"W\" && cat == \"w\" && dir > 0) { type = \"w\"; continue; }\n          break;\n        }\n      }\n    }\n    return Pos(start.line, pos);\n  }\n\n  function moveSubword(cm, dir) {\n    cm.extendSelectionsBy(function(range) {\n      if (cm.display.shift || cm.doc.extend || range.empty())\n        return findPosSubword(cm.doc, range.head, dir);\n      else\n        return dir < 0 ? range.from() : range.to();\n    });\n  }\n\n  cmds.goSubwordLeft = function(cm) { moveSubword(cm, -1); };\n  cmds.goSubwordRight = function(cm) { moveSubword(cm, 1); };\n\n  cmds.scrollLineUp = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleBottomLine = cm.lineAtHeight(info.top + info.clientHeight, \"local\");\n      if (cm.getCursor().line >= visibleBottomLine)\n        cm.execCommand(\"goLineUp\");\n    }\n    cm.scrollTo(null, info.top - cm.defaultTextHeight());\n  };\n  cmds.scrollLineDown = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleTopLine = cm.lineAtHeight(info.top, \"local\")+1;\n      if (cm.getCursor().line <= visibleTopLine)\n        cm.execCommand(\"goLineDown\");\n    }\n    cm.scrollTo(null, info.top + cm.defaultTextHeight());\n  };\n\n  cmds.splitSelectionByLine = function(cm) {\n    var ranges = cm.listSelections(), lineRanges = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      for (var line = from.line; line <= to.line; ++line)\n        if (!(to.line > from.line && line == to.line && to.ch == 0))\n          lineRanges.push({anchor: line == from.line ? from : Pos(line, 0),\n                           head: line == to.line ? to : Pos(line)});\n    }\n    cm.setSelections(lineRanges, 0);\n  };\n\n  cmds.singleSelectionTop = function(cm) {\n    var range = cm.listSelections()[0];\n    cm.setSelection(range.anchor, range.head, {scroll: false});\n  };\n\n  cmds.selectLine = function(cm) {\n    var ranges = cm.listSelections(), extended = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      extended.push({anchor: Pos(range.from().line, 0),\n                     head: Pos(range.to().line + 1, 0)});\n    }\n    cm.setSelections(extended);\n  };\n\n  function insertLine(cm, above) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    cm.operation(function() {\n      var len = cm.listSelections().length, newSelection = [], last = -1;\n      for (var i = 0; i < len; i++) {\n        var head = cm.listSelections()[i].head;\n        if (head.line <= last) continue;\n        var at = Pos(head.line + (above ? 0 : 1), 0);\n        cm.replaceRange(\"\\n\", at, null, \"+insertLine\");\n        cm.indentLine(at.line, null, true);\n        newSelection.push({head: at, anchor: at});\n        last = head.line + 1;\n      }\n      cm.setSelections(newSelection);\n    });\n    cm.execCommand(\"indentAuto\");\n  }\n\n  cmds.insertLineAfter = function(cm) { return insertLine(cm, false); };\n\n  cmds.insertLineBefore = function(cm) { return insertLine(cm, true); };\n\n  function wordAt(cm, pos) {\n    var start = pos.ch, end = start, line = cm.getLine(pos.line);\n    while (start && CodeMirror.isWordChar(line.charAt(start - 1))) --start;\n    while (end < line.length && CodeMirror.isWordChar(line.charAt(end))) ++end;\n    return {from: Pos(pos.line, start), to: Pos(pos.line, end), word: line.slice(start, end)};\n  }\n\n  cmds.selectNextOccurrence = function(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    var fullWord = cm.state.sublimeFindFullWord == cm.doc.sel;\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      cm.setSelection(word.from, word.to);\n      fullWord = true;\n    } else {\n      var text = cm.getRange(from, to);\n      var query = fullWord ? new RegExp(\"\\\\b\" + text + \"\\\\b\") : text;\n      var cur = cm.getSearchCursor(query, to);\n      var found = cur.findNext();\n      if (!found) {\n        cur = cm.getSearchCursor(query, Pos(cm.firstLine(), 0));\n        found = cur.findNext();\n      }\n      if (!found || isSelectedRange(cm.listSelections(), cur.from(), cur.to()))\n        return CodeMirror.Pass\n      cm.addSelection(cur.from(), cur.to());\n    }\n    if (fullWord)\n      cm.state.sublimeFindFullWord = cm.doc.sel;\n  };\n\n  function addCursorToSelection(cm, dir) {\n    var ranges = cm.listSelections(), newRanges = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      var newAnchor = cm.findPosV(\n          range.anchor, dir, \"line\", range.anchor.goalColumn);\n      var newHead = cm.findPosV(\n          range.head, dir, \"line\", range.head.goalColumn);\n      newAnchor.goalColumn = range.anchor.goalColumn != null ?\n          range.anchor.goalColumn : cm.cursorCoords(range.anchor, \"div\").left;\n      newHead.goalColumn = range.head.goalColumn != null ?\n          range.head.goalColumn : cm.cursorCoords(range.head, \"div\").left;\n      var newRange = {anchor: newAnchor, head: newHead};\n      newRanges.push(range);\n      newRanges.push(newRange);\n    }\n    cm.setSelections(newRanges);\n  }\n  cmds.addCursorToPrevLine = function(cm) { addCursorToSelection(cm, -1); };\n  cmds.addCursorToNextLine = function(cm) { addCursorToSelection(cm, 1); };\n\n  function isSelectedRange(ranges, from, to) {\n    for (var i = 0; i < ranges.length; i++)\n      if (ranges[i].from() == from && ranges[i].to() == to) return true\n    return false\n  }\n\n  var mirror = \"(){}[]\";\n  function selectBetweenBrackets(cm) {\n    var ranges = cm.listSelections(), newRanges = []\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], pos = range.head, opening = cm.scanForBracket(pos, -1);\n      if (!opening) return false;\n      for (;;) {\n        var closing = cm.scanForBracket(pos, 1);\n        if (!closing) return false;\n        if (closing.ch == mirror.charAt(mirror.indexOf(opening.ch) + 1)) {\n          var startPos = Pos(opening.pos.line, opening.pos.ch + 1);\n          if (CodeMirror.cmpPos(startPos, range.from()) == 0 &&\n              CodeMirror.cmpPos(closing.pos, range.to()) == 0) {\n            opening = cm.scanForBracket(opening.pos, -1);\n            if (!opening) return false;\n          } else {\n            newRanges.push({anchor: startPos, head: closing.pos});\n            break;\n          }\n        }\n        pos = Pos(closing.pos.line, closing.pos.ch + 1);\n      }\n    }\n    cm.setSelections(newRanges);\n    return true;\n  }\n\n  cmds.selectScope = function(cm) {\n    selectBetweenBrackets(cm) || cm.execCommand(\"selectAll\");\n  };\n  cmds.selectBetweenBrackets = function(cm) {\n    if (!selectBetweenBrackets(cm)) return CodeMirror.Pass;\n  };\n\n  cmds.goToBracket = function(cm) {\n    cm.extendSelectionsBy(function(range) {\n      var next = cm.scanForBracket(range.head, 1);\n      if (next && CodeMirror.cmpPos(next.pos, range.head) != 0) return next.pos;\n      var prev = cm.scanForBracket(range.head, -1);\n      return prev && Pos(prev.pos.line, prev.pos.ch + 1) || range.head;\n    });\n  };\n\n  cmds.swapLineUp = function(cm) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.firstLine() - 1, newSels = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from().line - 1, to = range.to().line;\n      newSels.push({anchor: Pos(range.anchor.line - 1, range.anchor.ch),\n                    head: Pos(range.head.line - 1, range.head.ch)});\n      if (range.to().ch == 0 && !range.empty()) --to;\n      if (from > at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = 0; i < linesToMove.length; i += 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        if (to > cm.lastLine())\n          cm.replaceRange(\"\\n\" + line, Pos(cm.lastLine()), null, \"+swapLine\");\n        else\n          cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.setSelections(newSels);\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.swapLineDown = function(cm) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.lastLine() + 1;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var range = ranges[i], from = range.to().line + 1, to = range.from().line;\n      if (range.to().ch == 0 && !range.empty()) from--;\n      if (from < at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = linesToMove.length - 2; i >= 0; i -= 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        if (from == cm.lastLine())\n          cm.replaceRange(\"\", Pos(from - 1), Pos(from), \"+swapLine\");\n        else\n          cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.toggleCommentIndented = function(cm) {\n    cm.toggleComment({ indent: true });\n  }\n\n  cmds.joinLines = function(cm) {\n    var ranges = cm.listSelections(), joined = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from();\n      var start = from.line, end = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == end)\n        end = ranges[++i].to().line;\n      joined.push({start: start, end: end, anchor: !range.empty() && from});\n    }\n    cm.operation(function() {\n      var offset = 0, ranges = [];\n      for (var i = 0; i < joined.length; i++) {\n        var obj = joined[i];\n        var anchor = obj.anchor && Pos(obj.anchor.line - offset, obj.anchor.ch), head;\n        for (var line = obj.start; line <= obj.end; line++) {\n          var actual = line - offset;\n          if (line == obj.end) head = Pos(actual, cm.getLine(actual).length + 1);\n          if (actual < cm.lastLine()) {\n            cm.replaceRange(\" \", Pos(actual), Pos(actual + 1, /^\\s*/.exec(cm.getLine(actual + 1))[0].length));\n            ++offset;\n          }\n        }\n        ranges.push({anchor: anchor || head, head: head});\n      }\n      cm.setSelections(ranges, 0);\n    });\n  };\n\n  cmds.duplicateLine = function(cm) {\n    cm.operation(function() {\n      var rangeCount = cm.listSelections().length;\n      for (var i = 0; i < rangeCount; i++) {\n        var range = cm.listSelections()[i];\n        if (range.empty())\n          cm.replaceRange(cm.getLine(range.head.line) + \"\\n\", Pos(range.head.line, 0));\n        else\n          cm.replaceRange(cm.getRange(range.from(), range.to()), range.from());\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n\n  function sortLines(cm, caseSensitive) {\n    if (cm.isReadOnly()) return CodeMirror.Pass\n    var ranges = cm.listSelections(), toSort = [], selected;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      if (range.empty()) continue;\n      var from = range.from().line, to = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == to)\n        to = ranges[++i].to().line;\n      if (!ranges[i].to().ch) to--;\n      toSort.push(from, to);\n    }\n    if (toSort.length) selected = true;\n    else toSort.push(cm.firstLine(), cm.lastLine());\n\n    cm.operation(function() {\n      var ranges = [];\n      for (var i = 0; i < toSort.length; i += 2) {\n        var from = toSort[i], to = toSort[i + 1];\n        var start = Pos(from, 0), end = Pos(to);\n        var lines = cm.getRange(start, end, false);\n        if (caseSensitive)\n          lines.sort();\n        else\n          lines.sort(function(a, b) {\n            var au = a.toUpperCase(), bu = b.toUpperCase();\n            if (au != bu) { a = au; b = bu; }\n            return a < b ? -1 : a == b ? 0 : 1;\n          });\n        cm.replaceRange(lines, start, end);\n        if (selected) ranges.push({anchor: start, head: Pos(to + 1, 0)});\n      }\n      if (selected) cm.setSelections(ranges, 0);\n    });\n  }\n\n  cmds.sortLines = function(cm) { sortLines(cm, true); };\n  cmds.sortLinesInsensitive = function(cm) { sortLines(cm, false); };\n\n  cmds.nextBookmark = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      var current = marks.shift();\n      var found = current.find();\n      if (found) {\n        marks.push(current);\n        return cm.setSelection(found.from, found.to);\n      }\n    }\n  };\n\n  cmds.prevBookmark = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      marks.unshift(marks.pop());\n      var found = marks[marks.length - 1].find();\n      if (!found)\n        marks.pop();\n      else\n        return cm.setSelection(found.from, found.to);\n    }\n  };\n\n  cmds.toggleBookmark = function(cm) {\n    var ranges = cm.listSelections();\n    var marks = cm.state.sublimeBookmarks || (cm.state.sublimeBookmarks = []);\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      var found = ranges[i].empty() ? cm.findMarksAt(from) : cm.findMarks(from, to);\n      for (var j = 0; j < found.length; j++) {\n        if (found[j].sublimeBookmark) {\n          found[j].clear();\n          for (var k = 0; k < marks.length; k++)\n            if (marks[k] == found[j])\n              marks.splice(k--, 1);\n          break;\n        }\n      }\n      if (j == found.length)\n        marks.push(cm.markText(from, to, {sublimeBookmark: true, clearWhenEmpty: false}));\n    }\n  };\n\n  cmds.clearBookmarks = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) for (var i = 0; i < marks.length; i++) marks[i].clear();\n    marks.length = 0;\n  };\n\n  cmds.selectBookmarks = function(cm) {\n    var marks = cm.state.sublimeBookmarks, ranges = [];\n    if (marks) for (var i = 0; i < marks.length; i++) {\n      var found = marks[i].find();\n      if (!found)\n        marks.splice(i--, 0);\n      else\n        ranges.push({anchor: found.from, head: found.to});\n    }\n    if (ranges.length)\n      cm.setSelections(ranges, 0);\n  };\n\n  function modifyWordOrSelection(cm, mod) {\n    cm.operation(function() {\n      var ranges = cm.listSelections(), indices = [], replacements = [];\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (range.empty()) { indices.push(i); replacements.push(\"\"); }\n        else replacements.push(mod(cm.getRange(range.from(), range.to())));\n      }\n      cm.replaceSelections(replacements, \"around\", \"case\");\n      for (var i = indices.length - 1, at; i >= 0; i--) {\n        var range = ranges[indices[i]];\n        if (at && CodeMirror.cmpPos(range.head, at) > 0) continue;\n        var word = wordAt(cm, range.head);\n        at = word.from;\n        cm.replaceRange(mod(word.word), word.from, word.to);\n      }\n    });\n  }\n\n  cmds.smartBackspace = function(cm) {\n    if (cm.somethingSelected()) return CodeMirror.Pass;\n\n    cm.operation(function() {\n      var cursors = cm.listSelections();\n      var indentUnit = cm.getOption(\"indentUnit\");\n\n      for (var i = cursors.length - 1; i >= 0; i--) {\n        var cursor = cursors[i].head;\n        var toStartOfLine = cm.getRange({line: cursor.line, ch: 0}, cursor);\n        var column = CodeMirror.countColumn(toStartOfLine, null, cm.getOption(\"tabSize\"));\n\n        // Delete by one character by default\n        var deletePos = cm.findPosH(cursor, -1, \"char\", false);\n\n        if (toStartOfLine && !/\\S/.test(toStartOfLine) && column % indentUnit == 0) {\n          var prevIndent = new Pos(cursor.line,\n            CodeMirror.findColumn(toStartOfLine, column - indentUnit, indentUnit));\n\n          // Smart delete only if we found a valid prevIndent location\n          if (prevIndent.ch != cursor.ch) deletePos = prevIndent;\n        }\n\n        cm.replaceRange(\"\", deletePos, cursor, \"+delete\");\n      }\n    });\n  };\n\n  cmds.delLineRight = function(cm) {\n    cm.operation(function() {\n      var ranges = cm.listSelections();\n      for (var i = ranges.length - 1; i >= 0; i--)\n        cm.replaceRange(\"\", ranges[i].anchor, Pos(ranges[i].to().line), \"+delete\");\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds.upcaseAtCursor = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toUpperCase(); });\n  };\n  cmds.downcaseAtCursor = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toLowerCase(); });\n  };\n\n  cmds.setSublimeMark = function(cm) {\n    if (cm.state.sublimeMark) cm.state.sublimeMark.clear();\n    cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n  };\n  cmds.selectToSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) cm.setSelection(cm.getCursor(), found);\n  };\n  cmds.deleteToSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      var from = cm.getCursor(), to = found;\n      if (CodeMirror.cmpPos(from, to) > 0) { var tmp = to; to = from; from = tmp; }\n      cm.state.sublimeKilled = cm.getRange(from, to);\n      cm.replaceRange(\"\", from, to);\n    }\n  };\n  cmds.swapWithSublimeMark = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      cm.state.sublimeMark.clear();\n      cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n      cm.setCursor(found);\n    }\n  };\n  cmds.sublimeYank = function(cm) {\n    if (cm.state.sublimeKilled != null)\n      cm.replaceSelection(cm.state.sublimeKilled, null, \"paste\");\n  };\n\n  cmds.showInCenter = function(cm) {\n    var pos = cm.cursorCoords(null, \"local\");\n    cm.scrollTo(null, (pos.top + pos.bottom) / 2 - cm.getScrollInfo().clientHeight / 2);\n  };\n\n  function getTarget(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      from = word.from;\n      to = word.to;\n    }\n    return {from: from, to: to, query: cm.getRange(from, to), word: word};\n  }\n\n  function findAndGoTo(cm, forward) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var query = target.query;\n    var cur = cm.getSearchCursor(query, forward ? target.to : target.from);\n\n    if (forward ? cur.findNext() : cur.findPrevious()) {\n      cm.setSelection(cur.from(), cur.to());\n    } else {\n      cur = cm.getSearchCursor(query, forward ? Pos(cm.firstLine(), 0)\n                                              : cm.clipPos(Pos(cm.lastLine())));\n      if (forward ? cur.findNext() : cur.findPrevious())\n        cm.setSelection(cur.from(), cur.to());\n      else if (target.word)\n        cm.setSelection(target.from, target.to);\n    }\n  };\n  cmds.findUnder = function(cm) { findAndGoTo(cm, true); };\n  cmds.findUnderPrevious = function(cm) { findAndGoTo(cm,false); };\n  cmds.findAllUnder = function(cm) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var cur = cm.getSearchCursor(target.query);\n    var matches = [];\n    var primaryIndex = -1;\n    while (cur.findNext()) {\n      matches.push({anchor: cur.from(), head: cur.to()});\n      if (cur.from().line <= target.from.line && cur.from().ch <= target.from.ch)\n        primaryIndex++;\n    }\n    cm.setSelections(matches, primaryIndex);\n  };\n\n\n  var keyMap = CodeMirror.keyMap;\n  keyMap.macSublime = {\n    \"Cmd-Left\": \"goLineStartSmart\",\n    \"Shift-Tab\": \"indentLess\",\n    \"Shift-Ctrl-K\": \"deleteLine\",\n    \"Alt-Q\": \"wrapLines\",\n    \"Ctrl-Left\": \"goSubwordLeft\",\n    \"Ctrl-Right\": \"goSubwordRight\",\n    \"Ctrl-Alt-Up\": \"scrollLineUp\",\n    \"Ctrl-Alt-Down\": \"scrollLineDown\",\n    \"Cmd-L\": \"selectLine\",\n    \"Shift-Cmd-L\": \"splitSelectionByLine\",\n    \"Esc\": \"singleSelectionTop\",\n    \"Cmd-Enter\": \"insertLineAfter\",\n    \"Shift-Cmd-Enter\": \"insertLineBefore\",\n    \"Cmd-D\": \"selectNextOccurrence\",\n    \"Shift-Cmd-Space\": \"selectScope\",\n    \"Shift-Cmd-M\": \"selectBetweenBrackets\",\n    \"Cmd-M\": \"goToBracket\",\n    \"Cmd-Ctrl-Up\": \"swapLineUp\",\n    \"Cmd-Ctrl-Down\": \"swapLineDown\",\n    \"Cmd-/\": \"toggleCommentIndented\",\n    \"Cmd-J\": \"joinLines\",\n    \"Shift-Cmd-D\": \"duplicateLine\",\n    \"F9\": \"sortLines\",\n    \"Cmd-F9\": \"sortLinesInsensitive\",\n    \"F2\": \"nextBookmark\",\n    \"Shift-F2\": \"prevBookmark\",\n    \"Cmd-F2\": \"toggleBookmark\",\n    \"Shift-Cmd-F2\": \"clearBookmarks\",\n    \"Alt-F2\": \"selectBookmarks\",\n    \"Backspace\": \"smartBackspace\",\n    \"Cmd-K Cmd-K\": \"delLineRight\",\n    \"Cmd-K Cmd-U\": \"upcaseAtCursor\",\n    \"Cmd-K Cmd-L\": \"downcaseAtCursor\",\n    \"Cmd-K Cmd-Space\": \"setSublimeMark\",\n    \"Cmd-K Cmd-A\": \"selectToSublimeMark\",\n    \"Cmd-K Cmd-W\": \"deleteToSublimeMark\",\n    \"Cmd-K Cmd-X\": \"swapWithSublimeMark\",\n    \"Cmd-K Cmd-Y\": \"sublimeYank\",\n    \"Cmd-K Cmd-C\": \"showInCenter\",\n    \"Cmd-K Cmd-G\": \"clearBookmarks\",\n    \"Cmd-K Cmd-Backspace\": \"delLineLeft\",\n    \"Cmd-K Cmd-0\": \"unfoldAll\",\n    \"Cmd-K Cmd-J\": \"unfoldAll\",\n    \"Ctrl-Shift-Up\": \"addCursorToPrevLine\",\n    \"Ctrl-Shift-Down\": \"addCursorToNextLine\",\n    \"Cmd-F3\": \"findUnder\",\n    \"Shift-Cmd-F3\": \"findUnderPrevious\",\n    \"Alt-F3\": \"findAllUnder\",\n    \"Shift-Cmd-[\": \"fold\",\n    \"Shift-Cmd-]\": \"unfold\",\n    \"Cmd-I\": \"findIncremental\",\n    \"Shift-Cmd-I\": \"findIncrementalReverse\",\n    \"Cmd-H\": \"replace\",\n    \"F3\": \"findNext\",\n    \"Shift-F3\": \"findPrev\",\n    \"fallthrough\": \"macDefault\"\n  };\n  CodeMirror.normalizeKeyMap(keyMap.macSublime);\n\n  keyMap.pcSublime = {\n    \"Shift-Tab\": \"indentLess\",\n    \"Shift-Ctrl-K\": \"deleteLine\",\n    \"Alt-Q\": \"wrapLines\",\n    \"Ctrl-T\": \"transposeChars\",\n    \"Alt-Left\": \"goSubwordLeft\",\n    \"Alt-Right\": \"goSubwordRight\",\n    \"Ctrl-Up\": \"scrollLineUp\",\n    \"Ctrl-Down\": \"scrollLineDown\",\n    \"Ctrl-L\": \"selectLine\",\n    \"Shift-Ctrl-L\": \"splitSelectionByLine\",\n    \"Esc\": \"singleSelectionTop\",\n    \"Ctrl-Enter\": \"insertLineAfter\",\n    \"Shift-Ctrl-Enter\": \"insertLineBefore\",\n    \"Ctrl-D\": \"selectNextOccurrence\",\n    \"Shift-Ctrl-Space\": \"selectScope\",\n    \"Shift-Ctrl-M\": \"selectBetweenBrackets\",\n    \"Ctrl-M\": \"goToBracket\",\n    \"Shift-Ctrl-Up\": \"swapLineUp\",\n    \"Shift-Ctrl-Down\": \"swapLineDown\",\n    \"Ctrl-/\": \"toggleCommentIndented\",\n    \"Ctrl-J\": \"joinLines\",\n    \"Shift-Ctrl-D\": \"duplicateLine\",\n    \"F9\": \"sortLines\",\n    \"Ctrl-F9\": \"sortLinesInsensitive\",\n    \"F2\": \"nextBookmark\",\n    \"Shift-F2\": \"prevBookmark\",\n    \"Ctrl-F2\": \"toggleBookmark\",\n    \"Shift-Ctrl-F2\": \"clearBookmarks\",\n    \"Alt-F2\": \"selectBookmarks\",\n    \"Backspace\": \"smartBackspace\",\n    \"Ctrl-K Ctrl-K\": \"delLineRight\",\n    \"Ctrl-K Ctrl-U\": \"upcaseAtCursor\",\n    \"Ctrl-K Ctrl-L\": \"downcaseAtCursor\",\n    \"Ctrl-K Ctrl-Space\": \"setSublimeMark\",\n    \"Ctrl-K Ctrl-A\": \"selectToSublimeMark\",\n    \"Ctrl-K Ctrl-W\": \"deleteToSublimeMark\",\n    \"Ctrl-K Ctrl-X\": \"swapWithSublimeMark\",\n    \"Ctrl-K Ctrl-Y\": \"sublimeYank\",\n    \"Ctrl-K Ctrl-C\": \"showInCenter\",\n    \"Ctrl-K Ctrl-G\": \"clearBookmarks\",\n    \"Ctrl-K Ctrl-Backspace\": \"delLineLeft\",\n    \"Ctrl-K Ctrl-0\": \"unfoldAll\",\n    \"Ctrl-K Ctrl-J\": \"unfoldAll\",\n    \"Ctrl-Alt-Up\": \"addCursorToPrevLine\",\n    \"Ctrl-Alt-Down\": \"addCursorToNextLine\",\n    \"Ctrl-F3\": \"findUnder\",\n    \"Shift-Ctrl-F3\": \"findUnderPrevious\",\n    \"Alt-F3\": \"findAllUnder\",\n    \"Shift-Ctrl-[\": \"fold\",\n    \"Shift-Ctrl-]\": \"unfold\",\n    \"Ctrl-I\": \"findIncremental\",\n    \"Shift-Ctrl-I\": \"findIncrementalReverse\",\n    \"Ctrl-H\": \"replace\",\n    \"F3\": \"findNext\",\n    \"Shift-F3\": \"findPrev\",\n    \"fallthrough\": \"pcDefault\"\n  };\n  CodeMirror.normalizeKeyMap(keyMap.pcSublime);\n\n  var mac = keyMap.default == keyMap.macDefault;\n  keyMap.sublime = mac ? keyMap.macSublime : keyMap.pcSublime;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/codemirror/keymap/sublime.js\n// module id = 14\n// module chunks = 0","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n// Kludges for bugs and behavior differences that can't be feature\n// detected are enabled based on userAgent etc sniffing.\nvar userAgent = navigator.userAgent;\nvar platform = navigator.platform;\n\nvar gecko = /gecko\\/\\d/i.test(userAgent);\nvar ie_upto10 = /MSIE \\d/.test(userAgent);\nvar ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\nvar edge = /Edge\\/(\\d+)/.exec(userAgent);\nvar ie = ie_upto10 || ie_11up || edge;\nvar ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\nvar webkit = !edge && /WebKit\\//.test(userAgent);\nvar qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\nvar chrome = !edge && /Chrome\\//.test(userAgent);\nvar presto = /Opera\\//.test(userAgent);\nvar safari = /Apple Computer/.test(navigator.vendor);\nvar mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\nvar phantom = /PhantomJS/.test(userAgent);\n\nvar ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\nvar android = /Android/.test(userAgent);\n// This is woefully incomplete. Suggestions for alternative methods welcome.\nvar mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\nvar mac = ios || /Mac/.test(platform);\nvar chromeOS = /\\bCrOS\\b/.test(userAgent);\nvar windows = /win/i.test(platform);\n\nvar presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\nif (presto_version) { presto_version = Number(presto_version[1]); }\nif (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n// Some browsers use the wrong event properties to signal cmd/ctrl on OS X\nvar flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\nvar captureRightClick = gecko || (ie && ie_version >= 9);\n\nfunction classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\nvar rmClass = function(node, cls) {\n  var current = node.className;\n  var match = classTest(cls).exec(current);\n  if (match) {\n    var after = current.slice(match.index + match[0].length);\n    node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n  }\n};\n\nfunction removeChildren(e) {\n  for (var count = e.childNodes.length; count > 0; --count)\n    { e.removeChild(e.firstChild); }\n  return e\n}\n\nfunction removeChildrenAndAdd(parent, e) {\n  return removeChildren(parent).appendChild(e)\n}\n\nfunction elt(tag, content, className, style) {\n  var e = document.createElement(tag);\n  if (className) { e.className = className; }\n  if (style) { e.style.cssText = style; }\n  if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n  else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n  return e\n}\n// wrapper for elt, which removes the elt from the accessibility tree\nfunction eltP(tag, content, className, style) {\n  var e = elt(tag, content, className, style);\n  e.setAttribute(\"role\", \"presentation\");\n  return e\n}\n\nvar range;\nif (document.createRange) { range = function(node, start, end, endNode) {\n  var r = document.createRange();\n  r.setEnd(endNode || node, end);\n  r.setStart(node, start);\n  return r\n}; }\nelse { range = function(node, start, end) {\n  var r = document.body.createTextRange();\n  try { r.moveToElementText(node.parentNode); }\n  catch(e) { return r }\n  r.collapse(true);\n  r.moveEnd(\"character\", end);\n  r.moveStart(\"character\", start);\n  return r\n}; }\n\nfunction contains(parent, child) {\n  if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n    { child = child.parentNode; }\n  if (parent.contains)\n    { return parent.contains(child) }\n  do {\n    if (child.nodeType == 11) { child = child.host; }\n    if (child == parent) { return true }\n  } while (child = child.parentNode)\n}\n\nfunction activeElt() {\n  // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n  // IE < 10 will throw when accessed while the page is loading or in an iframe.\n  // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n  var activeElement;\n  try {\n    activeElement = document.activeElement;\n  } catch(e) {\n    activeElement = document.body || null;\n  }\n  while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n    { activeElement = activeElement.shadowRoot.activeElement; }\n  return activeElement\n}\n\nfunction addClass(node, cls) {\n  var current = node.className;\n  if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n}\nfunction joinClasses(a, b) {\n  var as = a.split(\" \");\n  for (var i = 0; i < as.length; i++)\n    { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n  return b\n}\n\nvar selectInput = function(node) { node.select(); };\nif (ios) // Mobile Safari apparently has a bug where select() is broken.\n  { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\nelse if (ie) // Suppress mysterious IE10 errors\n  { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\nfunction bind(f) {\n  var args = Array.prototype.slice.call(arguments, 1);\n  return function(){return f.apply(null, args)}\n}\n\nfunction copyObj(obj, target, overwrite) {\n  if (!target) { target = {}; }\n  for (var prop in obj)\n    { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n      { target[prop] = obj[prop]; } }\n  return target\n}\n\n// Counts the column offset in a string, taking tabs into account.\n// Used mostly to find indentation.\nfunction countColumn(string, end, tabSize, startIndex, startValue) {\n  if (end == null) {\n    end = string.search(/[^\\s\\u00a0]/);\n    if (end == -1) { end = string.length; }\n  }\n  for (var i = startIndex || 0, n = startValue || 0;;) {\n    var nextTab = string.indexOf(\"\\t\", i);\n    if (nextTab < 0 || nextTab >= end)\n      { return n + (end - i) }\n    n += nextTab - i;\n    n += tabSize - (n % tabSize);\n    i = nextTab + 1;\n  }\n}\n\nvar Delayed = function() {this.id = null;};\nDelayed.prototype.set = function (ms, f) {\n  clearTimeout(this.id);\n  this.id = setTimeout(f, ms);\n};\n\nfunction indexOf(array, elt) {\n  for (var i = 0; i < array.length; ++i)\n    { if (array[i] == elt) { return i } }\n  return -1\n}\n\n// Number of pixels added to scroller and sizer to hide scrollbar\nvar scrollerGap = 30;\n\n// Returned or thrown by various protocols to signal 'I'm not\n// handling this'.\nvar Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n// Reused option objects for setSelection & friends\nvar sel_dontScroll = {scroll: false};\nvar sel_mouse = {origin: \"*mouse\"};\nvar sel_move = {origin: \"+move\"};\n\n// The inverse of countColumn -- find the offset that corresponds to\n// a particular column.\nfunction findColumn(string, goal, tabSize) {\n  for (var pos = 0, col = 0;;) {\n    var nextTab = string.indexOf(\"\\t\", pos);\n    if (nextTab == -1) { nextTab = string.length; }\n    var skipped = nextTab - pos;\n    if (nextTab == string.length || col + skipped >= goal)\n      { return pos + Math.min(skipped, goal - col) }\n    col += nextTab - pos;\n    col += tabSize - (col % tabSize);\n    pos = nextTab + 1;\n    if (col >= goal) { return pos }\n  }\n}\n\nvar spaceStrs = [\"\"];\nfunction spaceStr(n) {\n  while (spaceStrs.length <= n)\n    { spaceStrs.push(lst(spaceStrs) + \" \"); }\n  return spaceStrs[n]\n}\n\nfunction lst(arr) { return arr[arr.length-1] }\n\nfunction map(array, f) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n  return out\n}\n\nfunction insertSorted(array, value, score) {\n  var pos = 0, priority = score(value);\n  while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n  array.splice(pos, 0, value);\n}\n\nfunction nothing() {}\n\nfunction createObj(base, props) {\n  var inst;\n  if (Object.create) {\n    inst = Object.create(base);\n  } else {\n    nothing.prototype = base;\n    inst = new nothing();\n  }\n  if (props) { copyObj(props, inst); }\n  return inst\n}\n\nvar nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\nfunction isWordCharBasic(ch) {\n  return /\\w/.test(ch) || ch > \"\\x80\" &&\n    (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n}\nfunction isWordChar(ch, helper) {\n  if (!helper) { return isWordCharBasic(ch) }\n  if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n  return helper.test(ch)\n}\n\nfunction isEmpty(obj) {\n  for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n  return true\n}\n\n// Extending unicode characters. A series of a non-extending char +\n// any number of extending chars is treated as a single unit as far\n// as editing and measuring is concerned. This is not fully correct,\n// since some scripts/fonts/browsers also treat other configurations\n// of code points as a group.\nvar extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\nfunction isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n// Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\nfunction skipExtendingChars(str, pos, dir) {\n  while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n  return pos\n}\n\n// Returns the value from the range [`from`; `to`] that satisfies\n// `pred` and is closest to `from`. Assumes that at least `to`\n// satisfies `pred`. Supports `from` being greater than `to`.\nfunction findFirst(pred, from, to) {\n  // At any point we are certain `to` satisfies `pred`, don't know\n  // whether `from` does.\n  var dir = from > to ? -1 : 1;\n  for (;;) {\n    if (from == to) { return from }\n    var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n    if (mid == from) { return pred(mid) ? from : to }\n    if (pred(mid)) { to = mid; }\n    else { from = mid + dir; }\n  }\n}\n\n// The display handles the DOM integration, both for input reading\n// and content drawing. It holds references to DOM nodes and\n// display-related state.\n\nfunction Display(place, doc, input) {\n  var d = this;\n  this.input = input;\n\n  // Covers bottom-right square when both scrollbars are present.\n  d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n  d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Covers bottom of gutter when coverGutterNextToScrollbar is on\n  // and h scrollbar is present.\n  d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n  d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Will contain the actual code, positioned to cover the viewport.\n  d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n  // Elements are added to these to represent selection and cursors.\n  d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n  d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n  // A visibility: hidden element used to find the size of things.\n  d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n  // When lines outside of the viewport are measured, they are drawn in this.\n  d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n  // Wraps everything that needs to exist inside the vertically-padded coordinate system\n  d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                    null, \"position: relative; outline: none\");\n  var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n  // Moved around its parent to cover visible view.\n  d.mover = elt(\"div\", [lines], null, \"position: relative\");\n  // Set to the height of the document, allowing scrolling.\n  d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n  d.sizerWidth = null;\n  // Behavior of elts with overflow: auto and padding is\n  // inconsistent across browsers. This is used to ensure the\n  // scrollable area is big enough.\n  d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n  // Will contain the gutters, if any.\n  d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n  d.lineGutter = null;\n  // Actual scrollable element.\n  d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n  d.scroller.setAttribute(\"tabIndex\", \"-1\");\n  // The element in which the editor lives.\n  d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n  // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n  if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n  if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n  if (place) {\n    if (place.appendChild) { place.appendChild(d.wrapper); }\n    else { place(d.wrapper); }\n  }\n\n  // Current rendered range (may be bigger than the view window).\n  d.viewFrom = d.viewTo = doc.first;\n  d.reportedViewFrom = d.reportedViewTo = doc.first;\n  // Information about the rendered lines.\n  d.view = [];\n  d.renderedView = null;\n  // Holds info about a single rendered line when it was rendered\n  // for measurement, while not in view.\n  d.externalMeasured = null;\n  // Empty space (in pixels) above the view\n  d.viewOffset = 0;\n  d.lastWrapHeight = d.lastWrapWidth = 0;\n  d.updateLineNumbers = null;\n\n  d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n  d.scrollbarsClipped = false;\n\n  // Used to only resize the line number gutter when necessary (when\n  // the amount of lines crosses a boundary that makes its width change)\n  d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n  // Set to true when a non-horizontal-scrolling line widget is\n  // added. As an optimization, line widget aligning is skipped when\n  // this is false.\n  d.alignWidgets = false;\n\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n  // Tracks the maximum line length so that the horizontal scrollbar\n  // can be kept static when scrolling.\n  d.maxLine = null;\n  d.maxLineLength = 0;\n  d.maxLineChanged = false;\n\n  // Used for measuring wheel scrolling granularity\n  d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n  // True when shift is held down.\n  d.shift = false;\n\n  // Used to track whether anything happened since the context menu\n  // was opened.\n  d.selForContextMenu = null;\n\n  d.activeTouch = null;\n\n  input.init(d);\n}\n\n// Find the line object corresponding to the given line number.\nfunction getLine(doc, n) {\n  n -= doc.first;\n  if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n  var chunk = doc;\n  while (!chunk.lines) {\n    for (var i = 0;; ++i) {\n      var child = chunk.children[i], sz = child.chunkSize();\n      if (n < sz) { chunk = child; break }\n      n -= sz;\n    }\n  }\n  return chunk.lines[n]\n}\n\n// Get the part of a document between two positions, as an array of\n// strings.\nfunction getBetween(doc, start, end) {\n  var out = [], n = start.line;\n  doc.iter(start.line, end.line + 1, function (line) {\n    var text = line.text;\n    if (n == end.line) { text = text.slice(0, end.ch); }\n    if (n == start.line) { text = text.slice(start.ch); }\n    out.push(text);\n    ++n;\n  });\n  return out\n}\n// Get the lines between from and to, as array of strings.\nfunction getLines(doc, from, to) {\n  var out = [];\n  doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n  return out\n}\n\n// Update the height of a line, propagating the height change\n// upwards to parent nodes.\nfunction updateLineHeight(line, height) {\n  var diff = height - line.height;\n  if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n}\n\n// Given a line object, find its line number by walking up through\n// its parent links.\nfunction lineNo(line) {\n  if (line.parent == null) { return null }\n  var cur = line.parent, no = indexOf(cur.lines, line);\n  for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n    for (var i = 0;; ++i) {\n      if (chunk.children[i] == cur) { break }\n      no += chunk.children[i].chunkSize();\n    }\n  }\n  return no + cur.first\n}\n\n// Find the line at the given vertical position, using the height\n// information in the document tree.\nfunction lineAtHeight(chunk, h) {\n  var n = chunk.first;\n  outer: do {\n    for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n      var child = chunk.children[i$1], ch = child.height;\n      if (h < ch) { chunk = child; continue outer }\n      h -= ch;\n      n += child.chunkSize();\n    }\n    return n\n  } while (!chunk.lines)\n  var i = 0;\n  for (; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i], lh = line.height;\n    if (h < lh) { break }\n    h -= lh;\n  }\n  return n + i\n}\n\nfunction isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\nfunction lineNumberFor(options, i) {\n  return String(options.lineNumberFormatter(i + options.firstLineNumber))\n}\n\n// A Pos instance represents a position within the text.\nfunction Pos(line, ch, sticky) {\n  if ( sticky === void 0 ) sticky = null;\n\n  if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n  this.line = line;\n  this.ch = ch;\n  this.sticky = sticky;\n}\n\n// Compare two positions, return 0 if they are the same, a negative\n// number when a is less, and a positive number otherwise.\nfunction cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\nfunction equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\nfunction copyPos(x) {return Pos(x.line, x.ch)}\nfunction maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\nfunction minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n// Most of the external API clips given positions to make sure they\n// actually exist within the document.\nfunction clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\nfunction clipPos(doc, pos) {\n  if (pos.line < doc.first) { return Pos(doc.first, 0) }\n  var last = doc.first + doc.size - 1;\n  if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n  return clipToLen(pos, getLine(doc, pos.line).text.length)\n}\nfunction clipToLen(pos, linelen) {\n  var ch = pos.ch;\n  if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n  else if (ch < 0) { return Pos(pos.line, 0) }\n  else { return pos }\n}\nfunction clipPosArray(doc, array) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n  return out\n}\n\n// Optimize some code when these features are not used.\nvar sawReadOnlySpans = false;\nvar sawCollapsedSpans = false;\n\nfunction seeReadOnlySpans() {\n  sawReadOnlySpans = true;\n}\n\nfunction seeCollapsedSpans() {\n  sawCollapsedSpans = true;\n}\n\n// TEXTMARKER SPANS\n\nfunction MarkedSpan(marker, from, to) {\n  this.marker = marker;\n  this.from = from; this.to = to;\n}\n\n// Search an array of spans for a span matching the given marker.\nfunction getMarkedSpanFor(spans, marker) {\n  if (spans) { for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.marker == marker) { return span }\n  } }\n}\n// Remove a span from an array, returning undefined if no spans are\n// left (we don't store arrays for lines without spans).\nfunction removeMarkedSpan(spans, span) {\n  var r;\n  for (var i = 0; i < spans.length; ++i)\n    { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n  return r\n}\n// Add a span to a line.\nfunction addMarkedSpan(line, span) {\n  line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n  span.marker.attachLine(line);\n}\n\n// Used for the algorithm that adjusts markers for a change in the\n// document. These functions cut an array of spans at a given\n// character position, returning an array of remaining chunks (or\n// undefined if nothing remains).\nfunction markedSpansBefore(old, startCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n    if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n    }\n  } }\n  return nw\n}\nfunction markedSpansAfter(old, endCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n    if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                            span.to == null ? null : span.to - endCh));\n    }\n  } }\n  return nw\n}\n\n// Given a change object, compute the new set of marker spans that\n// cover the line in which the change took place. Removes spans\n// entirely within the change, reconnects spans belonging to the\n// same marker that appear on both sides of the change, and cuts off\n// spans partially within the change. Returns an array of span\n// arrays with one element for each line in (after) the change.\nfunction stretchSpansOverChange(doc, change) {\n  if (change.full) { return null }\n  var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n  var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n  if (!oldFirst && !oldLast) { return null }\n\n  var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n  // Get the spans that 'stick out' on both sides\n  var first = markedSpansBefore(oldFirst, startCh, isInsert);\n  var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n  // Next, merge those two ends\n  var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n  if (first) {\n    // Fix up .to properties of first\n    for (var i = 0; i < first.length; ++i) {\n      var span = first[i];\n      if (span.to == null) {\n        var found = getMarkedSpanFor(last, span.marker);\n        if (!found) { span.to = startCh; }\n        else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n      }\n    }\n  }\n  if (last) {\n    // Fix up .from in last (or move them into first in case of sameLine)\n    for (var i$1 = 0; i$1 < last.length; ++i$1) {\n      var span$1 = last[i$1];\n      if (span$1.to != null) { span$1.to += offset; }\n      if (span$1.from == null) {\n        var found$1 = getMarkedSpanFor(first, span$1.marker);\n        if (!found$1) {\n          span$1.from = offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      } else {\n        span$1.from += offset;\n        if (sameLine) { (first || (first = [])).push(span$1); }\n      }\n    }\n  }\n  // Make sure we didn't create any zero-length spans\n  if (first) { first = clearEmptySpans(first); }\n  if (last && last != first) { last = clearEmptySpans(last); }\n\n  var newMarkers = [first];\n  if (!sameLine) {\n    // Fill gap with whole-line-spans\n    var gap = change.text.length - 2, gapMarkers;\n    if (gap > 0 && first)\n      { for (var i$2 = 0; i$2 < first.length; ++i$2)\n        { if (first[i$2].to == null)\n          { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n    for (var i$3 = 0; i$3 < gap; ++i$3)\n      { newMarkers.push(gapMarkers); }\n    newMarkers.push(last);\n  }\n  return newMarkers\n}\n\n// Remove spans that are empty and don't have a clearWhenEmpty\n// option of false.\nfunction clearEmptySpans(spans) {\n  for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n      { spans.splice(i--, 1); }\n  }\n  if (!spans.length) { return null }\n  return spans\n}\n\n// Used to 'clip' out readOnly ranges when making a change.\nfunction removeReadOnlyRanges(doc, from, to) {\n  var markers = null;\n  doc.iter(from.line, to.line + 1, function (line) {\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var mark = line.markedSpans[i].marker;\n      if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n        { (markers || (markers = [])).push(mark); }\n    } }\n  });\n  if (!markers) { return null }\n  var parts = [{from: from, to: to}];\n  for (var i = 0; i < markers.length; ++i) {\n    var mk = markers[i], m = mk.find(0);\n    for (var j = 0; j < parts.length; ++j) {\n      var p = parts[j];\n      if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n      var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n      if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n        { newParts.push({from: p.from, to: m.from}); }\n      if (dto > 0 || !mk.inclusiveRight && !dto)\n        { newParts.push({from: m.to, to: p.to}); }\n      parts.splice.apply(parts, newParts);\n      j += newParts.length - 3;\n    }\n  }\n  return parts\n}\n\n// Connect or disconnect spans from a line.\nfunction detachMarkedSpans(line) {\n  var spans = line.markedSpans;\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.detachLine(line); }\n  line.markedSpans = null;\n}\nfunction attachMarkedSpans(line, spans) {\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.attachLine(line); }\n  line.markedSpans = spans;\n}\n\n// Helpers used when computing which overlapping collapsed span\n// counts as the larger one.\nfunction extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\nfunction extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n// Returns a number indicating which of two overlapping collapsed\n// spans is larger (and thus includes the other). Falls back to\n// comparing ids when the spans cover exactly the same range.\nfunction compareCollapsedMarkers(a, b) {\n  var lenDiff = a.lines.length - b.lines.length;\n  if (lenDiff != 0) { return lenDiff }\n  var aPos = a.find(), bPos = b.find();\n  var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n  if (fromCmp) { return -fromCmp }\n  var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n  if (toCmp) { return toCmp }\n  return b.id - a.id\n}\n\n// Find out whether a line ends or starts in a collapsed span. If\n// so, return the marker for that span.\nfunction collapsedSpanAtSide(line, start) {\n  var sps = sawCollapsedSpans && line.markedSpans, found;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n        (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n      { found = sp.marker; }\n  } }\n  return found\n}\nfunction collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\nfunction collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\nfunction collapsedSpanAround(line, ch) {\n  var sps = sawCollapsedSpans && line.markedSpans, found;\n  if (sps) { for (var i = 0; i < sps.length; ++i) {\n    var sp = sps[i];\n    if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n        (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n  } }\n  return found\n}\n\n// Test whether there exists a collapsed span that partially\n// overlaps (covers the start or end, but not both) of a new span.\n// Such overlap is not allowed.\nfunction conflictingCollapsedRange(doc, lineNo$$1, from, to, marker) {\n  var line = getLine(doc, lineNo$$1);\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var i = 0; i < sps.length; ++i) {\n    var sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    var found = sp.marker.find(0);\n    var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n    var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n    if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n    if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n        fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n      { return true }\n  } }\n}\n\n// A visual line is a line as drawn on the screen. Folding, for\n// example, can cause multiple logical lines to appear on the same\n// visual line. This finds the start of the visual line that the\n// given line is part of (usually that is the line itself).\nfunction visualLine(line) {\n  var merged;\n  while (merged = collapsedSpanAtStart(line))\n    { line = merged.find(-1, true).line; }\n  return line\n}\n\nfunction visualLineEnd(line) {\n  var merged;\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return line\n}\n\n// Returns an array of logical lines that continue the visual line\n// started by the argument, or undefined if there are no such lines.\nfunction visualLineContinued(line) {\n  var merged, lines;\n  while (merged = collapsedSpanAtEnd(line)) {\n    line = merged.find(1, true).line\n    ;(lines || (lines = [])).push(line);\n  }\n  return lines\n}\n\n// Get the line number of the start of the visual line that the\n// given line number is part of.\nfunction visualLineNo(doc, lineN) {\n  var line = getLine(doc, lineN), vis = visualLine(line);\n  if (line == vis) { return lineN }\n  return lineNo(vis)\n}\n\n// Get the line number of the start of the next visual line after\n// the given line.\nfunction visualLineEndNo(doc, lineN) {\n  if (lineN > doc.lastLine()) { return lineN }\n  var line = getLine(doc, lineN), merged;\n  if (!lineIsHidden(doc, line)) { return lineN }\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return lineNo(line) + 1\n}\n\n// Compute whether a line is hidden. Lines count as hidden when they\n// are part of a visual line that starts with another line, or when\n// they are entirely covered by collapsed, non-widget span.\nfunction lineIsHidden(doc, line) {\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    if (sp.from == null) { return true }\n    if (sp.marker.widgetNode) { continue }\n    if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n      { return true }\n  } }\n}\nfunction lineIsHiddenInner(doc, line, span) {\n  if (span.to == null) {\n    var end = span.marker.find(1, true);\n    return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n  }\n  if (span.marker.inclusiveRight && span.to == line.text.length)\n    { return true }\n  for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n    sp = line.markedSpans[i];\n    if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n        (sp.to == null || sp.to != span.from) &&\n        (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n        lineIsHiddenInner(doc, line, sp)) { return true }\n  }\n}\n\n// Find the height above the given line.\nfunction heightAtLine(lineObj) {\n  lineObj = visualLine(lineObj);\n\n  var h = 0, chunk = lineObj.parent;\n  for (var i = 0; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i];\n    if (line == lineObj) { break }\n    else { h += line.height; }\n  }\n  for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n    for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n      var cur = p.children[i$1];\n      if (cur == chunk) { break }\n      else { h += cur.height; }\n    }\n  }\n  return h\n}\n\n// Compute the character length of a line, taking into account\n// collapsed ranges (see markText) that might hide parts, and join\n// other lines onto it.\nfunction lineLength(line) {\n  if (line.height == 0) { return 0 }\n  var len = line.text.length, merged, cur = line;\n  while (merged = collapsedSpanAtStart(cur)) {\n    var found = merged.find(0, true);\n    cur = found.from.line;\n    len += found.from.ch - found.to.ch;\n  }\n  cur = line;\n  while (merged = collapsedSpanAtEnd(cur)) {\n    var found$1 = merged.find(0, true);\n    len -= cur.text.length - found$1.from.ch;\n    cur = found$1.to.line;\n    len += cur.text.length - found$1.to.ch;\n  }\n  return len\n}\n\n// Find the longest line in the document.\nfunction findMaxLine(cm) {\n  var d = cm.display, doc = cm.doc;\n  d.maxLine = getLine(doc, doc.first);\n  d.maxLineLength = lineLength(d.maxLine);\n  d.maxLineChanged = true;\n  doc.iter(function (line) {\n    var len = lineLength(line);\n    if (len > d.maxLineLength) {\n      d.maxLineLength = len;\n      d.maxLine = line;\n    }\n  });\n}\n\n// BIDI HELPERS\n\nfunction iterateBidiSections(order, from, to, f) {\n  if (!order) { return f(from, to, \"ltr\", 0) }\n  var found = false;\n  for (var i = 0; i < order.length; ++i) {\n    var part = order[i];\n    if (part.from < to && part.to > from || from == to && part.to == from) {\n      f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n      found = true;\n    }\n  }\n  if (!found) { f(from, to, \"ltr\"); }\n}\n\nvar bidiOther = null;\nfunction getBidiPartAt(order, ch, sticky) {\n  var found;\n  bidiOther = null;\n  for (var i = 0; i < order.length; ++i) {\n    var cur = order[i];\n    if (cur.from < ch && cur.to > ch) { return i }\n    if (cur.to == ch) {\n      if (cur.from != cur.to && sticky == \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n    if (cur.from == ch) {\n      if (cur.from != cur.to && sticky != \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n  }\n  return found != null ? found : bidiOther\n}\n\n// Bidirectional ordering algorithm\n// See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n// that this (partially) implements.\n\n// One-char codes used for character types:\n// L (L):   Left-to-Right\n// R (R):   Right-to-Left\n// r (AL):  Right-to-Left Arabic\n// 1 (EN):  European Number\n// + (ES):  European Number Separator\n// % (ET):  European Number Terminator\n// n (AN):  Arabic Number\n// , (CS):  Common Number Separator\n// m (NSM): Non-Spacing Mark\n// b (BN):  Boundary Neutral\n// s (B):   Paragraph Separator\n// t (S):   Segment Separator\n// w (WS):  Whitespace\n// N (ON):  Other Neutrals\n\n// Returns null if characters are ordered as they appear\n// (left-to-right), or an array of sections ({from, to, level}\n// objects) in the order in which they occur visually.\nvar bidiOrdering = (function() {\n  // Character types for codepoints 0 to 0xff\n  var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n  // Character types for codepoints 0x600 to 0x6f9\n  var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n  function charType(code) {\n    if (code <= 0xf7) { return lowTypes.charAt(code) }\n    else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n    else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n    else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n    else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n    else if (code == 0x200c) { return \"b\" }\n    else { return \"L\" }\n  }\n\n  var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n  var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n  function BidiSpan(level, from, to) {\n    this.level = level;\n    this.from = from; this.to = to;\n  }\n\n  return function(str, direction) {\n    var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n    if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n    var len = str.length, types = [];\n    for (var i = 0; i < len; ++i)\n      { types.push(charType(str.charCodeAt(i))); }\n\n    // W1. Examine each non-spacing mark (NSM) in the level run, and\n    // change the type of the NSM to the type of the previous\n    // character. If the NSM is at the start of the level run, it will\n    // get the type of sor.\n    for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n      var type = types[i$1];\n      if (type == \"m\") { types[i$1] = prev; }\n      else { prev = type; }\n    }\n\n    // W2. Search backwards from each instance of a European number\n    // until the first strong type (R, L, AL, or sor) is found. If an\n    // AL is found, change the type of the European number to Arabic\n    // number.\n    // W3. Change all ALs to R.\n    for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n      var type$1 = types[i$2];\n      if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n      else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n    }\n\n    // W4. A single European separator between two European numbers\n    // changes to a European number. A single common separator between\n    // two numbers of the same type changes to that type.\n    for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n      var type$2 = types[i$3];\n      if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n      else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n               (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n      prev$1 = type$2;\n    }\n\n    // W5. A sequence of European terminators adjacent to European\n    // numbers changes to all European numbers.\n    // W6. Otherwise, separators and terminators change to Other\n    // Neutral.\n    for (var i$4 = 0; i$4 < len; ++i$4) {\n      var type$3 = types[i$4];\n      if (type$3 == \",\") { types[i$4] = \"N\"; }\n      else if (type$3 == \"%\") {\n        var end = (void 0);\n        for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n        var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n        for (var j = i$4; j < end; ++j) { types[j] = replace; }\n        i$4 = end - 1;\n      }\n    }\n\n    // W7. Search backwards from each instance of a European number\n    // until the first strong type (R, L, or sor) is found. If an L is\n    // found, then change the type of the European number to L.\n    for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n      var type$4 = types[i$5];\n      if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n      else if (isStrong.test(type$4)) { cur$1 = type$4; }\n    }\n\n    // N1. A sequence of neutrals takes the direction of the\n    // surrounding strong text if the text on both sides has the same\n    // direction. European and Arabic numbers act as if they were R in\n    // terms of their influence on neutrals. Start-of-level-run (sor)\n    // and end-of-level-run (eor) are used at level run boundaries.\n    // N2. Any remaining neutrals take the embedding direction.\n    for (var i$6 = 0; i$6 < len; ++i$6) {\n      if (isNeutral.test(types[i$6])) {\n        var end$1 = (void 0);\n        for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n        var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n        var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n        var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n        for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n        i$6 = end$1 - 1;\n      }\n    }\n\n    // Here we depart from the documented algorithm, in order to avoid\n    // building up an actual levels array. Since there are only three\n    // levels (0, 1, 2) in an implementation that doesn't take\n    // explicit embedding into account, we can build up the order on\n    // the fly, without following the level-based algorithm.\n    var order = [], m;\n    for (var i$7 = 0; i$7 < len;) {\n      if (countsAsLeft.test(types[i$7])) {\n        var start = i$7;\n        for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n        order.push(new BidiSpan(0, start, i$7));\n      } else {\n        var pos = i$7, at = order.length;\n        for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n        for (var j$2 = pos; j$2 < i$7;) {\n          if (countsAsNum.test(types[j$2])) {\n            if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); }\n            var nstart = j$2;\n            for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n            order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n            pos = j$2;\n          } else { ++j$2; }\n        }\n        if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n      }\n    }\n    if (direction == \"ltr\") {\n      if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n        order[0].from = m[0].length;\n        order.unshift(new BidiSpan(0, 0, m[0].length));\n      }\n      if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n        lst(order).to -= m[0].length;\n        order.push(new BidiSpan(0, len - m[0].length, len));\n      }\n    }\n\n    return direction == \"rtl\" ? order.reverse() : order\n  }\n})();\n\n// Get the bidi ordering for the given line (and cache it). Returns\n// false for lines that are fully left-to-right, and an array of\n// BidiSpan objects otherwise.\nfunction getOrder(line, direction) {\n  var order = line.order;\n  if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n  return order\n}\n\n// EVENT HANDLING\n\n// Lightweight event framework. on/off also work on DOM nodes,\n// registering native DOM handlers.\n\nvar noHandlers = [];\n\nvar on = function(emitter, type, f) {\n  if (emitter.addEventListener) {\n    emitter.addEventListener(type, f, false);\n  } else if (emitter.attachEvent) {\n    emitter.attachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers || (emitter._handlers = {});\n    map$$1[type] = (map$$1[type] || noHandlers).concat(f);\n  }\n};\n\nfunction getHandlers(emitter, type) {\n  return emitter._handlers && emitter._handlers[type] || noHandlers\n}\n\nfunction off(emitter, type, f) {\n  if (emitter.removeEventListener) {\n    emitter.removeEventListener(type, f, false);\n  } else if (emitter.detachEvent) {\n    emitter.detachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers, arr = map$$1 && map$$1[type];\n    if (arr) {\n      var index = indexOf(arr, f);\n      if (index > -1)\n        { map$$1[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n    }\n  }\n}\n\nfunction signal(emitter, type /*, values...*/) {\n  var handlers = getHandlers(emitter, type);\n  if (!handlers.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2);\n  for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n}\n\n// The DOM events that CodeMirror handles can be overridden by\n// registering a (non-DOM) handler on the editor for the event name,\n// and preventDefault-ing the event in that handler.\nfunction signalDOMEvent(cm, e, override) {\n  if (typeof e == \"string\")\n    { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n  signal(cm, override || e.type, cm, e);\n  return e_defaultPrevented(e) || e.codemirrorIgnore\n}\n\nfunction signalCursorActivity(cm) {\n  var arr = cm._handlers && cm._handlers.cursorActivity;\n  if (!arr) { return }\n  var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n  for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n    { set.push(arr[i]); } }\n}\n\nfunction hasHandler(emitter, type) {\n  return getHandlers(emitter, type).length > 0\n}\n\n// Add on and off methods to a constructor's prototype, to make\n// registering events on such objects more convenient.\nfunction eventMixin(ctor) {\n  ctor.prototype.on = function(type, f) {on(this, type, f);};\n  ctor.prototype.off = function(type, f) {off(this, type, f);};\n}\n\n// Due to the fact that we still support jurassic IE versions, some\n// compatibility wrappers are needed.\n\nfunction e_preventDefault(e) {\n  if (e.preventDefault) { e.preventDefault(); }\n  else { e.returnValue = false; }\n}\nfunction e_stopPropagation(e) {\n  if (e.stopPropagation) { e.stopPropagation(); }\n  else { e.cancelBubble = true; }\n}\nfunction e_defaultPrevented(e) {\n  return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n}\nfunction e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\nfunction e_target(e) {return e.target || e.srcElement}\nfunction e_button(e) {\n  var b = e.which;\n  if (b == null) {\n    if (e.button & 1) { b = 1; }\n    else if (e.button & 2) { b = 3; }\n    else if (e.button & 4) { b = 2; }\n  }\n  if (mac && e.ctrlKey && b == 1) { b = 3; }\n  return b\n}\n\n// Detect drag-and-drop\nvar dragAndDrop = function() {\n  // There is *some* kind of drag-and-drop support in IE6-8, but I\n  // couldn't get it to work yet.\n  if (ie && ie_version < 9) { return false }\n  var div = elt('div');\n  return \"draggable\" in div || \"dragDrop\" in div\n}();\n\nvar zwspSupported;\nfunction zeroWidthElement(measure) {\n  if (zwspSupported == null) {\n    var test = elt(\"span\", \"\\u200b\");\n    removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n    if (measure.firstChild.offsetHeight != 0)\n      { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n  }\n  var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n    elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n  node.setAttribute(\"cm-text\", \"\");\n  return node\n}\n\n// Feature-detect IE's crummy client rect reporting for bidi text\nvar badBidiRects;\nfunction hasBadBidiRects(measure) {\n  if (badBidiRects != null) { return badBidiRects }\n  var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n  var r0 = range(txt, 0, 1).getBoundingClientRect();\n  var r1 = range(txt, 1, 2).getBoundingClientRect();\n  removeChildren(measure);\n  if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n  return badBidiRects = (r1.right - r0.right < 3)\n}\n\n// See if \"\".split is the broken IE version, if so, provide an\n// alternative way to split lines.\nvar splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n  var pos = 0, result = [], l = string.length;\n  while (pos <= l) {\n    var nl = string.indexOf(\"\\n\", pos);\n    if (nl == -1) { nl = string.length; }\n    var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n    var rt = line.indexOf(\"\\r\");\n    if (rt != -1) {\n      result.push(line.slice(0, rt));\n      pos += rt + 1;\n    } else {\n      result.push(line);\n      pos = nl + 1;\n    }\n  }\n  return result\n} : function (string) { return string.split(/\\r\\n?|\\n/); };\n\nvar hasSelection = window.getSelection ? function (te) {\n  try { return te.selectionStart != te.selectionEnd }\n  catch(e) { return false }\n} : function (te) {\n  var range$$1;\n  try {range$$1 = te.ownerDocument.selection.createRange();}\n  catch(e) {}\n  if (!range$$1 || range$$1.parentElement() != te) { return false }\n  return range$$1.compareEndPoints(\"StartToEnd\", range$$1) != 0\n};\n\nvar hasCopyEvent = (function () {\n  var e = elt(\"div\");\n  if (\"oncopy\" in e) { return true }\n  e.setAttribute(\"oncopy\", \"return;\");\n  return typeof e.oncopy == \"function\"\n})();\n\nvar badZoomedRects = null;\nfunction hasBadZoomedRects(measure) {\n  if (badZoomedRects != null) { return badZoomedRects }\n  var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n  var normal = node.getBoundingClientRect();\n  var fromRange = range(node, 0, 1).getBoundingClientRect();\n  return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n}\n\n// Known modes, by name and by MIME\nvar modes = {};\nvar mimeModes = {};\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nfunction defineMode(name, mode) {\n  if (arguments.length > 2)\n    { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n  modes[name] = mode;\n}\n\nfunction defineMIME(mime, spec) {\n  mimeModes[mime] = spec;\n}\n\n// Given a MIME type, a {name, ...options} config object, or a name\n// string, return a mode config object.\nfunction resolveMode(spec) {\n  if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n    spec = mimeModes[spec];\n  } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n    var found = mimeModes[spec.name];\n    if (typeof found == \"string\") { found = {name: found}; }\n    spec = createObj(found, spec);\n    spec.name = found.name;\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n    return resolveMode(\"application/xml\")\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n    return resolveMode(\"application/json\")\n  }\n  if (typeof spec == \"string\") { return {name: spec} }\n  else { return spec || {name: \"null\"} }\n}\n\n// Given a mode spec (anything that resolveMode accepts), find and\n// initialize an actual mode object.\nfunction getMode(options, spec) {\n  spec = resolveMode(spec);\n  var mfactory = modes[spec.name];\n  if (!mfactory) { return getMode(options, \"text/plain\") }\n  var modeObj = mfactory(options, spec);\n  if (modeExtensions.hasOwnProperty(spec.name)) {\n    var exts = modeExtensions[spec.name];\n    for (var prop in exts) {\n      if (!exts.hasOwnProperty(prop)) { continue }\n      if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n      modeObj[prop] = exts[prop];\n    }\n  }\n  modeObj.name = spec.name;\n  if (spec.helperType) { modeObj.helperType = spec.helperType; }\n  if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n    { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n  return modeObj\n}\n\n// This can be used to attach properties to mode objects from\n// outside the actual mode definition.\nvar modeExtensions = {};\nfunction extendMode(mode, properties) {\n  var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n  copyObj(properties, exts);\n}\n\nfunction copyState(mode, state) {\n  if (state === true) { return state }\n  if (mode.copyState) { return mode.copyState(state) }\n  var nstate = {};\n  for (var n in state) {\n    var val = state[n];\n    if (val instanceof Array) { val = val.concat([]); }\n    nstate[n] = val;\n  }\n  return nstate\n}\n\n// Given a mode and a state (for that mode), find the inner mode and\n// state at the position that the state refers to.\nfunction innerMode(mode, state) {\n  var info;\n  while (mode.innerMode) {\n    info = mode.innerMode(state);\n    if (!info || info.mode == mode) { break }\n    state = info.state;\n    mode = info.mode;\n  }\n  return info || {mode: mode, state: state}\n}\n\nfunction startState(mode, a1, a2) {\n  return mode.startState ? mode.startState(a1, a2) : true\n}\n\n// STRING STREAM\n\n// Fed to the mode parsers, provides helper functions to make\n// parsers more succinct.\n\nvar StringStream = function(string, tabSize, lineOracle) {\n  this.pos = this.start = 0;\n  this.string = string;\n  this.tabSize = tabSize || 8;\n  this.lastColumnPos = this.lastColumnValue = 0;\n  this.lineStart = 0;\n  this.lineOracle = lineOracle;\n};\n\nStringStream.prototype.eol = function () {return this.pos >= this.string.length};\nStringStream.prototype.sol = function () {return this.pos == this.lineStart};\nStringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\nStringStream.prototype.next = function () {\n  if (this.pos < this.string.length)\n    { return this.string.charAt(this.pos++) }\n};\nStringStream.prototype.eat = function (match) {\n  var ch = this.string.charAt(this.pos);\n  var ok;\n  if (typeof match == \"string\") { ok = ch == match; }\n  else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n  if (ok) {++this.pos; return ch}\n};\nStringStream.prototype.eatWhile = function (match) {\n  var start = this.pos;\n  while (this.eat(match)){}\n  return this.pos > start\n};\nStringStream.prototype.eatSpace = function () {\n    var this$1 = this;\n\n  var start = this.pos;\n  while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this$1.pos; }\n  return this.pos > start\n};\nStringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\nStringStream.prototype.skipTo = function (ch) {\n  var found = this.string.indexOf(ch, this.pos);\n  if (found > -1) {this.pos = found; return true}\n};\nStringStream.prototype.backUp = function (n) {this.pos -= n;};\nStringStream.prototype.column = function () {\n  if (this.lastColumnPos < this.start) {\n    this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n    this.lastColumnPos = this.start;\n  }\n  return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.indentation = function () {\n  return countColumn(this.string, null, this.tabSize) -\n    (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n  if (typeof pattern == \"string\") {\n    var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n    var substr = this.string.substr(this.pos, pattern.length);\n    if (cased(substr) == cased(pattern)) {\n      if (consume !== false) { this.pos += pattern.length; }\n      return true\n    }\n  } else {\n    var match = this.string.slice(this.pos).match(pattern);\n    if (match && match.index > 0) { return null }\n    if (match && consume !== false) { this.pos += match[0].length; }\n    return match\n  }\n};\nStringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\nStringStream.prototype.hideFirstChars = function (n, inner) {\n  this.lineStart += n;\n  try { return inner() }\n  finally { this.lineStart -= n; }\n};\nStringStream.prototype.lookAhead = function (n) {\n  var oracle = this.lineOracle;\n  return oracle && oracle.lookAhead(n)\n};\nStringStream.prototype.baseToken = function () {\n  var oracle = this.lineOracle;\n  return oracle && oracle.baseToken(this.pos)\n};\n\nvar SavedContext = function(state, lookAhead) {\n  this.state = state;\n  this.lookAhead = lookAhead;\n};\n\nvar Context = function(doc, state, line, lookAhead) {\n  this.state = state;\n  this.doc = doc;\n  this.line = line;\n  this.maxLookAhead = lookAhead || 0;\n  this.baseTokens = null;\n  this.baseTokenPos = 1;\n};\n\nContext.prototype.lookAhead = function (n) {\n  var line = this.doc.getLine(this.line + n);\n  if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n  return line\n};\n\nContext.prototype.baseToken = function (n) {\n    var this$1 = this;\n\n  if (!this.baseTokens) { return null }\n  while (this.baseTokens[this.baseTokenPos] <= n)\n    { this$1.baseTokenPos += 2; }\n  var type = this.baseTokens[this.baseTokenPos + 1];\n  return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n          size: this.baseTokens[this.baseTokenPos] - n}\n};\n\nContext.prototype.nextLine = function () {\n  this.line++;\n  if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n};\n\nContext.fromSaved = function (doc, saved, line) {\n  if (saved instanceof SavedContext)\n    { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n  else\n    { return new Context(doc, copyState(doc.mode, saved), line) }\n};\n\nContext.prototype.save = function (copy) {\n  var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n  return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n};\n\n\n// Compute a style array (an array starting with a mode generation\n// -- for invalidation -- followed by pairs of end positions and\n// style strings), which is used to highlight the tokens on the\n// line.\nfunction highlightLine(cm, line, context, forceToEnd) {\n  // A styles array always starts with a number identifying the\n  // mode/overlays that it is based on (for easy invalidation).\n  var st = [cm.state.modeGen], lineClasses = {};\n  // Compute the base array of styles\n  runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n          lineClasses, forceToEnd);\n  var state = context.state;\n\n  // Run overlays, adjust style array.\n  var loop = function ( o ) {\n    context.baseTokens = st;\n    var overlay = cm.state.overlays[o], i = 1, at = 0;\n    context.state = true;\n    runMode(cm, line.text, overlay.mode, context, function (end, style) {\n      var start = i;\n      // Ensure there's a token end at the current position, and that i points at it\n      while (at < end) {\n        var i_end = st[i];\n        if (i_end > end)\n          { st.splice(i, 1, end, st[i+1], i_end); }\n        i += 2;\n        at = Math.min(end, i_end);\n      }\n      if (!style) { return }\n      if (overlay.opaque) {\n        st.splice(start, i - start, end, \"overlay \" + style);\n        i = start + 2;\n      } else {\n        for (; start < i; start += 2) {\n          var cur = st[start+1];\n          st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n        }\n      }\n    }, lineClasses);\n    context.state = state;\n    context.baseTokens = null;\n    context.baseTokenPos = 1;\n  };\n\n  for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n  return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n}\n\nfunction getLineStyles(cm, line, updateFrontier) {\n  if (!line.styles || line.styles[0] != cm.state.modeGen) {\n    var context = getContextBefore(cm, lineNo(line));\n    var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n    var result = highlightLine(cm, line, context);\n    if (resetState) { context.state = resetState; }\n    line.stateAfter = context.save(!resetState);\n    line.styles = result.styles;\n    if (result.classes) { line.styleClasses = result.classes; }\n    else if (line.styleClasses) { line.styleClasses = null; }\n    if (updateFrontier === cm.doc.highlightFrontier)\n      { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n  }\n  return line.styles\n}\n\nfunction getContextBefore(cm, n, precise) {\n  var doc = cm.doc, display = cm.display;\n  if (!doc.mode.startState) { return new Context(doc, true, n) }\n  var start = findStartLine(cm, n, precise);\n  var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n  var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n  doc.iter(start, n, function (line) {\n    processLine(cm, line.text, context);\n    var pos = context.line;\n    line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n    context.nextLine();\n  });\n  if (precise) { doc.modeFrontier = context.line; }\n  return context\n}\n\n// Lightweight form of highlight -- proceed over this line and\n// update state, but don't save a style array. Used for lines that\n// aren't currently visible.\nfunction processLine(cm, text, context, startAt) {\n  var mode = cm.doc.mode;\n  var stream = new StringStream(text, cm.options.tabSize, context);\n  stream.start = stream.pos = startAt || 0;\n  if (text == \"\") { callBlankLine(mode, context.state); }\n  while (!stream.eol()) {\n    readToken(mode, stream, context.state);\n    stream.start = stream.pos;\n  }\n}\n\nfunction callBlankLine(mode, state) {\n  if (mode.blankLine) { return mode.blankLine(state) }\n  if (!mode.innerMode) { return }\n  var inner = innerMode(mode, state);\n  if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n}\n\nfunction readToken(mode, stream, state, inner) {\n  for (var i = 0; i < 10; i++) {\n    if (inner) { inner[0] = innerMode(mode, state).mode; }\n    var style = mode.token(stream, state);\n    if (stream.pos > stream.start) { return style }\n  }\n  throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n}\n\nvar Token = function(stream, type, state) {\n  this.start = stream.start; this.end = stream.pos;\n  this.string = stream.current();\n  this.type = type || null;\n  this.state = state;\n};\n\n// Utility for getTokenAt and getLineTokens\nfunction takeToken(cm, pos, precise, asArray) {\n  var doc = cm.doc, mode = doc.mode, style;\n  pos = clipPos(doc, pos);\n  var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n  var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n  if (asArray) { tokens = []; }\n  while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n    stream.start = stream.pos;\n    style = readToken(mode, stream, context.state);\n    if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n  }\n  return asArray ? tokens : new Token(stream, style, context.state)\n}\n\nfunction extractLineClasses(type, output) {\n  if (type) { for (;;) {\n    var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n    if (!lineClass) { break }\n    type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n    var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n    if (output[prop] == null)\n      { output[prop] = lineClass[2]; }\n    else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n      { output[prop] += \" \" + lineClass[2]; }\n  } }\n  return type\n}\n\n// Run the given mode's parser over a line, calling f for each token.\nfunction runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n  var flattenSpans = mode.flattenSpans;\n  if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n  var curStart = 0, curStyle = null;\n  var stream = new StringStream(text, cm.options.tabSize, context), style;\n  var inner = cm.options.addModeClass && [null];\n  if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n  while (!stream.eol()) {\n    if (stream.pos > cm.options.maxHighlightLength) {\n      flattenSpans = false;\n      if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n      stream.pos = text.length;\n      style = null;\n    } else {\n      style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n    }\n    if (inner) {\n      var mName = inner[0].name;\n      if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n    }\n    if (!flattenSpans || curStyle != style) {\n      while (curStart < stream.start) {\n        curStart = Math.min(stream.start, curStart + 5000);\n        f(curStart, curStyle);\n      }\n      curStyle = style;\n    }\n    stream.start = stream.pos;\n  }\n  while (curStart < stream.pos) {\n    // Webkit seems to refuse to render text nodes longer than 57444\n    // characters, and returns inaccurate measurements in nodes\n    // starting around 5000 chars.\n    var pos = Math.min(stream.pos, curStart + 5000);\n    f(pos, curStyle);\n    curStart = pos;\n  }\n}\n\n// Finds the line to start with when starting a parse. Tries to\n// find a line with a stateAfter, so that it can start with a\n// valid state. If that fails, it returns the line with the\n// smallest indentation, which tends to need the least context to\n// parse correctly.\nfunction findStartLine(cm, n, precise) {\n  var minindent, minline, doc = cm.doc;\n  var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n  for (var search = n; search > lim; --search) {\n    if (search <= doc.first) { return doc.first }\n    var line = getLine(doc, search - 1), after = line.stateAfter;\n    if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n      { return search }\n    var indented = countColumn(line.text, null, cm.options.tabSize);\n    if (minline == null || minindent > indented) {\n      minline = search - 1;\n      minindent = indented;\n    }\n  }\n  return minline\n}\n\nfunction retreatFrontier(doc, n) {\n  doc.modeFrontier = Math.min(doc.modeFrontier, n);\n  if (doc.highlightFrontier < n - 10) { return }\n  var start = doc.first;\n  for (var line = n - 1; line > start; line--) {\n    var saved = getLine(doc, line).stateAfter;\n    // change is on 3\n    // state on line 1 looked ahead 2 -- so saw 3\n    // test 1 + 2 < 3 should cover this\n    if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n      start = line + 1;\n      break\n    }\n  }\n  doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n}\n\n// LINE DATA STRUCTURE\n\n// Line objects. These hold state related to a line, including\n// highlighting info (the styles array).\nvar Line = function(text, markedSpans, estimateHeight) {\n  this.text = text;\n  attachMarkedSpans(this, markedSpans);\n  this.height = estimateHeight ? estimateHeight(this) : 1;\n};\n\nLine.prototype.lineNo = function () { return lineNo(this) };\neventMixin(Line);\n\n// Change the content (text, markers) of a line. Automatically\n// invalidates cached information and tries to re-estimate the\n// line's height.\nfunction updateLine(line, text, markedSpans, estimateHeight) {\n  line.text = text;\n  if (line.stateAfter) { line.stateAfter = null; }\n  if (line.styles) { line.styles = null; }\n  if (line.order != null) { line.order = null; }\n  detachMarkedSpans(line);\n  attachMarkedSpans(line, markedSpans);\n  var estHeight = estimateHeight ? estimateHeight(line) : 1;\n  if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n}\n\n// Detach a line from the document tree and its markers.\nfunction cleanUpLine(line) {\n  line.parent = null;\n  detachMarkedSpans(line);\n}\n\n// Convert a style as returned by a mode (either null, or a string\n// containing one or more styles) to a CSS style. This is cached,\n// and also looks for line-wide styles.\nvar styleToClassCache = {};\nvar styleToClassCacheWithMode = {};\nfunction interpretTokenStyle(style, options) {\n  if (!style || /^\\s*$/.test(style)) { return null }\n  var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n  return cache[style] ||\n    (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n}\n\n// Render the DOM representation of the text of a line. Also builds\n// up a 'line map', which points at the DOM nodes that represent\n// specific stretches of text, and is used by the measuring code.\n// The returned object contains the DOM node, this map, and\n// information about line-wide styles that were set by the mode.\nfunction buildLineContent(cm, lineView) {\n  // The padding-right forces the element to have a 'border', which\n  // is needed on Webkit to be able to get line-level bounding\n  // rectangles for it (in measureChar).\n  var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n  var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                 col: 0, pos: 0, cm: cm,\n                 trailingSpace: false,\n                 splitSpaces: (ie || webkit) && cm.getOption(\"lineWrapping\")};\n  lineView.measure = {};\n\n  // Iterate over the logical lines that make up this visual line.\n  for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n    var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n    builder.pos = 0;\n    builder.addToken = buildToken;\n    // Optionally wire in some hacks into the token-rendering\n    // algorithm, to deal with browser quirks.\n    if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n      { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n    builder.map = [];\n    var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n    insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n    if (line.styleClasses) {\n      if (line.styleClasses.bgClass)\n        { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n      if (line.styleClasses.textClass)\n        { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n    }\n\n    // Ensure at least a single node is present, for measuring.\n    if (builder.map.length == 0)\n      { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n    // Store the map and a cache object for the current logical line\n    if (i == 0) {\n      lineView.measure.map = builder.map;\n      lineView.measure.cache = {};\n    } else {\n      (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n      ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n    }\n  }\n\n  // See issue #2901\n  if (webkit) {\n    var last = builder.content.lastChild;\n    if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n      { builder.content.className = \"cm-tab-wrap-hack\"; }\n  }\n\n  signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n  if (builder.pre.className)\n    { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n  return builder\n}\n\nfunction defaultSpecialCharPlaceholder(ch) {\n  var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n  token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n  token.setAttribute(\"aria-label\", token.title);\n  return token\n}\n\n// Build up the DOM representation for a single token, and add it to\n// the line map. Takes care to render special characters separately.\nfunction buildToken(builder, text, style, startStyle, endStyle, title, css) {\n  if (!text) { return }\n  var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n  var special = builder.cm.state.specialChars, mustWrap = false;\n  var content;\n  if (!special.test(text)) {\n    builder.col += text.length;\n    content = document.createTextNode(displayText);\n    builder.map.push(builder.pos, builder.pos + text.length, content);\n    if (ie && ie_version < 9) { mustWrap = true; }\n    builder.pos += text.length;\n  } else {\n    content = document.createDocumentFragment();\n    var pos = 0;\n    while (true) {\n      special.lastIndex = pos;\n      var m = special.exec(text);\n      var skipped = m ? m.index - pos : text.length - pos;\n      if (skipped) {\n        var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n        else { content.appendChild(txt); }\n        builder.map.push(builder.pos, builder.pos + skipped, txt);\n        builder.col += skipped;\n        builder.pos += skipped;\n      }\n      if (!m) { break }\n      pos += skipped + 1;\n      var txt$1 = (void 0);\n      if (m[0] == \"\\t\") {\n        var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n        txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n        txt$1.setAttribute(\"role\", \"presentation\");\n        txt$1.setAttribute(\"cm-text\", \"\\t\");\n        builder.col += tabWidth;\n      } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n        txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        builder.col += 1;\n      } else {\n        txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n        else { content.appendChild(txt$1); }\n        builder.col += 1;\n      }\n      builder.map.push(builder.pos, builder.pos + 1, txt$1);\n      builder.pos++;\n    }\n  }\n  builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n  if (style || startStyle || endStyle || mustWrap || css) {\n    var fullStyle = style || \"\";\n    if (startStyle) { fullStyle += startStyle; }\n    if (endStyle) { fullStyle += endStyle; }\n    var token = elt(\"span\", [content], fullStyle, css);\n    if (title) { token.title = title; }\n    return builder.content.appendChild(token)\n  }\n  builder.content.appendChild(content);\n}\n\nfunction splitSpaces(text, trailingBefore) {\n  if (text.length > 1 && !/  /.test(text)) { return text }\n  var spaceBefore = trailingBefore, result = \"\";\n  for (var i = 0; i < text.length; i++) {\n    var ch = text.charAt(i);\n    if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n      { ch = \"\\u00a0\"; }\n    result += ch;\n    spaceBefore = ch == \" \";\n  }\n  return result\n}\n\n// Work around nonsense dimensions being reported for stretches of\n// right-to-left text.\nfunction buildTokenBadBidi(inner, order) {\n  return function (builder, text, style, startStyle, endStyle, title, css) {\n    style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n    var start = builder.pos, end = start + text.length;\n    for (;;) {\n      // Find the part that overlaps with the start of this text\n      var part = (void 0);\n      for (var i = 0; i < order.length; i++) {\n        part = order[i];\n        if (part.to > start && part.from <= start) { break }\n      }\n      if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, title, css) }\n      inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css);\n      startStyle = null;\n      text = text.slice(part.to - start);\n      start = part.to;\n    }\n  }\n}\n\nfunction buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n  var widget = !ignoreWidget && marker.widgetNode;\n  if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n  if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n    if (!widget)\n      { widget = builder.content.appendChild(document.createElement(\"span\")); }\n    widget.setAttribute(\"cm-marker\", marker.id);\n  }\n  if (widget) {\n    builder.cm.display.input.setUneditable(widget);\n    builder.content.appendChild(widget);\n  }\n  builder.pos += size;\n  builder.trailingSpace = false;\n}\n\n// Outputs a number of spans to make up a line, taking highlighting\n// and marked text into account.\nfunction insertLineContent(line, builder, styles) {\n  var spans = line.markedSpans, allText = line.text, at = 0;\n  if (!spans) {\n    for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n      { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n    return\n  }\n\n  var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n  var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed;\n  for (;;) {\n    if (nextChange == pos) { // Update current marker set\n      spanStyle = spanEndStyle = spanStartStyle = title = css = \"\";\n      collapsed = null; nextChange = Infinity;\n      var foundBookmarks = [], endStyles = (void 0);\n      for (var j = 0; j < spans.length; ++j) {\n        var sp = spans[j], m = sp.marker;\n        if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n          foundBookmarks.push(m);\n        } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n          if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n            nextChange = sp.to;\n            spanEndStyle = \"\";\n          }\n          if (m.className) { spanStyle += \" \" + m.className; }\n          if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n          if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n          if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n          if (m.title && !title) { title = m.title; }\n          if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n            { collapsed = sp; }\n        } else if (sp.from > pos && nextChange > sp.from) {\n          nextChange = sp.from;\n        }\n      }\n      if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n        { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n      if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n        { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n      if (collapsed && (collapsed.from || 0) == pos) {\n        buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                           collapsed.marker, collapsed.from == null);\n        if (collapsed.to == null) { return }\n        if (collapsed.to == pos) { collapsed = false; }\n      }\n    }\n    if (pos >= len) { break }\n\n    var upto = Math.min(len, nextChange);\n    while (true) {\n      if (text) {\n        var end = pos + text.length;\n        if (!collapsed) {\n          var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n          builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                           spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css);\n        }\n        if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n        pos = end;\n        spanStartStyle = \"\";\n      }\n      text = allText.slice(at, at = styles[i++]);\n      style = interpretTokenStyle(styles[i++], builder.cm.options);\n    }\n  }\n}\n\n\n// These objects are used to represent the visible (currently drawn)\n// part of the document. A LineView may correspond to multiple\n// logical lines, if those are connected by collapsed ranges.\nfunction LineView(doc, line, lineN) {\n  // The starting line\n  this.line = line;\n  // Continuing lines, if any\n  this.rest = visualLineContinued(line);\n  // Number of logical lines in this visual line\n  this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n  this.node = this.text = null;\n  this.hidden = lineIsHidden(doc, line);\n}\n\n// Create a range of LineView objects for the given lines.\nfunction buildViewArray(cm, from, to) {\n  var array = [], nextPos;\n  for (var pos = from; pos < to; pos = nextPos) {\n    var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n    nextPos = pos + view.size;\n    array.push(view);\n  }\n  return array\n}\n\nvar operationGroup = null;\n\nfunction pushOperation(op) {\n  if (operationGroup) {\n    operationGroup.ops.push(op);\n  } else {\n    op.ownsGroup = operationGroup = {\n      ops: [op],\n      delayedCallbacks: []\n    };\n  }\n}\n\nfunction fireCallbacksForOps(group) {\n  // Calls delayed callbacks and cursorActivity handlers until no\n  // new ones appear\n  var callbacks = group.delayedCallbacks, i = 0;\n  do {\n    for (; i < callbacks.length; i++)\n      { callbacks[i].call(null); }\n    for (var j = 0; j < group.ops.length; j++) {\n      var op = group.ops[j];\n      if (op.cursorActivityHandlers)\n        { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n          { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n    }\n  } while (i < callbacks.length)\n}\n\nfunction finishOperation(op, endCb) {\n  var group = op.ownsGroup;\n  if (!group) { return }\n\n  try { fireCallbacksForOps(group); }\n  finally {\n    operationGroup = null;\n    endCb(group);\n  }\n}\n\nvar orphanDelayedCallbacks = null;\n\n// Often, we want to signal events at a point where we are in the\n// middle of some work, but don't want the handler to start calling\n// other methods on the editor, which might be in an inconsistent\n// state or simply not expect any other events to happen.\n// signalLater looks whether there are any handlers, and schedules\n// them to be executed when the last operation ends, or, if no\n// operation is active, when a timeout fires.\nfunction signalLater(emitter, type /*, values...*/) {\n  var arr = getHandlers(emitter, type);\n  if (!arr.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2), list;\n  if (operationGroup) {\n    list = operationGroup.delayedCallbacks;\n  } else if (orphanDelayedCallbacks) {\n    list = orphanDelayedCallbacks;\n  } else {\n    list = orphanDelayedCallbacks = [];\n    setTimeout(fireOrphanDelayed, 0);\n  }\n  var loop = function ( i ) {\n    list.push(function () { return arr[i].apply(null, args); });\n  };\n\n  for (var i = 0; i < arr.length; ++i)\n    loop( i );\n}\n\nfunction fireOrphanDelayed() {\n  var delayed = orphanDelayedCallbacks;\n  orphanDelayedCallbacks = null;\n  for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n}\n\n// When an aspect of a line changes, a string is added to\n// lineView.changes. This updates the relevant part of the line's\n// DOM structure.\nfunction updateLineForChanges(cm, lineView, lineN, dims) {\n  for (var j = 0; j < lineView.changes.length; j++) {\n    var type = lineView.changes[j];\n    if (type == \"text\") { updateLineText(cm, lineView); }\n    else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n    else if (type == \"class\") { updateLineClasses(cm, lineView); }\n    else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n  }\n  lineView.changes = null;\n}\n\n// Lines with gutter elements, widgets or a background class need to\n// be wrapped, and have the extra elements added to the wrapper div\nfunction ensureLineWrapped(lineView) {\n  if (lineView.node == lineView.text) {\n    lineView.node = elt(\"div\", null, null, \"position: relative\");\n    if (lineView.text.parentNode)\n      { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n    lineView.node.appendChild(lineView.text);\n    if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n  }\n  return lineView.node\n}\n\nfunction updateLineBackground(cm, lineView) {\n  var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n  if (cls) { cls += \" CodeMirror-linebackground\"; }\n  if (lineView.background) {\n    if (cls) { lineView.background.className = cls; }\n    else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n  } else if (cls) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n    cm.display.input.setUneditable(lineView.background);\n  }\n}\n\n// Wrapper around buildLineContent which will reuse the structure\n// in display.externalMeasured when possible.\nfunction getLineContent(cm, lineView) {\n  var ext = cm.display.externalMeasured;\n  if (ext && ext.line == lineView.line) {\n    cm.display.externalMeasured = null;\n    lineView.measure = ext.measure;\n    return ext.built\n  }\n  return buildLineContent(cm, lineView)\n}\n\n// Redraw the line's text. Interacts with the background and text\n// classes because the mode may output tokens that influence these\n// classes.\nfunction updateLineText(cm, lineView) {\n  var cls = lineView.text.className;\n  var built = getLineContent(cm, lineView);\n  if (lineView.text == lineView.node) { lineView.node = built.pre; }\n  lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n  lineView.text = built.pre;\n  if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n    lineView.bgClass = built.bgClass;\n    lineView.textClass = built.textClass;\n    updateLineClasses(cm, lineView);\n  } else if (cls) {\n    lineView.text.className = cls;\n  }\n}\n\nfunction updateLineClasses(cm, lineView) {\n  updateLineBackground(cm, lineView);\n  if (lineView.line.wrapClass)\n    { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n  else if (lineView.node != lineView.text)\n    { lineView.node.className = \"\"; }\n  var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n  lineView.text.className = textClass || \"\";\n}\n\nfunction updateLineGutter(cm, lineView, lineN, dims) {\n  if (lineView.gutter) {\n    lineView.node.removeChild(lineView.gutter);\n    lineView.gutter = null;\n  }\n  if (lineView.gutterBackground) {\n    lineView.node.removeChild(lineView.gutterBackground);\n    lineView.gutterBackground = null;\n  }\n  if (lineView.line.gutterClass) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                    (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(lineView.gutterBackground);\n    wrap.insertBefore(lineView.gutterBackground, lineView.text);\n  }\n  var markers = lineView.line.gutterMarkers;\n  if (cm.options.lineNumbers || markers) {\n    var wrap$1 = ensureLineWrapped(lineView);\n    var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(gutterWrap);\n    wrap$1.insertBefore(gutterWrap, lineView.text);\n    if (lineView.line.gutterClass)\n      { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n    if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n      { lineView.lineNumber = gutterWrap.appendChild(\n        elt(\"div\", lineNumberFor(cm.options, lineN),\n            \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n            (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n    if (markers) { for (var k = 0; k < cm.options.gutters.length; ++k) {\n      var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n      if (found)\n        { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                   (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n    } }\n  }\n}\n\nfunction updateLineWidgets(cm, lineView, dims) {\n  if (lineView.alignable) { lineView.alignable = null; }\n  for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n    next = node.nextSibling;\n    if (node.className == \"CodeMirror-linewidget\")\n      { lineView.node.removeChild(node); }\n  }\n  insertLineWidgets(cm, lineView, dims);\n}\n\n// Build a line's DOM representation from scratch\nfunction buildLineElement(cm, lineView, lineN, dims) {\n  var built = getLineContent(cm, lineView);\n  lineView.text = lineView.node = built.pre;\n  if (built.bgClass) { lineView.bgClass = built.bgClass; }\n  if (built.textClass) { lineView.textClass = built.textClass; }\n\n  updateLineClasses(cm, lineView);\n  updateLineGutter(cm, lineView, lineN, dims);\n  insertLineWidgets(cm, lineView, dims);\n  return lineView.node\n}\n\n// A lineView may contain multiple logical lines (when merged by\n// collapsed spans). The widgets for all of them need to be drawn.\nfunction insertLineWidgets(cm, lineView, dims) {\n  insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n  if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n    { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n}\n\nfunction insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n  if (!line.widgets) { return }\n  var wrap = ensureLineWrapped(lineView);\n  for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n    var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n    if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n    positionLineWidget(widget, node, lineView, dims);\n    cm.display.input.setUneditable(node);\n    if (allowAbove && widget.above)\n      { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n    else\n      { wrap.appendChild(node); }\n    signalLater(widget, \"redraw\");\n  }\n}\n\nfunction positionLineWidget(widget, node, lineView, dims) {\n  if (widget.noHScroll) {\n    (lineView.alignable || (lineView.alignable = [])).push(node);\n    var width = dims.wrapperWidth;\n    node.style.left = dims.fixedPos + \"px\";\n    if (!widget.coverGutter) {\n      width -= dims.gutterTotalWidth;\n      node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n    }\n    node.style.width = width + \"px\";\n  }\n  if (widget.coverGutter) {\n    node.style.zIndex = 5;\n    node.style.position = \"relative\";\n    if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n  }\n}\n\nfunction widgetHeight(widget) {\n  if (widget.height != null) { return widget.height }\n  var cm = widget.doc.cm;\n  if (!cm) { return 0 }\n  if (!contains(document.body, widget.node)) {\n    var parentStyle = \"position: relative;\";\n    if (widget.coverGutter)\n      { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n    if (widget.noHScroll)\n      { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n    removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n  }\n  return widget.height = widget.node.parentNode.offsetHeight\n}\n\n// Return true when the given mouse event happened in a widget\nfunction eventInWidget(display, e) {\n  for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n    if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n        (n.parentNode == display.sizer && n != display.mover))\n      { return true }\n  }\n}\n\n// POSITION MEASUREMENT\n\nfunction paddingTop(display) {return display.lineSpace.offsetTop}\nfunction paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\nfunction paddingH(display) {\n  if (display.cachedPaddingH) { return display.cachedPaddingH }\n  var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n  var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n  var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n  if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n  return data\n}\n\nfunction scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\nfunction displayWidth(cm) {\n  return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n}\nfunction displayHeight(cm) {\n  return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n}\n\n// Ensure the lineView.wrapping.heights array is populated. This is\n// an array of bottom offsets for the lines that make up a drawn\n// line. When lineWrapping is on, there might be more than one\n// height.\nfunction ensureLineHeights(cm, lineView, rect) {\n  var wrapping = cm.options.lineWrapping;\n  var curWidth = wrapping && displayWidth(cm);\n  if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n    var heights = lineView.measure.heights = [];\n    if (wrapping) {\n      lineView.measure.width = curWidth;\n      var rects = lineView.text.firstChild.getClientRects();\n      for (var i = 0; i < rects.length - 1; i++) {\n        var cur = rects[i], next = rects[i + 1];\n        if (Math.abs(cur.bottom - next.bottom) > 2)\n          { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n      }\n    }\n    heights.push(rect.bottom - rect.top);\n  }\n}\n\n// Find a line map (mapping character offsets to text nodes) and a\n// measurement cache for the given line number. (A line view might\n// contain multiple lines when collapsed ranges are present.)\nfunction mapFromLineView(lineView, line, lineN) {\n  if (lineView.line == line)\n    { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n  for (var i = 0; i < lineView.rest.length; i++)\n    { if (lineView.rest[i] == line)\n      { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n  for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n    { if (lineNo(lineView.rest[i$1]) > lineN)\n      { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n}\n\n// Render a line into the hidden node display.externalMeasured. Used\n// when measurement is needed for a line that's not in the viewport.\nfunction updateExternalMeasurement(cm, line) {\n  line = visualLine(line);\n  var lineN = lineNo(line);\n  var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n  view.lineN = lineN;\n  var built = view.built = buildLineContent(cm, view);\n  view.text = built.pre;\n  removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n  return view\n}\n\n// Get a {top, bottom, left, right} box (in line-local coordinates)\n// for a given character.\nfunction measureChar(cm, line, ch, bias) {\n  return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n}\n\n// Find a line view that corresponds to the given line number.\nfunction findViewForLine(cm, lineN) {\n  if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n    { return cm.display.view[findViewIndex(cm, lineN)] }\n  var ext = cm.display.externalMeasured;\n  if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n    { return ext }\n}\n\n// Measurement can be split in two steps, the set-up work that\n// applies to the whole line, and the measurement of the actual\n// character. Functions like coordsChar, that need to do a lot of\n// measurements in a row, can thus ensure that the set-up work is\n// only done once.\nfunction prepareMeasureForLine(cm, line) {\n  var lineN = lineNo(line);\n  var view = findViewForLine(cm, lineN);\n  if (view && !view.text) {\n    view = null;\n  } else if (view && view.changes) {\n    updateLineForChanges(cm, view, lineN, getDimensions(cm));\n    cm.curOp.forceUpdate = true;\n  }\n  if (!view)\n    { view = updateExternalMeasurement(cm, line); }\n\n  var info = mapFromLineView(view, line, lineN);\n  return {\n    line: line, view: view, rect: null,\n    map: info.map, cache: info.cache, before: info.before,\n    hasHeights: false\n  }\n}\n\n// Given a prepared measurement object, measures the position of an\n// actual character (or fetches it from the cache).\nfunction measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n  if (prepared.before) { ch = -1; }\n  var key = ch + (bias || \"\"), found;\n  if (prepared.cache.hasOwnProperty(key)) {\n    found = prepared.cache[key];\n  } else {\n    if (!prepared.rect)\n      { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n    if (!prepared.hasHeights) {\n      ensureLineHeights(cm, prepared.view, prepared.rect);\n      prepared.hasHeights = true;\n    }\n    found = measureCharInner(cm, prepared, ch, bias);\n    if (!found.bogus) { prepared.cache[key] = found; }\n  }\n  return {left: found.left, right: found.right,\n          top: varHeight ? found.rtop : found.top,\n          bottom: varHeight ? found.rbottom : found.bottom}\n}\n\nvar nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\nfunction nodeAndOffsetInLineMap(map$$1, ch, bias) {\n  var node, start, end, collapse, mStart, mEnd;\n  // First, search the line map for the text node corresponding to,\n  // or closest to, the target character.\n  for (var i = 0; i < map$$1.length; i += 3) {\n    mStart = map$$1[i];\n    mEnd = map$$1[i + 1];\n    if (ch < mStart) {\n      start = 0; end = 1;\n      collapse = \"left\";\n    } else if (ch < mEnd) {\n      start = ch - mStart;\n      end = start + 1;\n    } else if (i == map$$1.length - 3 || ch == mEnd && map$$1[i + 3] > ch) {\n      end = mEnd - mStart;\n      start = end - 1;\n      if (ch >= mEnd) { collapse = \"right\"; }\n    }\n    if (start != null) {\n      node = map$$1[i + 2];\n      if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n        { collapse = bias; }\n      if (bias == \"left\" && start == 0)\n        { while (i && map$$1[i - 2] == map$$1[i - 3] && map$$1[i - 1].insertLeft) {\n          node = map$$1[(i -= 3) + 2];\n          collapse = \"left\";\n        } }\n      if (bias == \"right\" && start == mEnd - mStart)\n        { while (i < map$$1.length - 3 && map$$1[i + 3] == map$$1[i + 4] && !map$$1[i + 5].insertLeft) {\n          node = map$$1[(i += 3) + 2];\n          collapse = \"right\";\n        } }\n      break\n    }\n  }\n  return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n}\n\nfunction getUsefulRect(rects, bias) {\n  var rect = nullRect;\n  if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n    if ((rect = rects[i]).left != rect.right) { break }\n  } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n    if ((rect = rects[i$1]).left != rect.right) { break }\n  } }\n  return rect\n}\n\nfunction measureCharInner(cm, prepared, ch, bias) {\n  var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n  var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n  var rect;\n  if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n    for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n      while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n      while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n      if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n        { rect = node.parentNode.getBoundingClientRect(); }\n      else\n        { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n      if (rect.left || rect.right || start == 0) { break }\n      end = start;\n      start = start - 1;\n      collapse = \"right\";\n    }\n    if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n  } else { // If it is a widget, simply get the box for the whole widget.\n    if (start > 0) { collapse = bias = \"right\"; }\n    var rects;\n    if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n      { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n    else\n      { rect = node.getBoundingClientRect(); }\n  }\n  if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n    var rSpan = node.parentNode.getClientRects()[0];\n    if (rSpan)\n      { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n    else\n      { rect = nullRect; }\n  }\n\n  var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n  var mid = (rtop + rbot) / 2;\n  var heights = prepared.view.measure.heights;\n  var i = 0;\n  for (; i < heights.length - 1; i++)\n    { if (mid < heights[i]) { break } }\n  var top = i ? heights[i - 1] : 0, bot = heights[i];\n  var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                top: top, bottom: bot};\n  if (!rect.left && !rect.right) { result.bogus = true; }\n  if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n  return result\n}\n\n// Work around problem with bounding client rects on ranges being\n// returned incorrectly when zoomed on IE10 and below.\nfunction maybeUpdateRectForZooming(measure, rect) {\n  if (!window.screen || screen.logicalXDPI == null ||\n      screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n    { return rect }\n  var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n  var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n  return {left: rect.left * scaleX, right: rect.right * scaleX,\n          top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n}\n\nfunction clearLineMeasurementCacheFor(lineView) {\n  if (lineView.measure) {\n    lineView.measure.cache = {};\n    lineView.measure.heights = null;\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { lineView.measure.caches[i] = {}; } }\n  }\n}\n\nfunction clearLineMeasurementCache(cm) {\n  cm.display.externalMeasure = null;\n  removeChildren(cm.display.lineMeasure);\n  for (var i = 0; i < cm.display.view.length; i++)\n    { clearLineMeasurementCacheFor(cm.display.view[i]); }\n}\n\nfunction clearCaches(cm) {\n  clearLineMeasurementCache(cm);\n  cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n  if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n  cm.display.lineNumChars = null;\n}\n\nfunction pageScrollX() {\n  // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n  // which causes page_Offset and bounding client rects to use\n  // different reference viewports and invalidate our calculations.\n  if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n  return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n}\nfunction pageScrollY() {\n  if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n  return window.pageYOffset || (document.documentElement || document.body).scrollTop\n}\n\nfunction widgetTopHeight(lineObj) {\n  var height = 0;\n  if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n    { height += widgetHeight(lineObj.widgets[i]); } } }\n  return height\n}\n\n// Converts a {top, bottom, left, right} box from line-local\n// coordinates into another coordinate system. Context may be one of\n// \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n// or \"page\".\nfunction intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n  if (!includeWidgets) {\n    var height = widgetTopHeight(lineObj);\n    rect.top += height; rect.bottom += height;\n  }\n  if (context == \"line\") { return rect }\n  if (!context) { context = \"local\"; }\n  var yOff = heightAtLine(lineObj);\n  if (context == \"local\") { yOff += paddingTop(cm.display); }\n  else { yOff -= cm.display.viewOffset; }\n  if (context == \"page\" || context == \"window\") {\n    var lOff = cm.display.lineSpace.getBoundingClientRect();\n    yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n    var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n    rect.left += xOff; rect.right += xOff;\n  }\n  rect.top += yOff; rect.bottom += yOff;\n  return rect\n}\n\n// Coverts a box from \"div\" coords to another coordinate system.\n// Context may be \"window\", \"page\", \"div\", or \"local\"./null.\nfunction fromCoordSystem(cm, coords, context) {\n  if (context == \"div\") { return coords }\n  var left = coords.left, top = coords.top;\n  // First move into \"page\" coordinate system\n  if (context == \"page\") {\n    left -= pageScrollX();\n    top -= pageScrollY();\n  } else if (context == \"local\" || !context) {\n    var localBox = cm.display.sizer.getBoundingClientRect();\n    left += localBox.left;\n    top += localBox.top;\n  }\n\n  var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n  return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n}\n\nfunction charCoords(cm, pos, context, lineObj, bias) {\n  if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n  return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n}\n\n// Returns a box for a given cursor position, which may have an\n// 'other' property containing the position of the secondary cursor\n// on a bidi boundary.\n// A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n// and after `char - 1` in writing order of `char - 1`\n// A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n// and before `char` in writing order of `char`\n// Examples (upper-case letters are RTL, lower-case are LTR):\n//     Pos(0, 1, ...)\n//     before   after\n// ab     a|b     a|b\n// aB     a|B     aB|\n// Ab     |Ab     A|b\n// AB     B|A     B|A\n// Every position after the last character on a line is considered to stick\n// to the last character on the line.\nfunction cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n  lineObj = lineObj || getLine(cm.doc, pos.line);\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n  function get(ch, right) {\n    var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n    if (right) { m.left = m.right; } else { m.right = m.left; }\n    return intoCoordSystem(cm, lineObj, m, context)\n  }\n  var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n  if (ch >= lineObj.text.length) {\n    ch = lineObj.text.length;\n    sticky = \"before\";\n  } else if (ch <= 0) {\n    ch = 0;\n    sticky = \"after\";\n  }\n  if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n  function getBidi(ch, partPos, invert) {\n    var part = order[partPos], right = part.level == 1;\n    return get(invert ? ch - 1 : ch, right != invert)\n  }\n  var partPos = getBidiPartAt(order, ch, sticky);\n  var other = bidiOther;\n  var val = getBidi(ch, partPos, sticky == \"before\");\n  if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n  return val\n}\n\n// Used to cheaply estimate the coordinates for a position. Used for\n// intermediate scroll updates.\nfunction estimateCoords(cm, pos) {\n  var left = 0;\n  pos = clipPos(cm.doc, pos);\n  if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n  var lineObj = getLine(cm.doc, pos.line);\n  var top = heightAtLine(lineObj) + paddingTop(cm.display);\n  return {left: left, right: left, top: top, bottom: top + lineObj.height}\n}\n\n// Positions returned by coordsChar contain some extra information.\n// xRel is the relative x position of the input coordinates compared\n// to the found position (so xRel > 0 means the coordinates are to\n// the right of the character position, for example). When outside\n// is true, that means the coordinates lie outside the line's\n// vertical range.\nfunction PosWithInfo(line, ch, sticky, outside, xRel) {\n  var pos = Pos(line, ch, sticky);\n  pos.xRel = xRel;\n  if (outside) { pos.outside = true; }\n  return pos\n}\n\n// Compute the character position closest to the given coordinates.\n// Input must be lineSpace-local (\"div\" coordinate system).\nfunction coordsChar(cm, x, y) {\n  var doc = cm.doc;\n  y += cm.display.viewOffset;\n  if (y < 0) { return PosWithInfo(doc.first, 0, null, true, -1) }\n  var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n  if (lineN > last)\n    { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1) }\n  if (x < 0) { x = 0; }\n\n  var lineObj = getLine(doc, lineN);\n  for (;;) {\n    var found = coordsCharInner(cm, lineObj, lineN, x, y);\n    var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 ? 1 : 0));\n    if (!collapsed) { return found }\n    var rangeEnd = collapsed.find(1);\n    if (rangeEnd.line == lineN) { return rangeEnd }\n    lineObj = getLine(doc, lineN = rangeEnd.line);\n  }\n}\n\nfunction wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n  y -= widgetTopHeight(lineObj);\n  var end = lineObj.text.length;\n  var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n  end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n  return {begin: begin, end: end}\n}\n\nfunction wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n  var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n  return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n}\n\n// Returns true if the given side of a box is after the given\n// coordinates, in top-to-bottom, left-to-right order.\nfunction boxIsAfter(box, x, y, left) {\n  return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n}\n\nfunction coordsCharInner(cm, lineObj, lineNo$$1, x, y) {\n  // Move y into line-local coordinate space\n  y -= heightAtLine(lineObj);\n  var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n  // When directly calling `measureCharPrepared`, we have to adjust\n  // for the widgets at this line.\n  var widgetHeight$$1 = widgetTopHeight(lineObj);\n  var begin = 0, end = lineObj.text.length, ltr = true;\n\n  var order = getOrder(lineObj, cm.doc.direction);\n  // If the line isn't plain left-to-right text, first figure out\n  // which bidi section the coordinates fall into.\n  if (order) {\n    var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                 (cm, lineObj, lineNo$$1, preparedMeasure, order, x, y);\n    ltr = part.level != 1;\n    // The awkward -1 offsets are needed because findFirst (called\n    // on these below) will treat its first bound as inclusive,\n    // second as exclusive, but we want to actually address the\n    // characters in the part's range\n    begin = ltr ? part.from : part.to - 1;\n    end = ltr ? part.to : part.from - 1;\n  }\n\n  // A binary search to find the first character whose bounding box\n  // starts after the coordinates. If we run across any whose box wrap\n  // the coordinates, store that.\n  var chAround = null, boxAround = null;\n  var ch = findFirst(function (ch) {\n    var box = measureCharPrepared(cm, preparedMeasure, ch);\n    box.top += widgetHeight$$1; box.bottom += widgetHeight$$1;\n    if (!boxIsAfter(box, x, y, false)) { return false }\n    if (box.top <= y && box.left <= x) {\n      chAround = ch;\n      boxAround = box;\n    }\n    return true\n  }, begin, end);\n\n  var baseX, sticky, outside = false;\n  // If a box around the coordinates was found, use that\n  if (boxAround) {\n    // Distinguish coordinates nearer to the left or right side of the box\n    var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n    ch = chAround + (atStart ? 0 : 1);\n    sticky = atStart ? \"after\" : \"before\";\n    baseX = atLeft ? boxAround.left : boxAround.right;\n  } else {\n    // (Adjust for extended bound, if necessary.)\n    if (!ltr && (ch == end || ch == begin)) { ch++; }\n    // To determine which side to associate with, get the box to the\n    // left of the character and compare it's vertical position to the\n    // coordinates\n    sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n      (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight$$1 <= y) == ltr ?\n      \"after\" : \"before\";\n    // Now get accurate coordinates for this place, in order to get a\n    // base X position\n    var coords = cursorCoords(cm, Pos(lineNo$$1, ch, sticky), \"line\", lineObj, preparedMeasure);\n    baseX = coords.left;\n    outside = y < coords.top || y >= coords.bottom;\n  }\n\n  ch = skipExtendingChars(lineObj.text, ch, 1);\n  return PosWithInfo(lineNo$$1, ch, sticky, outside, x - baseX)\n}\n\nfunction coordsBidiPart(cm, lineObj, lineNo$$1, preparedMeasure, order, x, y) {\n  // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n  // situation, we can take this ordering to correspond to the visual\n  // ordering. This finds the first part whose end is after the given\n  // coordinates.\n  var index = findFirst(function (i) {\n    var part = order[i], ltr = part.level != 1;\n    return boxIsAfter(cursorCoords(cm, Pos(lineNo$$1, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                   \"line\", lineObj, preparedMeasure), x, y, true)\n  }, 0, order.length - 1);\n  var part = order[index];\n  // If this isn't the first part, the part's start is also after\n  // the coordinates, and the coordinates aren't on the same line as\n  // that start, move one part back.\n  if (index > 0) {\n    var ltr = part.level != 1;\n    var start = cursorCoords(cm, Pos(lineNo$$1, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                             \"line\", lineObj, preparedMeasure);\n    if (boxIsAfter(start, x, y, true) && start.top > y)\n      { part = order[index - 1]; }\n  }\n  return part\n}\n\nfunction coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n  // In a wrapped line, rtl text on wrapping boundaries can do things\n  // that don't correspond to the ordering in our `order` array at\n  // all, so a binary search doesn't work, and we want to return a\n  // part that only spans one line so that the binary search in\n  // coordsCharInner is safe. As such, we first find the extent of the\n  // wrapped line, and then do a flat search in which we discard any\n  // spans that aren't on the line.\n  var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n  var begin = ref.begin;\n  var end = ref.end;\n  if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n  var part = null, closestDist = null;\n  for (var i = 0; i < order.length; i++) {\n    var p = order[i];\n    if (p.from >= end || p.to <= begin) { continue }\n    var ltr = p.level != 1;\n    var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n    // Weigh against spans ending before this, so that they are only\n    // picked if nothing ends after\n    var dist = endX < x ? x - endX + 1e9 : endX - x;\n    if (!part || closestDist > dist) {\n      part = p;\n      closestDist = dist;\n    }\n  }\n  if (!part) { part = order[order.length - 1]; }\n  // Clip the part to the wrapped line.\n  if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n  if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n  return part\n}\n\nvar measureText;\n// Compute the default text height.\nfunction textHeight(display) {\n  if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n  if (measureText == null) {\n    measureText = elt(\"pre\");\n    // Measure a bunch of lines, for browsers that compute\n    // fractional heights.\n    for (var i = 0; i < 49; ++i) {\n      measureText.appendChild(document.createTextNode(\"x\"));\n      measureText.appendChild(elt(\"br\"));\n    }\n    measureText.appendChild(document.createTextNode(\"x\"));\n  }\n  removeChildrenAndAdd(display.measure, measureText);\n  var height = measureText.offsetHeight / 50;\n  if (height > 3) { display.cachedTextHeight = height; }\n  removeChildren(display.measure);\n  return height || 1\n}\n\n// Compute the default character width.\nfunction charWidth(display) {\n  if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n  var anchor = elt(\"span\", \"xxxxxxxxxx\");\n  var pre = elt(\"pre\", [anchor]);\n  removeChildrenAndAdd(display.measure, pre);\n  var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n  if (width > 2) { display.cachedCharWidth = width; }\n  return width || 10\n}\n\n// Do a bulk-read of the DOM positions and sizes needed to draw the\n// view, so that we don't interleave reading and writing to the DOM.\nfunction getDimensions(cm) {\n  var d = cm.display, left = {}, width = {};\n  var gutterLeft = d.gutters.clientLeft;\n  for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n    left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n    width[cm.options.gutters[i]] = n.clientWidth;\n  }\n  return {fixedPos: compensateForHScroll(d),\n          gutterTotalWidth: d.gutters.offsetWidth,\n          gutterLeft: left,\n          gutterWidth: width,\n          wrapperWidth: d.wrapper.clientWidth}\n}\n\n// Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n// but using getBoundingClientRect to get a sub-pixel-accurate\n// result.\nfunction compensateForHScroll(display) {\n  return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n}\n\n// Returns a function that estimates the height of a line, to use as\n// first approximation until the line becomes visible (and is thus\n// properly measurable).\nfunction estimateHeight(cm) {\n  var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n  var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n  return function (line) {\n    if (lineIsHidden(cm.doc, line)) { return 0 }\n\n    var widgetsHeight = 0;\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n      if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n    } }\n\n    if (wrapping)\n      { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n    else\n      { return widgetsHeight + th }\n  }\n}\n\nfunction estimateLineHeights(cm) {\n  var doc = cm.doc, est = estimateHeight(cm);\n  doc.iter(function (line) {\n    var estHeight = est(line);\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  });\n}\n\n// Given a mouse event, find the corresponding position. If liberal\n// is false, it checks whether a gutter or scrollbar was clicked,\n// and returns null if it was. forRect is used by rectangular\n// selections, and tries to estimate a character position even for\n// coordinates beyond the right of the text.\nfunction posFromMouse(cm, e, liberal, forRect) {\n  var display = cm.display;\n  if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n  var x, y, space = display.lineSpace.getBoundingClientRect();\n  // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n  try { x = e.clientX - space.left; y = e.clientY - space.top; }\n  catch (e) { return null }\n  var coords = coordsChar(cm, x, y), line;\n  if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n    var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n    coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n  }\n  return coords\n}\n\n// Find the view element corresponding to a given line. Return null\n// when the line isn't visible.\nfunction findViewIndex(cm, n) {\n  if (n >= cm.display.viewTo) { return null }\n  n -= cm.display.viewFrom;\n  if (n < 0) { return null }\n  var view = cm.display.view;\n  for (var i = 0; i < view.length; i++) {\n    n -= view[i].size;\n    if (n < 0) { return i }\n  }\n}\n\nfunction updateSelection(cm) {\n  cm.display.input.showSelection(cm.display.input.prepareSelection());\n}\n\nfunction prepareSelection(cm, primary) {\n  if ( primary === void 0 ) primary = true;\n\n  var doc = cm.doc, result = {};\n  var curFragment = result.cursors = document.createDocumentFragment();\n  var selFragment = result.selection = document.createDocumentFragment();\n\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    if (!primary && i == doc.sel.primIndex) { continue }\n    var range$$1 = doc.sel.ranges[i];\n    if (range$$1.from().line >= cm.display.viewTo || range$$1.to().line < cm.display.viewFrom) { continue }\n    var collapsed = range$$1.empty();\n    if (collapsed || cm.options.showCursorWhenSelecting)\n      { drawSelectionCursor(cm, range$$1.head, curFragment); }\n    if (!collapsed)\n      { drawSelectionRange(cm, range$$1, selFragment); }\n  }\n  return result\n}\n\n// Draws a cursor for the given range\nfunction drawSelectionCursor(cm, head, output) {\n  var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n  var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n  cursor.style.left = pos.left + \"px\";\n  cursor.style.top = pos.top + \"px\";\n  cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n  if (pos.other) {\n    // Secondary cursor, shown when on a 'jump' in bi-directional text\n    var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n    otherCursor.style.display = \"\";\n    otherCursor.style.left = pos.other.left + \"px\";\n    otherCursor.style.top = pos.other.top + \"px\";\n    otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n  }\n}\n\nfunction cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n// Draws the given range as a highlighted selection\nfunction drawSelectionRange(cm, range$$1, output) {\n  var display = cm.display, doc = cm.doc;\n  var fragment = document.createDocumentFragment();\n  var padding = paddingH(cm.display), leftSide = padding.left;\n  var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n  var docLTR = doc.direction == \"ltr\";\n\n  function add(left, top, width, bottom) {\n    if (top < 0) { top = 0; }\n    top = Math.round(top);\n    bottom = Math.round(bottom);\n    fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n  }\n\n  function drawForLine(line, fromArg, toArg) {\n    var lineObj = getLine(doc, line);\n    var lineLen = lineObj.text.length;\n    var start, end;\n    function coords(ch, bias) {\n      return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n    }\n\n    function wrapX(pos, dir, side) {\n      var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n      var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n      var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n      return coords(ch, prop)[prop]\n    }\n\n    var order = getOrder(lineObj, doc.direction);\n    iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n      var ltr = dir == \"ltr\";\n      var fromPos = coords(from, ltr ? \"left\" : \"right\");\n      var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n      var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n      var first = i == 0, last = !order || i == order.length - 1;\n      if (toPos.top - fromPos.top <= 3) { // Single line\n        var openLeft = (docLTR ? openStart : openEnd) && first;\n        var openRight = (docLTR ? openEnd : openStart) && last;\n        var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n        var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n        add(left, fromPos.top, right - left, fromPos.bottom);\n      } else { // Multiple lines\n        var topLeft, topRight, botLeft, botRight;\n        if (ltr) {\n          topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n          topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n          botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n          botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n        } else {\n          topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n          topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n          botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n          botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n        }\n        add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n        if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n        add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n      }\n\n      if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n      if (cmpCoords(toPos, start) < 0) { start = toPos; }\n      if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n      if (cmpCoords(toPos, end) < 0) { end = toPos; }\n    });\n    return {start: start, end: end}\n  }\n\n  var sFrom = range$$1.from(), sTo = range$$1.to();\n  if (sFrom.line == sTo.line) {\n    drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n  } else {\n    var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n    var singleVLine = visualLine(fromLine) == visualLine(toLine);\n    var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n    var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n    if (singleVLine) {\n      if (leftEnd.top < rightStart.top - 2) {\n        add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n        add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n      } else {\n        add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n      }\n    }\n    if (leftEnd.bottom < rightStart.top)\n      { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n  }\n\n  output.appendChild(fragment);\n}\n\n// Cursor-blinking\nfunction restartBlink(cm) {\n  if (!cm.state.focused) { return }\n  var display = cm.display;\n  clearInterval(display.blinker);\n  var on = true;\n  display.cursorDiv.style.visibility = \"\";\n  if (cm.options.cursorBlinkRate > 0)\n    { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n      cm.options.cursorBlinkRate); }\n  else if (cm.options.cursorBlinkRate < 0)\n    { display.cursorDiv.style.visibility = \"hidden\"; }\n}\n\nfunction ensureFocus(cm) {\n  if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n}\n\nfunction delayBlurEvent(cm) {\n  cm.state.delayingBlurEvent = true;\n  setTimeout(function () { if (cm.state.delayingBlurEvent) {\n    cm.state.delayingBlurEvent = false;\n    onBlur(cm);\n  } }, 100);\n}\n\nfunction onFocus(cm, e) {\n  if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n  if (cm.options.readOnly == \"nocursor\") { return }\n  if (!cm.state.focused) {\n    signal(cm, \"focus\", cm, e);\n    cm.state.focused = true;\n    addClass(cm.display.wrapper, \"CodeMirror-focused\");\n    // This test prevents this from firing when a context\n    // menu is closed (since the input reset would kill the\n    // select-all detection hack)\n    if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n      cm.display.input.reset();\n      if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n    }\n    cm.display.input.receivedFocus();\n  }\n  restartBlink(cm);\n}\nfunction onBlur(cm, e) {\n  if (cm.state.delayingBlurEvent) { return }\n\n  if (cm.state.focused) {\n    signal(cm, \"blur\", cm, e);\n    cm.state.focused = false;\n    rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n  }\n  clearInterval(cm.display.blinker);\n  setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n}\n\n// Read the actual heights of the rendered lines, and update their\n// stored heights to match.\nfunction updateHeightsInViewport(cm) {\n  var display = cm.display;\n  var prevBottom = display.lineDiv.offsetTop;\n  for (var i = 0; i < display.view.length; i++) {\n    var cur = display.view[i], height = (void 0);\n    if (cur.hidden) { continue }\n    if (ie && ie_version < 8) {\n      var bot = cur.node.offsetTop + cur.node.offsetHeight;\n      height = bot - prevBottom;\n      prevBottom = bot;\n    } else {\n      var box = cur.node.getBoundingClientRect();\n      height = box.bottom - box.top;\n    }\n    var diff = cur.line.height - height;\n    if (height < 2) { height = textHeight(display); }\n    if (diff > .005 || diff < -.005) {\n      updateLineHeight(cur.line, height);\n      updateWidgetHeight(cur.line);\n      if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n        { updateWidgetHeight(cur.rest[j]); } }\n    }\n  }\n}\n\n// Read and store the height of line widgets associated with the\n// given line.\nfunction updateWidgetHeight(line) {\n  if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n    var w = line.widgets[i], parent = w.node.parentNode;\n    if (parent) { w.height = parent.offsetHeight; }\n  } }\n}\n\n// Compute the lines that are visible in a given viewport (defaults\n// the the current scroll position). viewport may contain top,\n// height, and ensure (see op.scrollToPos) properties.\nfunction visibleLines(display, doc, viewport) {\n  var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n  top = Math.floor(top - paddingTop(display));\n  var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n  var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n  // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n  // forces those lines into the viewport (if possible).\n  if (viewport && viewport.ensure) {\n    var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n    if (ensureFrom < from) {\n      from = ensureFrom;\n      to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n    } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n      from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n      to = ensureTo;\n    }\n  }\n  return {from: from, to: Math.max(to, from + 1)}\n}\n\n// Re-align line numbers and gutter marks to compensate for\n// horizontal scrolling.\nfunction alignHorizontally(cm) {\n  var display = cm.display, view = display.view;\n  if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n  var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n  var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n  for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n    if (cm.options.fixedGutter) {\n      if (view[i].gutter)\n        { view[i].gutter.style.left = left; }\n      if (view[i].gutterBackground)\n        { view[i].gutterBackground.style.left = left; }\n    }\n    var align = view[i].alignable;\n    if (align) { for (var j = 0; j < align.length; j++)\n      { align[j].style.left = left; } }\n  } }\n  if (cm.options.fixedGutter)\n    { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n}\n\n// Used to ensure that the line number gutter is still the right\n// size for the current document size. Returns true when an update\n// is needed.\nfunction maybeUpdateLineNumberWidth(cm) {\n  if (!cm.options.lineNumbers) { return false }\n  var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n  if (last.length != display.lineNumChars) {\n    var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                               \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n    var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n    display.lineGutter.style.width = \"\";\n    display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n    display.lineNumWidth = display.lineNumInnerWidth + padding;\n    display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n    display.lineGutter.style.width = display.lineNumWidth + \"px\";\n    updateGutterSpace(cm);\n    return true\n  }\n  return false\n}\n\n// SCROLLING THINGS INTO VIEW\n\n// If an editor sits on the top or bottom of the window, partially\n// scrolled out of view, this ensures that the cursor is visible.\nfunction maybeScrollWindow(cm, rect) {\n  if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n  var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n  if (rect.top + box.top < 0) { doScroll = true; }\n  else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n  if (doScroll != null && !phantom) {\n    var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n    cm.display.lineSpace.appendChild(scrollNode);\n    scrollNode.scrollIntoView(doScroll);\n    cm.display.lineSpace.removeChild(scrollNode);\n  }\n}\n\n// Scroll a given position into view (immediately), verifying that\n// it actually became visible (as line heights are accurately\n// measured, the position of something may 'drift' during drawing).\nfunction scrollPosIntoView(cm, pos, end, margin) {\n  if (margin == null) { margin = 0; }\n  var rect;\n  if (!cm.options.lineWrapping && pos == end) {\n    // Set pos and end to the cursor positions around the character pos sticks to\n    // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n    // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n    pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n    end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n  }\n  for (var limit = 0; limit < 5; limit++) {\n    var changed = false;\n    var coords = cursorCoords(cm, pos);\n    var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n    rect = {left: Math.min(coords.left, endCoords.left),\n            top: Math.min(coords.top, endCoords.top) - margin,\n            right: Math.max(coords.left, endCoords.left),\n            bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n    var scrollPos = calculateScrollPos(cm, rect);\n    var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n    if (scrollPos.scrollTop != null) {\n      updateScrollTop(cm, scrollPos.scrollTop);\n      if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n    }\n    if (scrollPos.scrollLeft != null) {\n      setScrollLeft(cm, scrollPos.scrollLeft);\n      if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n    }\n    if (!changed) { break }\n  }\n  return rect\n}\n\n// Scroll a given set of coordinates into view (immediately).\nfunction scrollIntoView(cm, rect) {\n  var scrollPos = calculateScrollPos(cm, rect);\n  if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n  if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n}\n\n// Calculate a new scroll position needed to scroll the given\n// rectangle into view. Returns an object with scrollTop and\n// scrollLeft properties. When these are undefined, the\n// vertical/horizontal position does not need to be adjusted.\nfunction calculateScrollPos(cm, rect) {\n  var display = cm.display, snapMargin = textHeight(cm.display);\n  if (rect.top < 0) { rect.top = 0; }\n  var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n  var screen = displayHeight(cm), result = {};\n  if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n  var docBottom = cm.doc.height + paddingVert(display);\n  var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n  if (rect.top < screentop) {\n    result.scrollTop = atTop ? 0 : rect.top;\n  } else if (rect.bottom > screentop + screen) {\n    var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n    if (newTop != screentop) { result.scrollTop = newTop; }\n  }\n\n  var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n  var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n  var tooWide = rect.right - rect.left > screenw;\n  if (tooWide) { rect.right = rect.left + screenw; }\n  if (rect.left < 10)\n    { result.scrollLeft = 0; }\n  else if (rect.left < screenleft)\n    { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n  else if (rect.right > screenw + screenleft - 3)\n    { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n  return result\n}\n\n// Store a relative adjustment to the scroll position in the current\n// operation (to be applied when the operation finishes).\nfunction addToScrollTop(cm, top) {\n  if (top == null) { return }\n  resolveScrollToPos(cm);\n  cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n}\n\n// Make sure that at the end of the operation the current cursor is\n// shown.\nfunction ensureCursorVisible(cm) {\n  resolveScrollToPos(cm);\n  var cur = cm.getCursor();\n  cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n}\n\nfunction scrollToCoords(cm, x, y) {\n  if (x != null || y != null) { resolveScrollToPos(cm); }\n  if (x != null) { cm.curOp.scrollLeft = x; }\n  if (y != null) { cm.curOp.scrollTop = y; }\n}\n\nfunction scrollToRange(cm, range$$1) {\n  resolveScrollToPos(cm);\n  cm.curOp.scrollToPos = range$$1;\n}\n\n// When an operation has its scrollToPos property set, and another\n// scroll action is applied before the end of the operation, this\n// 'simulates' scrolling that position into view in a cheap way, so\n// that the effect of intermediate scroll commands is not ignored.\nfunction resolveScrollToPos(cm) {\n  var range$$1 = cm.curOp.scrollToPos;\n  if (range$$1) {\n    cm.curOp.scrollToPos = null;\n    var from = estimateCoords(cm, range$$1.from), to = estimateCoords(cm, range$$1.to);\n    scrollToCoordsRange(cm, from, to, range$$1.margin);\n  }\n}\n\nfunction scrollToCoordsRange(cm, from, to, margin) {\n  var sPos = calculateScrollPos(cm, {\n    left: Math.min(from.left, to.left),\n    top: Math.min(from.top, to.top) - margin,\n    right: Math.max(from.right, to.right),\n    bottom: Math.max(from.bottom, to.bottom) + margin\n  });\n  scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n}\n\n// Sync the scrollable area and scrollbars, ensure the viewport\n// covers the visible area.\nfunction updateScrollTop(cm, val) {\n  if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n  if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n  setScrollTop(cm, val, true);\n  if (gecko) { updateDisplaySimple(cm); }\n  startWorker(cm, 100);\n}\n\nfunction setScrollTop(cm, val, forceScroll) {\n  val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n  if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n  cm.doc.scrollTop = val;\n  cm.display.scrollbars.setScrollTop(val);\n  if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n}\n\n// Sync scroller and scrollbar, ensure the gutter elements are\n// aligned.\nfunction setScrollLeft(cm, val, isScroller, forceScroll) {\n  val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n  if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n  cm.doc.scrollLeft = val;\n  alignHorizontally(cm);\n  if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n  cm.display.scrollbars.setScrollLeft(val);\n}\n\n// SCROLLBARS\n\n// Prepare DOM reads needed to update the scrollbars. Done in one\n// shot to minimize update/measure roundtrips.\nfunction measureForScrollbars(cm) {\n  var d = cm.display, gutterW = d.gutters.offsetWidth;\n  var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n  return {\n    clientHeight: d.scroller.clientHeight,\n    viewHeight: d.wrapper.clientHeight,\n    scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n    viewWidth: d.wrapper.clientWidth,\n    barLeft: cm.options.fixedGutter ? gutterW : 0,\n    docHeight: docH,\n    scrollHeight: docH + scrollGap(cm) + d.barHeight,\n    nativeBarWidth: d.nativeBarWidth,\n    gutterWidth: gutterW\n  }\n}\n\nvar NativeScrollbars = function(place, scroll, cm) {\n  this.cm = cm;\n  var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n  var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n  vert.tabIndex = horiz.tabIndex = -1;\n  place(vert); place(horiz);\n\n  on(vert, \"scroll\", function () {\n    if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n  });\n  on(horiz, \"scroll\", function () {\n    if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n  });\n\n  this.checkedZeroWidth = false;\n  // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n  if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n};\n\nNativeScrollbars.prototype.update = function (measure) {\n  var needsH = measure.scrollWidth > measure.clientWidth + 1;\n  var needsV = measure.scrollHeight > measure.clientHeight + 1;\n  var sWidth = measure.nativeBarWidth;\n\n  if (needsV) {\n    this.vert.style.display = \"block\";\n    this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n    var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n    // A bug in IE8 can cause this value to be negative, so guard it.\n    this.vert.firstChild.style.height =\n      Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n  } else {\n    this.vert.style.display = \"\";\n    this.vert.firstChild.style.height = \"0\";\n  }\n\n  if (needsH) {\n    this.horiz.style.display = \"block\";\n    this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n    this.horiz.style.left = measure.barLeft + \"px\";\n    var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n    this.horiz.firstChild.style.width =\n      Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n  } else {\n    this.horiz.style.display = \"\";\n    this.horiz.firstChild.style.width = \"0\";\n  }\n\n  if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n    if (sWidth == 0) { this.zeroWidthHack(); }\n    this.checkedZeroWidth = true;\n  }\n\n  return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n};\n\nNativeScrollbars.prototype.setScrollLeft = function (pos) {\n  if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n  if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n};\n\nNativeScrollbars.prototype.setScrollTop = function (pos) {\n  if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n  if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n};\n\nNativeScrollbars.prototype.zeroWidthHack = function () {\n  var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n  this.horiz.style.height = this.vert.style.width = w;\n  this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n  this.disableHoriz = new Delayed;\n  this.disableVert = new Delayed;\n};\n\nNativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n  bar.style.pointerEvents = \"auto\";\n  function maybeDisable() {\n    // To find out whether the scrollbar is still visible, we\n    // check whether the element under the pixel in the bottom\n    // right corner of the scrollbar box is the scrollbar box\n    // itself (when the bar is still visible) or its filler child\n    // (when the bar is hidden). If it is still visible, we keep\n    // it enabled, if it's hidden, we disable pointer events.\n    var box = bar.getBoundingClientRect();\n    var elt$$1 = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n        : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n    if (elt$$1 != bar) { bar.style.pointerEvents = \"none\"; }\n    else { delay.set(1000, maybeDisable); }\n  }\n  delay.set(1000, maybeDisable);\n};\n\nNativeScrollbars.prototype.clear = function () {\n  var parent = this.horiz.parentNode;\n  parent.removeChild(this.horiz);\n  parent.removeChild(this.vert);\n};\n\nvar NullScrollbars = function () {};\n\nNullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\nNullScrollbars.prototype.setScrollLeft = function () {};\nNullScrollbars.prototype.setScrollTop = function () {};\nNullScrollbars.prototype.clear = function () {};\n\nfunction updateScrollbars(cm, measure) {\n  if (!measure) { measure = measureForScrollbars(cm); }\n  var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n  updateScrollbarsInner(cm, measure);\n  for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n    if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n      { updateHeightsInViewport(cm); }\n    updateScrollbarsInner(cm, measureForScrollbars(cm));\n    startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n  }\n}\n\n// Re-synchronize the fake scrollbars with the actual size of the\n// content.\nfunction updateScrollbarsInner(cm, measure) {\n  var d = cm.display;\n  var sizes = d.scrollbars.update(measure);\n\n  d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n  d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n  d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n  if (sizes.right && sizes.bottom) {\n    d.scrollbarFiller.style.display = \"block\";\n    d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n    d.scrollbarFiller.style.width = sizes.right + \"px\";\n  } else { d.scrollbarFiller.style.display = \"\"; }\n  if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n    d.gutterFiller.style.display = \"block\";\n    d.gutterFiller.style.height = sizes.bottom + \"px\";\n    d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n  } else { d.gutterFiller.style.display = \"\"; }\n}\n\nvar scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\nfunction initScrollbars(cm) {\n  if (cm.display.scrollbars) {\n    cm.display.scrollbars.clear();\n    if (cm.display.scrollbars.addClass)\n      { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n    cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n    // Prevent clicks in the scrollbars from killing focus\n    on(node, \"mousedown\", function () {\n      if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n    });\n    node.setAttribute(\"cm-not-content\", \"true\");\n  }, function (pos, axis) {\n    if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n    else { updateScrollTop(cm, pos); }\n  }, cm);\n  if (cm.display.scrollbars.addClass)\n    { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n}\n\n// Operations are used to wrap a series of changes to the editor\n// state in such a way that each change won't have to update the\n// cursor and display (which would be awkward, slow, and\n// error-prone). Instead, display updates are batched and then all\n// combined and executed at once.\n\nvar nextOpId = 0;\n// Start a new operation.\nfunction startOperation(cm) {\n  cm.curOp = {\n    cm: cm,\n    viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n    startHeight: cm.doc.height, // Used to detect need to update scrollbar\n    forceUpdate: false,      // Used to force a redraw\n    updateInput: null,       // Whether to reset the input textarea\n    typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n    changeObjs: null,        // Accumulated changes, for firing change events\n    cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n    cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n    selectionChanged: false, // Whether the selection needs to be redrawn\n    updateMaxLine: false,    // Set when the widest line needs to be determined anew\n    scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n    scrollToPos: null,       // Used to scroll to a specific position\n    focus: false,\n    id: ++nextOpId           // Unique ID\n  };\n  pushOperation(cm.curOp);\n}\n\n// Finish an operation, updating the display and signalling delayed events\nfunction endOperation(cm) {\n  var op = cm.curOp;\n  finishOperation(op, function (group) {\n    for (var i = 0; i < group.ops.length; i++)\n      { group.ops[i].cm.curOp = null; }\n    endOperations(group);\n  });\n}\n\n// The DOM updates done when an operation finishes are batched so\n// that the minimum number of relayouts are required.\nfunction endOperations(group) {\n  var ops = group.ops;\n  for (var i = 0; i < ops.length; i++) // Read DOM\n    { endOperation_R1(ops[i]); }\n  for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n    { endOperation_W1(ops[i$1]); }\n  for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n    { endOperation_R2(ops[i$2]); }\n  for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n    { endOperation_W2(ops[i$3]); }\n  for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n    { endOperation_finish(ops[i$4]); }\n}\n\nfunction endOperation_R1(op) {\n  var cm = op.cm, display = cm.display;\n  maybeClipScrollbars(cm);\n  if (op.updateMaxLine) { findMaxLine(cm); }\n\n  op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n    op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                       op.scrollToPos.to.line >= display.viewTo) ||\n    display.maxLineChanged && cm.options.lineWrapping;\n  op.update = op.mustUpdate &&\n    new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n}\n\nfunction endOperation_W1(op) {\n  op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n}\n\nfunction endOperation_R2(op) {\n  var cm = op.cm, display = cm.display;\n  if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n  op.barMeasure = measureForScrollbars(cm);\n\n  // If the max line changed since it was last measured, measure it,\n  // and ensure the document's width matches it.\n  // updateDisplay_W2 will use these properties to do the actual resizing\n  if (display.maxLineChanged && !cm.options.lineWrapping) {\n    op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n    cm.display.sizerWidth = op.adjustWidthTo;\n    op.barMeasure.scrollWidth =\n      Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n    op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n  }\n\n  if (op.updatedDisplay || op.selectionChanged)\n    { op.preparedSelection = display.input.prepareSelection(); }\n}\n\nfunction endOperation_W2(op) {\n  var cm = op.cm;\n\n  if (op.adjustWidthTo != null) {\n    cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n    if (op.maxScrollLeft < cm.doc.scrollLeft)\n      { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n    cm.display.maxLineChanged = false;\n  }\n\n  var takeFocus = op.focus && op.focus == activeElt();\n  if (op.preparedSelection)\n    { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n  if (op.updatedDisplay || op.startHeight != cm.doc.height)\n    { updateScrollbars(cm, op.barMeasure); }\n  if (op.updatedDisplay)\n    { setDocumentHeight(cm, op.barMeasure); }\n\n  if (op.selectionChanged) { restartBlink(cm); }\n\n  if (cm.state.focused && op.updateInput)\n    { cm.display.input.reset(op.typing); }\n  if (takeFocus) { ensureFocus(op.cm); }\n}\n\nfunction endOperation_finish(op) {\n  var cm = op.cm, display = cm.display, doc = cm.doc;\n\n  if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n  // Abort mouse wheel delta measurement, when scrolling explicitly\n  if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n    { display.wheelStartX = display.wheelStartY = null; }\n\n  // Propagate the scroll position to the actual DOM scroller\n  if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n  if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n  // If we need to scroll a specific position into view, do so.\n  if (op.scrollToPos) {\n    var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                 clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n    maybeScrollWindow(cm, rect);\n  }\n\n  // Fire events for markers that are hidden/unidden by editing or\n  // undoing\n  var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n  if (hidden) { for (var i = 0; i < hidden.length; ++i)\n    { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n  if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n    { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n  if (display.wrapper.offsetHeight)\n    { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n  // Fire change events, and delayed event handlers\n  if (op.changeObjs)\n    { signal(cm, \"changes\", cm, op.changeObjs); }\n  if (op.update)\n    { op.update.finish(); }\n}\n\n// Run the given function in an operation\nfunction runInOp(cm, f) {\n  if (cm.curOp) { return f() }\n  startOperation(cm);\n  try { return f() }\n  finally { endOperation(cm); }\n}\n// Wraps a function in an operation. Returns the wrapped function.\nfunction operation(cm, f) {\n  return function() {\n    if (cm.curOp) { return f.apply(cm, arguments) }\n    startOperation(cm);\n    try { return f.apply(cm, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n// Used to add methods to editor and doc instances, wrapping them in\n// operations.\nfunction methodOp(f) {\n  return function() {\n    if (this.curOp) { return f.apply(this, arguments) }\n    startOperation(this);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(this); }\n  }\n}\nfunction docMethodOp(f) {\n  return function() {\n    var cm = this.cm;\n    if (!cm || cm.curOp) { return f.apply(this, arguments) }\n    startOperation(cm);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n\n// Updates the display.view data structure for a given change to the\n// document. From and to are in pre-change coordinates. Lendiff is\n// the amount of lines added or subtracted by the change. This is\n// used for changes that span multiple lines, or change the way\n// lines are divided into visual lines. regLineChange (below)\n// registers single-line changes.\nfunction regChange(cm, from, to, lendiff) {\n  if (from == null) { from = cm.doc.first; }\n  if (to == null) { to = cm.doc.first + cm.doc.size; }\n  if (!lendiff) { lendiff = 0; }\n\n  var display = cm.display;\n  if (lendiff && to < display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers > from))\n    { display.updateLineNumbers = from; }\n\n  cm.curOp.viewChanged = true;\n\n  if (from >= display.viewTo) { // Change after\n    if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n      { resetView(cm); }\n  } else if (to <= display.viewFrom) { // Change before\n    if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n      resetView(cm);\n    } else {\n      display.viewFrom += lendiff;\n      display.viewTo += lendiff;\n    }\n  } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n    resetView(cm);\n  } else if (from <= display.viewFrom) { // Top overlap\n    var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cut) {\n      display.view = display.view.slice(cut.index);\n      display.viewFrom = cut.lineN;\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  } else if (to >= display.viewTo) { // Bottom overlap\n    var cut$1 = viewCuttingPoint(cm, from, from, -1);\n    if (cut$1) {\n      display.view = display.view.slice(0, cut$1.index);\n      display.viewTo = cut$1.lineN;\n    } else {\n      resetView(cm);\n    }\n  } else { // Gap in the middle\n    var cutTop = viewCuttingPoint(cm, from, from, -1);\n    var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cutTop && cutBot) {\n      display.view = display.view.slice(0, cutTop.index)\n        .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n        .concat(display.view.slice(cutBot.index));\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  }\n\n  var ext = display.externalMeasured;\n  if (ext) {\n    if (to < ext.lineN)\n      { ext.lineN += lendiff; }\n    else if (from < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n  }\n}\n\n// Register a change to a single line. Type must be one of \"text\",\n// \"gutter\", \"class\", \"widget\"\nfunction regLineChange(cm, line, type) {\n  cm.curOp.viewChanged = true;\n  var display = cm.display, ext = cm.display.externalMeasured;\n  if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n    { display.externalMeasured = null; }\n\n  if (line < display.viewFrom || line >= display.viewTo) { return }\n  var lineView = display.view[findViewIndex(cm, line)];\n  if (lineView.node == null) { return }\n  var arr = lineView.changes || (lineView.changes = []);\n  if (indexOf(arr, type) == -1) { arr.push(type); }\n}\n\n// Clear the view.\nfunction resetView(cm) {\n  cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n  cm.display.view = [];\n  cm.display.viewOffset = 0;\n}\n\nfunction viewCuttingPoint(cm, oldN, newN, dir) {\n  var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n  if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n    { return {index: index, lineN: newN} }\n  var n = cm.display.viewFrom;\n  for (var i = 0; i < index; i++)\n    { n += view[i].size; }\n  if (n != oldN) {\n    if (dir > 0) {\n      if (index == view.length - 1) { return null }\n      diff = (n + view[index].size) - oldN;\n      index++;\n    } else {\n      diff = n - oldN;\n    }\n    oldN += diff; newN += diff;\n  }\n  while (visualLineNo(cm.doc, newN) != newN) {\n    if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n    newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n    index += dir;\n  }\n  return {index: index, lineN: newN}\n}\n\n// Force the view to cover a given range, adding empty view element\n// or clipping off existing ones as needed.\nfunction adjustView(cm, from, to) {\n  var display = cm.display, view = display.view;\n  if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n    display.view = buildViewArray(cm, from, to);\n    display.viewFrom = from;\n  } else {\n    if (display.viewFrom > from)\n      { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n    else if (display.viewFrom < from)\n      { display.view = display.view.slice(findViewIndex(cm, from)); }\n    display.viewFrom = from;\n    if (display.viewTo < to)\n      { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n    else if (display.viewTo > to)\n      { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n  }\n  display.viewTo = to;\n}\n\n// Count the number of lines in the view whose DOM representation is\n// out of date (or nonexistent).\nfunction countDirtyView(cm) {\n  var view = cm.display.view, dirty = 0;\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n  }\n  return dirty\n}\n\n// HIGHLIGHT WORKER\n\nfunction startWorker(cm, time) {\n  if (cm.doc.highlightFrontier < cm.display.viewTo)\n    { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n}\n\nfunction highlightWorker(cm) {\n  var doc = cm.doc;\n  if (doc.highlightFrontier >= cm.display.viewTo) { return }\n  var end = +new Date + cm.options.workTime;\n  var context = getContextBefore(cm, doc.highlightFrontier);\n  var changedLines = [];\n\n  doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n    if (context.line >= cm.display.viewFrom) { // Visible\n      var oldStyles = line.styles;\n      var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n      var highlighted = highlightLine(cm, line, context, true);\n      if (resetState) { context.state = resetState; }\n      line.styles = highlighted.styles;\n      var oldCls = line.styleClasses, newCls = highlighted.classes;\n      if (newCls) { line.styleClasses = newCls; }\n      else if (oldCls) { line.styleClasses = null; }\n      var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n        oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n      for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n      if (ischange) { changedLines.push(context.line); }\n      line.stateAfter = context.save();\n      context.nextLine();\n    } else {\n      if (line.text.length <= cm.options.maxHighlightLength)\n        { processLine(cm, line.text, context); }\n      line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n      context.nextLine();\n    }\n    if (+new Date > end) {\n      startWorker(cm, cm.options.workDelay);\n      return true\n    }\n  });\n  doc.highlightFrontier = context.line;\n  doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n  if (changedLines.length) { runInOp(cm, function () {\n    for (var i = 0; i < changedLines.length; i++)\n      { regLineChange(cm, changedLines[i], \"text\"); }\n  }); }\n}\n\n// DISPLAY DRAWING\n\nvar DisplayUpdate = function(cm, viewport, force) {\n  var display = cm.display;\n\n  this.viewport = viewport;\n  // Store some values that we'll need later (but don't want to force a relayout for)\n  this.visible = visibleLines(display, cm.doc, viewport);\n  this.editorIsHidden = !display.wrapper.offsetWidth;\n  this.wrapperHeight = display.wrapper.clientHeight;\n  this.wrapperWidth = display.wrapper.clientWidth;\n  this.oldDisplayWidth = displayWidth(cm);\n  this.force = force;\n  this.dims = getDimensions(cm);\n  this.events = [];\n};\n\nDisplayUpdate.prototype.signal = function (emitter, type) {\n  if (hasHandler(emitter, type))\n    { this.events.push(arguments); }\n};\nDisplayUpdate.prototype.finish = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.events.length; i++)\n    { signal.apply(null, this$1.events[i]); }\n};\n\nfunction maybeClipScrollbars(cm) {\n  var display = cm.display;\n  if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n    display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n    display.heightForcer.style.height = scrollGap(cm) + \"px\";\n    display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n    display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n    display.scrollbarsClipped = true;\n  }\n}\n\nfunction selectionSnapshot(cm) {\n  if (cm.hasFocus()) { return null }\n  var active = activeElt();\n  if (!active || !contains(cm.display.lineDiv, active)) { return null }\n  var result = {activeElt: active};\n  if (window.getSelection) {\n    var sel = window.getSelection();\n    if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n      result.anchorNode = sel.anchorNode;\n      result.anchorOffset = sel.anchorOffset;\n      result.focusNode = sel.focusNode;\n      result.focusOffset = sel.focusOffset;\n    }\n  }\n  return result\n}\n\nfunction restoreSelection(snapshot) {\n  if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n  snapshot.activeElt.focus();\n  if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n    var sel = window.getSelection(), range$$1 = document.createRange();\n    range$$1.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n    range$$1.collapse(false);\n    sel.removeAllRanges();\n    sel.addRange(range$$1);\n    sel.extend(snapshot.focusNode, snapshot.focusOffset);\n  }\n}\n\n// Does the actual updating of the line display. Bails out\n// (returning false) when there is nothing to be done and forced is\n// false.\nfunction updateDisplayIfNeeded(cm, update) {\n  var display = cm.display, doc = cm.doc;\n\n  if (update.editorIsHidden) {\n    resetView(cm);\n    return false\n  }\n\n  // Bail out if the visible area is already rendered and nothing changed.\n  if (!update.force &&\n      update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n      display.renderedView == display.view && countDirtyView(cm) == 0)\n    { return false }\n\n  if (maybeUpdateLineNumberWidth(cm)) {\n    resetView(cm);\n    update.dims = getDimensions(cm);\n  }\n\n  // Compute a suitable new viewport (from & to)\n  var end = doc.first + doc.size;\n  var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n  var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n  if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n  if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n  if (sawCollapsedSpans) {\n    from = visualLineNo(cm.doc, from);\n    to = visualLineEndNo(cm.doc, to);\n  }\n\n  var different = from != display.viewFrom || to != display.viewTo ||\n    display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n  adjustView(cm, from, to);\n\n  display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n  // Position the mover div to align with the current scroll position\n  cm.display.mover.style.top = display.viewOffset + \"px\";\n\n  var toUpdate = countDirtyView(cm);\n  if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n    { return false }\n\n  // For big changes, we hide the enclosing element during the\n  // update, since that speeds up the operations on most browsers.\n  var selSnapshot = selectionSnapshot(cm);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n  patchDisplay(cm, display.updateLineNumbers, update.dims);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n  display.renderedView = display.view;\n  // There might have been a widget with a focused element that got\n  // hidden or updated, if so re-focus it.\n  restoreSelection(selSnapshot);\n\n  // Prevent selection and cursors from interfering with the scroll\n  // width and height.\n  removeChildren(display.cursorDiv);\n  removeChildren(display.selectionDiv);\n  display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n  if (different) {\n    display.lastWrapHeight = update.wrapperHeight;\n    display.lastWrapWidth = update.wrapperWidth;\n    startWorker(cm, 400);\n  }\n\n  display.updateLineNumbers = null;\n\n  return true\n}\n\nfunction postUpdateDisplay(cm, update) {\n  var viewport = update.viewport;\n\n  for (var first = true;; first = false) {\n    if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n      // Clip forced viewport to actual scrollable area.\n      if (viewport && viewport.top != null)\n        { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n      // Updated line heights might result in the drawn area not\n      // actually covering the viewport. Keep looping until it does.\n      update.visible = visibleLines(cm.display, cm.doc, viewport);\n      if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n        { break }\n    }\n    if (!updateDisplayIfNeeded(cm, update)) { break }\n    updateHeightsInViewport(cm);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n    update.force = false;\n  }\n\n  update.signal(cm, \"update\", cm);\n  if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n    update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n    cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n  }\n}\n\nfunction updateDisplaySimple(cm, viewport) {\n  var update = new DisplayUpdate(cm, viewport);\n  if (updateDisplayIfNeeded(cm, update)) {\n    updateHeightsInViewport(cm);\n    postUpdateDisplay(cm, update);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n    update.finish();\n  }\n}\n\n// Sync the actual display DOM structure with display.view, removing\n// nodes for lines that are no longer in view, and creating the ones\n// that are not there yet, and updating the ones that are out of\n// date.\nfunction patchDisplay(cm, updateNumbersFrom, dims) {\n  var display = cm.display, lineNumbers = cm.options.lineNumbers;\n  var container = display.lineDiv, cur = container.firstChild;\n\n  function rm(node) {\n    var next = node.nextSibling;\n    // Works around a throw-scroll bug in OS X Webkit\n    if (webkit && mac && cm.display.currentWheelTarget == node)\n      { node.style.display = \"none\"; }\n    else\n      { node.parentNode.removeChild(node); }\n    return next\n  }\n\n  var view = display.view, lineN = display.viewFrom;\n  // Loop over the elements in the view, syncing cur (the DOM nodes\n  // in display.lineDiv) with the view as we go.\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (lineView.hidden) {\n    } else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n      var node = buildLineElement(cm, lineView, lineN, dims);\n      container.insertBefore(node, cur);\n    } else { // Already drawn\n      while (cur != lineView.node) { cur = rm(cur); }\n      var updateNumber = lineNumbers && updateNumbersFrom != null &&\n        updateNumbersFrom <= lineN && lineView.lineNumber;\n      if (lineView.changes) {\n        if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n        updateLineForChanges(cm, lineView, lineN, dims);\n      }\n      if (updateNumber) {\n        removeChildren(lineView.lineNumber);\n        lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n      }\n      cur = lineView.node.nextSibling;\n    }\n    lineN += lineView.size;\n  }\n  while (cur) { cur = rm(cur); }\n}\n\nfunction updateGutterSpace(cm) {\n  var width = cm.display.gutters.offsetWidth;\n  cm.display.sizer.style.marginLeft = width + \"px\";\n}\n\nfunction setDocumentHeight(cm, measure) {\n  cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n  cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n  cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n}\n\n// Rebuild the gutter elements, ensure the margin to the left of the\n// code matches their width.\nfunction updateGutters(cm) {\n  var gutters = cm.display.gutters, specs = cm.options.gutters;\n  removeChildren(gutters);\n  var i = 0;\n  for (; i < specs.length; ++i) {\n    var gutterClass = specs[i];\n    var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n    if (gutterClass == \"CodeMirror-linenumbers\") {\n      cm.display.lineGutter = gElt;\n      gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n    }\n  }\n  gutters.style.display = i ? \"\" : \"none\";\n  updateGutterSpace(cm);\n}\n\n// Make sure the gutters options contains the element\n// \"CodeMirror-linenumbers\" when the lineNumbers option is true.\nfunction setGuttersForLineNumbers(options) {\n  var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n  if (found == -1 && options.lineNumbers) {\n    options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n  } else if (found > -1 && !options.lineNumbers) {\n    options.gutters = options.gutters.slice(0);\n    options.gutters.splice(found, 1);\n  }\n}\n\n// Since the delta values reported on mouse wheel events are\n// unstandardized between browsers and even browser versions, and\n// generally horribly unpredictable, this code starts by measuring\n// the scroll effect that the first few mouse wheel events have,\n// and, from that, detects the way it can convert deltas to pixel\n// offsets afterwards.\n//\n// The reason we want to know the amount a wheel event will scroll\n// is that it gives us a chance to update the display before the\n// actual scrolling happens, reducing flickering.\n\nvar wheelSamples = 0;\nvar wheelPixelsPerUnit = null;\n// Fill in a browser-detected starting value on browsers where we\n// know one. These don't have to be accurate -- the result of them\n// being wrong would just be a slight flicker on the first wheel\n// scroll (if it is large enough).\nif (ie) { wheelPixelsPerUnit = -.53; }\nelse if (gecko) { wheelPixelsPerUnit = 15; }\nelse if (chrome) { wheelPixelsPerUnit = -.7; }\nelse if (safari) { wheelPixelsPerUnit = -1/3; }\n\nfunction wheelEventDelta(e) {\n  var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n  if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n  if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n  else if (dy == null) { dy = e.wheelDelta; }\n  return {x: dx, y: dy}\n}\nfunction wheelEventPixels(e) {\n  var delta = wheelEventDelta(e);\n  delta.x *= wheelPixelsPerUnit;\n  delta.y *= wheelPixelsPerUnit;\n  return delta\n}\n\nfunction onScrollWheel(cm, e) {\n  var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n  var display = cm.display, scroll = display.scroller;\n  // Quit if there's nothing to scroll here\n  var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n  var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n  if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n  // Webkit browsers on OS X abort momentum scrolls when the target\n  // of the scroll event is removed from the scrollable element.\n  // This hack (see related code in patchDisplay) makes sure the\n  // element is kept around.\n  if (dy && mac && webkit) {\n    outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n      for (var i = 0; i < view.length; i++) {\n        if (view[i].node == cur) {\n          cm.display.currentWheelTarget = cur;\n          break outer\n        }\n      }\n    }\n  }\n\n  // On some browsers, horizontal scrolling will cause redraws to\n  // happen before the gutter has been realigned, causing it to\n  // wriggle around in a most unseemly way. When we have an\n  // estimated pixels/delta value, we just handle horizontal\n  // scrolling entirely here. It'll be slightly off from native, but\n  // better than glitching out.\n  if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n    if (dy && canScrollY)\n      { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n    setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n    // Only prevent default scrolling if vertical scrolling is\n    // actually possible. Otherwise, it causes vertical scroll\n    // jitter on OSX trackpads when deltaX is small and deltaY\n    // is large (issue #3579)\n    if (!dy || (dy && canScrollY))\n      { e_preventDefault(e); }\n    display.wheelStartX = null; // Abort measurement, if in progress\n    return\n  }\n\n  // 'Project' the visible viewport to cover the area that is being\n  // scrolled into view (if we know enough to estimate it).\n  if (dy && wheelPixelsPerUnit != null) {\n    var pixels = dy * wheelPixelsPerUnit;\n    var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n    if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n    else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n    updateDisplaySimple(cm, {top: top, bottom: bot});\n  }\n\n  if (wheelSamples < 20) {\n    if (display.wheelStartX == null) {\n      display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n      display.wheelDX = dx; display.wheelDY = dy;\n      setTimeout(function () {\n        if (display.wheelStartX == null) { return }\n        var movedX = scroll.scrollLeft - display.wheelStartX;\n        var movedY = scroll.scrollTop - display.wheelStartY;\n        var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n          (movedX && display.wheelDX && movedX / display.wheelDX);\n        display.wheelStartX = display.wheelStartY = null;\n        if (!sample) { return }\n        wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n        ++wheelSamples;\n      }, 200);\n    } else {\n      display.wheelDX += dx; display.wheelDY += dy;\n    }\n  }\n}\n\n// Selection objects are immutable. A new one is created every time\n// the selection changes. A selection is one or more non-overlapping\n// (and non-touching) ranges, sorted, and an integer that indicates\n// which one is the primary selection (the one that's scrolled into\n// view, that getCursor returns, etc).\nvar Selection = function(ranges, primIndex) {\n  this.ranges = ranges;\n  this.primIndex = primIndex;\n};\n\nSelection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\nSelection.prototype.equals = function (other) {\n    var this$1 = this;\n\n  if (other == this) { return true }\n  if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var here = this$1.ranges[i], there = other.ranges[i];\n    if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n  }\n  return true\n};\n\nSelection.prototype.deepCopy = function () {\n    var this$1 = this;\n\n  var out = [];\n  for (var i = 0; i < this.ranges.length; i++)\n    { out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head)); }\n  return new Selection(out, this.primIndex)\n};\n\nSelection.prototype.somethingSelected = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.ranges.length; i++)\n    { if (!this$1.ranges[i].empty()) { return true } }\n  return false\n};\n\nSelection.prototype.contains = function (pos, end) {\n    var this$1 = this;\n\n  if (!end) { end = pos; }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var range = this$1.ranges[i];\n    if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n      { return i }\n  }\n  return -1\n};\n\nvar Range = function(anchor, head) {\n  this.anchor = anchor; this.head = head;\n};\n\nRange.prototype.from = function () { return minPos(this.anchor, this.head) };\nRange.prototype.to = function () { return maxPos(this.anchor, this.head) };\nRange.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n// Take an unsorted, potentially overlapping set of ranges, and\n// build a selection out of it. 'Consumes' ranges array (modifying\n// it).\nfunction normalizeSelection(ranges, primIndex) {\n  var prim = ranges[primIndex];\n  ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n  primIndex = indexOf(ranges, prim);\n  for (var i = 1; i < ranges.length; i++) {\n    var cur = ranges[i], prev = ranges[i - 1];\n    if (cmp(prev.to(), cur.from()) >= 0) {\n      var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n      var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n      if (i <= primIndex) { --primIndex; }\n      ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n    }\n  }\n  return new Selection(ranges, primIndex)\n}\n\nfunction simpleSelection(anchor, head) {\n  return new Selection([new Range(anchor, head || anchor)], 0)\n}\n\n// Compute the position of the end of a change (its 'to' property\n// refers to the pre-change end).\nfunction changeEnd(change) {\n  if (!change.text) { return change.to }\n  return Pos(change.from.line + change.text.length - 1,\n             lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n}\n\n// Adjust a position to refer to the post-change position of the\n// same text, or the end of the change if the change covers it.\nfunction adjustForChange(pos, change) {\n  if (cmp(pos, change.from) < 0) { return pos }\n  if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n  var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n  if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n  return Pos(line, ch)\n}\n\nfunction computeSelAfterChange(doc, change) {\n  var out = [];\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    var range = doc.sel.ranges[i];\n    out.push(new Range(adjustForChange(range.anchor, change),\n                       adjustForChange(range.head, change)));\n  }\n  return normalizeSelection(out, doc.sel.primIndex)\n}\n\nfunction offsetPos(pos, old, nw) {\n  if (pos.line == old.line)\n    { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n  else\n    { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n}\n\n// Used by replaceSelections to allow moving the selection to the\n// start or around the replaced test. Hint may be \"start\" or \"around\".\nfunction computeReplacedSel(doc, changes, hint) {\n  var out = [];\n  var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n  for (var i = 0; i < changes.length; i++) {\n    var change = changes[i];\n    var from = offsetPos(change.from, oldPrev, newPrev);\n    var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n    oldPrev = change.to;\n    newPrev = to;\n    if (hint == \"around\") {\n      var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n      out[i] = new Range(inv ? to : from, inv ? from : to);\n    } else {\n      out[i] = new Range(from, from);\n    }\n  }\n  return new Selection(out, doc.sel.primIndex)\n}\n\n// Used to get the editor into a consistent state again when options change.\n\nfunction loadMode(cm) {\n  cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n  resetModeState(cm);\n}\n\nfunction resetModeState(cm) {\n  cm.doc.iter(function (line) {\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n  });\n  cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n  startWorker(cm, 100);\n  cm.state.modeGen++;\n  if (cm.curOp) { regChange(cm); }\n}\n\n// DOCUMENT DATA STRUCTURE\n\n// By default, updates that start and end at the beginning of a line\n// are treated specially, in order to make the association of line\n// widgets and marker elements with the text behave more intuitive.\nfunction isWholeLineUpdate(doc, change) {\n  return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n    (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n}\n\n// Perform a change on the document data structure.\nfunction updateDoc(doc, change, markedSpans, estimateHeight$$1) {\n  function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n  function update(line, text, spans) {\n    updateLine(line, text, spans, estimateHeight$$1);\n    signalLater(line, \"change\", line, change);\n  }\n  function linesFor(start, end) {\n    var result = [];\n    for (var i = start; i < end; ++i)\n      { result.push(new Line(text[i], spansFor(i), estimateHeight$$1)); }\n    return result\n  }\n\n  var from = change.from, to = change.to, text = change.text;\n  var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n  var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n  // Adjust the line structure\n  if (change.full) {\n    doc.insert(0, linesFor(0, text.length));\n    doc.remove(text.length, doc.size - text.length);\n  } else if (isWholeLineUpdate(doc, change)) {\n    // This is a whole-line replace. Treated specially to make\n    // sure line objects move the way they are supposed to.\n    var added = linesFor(0, text.length - 1);\n    update(lastLine, lastLine.text, lastSpans);\n    if (nlines) { doc.remove(from.line, nlines); }\n    if (added.length) { doc.insert(from.line, added); }\n  } else if (firstLine == lastLine) {\n    if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n    } else {\n      var added$1 = linesFor(1, text.length - 1);\n      added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight$$1));\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      doc.insert(from.line + 1, added$1);\n    }\n  } else if (text.length == 1) {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n    doc.remove(from.line + 1, nlines);\n  } else {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n    update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n    var added$2 = linesFor(1, text.length - 1);\n    if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n    doc.insert(from.line + 1, added$2);\n  }\n\n  signalLater(doc, \"change\", doc, change);\n}\n\n// Call f for all linked documents.\nfunction linkedDocs(doc, f, sharedHistOnly) {\n  function propagate(doc, skip, sharedHist) {\n    if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n      var rel = doc.linked[i];\n      if (rel.doc == skip) { continue }\n      var shared = sharedHist && rel.sharedHist;\n      if (sharedHistOnly && !shared) { continue }\n      f(rel.doc, shared);\n      propagate(rel.doc, doc, shared);\n    } }\n  }\n  propagate(doc, null, true);\n}\n\n// Attach a document to an editor.\nfunction attachDoc(cm, doc) {\n  if (doc.cm) { throw new Error(\"This document is already in use.\") }\n  cm.doc = doc;\n  doc.cm = cm;\n  estimateLineHeights(cm);\n  loadMode(cm);\n  setDirectionClass(cm);\n  if (!cm.options.lineWrapping) { findMaxLine(cm); }\n  cm.options.mode = doc.modeOption;\n  regChange(cm);\n}\n\nfunction setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n}\n\nfunction directionChanged(cm) {\n  runInOp(cm, function () {\n    setDirectionClass(cm);\n    regChange(cm);\n  });\n}\n\nfunction History(startGen) {\n  // Arrays of change events and selections. Doing something adds an\n  // event to done and clears undo. Undoing moves events from done\n  // to undone, redoing moves them in the other direction.\n  this.done = []; this.undone = [];\n  this.undoDepth = Infinity;\n  // Used to track when changes can be merged into a single undo\n  // event\n  this.lastModTime = this.lastSelTime = 0;\n  this.lastOp = this.lastSelOp = null;\n  this.lastOrigin = this.lastSelOrigin = null;\n  // Used by the isClean() method\n  this.generation = this.maxGeneration = startGen || 1;\n}\n\n// Create a history change event from an updateDoc-style change\n// object.\nfunction historyChangeFromChange(doc, change) {\n  var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n  attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n  linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n  return histChange\n}\n\n// Pop all selection events off the end of a history array. Stop at\n// a change event.\nfunction clearSelectionEvents(array) {\n  while (array.length) {\n    var last = lst(array);\n    if (last.ranges) { array.pop(); }\n    else { break }\n  }\n}\n\n// Find the top change event in the history. Pop off selection\n// events that are in the way.\nfunction lastChangeEvent(hist, force) {\n  if (force) {\n    clearSelectionEvents(hist.done);\n    return lst(hist.done)\n  } else if (hist.done.length && !lst(hist.done).ranges) {\n    return lst(hist.done)\n  } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n    hist.done.pop();\n    return lst(hist.done)\n  }\n}\n\n// Register a change in the history. Merges changes that are within\n// a single operation, or are close together with an origin that\n// allows merging (starting with \"+\") into a single event.\nfunction addChangeToHistory(doc, change, selAfter, opId) {\n  var hist = doc.history;\n  hist.undone.length = 0;\n  var time = +new Date, cur;\n  var last;\n\n  if ((hist.lastOp == opId ||\n       hist.lastOrigin == change.origin && change.origin &&\n       ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n        change.origin.charAt(0) == \"*\")) &&\n      (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n    // Merge this change into the last event\n    last = lst(cur.changes);\n    if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n      // Optimized case for simple insertion -- don't want to add\n      // new changesets for every character typed\n      last.to = changeEnd(change);\n    } else {\n      // Add new sub-event\n      cur.changes.push(historyChangeFromChange(doc, change));\n    }\n  } else {\n    // Can not be merged, start a new event.\n    var before = lst(hist.done);\n    if (!before || !before.ranges)\n      { pushSelectionToHistory(doc.sel, hist.done); }\n    cur = {changes: [historyChangeFromChange(doc, change)],\n           generation: hist.generation};\n    hist.done.push(cur);\n    while (hist.done.length > hist.undoDepth) {\n      hist.done.shift();\n      if (!hist.done[0].ranges) { hist.done.shift(); }\n    }\n  }\n  hist.done.push(selAfter);\n  hist.generation = ++hist.maxGeneration;\n  hist.lastModTime = hist.lastSelTime = time;\n  hist.lastOp = hist.lastSelOp = opId;\n  hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n  if (!last) { signal(doc, \"historyAdded\"); }\n}\n\nfunction selectionEventCanBeMerged(doc, origin, prev, sel) {\n  var ch = origin.charAt(0);\n  return ch == \"*\" ||\n    ch == \"+\" &&\n    prev.ranges.length == sel.ranges.length &&\n    prev.somethingSelected() == sel.somethingSelected() &&\n    new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n}\n\n// Called whenever the selection changes, sets the new selection as\n// the pending selection in the history, and pushes the old pending\n// selection into the 'done' array when it was significantly\n// different (in number of selected ranges, emptiness, or time).\nfunction addSelectionToHistory(doc, sel, opId, options) {\n  var hist = doc.history, origin = options && options.origin;\n\n  // A new event is started when the previous origin does not match\n  // the current, or the origins don't allow matching. Origins\n  // starting with * are always merged, those starting with + are\n  // merged when similar and close together in time.\n  if (opId == hist.lastSelOp ||\n      (origin && hist.lastSelOrigin == origin &&\n       (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n        selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n    { hist.done[hist.done.length - 1] = sel; }\n  else\n    { pushSelectionToHistory(sel, hist.done); }\n\n  hist.lastSelTime = +new Date;\n  hist.lastSelOrigin = origin;\n  hist.lastSelOp = opId;\n  if (options && options.clearRedo !== false)\n    { clearSelectionEvents(hist.undone); }\n}\n\nfunction pushSelectionToHistory(sel, dest) {\n  var top = lst(dest);\n  if (!(top && top.ranges && top.equals(sel)))\n    { dest.push(sel); }\n}\n\n// Used to store marked span information in the history.\nfunction attachLocalSpans(doc, change, from, to) {\n  var existing = change[\"spans_\" + doc.id], n = 0;\n  doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n    if (line.markedSpans)\n      { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n    ++n;\n  });\n}\n\n// When un/re-doing restores text containing marked spans, those\n// that have been explicitly cleared should not be restored.\nfunction removeClearedSpans(spans) {\n  if (!spans) { return null }\n  var out;\n  for (var i = 0; i < spans.length; ++i) {\n    if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n    else if (out) { out.push(spans[i]); }\n  }\n  return !out ? spans : out.length ? out : null\n}\n\n// Retrieve and filter the old marked spans stored in a change event.\nfunction getOldSpans(doc, change) {\n  var found = change[\"spans_\" + doc.id];\n  if (!found) { return null }\n  var nw = [];\n  for (var i = 0; i < change.text.length; ++i)\n    { nw.push(removeClearedSpans(found[i])); }\n  return nw\n}\n\n// Used for un/re-doing changes from the history. Combines the\n// result of computing the existing spans with the set of spans that\n// existed in the history (so that deleting around a span and then\n// undoing brings back the span).\nfunction mergeOldSpans(doc, change) {\n  var old = getOldSpans(doc, change);\n  var stretched = stretchSpansOverChange(doc, change);\n  if (!old) { return stretched }\n  if (!stretched) { return old }\n\n  for (var i = 0; i < old.length; ++i) {\n    var oldCur = old[i], stretchCur = stretched[i];\n    if (oldCur && stretchCur) {\n      spans: for (var j = 0; j < stretchCur.length; ++j) {\n        var span = stretchCur[j];\n        for (var k = 0; k < oldCur.length; ++k)\n          { if (oldCur[k].marker == span.marker) { continue spans } }\n        oldCur.push(span);\n      }\n    } else if (stretchCur) {\n      old[i] = stretchCur;\n    }\n  }\n  return old\n}\n\n// Used both to provide a JSON-safe object in .getHistory, and, when\n// detaching a document, to split the history in two\nfunction copyHistoryArray(events, newGroup, instantiateSel) {\n  var copy = [];\n  for (var i = 0; i < events.length; ++i) {\n    var event = events[i];\n    if (event.ranges) {\n      copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n      continue\n    }\n    var changes = event.changes, newChanges = [];\n    copy.push({changes: newChanges});\n    for (var j = 0; j < changes.length; ++j) {\n      var change = changes[j], m = (void 0);\n      newChanges.push({from: change.from, to: change.to, text: change.text});\n      if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n        if (indexOf(newGroup, Number(m[1])) > -1) {\n          lst(newChanges)[prop] = change[prop];\n          delete change[prop];\n        }\n      } } }\n    }\n  }\n  return copy\n}\n\n// The 'scroll' parameter given to many of these indicated whether\n// the new cursor position should be scrolled into view after\n// modifying the selection.\n\n// If shift is held or the extend flag is set, extends a range to\n// include a given position (and optionally a second position).\n// Otherwise, simply returns the range between the given positions.\n// Used for cursor motion and such.\nfunction extendRange(range, head, other, extend) {\n  if (extend) {\n    var anchor = range.anchor;\n    if (other) {\n      var posBefore = cmp(head, anchor) < 0;\n      if (posBefore != (cmp(other, anchor) < 0)) {\n        anchor = head;\n        head = other;\n      } else if (posBefore != (cmp(head, other) < 0)) {\n        head = other;\n      }\n    }\n    return new Range(anchor, head)\n  } else {\n    return new Range(other || head, head)\n  }\n}\n\n// Extend the primary selection range, discard the rest.\nfunction extendSelection(doc, head, other, options, extend) {\n  if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n  setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n}\n\n// Extend all selections (pos is an array of selections with length\n// equal the number of selections)\nfunction extendSelections(doc, heads, options) {\n  var out = [];\n  var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n  for (var i = 0; i < doc.sel.ranges.length; i++)\n    { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n  var newSel = normalizeSelection(out, doc.sel.primIndex);\n  setSelection(doc, newSel, options);\n}\n\n// Updates a single range in the selection.\nfunction replaceOneSelection(doc, i, range, options) {\n  var ranges = doc.sel.ranges.slice(0);\n  ranges[i] = range;\n  setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n}\n\n// Reset the selection to a single range.\nfunction setSimpleSelection(doc, anchor, head, options) {\n  setSelection(doc, simpleSelection(anchor, head), options);\n}\n\n// Give beforeSelectionChange handlers a change to influence a\n// selection update.\nfunction filterSelectionChange(doc, sel, options) {\n  var obj = {\n    ranges: sel.ranges,\n    update: function(ranges) {\n      var this$1 = this;\n\n      this.ranges = [];\n      for (var i = 0; i < ranges.length; i++)\n        { this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                   clipPos(doc, ranges[i].head)); }\n    },\n    origin: options && options.origin\n  };\n  signal(doc, \"beforeSelectionChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n  if (obj.ranges != sel.ranges) { return normalizeSelection(obj.ranges, obj.ranges.length - 1) }\n  else { return sel }\n}\n\nfunction setSelectionReplaceHistory(doc, sel, options) {\n  var done = doc.history.done, last = lst(done);\n  if (last && last.ranges) {\n    done[done.length - 1] = sel;\n    setSelectionNoUndo(doc, sel, options);\n  } else {\n    setSelection(doc, sel, options);\n  }\n}\n\n// Set a new selection.\nfunction setSelection(doc, sel, options) {\n  setSelectionNoUndo(doc, sel, options);\n  addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n}\n\nfunction setSelectionNoUndo(doc, sel, options) {\n  if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n    { sel = filterSelectionChange(doc, sel, options); }\n\n  var bias = options && options.bias ||\n    (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n  setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n  if (!(options && options.scroll === false) && doc.cm)\n    { ensureCursorVisible(doc.cm); }\n}\n\nfunction setSelectionInner(doc, sel) {\n  if (sel.equals(doc.sel)) { return }\n\n  doc.sel = sel;\n\n  if (doc.cm) {\n    doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n    signalCursorActivity(doc.cm);\n  }\n  signalLater(doc, \"cursorActivity\", doc);\n}\n\n// Verify that the selection does not partially select any atomic\n// marked ranges.\nfunction reCheckSelection(doc) {\n  setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n}\n\n// Return a selection that does not partially select any atomic\n// ranges.\nfunction skipAtomicInSelection(doc, sel, bias, mayClear) {\n  var out;\n  for (var i = 0; i < sel.ranges.length; i++) {\n    var range = sel.ranges[i];\n    var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n    var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n    var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n    if (out || newAnchor != range.anchor || newHead != range.head) {\n      if (!out) { out = sel.ranges.slice(0, i); }\n      out[i] = new Range(newAnchor, newHead);\n    }\n  }\n  return out ? normalizeSelection(out, sel.primIndex) : sel\n}\n\nfunction skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n  var line = getLine(doc, pos.line);\n  if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n    var sp = line.markedSpans[i], m = sp.marker;\n    if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n        (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n      if (mayClear) {\n        signal(m, \"beforeCursorEnter\");\n        if (m.explicitlyCleared) {\n          if (!line.markedSpans) { break }\n          else {--i; continue}\n        }\n      }\n      if (!m.atomic) { continue }\n\n      if (oldPos) {\n        var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n        if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft)\n          { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n        if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n          { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n      }\n\n      var far = m.find(dir < 0 ? -1 : 1);\n      if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight)\n        { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n      return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n    }\n  } }\n  return pos\n}\n\n// Ensure a given position is not inside an atomic range.\nfunction skipAtomic(doc, pos, oldPos, bias, mayClear) {\n  var dir = bias || 1;\n  var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n      skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n  if (!found) {\n    doc.cantEdit = true;\n    return Pos(doc.first, 0)\n  }\n  return found\n}\n\nfunction movePos(doc, pos, dir, line) {\n  if (dir < 0 && pos.ch == 0) {\n    if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n    else { return null }\n  } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n    if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n    else { return null }\n  } else {\n    return new Pos(pos.line, pos.ch + dir)\n  }\n}\n\nfunction selectAll(cm) {\n  cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n}\n\n// UPDATING\n\n// Allow \"beforeChange\" event handlers to influence a change\nfunction filterChange(doc, change, update) {\n  var obj = {\n    canceled: false,\n    from: change.from,\n    to: change.to,\n    text: change.text,\n    origin: change.origin,\n    cancel: function () { return obj.canceled = true; }\n  };\n  if (update) { obj.update = function (from, to, text, origin) {\n    if (from) { obj.from = clipPos(doc, from); }\n    if (to) { obj.to = clipPos(doc, to); }\n    if (text) { obj.text = text; }\n    if (origin !== undefined) { obj.origin = origin; }\n  }; }\n  signal(doc, \"beforeChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n  if (obj.canceled) { return null }\n  return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n}\n\n// Apply a change to a document, and add it to the document's\n// history, and propagating it to all linked documents.\nfunction makeChange(doc, change, ignoreReadOnly) {\n  if (doc.cm) {\n    if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n    if (doc.cm.state.suppressEdits) { return }\n  }\n\n  if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n    change = filterChange(doc, change, true);\n    if (!change) { return }\n  }\n\n  // Possibly split or suppress the update based on the presence\n  // of read-only spans in its range.\n  var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n  if (split) {\n    for (var i = split.length - 1; i >= 0; --i)\n      { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n  } else {\n    makeChangeInner(doc, change);\n  }\n}\n\nfunction makeChangeInner(doc, change) {\n  if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n  var selAfter = computeSelAfterChange(doc, change);\n  addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n  makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n  var rebased = [];\n\n  linkedDocs(doc, function (doc, sharedHist) {\n    if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n      rebaseHist(doc.history, change);\n      rebased.push(doc.history);\n    }\n    makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n  });\n}\n\n// Revert a change stored in a document's history.\nfunction makeChangeFromHistory(doc, type, allowSelectionOnly) {\n  var suppress = doc.cm && doc.cm.state.suppressEdits;\n  if (suppress && !allowSelectionOnly) { return }\n\n  var hist = doc.history, event, selAfter = doc.sel;\n  var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n  // Verify that there is a useable event (so that ctrl-z won't\n  // needlessly clear selection events)\n  var i = 0;\n  for (; i < source.length; i++) {\n    event = source[i];\n    if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n      { break }\n  }\n  if (i == source.length) { return }\n  hist.lastOrigin = hist.lastSelOrigin = null;\n\n  for (;;) {\n    event = source.pop();\n    if (event.ranges) {\n      pushSelectionToHistory(event, dest);\n      if (allowSelectionOnly && !event.equals(doc.sel)) {\n        setSelection(doc, event, {clearRedo: false});\n        return\n      }\n      selAfter = event;\n    } else if (suppress) {\n      source.push(event);\n      return\n    } else { break }\n  }\n\n  // Build up a reverse change object to add to the opposite history\n  // stack (redo when undoing, and vice versa).\n  var antiChanges = [];\n  pushSelectionToHistory(selAfter, dest);\n  dest.push({changes: antiChanges, generation: hist.generation});\n  hist.generation = event.generation || ++hist.maxGeneration;\n\n  var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n  var loop = function ( i ) {\n    var change = event.changes[i];\n    change.origin = type;\n    if (filter && !filterChange(doc, change, false)) {\n      source.length = 0;\n      return {}\n    }\n\n    antiChanges.push(historyChangeFromChange(doc, change));\n\n    var after = i ? computeSelAfterChange(doc, change) : lst(source);\n    makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n    if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n    var rebased = [];\n\n    // Propagate to the linked documents\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n    });\n  };\n\n  for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n    var returned = loop( i$1 );\n\n    if ( returned ) return returned.v;\n  }\n}\n\n// Sub-views need their line numbers shifted when text is added\n// above or below them in the parent document.\nfunction shiftDoc(doc, distance) {\n  if (distance == 0) { return }\n  doc.first += distance;\n  doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n    Pos(range.anchor.line + distance, range.anchor.ch),\n    Pos(range.head.line + distance, range.head.ch)\n  ); }), doc.sel.primIndex);\n  if (doc.cm) {\n    regChange(doc.cm, doc.first, doc.first - distance, distance);\n    for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n      { regLineChange(doc.cm, l, \"gutter\"); }\n  }\n}\n\n// More lower-level change function, handling only a single document\n// (not linked ones).\nfunction makeChangeSingleDoc(doc, change, selAfter, spans) {\n  if (doc.cm && !doc.cm.curOp)\n    { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n  if (change.to.line < doc.first) {\n    shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n    return\n  }\n  if (change.from.line > doc.lastLine()) { return }\n\n  // Clip the change to the size of this doc\n  if (change.from.line < doc.first) {\n    var shift = change.text.length - 1 - (doc.first - change.from.line);\n    shiftDoc(doc, shift);\n    change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n              text: [lst(change.text)], origin: change.origin};\n  }\n  var last = doc.lastLine();\n  if (change.to.line > last) {\n    change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n              text: [change.text[0]], origin: change.origin};\n  }\n\n  change.removed = getBetween(doc, change.from, change.to);\n\n  if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n  if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n  else { updateDoc(doc, change, spans); }\n  setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n}\n\n// Handle the interaction of a change to a document with the editor\n// that this document is part of.\nfunction makeChangeSingleDocInEditor(cm, change, spans) {\n  var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n  var recomputeMaxLength = false, checkWidthStart = from.line;\n  if (!cm.options.lineWrapping) {\n    checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n    doc.iter(checkWidthStart, to.line + 1, function (line) {\n      if (line == display.maxLine) {\n        recomputeMaxLength = true;\n        return true\n      }\n    });\n  }\n\n  if (doc.sel.contains(change.from, change.to) > -1)\n    { signalCursorActivity(cm); }\n\n  updateDoc(doc, change, spans, estimateHeight(cm));\n\n  if (!cm.options.lineWrapping) {\n    doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n      var len = lineLength(line);\n      if (len > display.maxLineLength) {\n        display.maxLine = line;\n        display.maxLineLength = len;\n        display.maxLineChanged = true;\n        recomputeMaxLength = false;\n      }\n    });\n    if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n  }\n\n  retreatFrontier(doc, from.line);\n  startWorker(cm, 400);\n\n  var lendiff = change.text.length - (to.line - from.line) - 1;\n  // Remember that these lines changed, for updating the display\n  if (change.full)\n    { regChange(cm); }\n  else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n    { regLineChange(cm, from.line, \"text\"); }\n  else\n    { regChange(cm, from.line, to.line + 1, lendiff); }\n\n  var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n  if (changeHandler || changesHandler) {\n    var obj = {\n      from: from, to: to,\n      text: change.text,\n      removed: change.removed,\n      origin: change.origin\n    };\n    if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n    if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n  }\n  cm.display.selForContextMenu = null;\n}\n\nfunction replaceRange(doc, code, from, to, origin) {\n  if (!to) { to = from; }\n  if (cmp(to, from) < 0) { var assign;\n    (assign = [to, from], from = assign[0], to = assign[1]); }\n  if (typeof code == \"string\") { code = doc.splitLines(code); }\n  makeChange(doc, {from: from, to: to, text: code, origin: origin});\n}\n\n// Rebasing/resetting history to deal with externally-sourced changes\n\nfunction rebaseHistSelSingle(pos, from, to, diff) {\n  if (to < pos.line) {\n    pos.line += diff;\n  } else if (from < pos.line) {\n    pos.line = from;\n    pos.ch = 0;\n  }\n}\n\n// Tries to rebase an array of history events given a change in the\n// document. If the change touches the same lines as the event, the\n// event, and everything 'behind' it, is discarded. If the change is\n// before the event, the event's positions are updated. Uses a\n// copy-on-write scheme for the positions, to avoid having to\n// reallocate them all on every rebase, but also avoid problems with\n// shared position objects being unsafely updated.\nfunction rebaseHistArray(array, from, to, diff) {\n  for (var i = 0; i < array.length; ++i) {\n    var sub = array[i], ok = true;\n    if (sub.ranges) {\n      if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n      for (var j = 0; j < sub.ranges.length; j++) {\n        rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n        rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n      }\n      continue\n    }\n    for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n      var cur = sub.changes[j$1];\n      if (to < cur.from.line) {\n        cur.from = Pos(cur.from.line + diff, cur.from.ch);\n        cur.to = Pos(cur.to.line + diff, cur.to.ch);\n      } else if (from <= cur.to.line) {\n        ok = false;\n        break\n      }\n    }\n    if (!ok) {\n      array.splice(0, i + 1);\n      i = 0;\n    }\n  }\n}\n\nfunction rebaseHist(hist, change) {\n  var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n  rebaseHistArray(hist.done, from, to, diff);\n  rebaseHistArray(hist.undone, from, to, diff);\n}\n\n// Utility for applying a change to a line by handle or number,\n// returning the number and optionally registering the line as\n// changed.\nfunction changeLine(doc, handle, changeType, op) {\n  var no = handle, line = handle;\n  if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n  else { no = lineNo(handle); }\n  if (no == null) { return null }\n  if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n  return line\n}\n\n// The document is represented as a BTree consisting of leaves, with\n// chunk of lines in them, and branches, with up to ten leaves or\n// other branch nodes below them. The top node is always a branch\n// node, and is the document object itself (meaning it has\n// additional methods and properties).\n//\n// All nodes have parent links. The tree is used both to go from\n// line numbers to line objects, and to go from objects to numbers.\n// It also indexes by height, and is used to convert between height\n// and line object, and to find the total height of the document.\n//\n// See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\nfunction LeafChunk(lines) {\n  var this$1 = this;\n\n  this.lines = lines;\n  this.parent = null;\n  var height = 0;\n  for (var i = 0; i < lines.length; ++i) {\n    lines[i].parent = this$1;\n    height += lines[i].height;\n  }\n  this.height = height;\n}\n\nLeafChunk.prototype = {\n  chunkSize: function() { return this.lines.length },\n\n  // Remove the n lines at offset 'at'.\n  removeInner: function(at, n) {\n    var this$1 = this;\n\n    for (var i = at, e = at + n; i < e; ++i) {\n      var line = this$1.lines[i];\n      this$1.height -= line.height;\n      cleanUpLine(line);\n      signalLater(line, \"delete\");\n    }\n    this.lines.splice(at, n);\n  },\n\n  // Helper used to collapse a small branch into a single leaf.\n  collapse: function(lines) {\n    lines.push.apply(lines, this.lines);\n  },\n\n  // Insert the given array of lines at offset 'at', count them as\n  // having the given height.\n  insertInner: function(at, lines, height) {\n    var this$1 = this;\n\n    this.height += height;\n    this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n    for (var i = 0; i < lines.length; ++i) { lines[i].parent = this$1; }\n  },\n\n  // Used to iterate over a part of the tree.\n  iterN: function(at, n, op) {\n    var this$1 = this;\n\n    for (var e = at + n; at < e; ++at)\n      { if (op(this$1.lines[at])) { return true } }\n  }\n};\n\nfunction BranchChunk(children) {\n  var this$1 = this;\n\n  this.children = children;\n  var size = 0, height = 0;\n  for (var i = 0; i < children.length; ++i) {\n    var ch = children[i];\n    size += ch.chunkSize(); height += ch.height;\n    ch.parent = this$1;\n  }\n  this.size = size;\n  this.height = height;\n  this.parent = null;\n}\n\nBranchChunk.prototype = {\n  chunkSize: function() { return this.size },\n\n  removeInner: function(at, n) {\n    var this$1 = this;\n\n    this.size -= n;\n    for (var i = 0; i < this.children.length; ++i) {\n      var child = this$1.children[i], sz = child.chunkSize();\n      if (at < sz) {\n        var rm = Math.min(n, sz - at), oldHeight = child.height;\n        child.removeInner(at, rm);\n        this$1.height -= oldHeight - child.height;\n        if (sz == rm) { this$1.children.splice(i--, 1); child.parent = null; }\n        if ((n -= rm) == 0) { break }\n        at = 0;\n      } else { at -= sz; }\n    }\n    // If the result is smaller than 25 lines, ensure that it is a\n    // single leaf node.\n    if (this.size - n < 25 &&\n        (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n      var lines = [];\n      this.collapse(lines);\n      this.children = [new LeafChunk(lines)];\n      this.children[0].parent = this;\n    }\n  },\n\n  collapse: function(lines) {\n    var this$1 = this;\n\n    for (var i = 0; i < this.children.length; ++i) { this$1.children[i].collapse(lines); }\n  },\n\n  insertInner: function(at, lines, height) {\n    var this$1 = this;\n\n    this.size += lines.length;\n    this.height += height;\n    for (var i = 0; i < this.children.length; ++i) {\n      var child = this$1.children[i], sz = child.chunkSize();\n      if (at <= sz) {\n        child.insertInner(at, lines, height);\n        if (child.lines && child.lines.length > 50) {\n          // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n          // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n          var remaining = child.lines.length % 25 + 25;\n          for (var pos = remaining; pos < child.lines.length;) {\n            var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n            child.height -= leaf.height;\n            this$1.children.splice(++i, 0, leaf);\n            leaf.parent = this$1;\n          }\n          child.lines = child.lines.slice(0, remaining);\n          this$1.maybeSpill();\n        }\n        break\n      }\n      at -= sz;\n    }\n  },\n\n  // When a node has grown, check whether it should be split.\n  maybeSpill: function() {\n    if (this.children.length <= 10) { return }\n    var me = this;\n    do {\n      var spilled = me.children.splice(me.children.length - 5, 5);\n      var sibling = new BranchChunk(spilled);\n      if (!me.parent) { // Become the parent node\n        var copy = new BranchChunk(me.children);\n        copy.parent = me;\n        me.children = [copy, sibling];\n        me = copy;\n     } else {\n        me.size -= sibling.size;\n        me.height -= sibling.height;\n        var myIndex = indexOf(me.parent.children, me);\n        me.parent.children.splice(myIndex + 1, 0, sibling);\n      }\n      sibling.parent = me.parent;\n    } while (me.children.length > 10)\n    me.parent.maybeSpill();\n  },\n\n  iterN: function(at, n, op) {\n    var this$1 = this;\n\n    for (var i = 0; i < this.children.length; ++i) {\n      var child = this$1.children[i], sz = child.chunkSize();\n      if (at < sz) {\n        var used = Math.min(n, sz - at);\n        if (child.iterN(at, used, op)) { return true }\n        if ((n -= used) == 0) { break }\n        at = 0;\n      } else { at -= sz; }\n    }\n  }\n};\n\n// Line widgets are block elements displayed above or below a line.\n\nvar LineWidget = function(doc, node, options) {\n  var this$1 = this;\n\n  if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n    { this$1[opt] = options[opt]; } } }\n  this.doc = doc;\n  this.node = node;\n};\n\nLineWidget.prototype.clear = function () {\n    var this$1 = this;\n\n  var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n  if (no == null || !ws) { return }\n  for (var i = 0; i < ws.length; ++i) { if (ws[i] == this$1) { ws.splice(i--, 1); } }\n  if (!ws.length) { line.widgets = null; }\n  var height = widgetHeight(this);\n  updateLineHeight(line, Math.max(0, line.height - height));\n  if (cm) {\n    runInOp(cm, function () {\n      adjustScrollWhenAboveVisible(cm, line, -height);\n      regLineChange(cm, no, \"widget\");\n    });\n    signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n  }\n};\n\nLineWidget.prototype.changed = function () {\n    var this$1 = this;\n\n  var oldH = this.height, cm = this.doc.cm, line = this.line;\n  this.height = null;\n  var diff = widgetHeight(this) - oldH;\n  if (!diff) { return }\n  if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n  if (cm) {\n    runInOp(cm, function () {\n      cm.curOp.forceUpdate = true;\n      adjustScrollWhenAboveVisible(cm, line, diff);\n      signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n    });\n  }\n};\neventMixin(LineWidget);\n\nfunction adjustScrollWhenAboveVisible(cm, line, diff) {\n  if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n    { addToScrollTop(cm, diff); }\n}\n\nfunction addLineWidget(doc, handle, node, options) {\n  var widget = new LineWidget(doc, node, options);\n  var cm = doc.cm;\n  if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n  changeLine(doc, handle, \"widget\", function (line) {\n    var widgets = line.widgets || (line.widgets = []);\n    if (widget.insertAt == null) { widgets.push(widget); }\n    else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n    widget.line = line;\n    if (cm && !lineIsHidden(doc, line)) {\n      var aboveVisible = heightAtLine(line) < doc.scrollTop;\n      updateLineHeight(line, line.height + widgetHeight(widget));\n      if (aboveVisible) { addToScrollTop(cm, widget.height); }\n      cm.curOp.forceUpdate = true;\n    }\n    return true\n  });\n  if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n  return widget\n}\n\n// TEXTMARKERS\n\n// Created with markText and setBookmark methods. A TextMarker is a\n// handle that can be used to clear or find a marked position in the\n// document. Line objects hold arrays (markedSpans) containing\n// {from, to, marker} object pointing to such marker objects, and\n// indicating that such a marker is present on that line. Multiple\n// lines may point to the same marker when it spans across lines.\n// The spans will have null for their from/to properties when the\n// marker continues beyond the start/end of the line. Markers have\n// links back to the lines they currently touch.\n\n// Collapsed markers have unique ids, in order to be able to order\n// them, which is needed for uniquely determining an outer marker\n// when they overlap (they may nest, but not partially overlap).\nvar nextMarkerId = 0;\n\nvar TextMarker = function(doc, type) {\n  this.lines = [];\n  this.type = type;\n  this.doc = doc;\n  this.id = ++nextMarkerId;\n};\n\n// Clear the marker.\nTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  var cm = this.doc.cm, withOp = cm && !cm.curOp;\n  if (withOp) { startOperation(cm); }\n  if (hasHandler(this, \"clear\")) {\n    var found = this.find();\n    if (found) { signalLater(this, \"clear\", found.from, found.to); }\n  }\n  var min = null, max = null;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (cm && !this$1.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n    else if (cm) {\n      if (span.to != null) { max = lineNo(line); }\n      if (span.from != null) { min = lineNo(line); }\n    }\n    line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n    if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm)\n      { updateLineHeight(line, textHeight(cm.display)); }\n  }\n  if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n    var visual = visualLine(this$1.lines[i$1]), len = lineLength(visual);\n    if (len > cm.display.maxLineLength) {\n      cm.display.maxLine = visual;\n      cm.display.maxLineLength = len;\n      cm.display.maxLineChanged = true;\n    }\n  } }\n\n  if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n  this.lines.length = 0;\n  this.explicitlyCleared = true;\n  if (this.atomic && this.doc.cantEdit) {\n    this.doc.cantEdit = false;\n    if (cm) { reCheckSelection(cm.doc); }\n  }\n  if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n  if (withOp) { endOperation(cm); }\n  if (this.parent) { this.parent.clear(); }\n};\n\n// Find the position of the marker in the document. Returns a {from,\n// to} object by default. Side can be passed to get a specific side\n// -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n// Pos objects returned contain a line object, rather than a line\n// number (used to prevent looking up the same line twice).\nTextMarker.prototype.find = function (side, lineObj) {\n    var this$1 = this;\n\n  if (side == null && this.type == \"bookmark\") { side = 1; }\n  var from, to;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (span.from != null) {\n      from = Pos(lineObj ? line : lineNo(line), span.from);\n      if (side == -1) { return from }\n    }\n    if (span.to != null) {\n      to = Pos(lineObj ? line : lineNo(line), span.to);\n      if (side == 1) { return to }\n    }\n  }\n  return from && {from: from, to: to}\n};\n\n// Signals that the marker's widget changed, and surrounding layout\n// should be recomputed.\nTextMarker.prototype.changed = function () {\n    var this$1 = this;\n\n  var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n  if (!pos || !cm) { return }\n  runInOp(cm, function () {\n    var line = pos.line, lineN = lineNo(pos.line);\n    var view = findViewForLine(cm, lineN);\n    if (view) {\n      clearLineMeasurementCacheFor(view);\n      cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n    }\n    cm.curOp.updateMaxLine = true;\n    if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n      var oldHeight = widget.height;\n      widget.height = null;\n      var dHeight = widgetHeight(widget) - oldHeight;\n      if (dHeight)\n        { updateLineHeight(line, line.height + dHeight); }\n    }\n    signalLater(cm, \"markerChanged\", cm, this$1);\n  });\n};\n\nTextMarker.prototype.attachLine = function (line) {\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;\n    if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n      { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n  }\n  this.lines.push(line);\n};\n\nTextMarker.prototype.detachLine = function (line) {\n  this.lines.splice(indexOf(this.lines, line), 1);\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n  }\n};\neventMixin(TextMarker);\n\n// Create a marker, wire it up to the right lines, and\nfunction markText(doc, from, to, options, type) {\n  // Shared markers (across linked documents) are handled separately\n  // (markTextShared will call out to this again, once per\n  // document).\n  if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n  // Ensure we are in an operation.\n  if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n  var marker = new TextMarker(doc, type), diff = cmp(from, to);\n  if (options) { copyObj(options, marker, false); }\n  // Don't connect empty markers unless clearWhenEmpty is false\n  if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n    { return marker }\n  if (marker.replacedWith) {\n    // Showing up as a widget implies collapsed (widget replaces text)\n    marker.collapsed = true;\n    marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n    if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n    if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n  }\n  if (marker.collapsed) {\n    if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n        from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n      { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n    seeCollapsedSpans();\n  }\n\n  if (marker.addToHistory)\n    { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n  var curLine = from.line, cm = doc.cm, updateMaxLine;\n  doc.iter(curLine, to.line + 1, function (line) {\n    if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n      { updateMaxLine = true; }\n    if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n    addMarkedSpan(line, new MarkedSpan(marker,\n                                       curLine == from.line ? from.ch : null,\n                                       curLine == to.line ? to.ch : null));\n    ++curLine;\n  });\n  // lineIsHidden depends on the presence of the spans, so needs a second pass\n  if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n    if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n  }); }\n\n  if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n  if (marker.readOnly) {\n    seeReadOnlySpans();\n    if (doc.history.done.length || doc.history.undone.length)\n      { doc.clearHistory(); }\n  }\n  if (marker.collapsed) {\n    marker.id = ++nextMarkerId;\n    marker.atomic = true;\n  }\n  if (cm) {\n    // Sync editor state\n    if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n    if (marker.collapsed)\n      { regChange(cm, from.line, to.line + 1); }\n    else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css)\n      { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n    if (marker.atomic) { reCheckSelection(cm.doc); }\n    signalLater(cm, \"markerAdded\", cm, marker);\n  }\n  return marker\n}\n\n// SHARED TEXTMARKERS\n\n// A shared marker spans multiple linked documents. It is\n// implemented as a meta-marker-object controlling multiple normal\n// markers.\nvar SharedTextMarker = function(markers, primary) {\n  var this$1 = this;\n\n  this.markers = markers;\n  this.primary = primary;\n  for (var i = 0; i < markers.length; ++i)\n    { markers[i].parent = this$1; }\n};\n\nSharedTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  this.explicitlyCleared = true;\n  for (var i = 0; i < this.markers.length; ++i)\n    { this$1.markers[i].clear(); }\n  signalLater(this, \"clear\");\n};\n\nSharedTextMarker.prototype.find = function (side, lineObj) {\n  return this.primary.find(side, lineObj)\n};\neventMixin(SharedTextMarker);\n\nfunction markTextShared(doc, from, to, options, type) {\n  options = copyObj(options);\n  options.shared = false;\n  var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n  var widget = options.widgetNode;\n  linkedDocs(doc, function (doc) {\n    if (widget) { options.widgetNode = widget.cloneNode(true); }\n    markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n    for (var i = 0; i < doc.linked.length; ++i)\n      { if (doc.linked[i].isParent) { return } }\n    primary = lst(markers);\n  });\n  return new SharedTextMarker(markers, primary)\n}\n\nfunction findSharedMarkers(doc) {\n  return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n}\n\nfunction copySharedMarkers(doc, markers) {\n  for (var i = 0; i < markers.length; i++) {\n    var marker = markers[i], pos = marker.find();\n    var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n    if (cmp(mFrom, mTo)) {\n      var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n      marker.markers.push(subMark);\n      subMark.parent = marker;\n    }\n  }\n}\n\nfunction detachSharedMarkers(markers) {\n  var loop = function ( i ) {\n    var marker = markers[i], linked = [marker.primary.doc];\n    linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n    for (var j = 0; j < marker.markers.length; j++) {\n      var subMarker = marker.markers[j];\n      if (indexOf(linked, subMarker.doc) == -1) {\n        subMarker.parent = null;\n        marker.markers.splice(j--, 1);\n      }\n    }\n  };\n\n  for (var i = 0; i < markers.length; i++) loop( i );\n}\n\nvar nextDocId = 0;\nvar Doc = function(text, mode, firstLine, lineSep, direction) {\n  if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n  if (firstLine == null) { firstLine = 0; }\n\n  BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n  this.first = firstLine;\n  this.scrollTop = this.scrollLeft = 0;\n  this.cantEdit = false;\n  this.cleanGeneration = 1;\n  this.modeFrontier = this.highlightFrontier = firstLine;\n  var start = Pos(firstLine, 0);\n  this.sel = simpleSelection(start);\n  this.history = new History(null);\n  this.id = ++nextDocId;\n  this.modeOption = mode;\n  this.lineSep = lineSep;\n  this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n  this.extend = false;\n\n  if (typeof text == \"string\") { text = this.splitLines(text); }\n  updateDoc(this, {from: start, to: start, text: text});\n  setSelection(this, simpleSelection(start), sel_dontScroll);\n};\n\nDoc.prototype = createObj(BranchChunk.prototype, {\n  constructor: Doc,\n  // Iterate over the document. Supports two forms -- with only one\n  // argument, it calls that for each line in the document. With\n  // three, it iterates over the range given by the first two (with\n  // the second being non-inclusive).\n  iter: function(from, to, op) {\n    if (op) { this.iterN(from - this.first, to - from, op); }\n    else { this.iterN(this.first, this.first + this.size, from); }\n  },\n\n  // Non-public interface for adding and removing lines.\n  insert: function(at, lines) {\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n    this.insertInner(at - this.first, lines, height);\n  },\n  remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n  // From here, the methods are part of the public interface. Most\n  // are also available from CodeMirror (editor) instances.\n\n  getValue: function(lineSep) {\n    var lines = getLines(this, this.first, this.first + this.size);\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n  setValue: docMethodOp(function(code) {\n    var top = Pos(this.first, 0), last = this.first + this.size - 1;\n    makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                      text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n    if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n    setSelection(this, simpleSelection(top), sel_dontScroll);\n  }),\n  replaceRange: function(code, from, to, origin) {\n    from = clipPos(this, from);\n    to = to ? clipPos(this, to) : from;\n    replaceRange(this, code, from, to, origin);\n  },\n  getRange: function(from, to, lineSep) {\n    var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n\n  getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n  getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n  getLineNumber: function(line) {return lineNo(line)},\n\n  getLineHandleVisualStart: function(line) {\n    if (typeof line == \"number\") { line = getLine(this, line); }\n    return visualLine(line)\n  },\n\n  lineCount: function() {return this.size},\n  firstLine: function() {return this.first},\n  lastLine: function() {return this.first + this.size - 1},\n\n  clipPos: function(pos) {return clipPos(this, pos)},\n\n  getCursor: function(start) {\n    var range$$1 = this.sel.primary(), pos;\n    if (start == null || start == \"head\") { pos = range$$1.head; }\n    else if (start == \"anchor\") { pos = range$$1.anchor; }\n    else if (start == \"end\" || start == \"to\" || start === false) { pos = range$$1.to(); }\n    else { pos = range$$1.from(); }\n    return pos\n  },\n  listSelections: function() { return this.sel.ranges },\n  somethingSelected: function() {return this.sel.somethingSelected()},\n\n  setCursor: docMethodOp(function(line, ch, options) {\n    setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n  }),\n  setSelection: docMethodOp(function(anchor, head, options) {\n    setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n  }),\n  extendSelection: docMethodOp(function(head, other, options) {\n    extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n  }),\n  extendSelections: docMethodOp(function(heads, options) {\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  extendSelectionsBy: docMethodOp(function(f, options) {\n    var heads = map(this.sel.ranges, f);\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  setSelections: docMethodOp(function(ranges, primary, options) {\n    var this$1 = this;\n\n    if (!ranges.length) { return }\n    var out = [];\n    for (var i = 0; i < ranges.length; i++)\n      { out[i] = new Range(clipPos(this$1, ranges[i].anchor),\n                         clipPos(this$1, ranges[i].head)); }\n    if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n    setSelection(this, normalizeSelection(out, primary), options);\n  }),\n  addSelection: docMethodOp(function(anchor, head, options) {\n    var ranges = this.sel.ranges.slice(0);\n    ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n    setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n  }),\n\n  getSelection: function(lineSep) {\n    var this$1 = this;\n\n    var ranges = this.sel.ranges, lines;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      lines = lines ? lines.concat(sel) : sel;\n    }\n    if (lineSep === false) { return lines }\n    else { return lines.join(lineSep || this.lineSeparator()) }\n  },\n  getSelections: function(lineSep) {\n    var this$1 = this;\n\n    var parts = [], ranges = this.sel.ranges;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      if (lineSep !== false) { sel = sel.join(lineSep || this$1.lineSeparator()); }\n      parts[i] = sel;\n    }\n    return parts\n  },\n  replaceSelection: function(code, collapse, origin) {\n    var dup = [];\n    for (var i = 0; i < this.sel.ranges.length; i++)\n      { dup[i] = code; }\n    this.replaceSelections(dup, collapse, origin || \"+input\");\n  },\n  replaceSelections: docMethodOp(function(code, collapse, origin) {\n    var this$1 = this;\n\n    var changes = [], sel = this.sel;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range$$1 = sel.ranges[i];\n      changes[i] = {from: range$$1.from(), to: range$$1.to(), text: this$1.splitLines(code[i]), origin: origin};\n    }\n    var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n    for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n      { makeChange(this$1, changes[i$1]); }\n    if (newSel) { setSelectionReplaceHistory(this, newSel); }\n    else if (this.cm) { ensureCursorVisible(this.cm); }\n  }),\n  undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n  redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n  undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n  redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n  setExtending: function(val) {this.extend = val;},\n  getExtending: function() {return this.extend},\n\n  historySize: function() {\n    var hist = this.history, done = 0, undone = 0;\n    for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n    for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n    return {undo: done, redo: undone}\n  },\n  clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n  markClean: function() {\n    this.cleanGeneration = this.changeGeneration(true);\n  },\n  changeGeneration: function(forceSplit) {\n    if (forceSplit)\n      { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n    return this.history.generation\n  },\n  isClean: function (gen) {\n    return this.history.generation == (gen || this.cleanGeneration)\n  },\n\n  getHistory: function() {\n    return {done: copyHistoryArray(this.history.done),\n            undone: copyHistoryArray(this.history.undone)}\n  },\n  setHistory: function(histData) {\n    var hist = this.history = new History(this.history.maxGeneration);\n    hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n    hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n  },\n\n  setGutterMarker: docMethodOp(function(line, gutterID, value) {\n    return changeLine(this, line, \"gutter\", function (line) {\n      var markers = line.gutterMarkers || (line.gutterMarkers = {});\n      markers[gutterID] = value;\n      if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n      return true\n    })\n  }),\n\n  clearGutter: docMethodOp(function(gutterID) {\n    var this$1 = this;\n\n    this.iter(function (line) {\n      if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n        changeLine(this$1, line, \"gutter\", function () {\n          line.gutterMarkers[gutterID] = null;\n          if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n          return true\n        });\n      }\n    });\n  }),\n\n  lineInfo: function(line) {\n    var n;\n    if (typeof line == \"number\") {\n      if (!isLine(this, line)) { return null }\n      n = line;\n      line = getLine(this, line);\n      if (!line) { return null }\n    } else {\n      n = lineNo(line);\n      if (n == null) { return null }\n    }\n    return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n            textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n            widgets: line.widgets}\n  },\n\n  addLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      if (!line[prop]) { line[prop] = cls; }\n      else if (classTest(cls).test(line[prop])) { return false }\n      else { line[prop] += \" \" + cls; }\n      return true\n    })\n  }),\n  removeLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      var cur = line[prop];\n      if (!cur) { return false }\n      else if (cls == null) { line[prop] = null; }\n      else {\n        var found = cur.match(classTest(cls));\n        if (!found) { return false }\n        var end = found.index + found[0].length;\n        line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n      }\n      return true\n    })\n  }),\n\n  addLineWidget: docMethodOp(function(handle, node, options) {\n    return addLineWidget(this, handle, node, options)\n  }),\n  removeLineWidget: function(widget) { widget.clear(); },\n\n  markText: function(from, to, options) {\n    return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n  },\n  setBookmark: function(pos, options) {\n    var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                    insertLeft: options && options.insertLeft,\n                    clearWhenEmpty: false, shared: options && options.shared,\n                    handleMouseEvents: options && options.handleMouseEvents};\n    pos = clipPos(this, pos);\n    return markText(this, pos, pos, realOpts, \"bookmark\")\n  },\n  findMarksAt: function(pos) {\n    pos = clipPos(this, pos);\n    var markers = [], spans = getLine(this, pos.line).markedSpans;\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if ((span.from == null || span.from <= pos.ch) &&\n          (span.to == null || span.to >= pos.ch))\n        { markers.push(span.marker.parent || span.marker); }\n    } }\n    return markers\n  },\n  findMarks: function(from, to, filter) {\n    from = clipPos(this, from); to = clipPos(this, to);\n    var found = [], lineNo$$1 = from.line;\n    this.iter(from.line, to.line + 1, function (line) {\n      var spans = line.markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; i++) {\n        var span = spans[i];\n        if (!(span.to != null && lineNo$$1 == from.line && from.ch >= span.to ||\n              span.from == null && lineNo$$1 != from.line ||\n              span.from != null && lineNo$$1 == to.line && span.from >= to.ch) &&\n            (!filter || filter(span.marker)))\n          { found.push(span.marker.parent || span.marker); }\n      } }\n      ++lineNo$$1;\n    });\n    return found\n  },\n  getAllMarks: function() {\n    var markers = [];\n    this.iter(function (line) {\n      var sps = line.markedSpans;\n      if (sps) { for (var i = 0; i < sps.length; ++i)\n        { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n    });\n    return markers\n  },\n\n  posFromIndex: function(off) {\n    var ch, lineNo$$1 = this.first, sepSize = this.lineSeparator().length;\n    this.iter(function (line) {\n      var sz = line.text.length + sepSize;\n      if (sz > off) { ch = off; return true }\n      off -= sz;\n      ++lineNo$$1;\n    });\n    return clipPos(this, Pos(lineNo$$1, ch))\n  },\n  indexFromPos: function (coords) {\n    coords = clipPos(this, coords);\n    var index = coords.ch;\n    if (coords.line < this.first || coords.ch < 0) { return 0 }\n    var sepSize = this.lineSeparator().length;\n    this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n      index += line.text.length + sepSize;\n    });\n    return index\n  },\n\n  copy: function(copyHistory) {\n    var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                      this.modeOption, this.first, this.lineSep, this.direction);\n    doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n    doc.sel = this.sel;\n    doc.extend = false;\n    if (copyHistory) {\n      doc.history.undoDepth = this.history.undoDepth;\n      doc.setHistory(this.getHistory());\n    }\n    return doc\n  },\n\n  linkedDoc: function(options) {\n    if (!options) { options = {}; }\n    var from = this.first, to = this.first + this.size;\n    if (options.from != null && options.from > from) { from = options.from; }\n    if (options.to != null && options.to < to) { to = options.to; }\n    var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n    if (options.sharedHist) { copy.history = this.history\n    ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n    copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n    copySharedMarkers(copy, findSharedMarkers(this));\n    return copy\n  },\n  unlinkDoc: function(other) {\n    var this$1 = this;\n\n    if (other instanceof CodeMirror$1) { other = other.doc; }\n    if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n      var link = this$1.linked[i];\n      if (link.doc != other) { continue }\n      this$1.linked.splice(i, 1);\n      other.unlinkDoc(this$1);\n      detachSharedMarkers(findSharedMarkers(this$1));\n      break\n    } }\n    // If the histories were shared, split them again\n    if (other.history == this.history) {\n      var splitIds = [other.id];\n      linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n      other.history = new History(null);\n      other.history.done = copyHistoryArray(this.history.done, splitIds);\n      other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n    }\n  },\n  iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n  getMode: function() {return this.mode},\n  getEditor: function() {return this.cm},\n\n  splitLines: function(str) {\n    if (this.lineSep) { return str.split(this.lineSep) }\n    return splitLinesAuto(str)\n  },\n  lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n  setDirection: docMethodOp(function (dir) {\n    if (dir != \"rtl\") { dir = \"ltr\"; }\n    if (dir == this.direction) { return }\n    this.direction = dir;\n    this.iter(function (line) { return line.order = null; });\n    if (this.cm) { directionChanged(this.cm); }\n  })\n});\n\n// Public alias.\nDoc.prototype.eachLine = Doc.prototype.iter;\n\n// Kludge to work around strange IE behavior where it'll sometimes\n// re-fire a series of drag-related events right after the drop (#1551)\nvar lastDrop = 0;\n\nfunction onDrop(e) {\n  var cm = this;\n  clearDragCursor(cm);\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n    { return }\n  e_preventDefault(e);\n  if (ie) { lastDrop = +new Date; }\n  var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n  if (!pos || cm.isReadOnly()) { return }\n  // Might be a file drop, in which case we simply extract the text\n  // and insert it.\n  if (files && files.length && window.FileReader && window.File) {\n    var n = files.length, text = Array(n), read = 0;\n    var loadFile = function (file, i) {\n      if (cm.options.allowDropFileTypes &&\n          indexOf(cm.options.allowDropFileTypes, file.type) == -1)\n        { return }\n\n      var reader = new FileReader;\n      reader.onload = operation(cm, function () {\n        var content = reader.result;\n        if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) { content = \"\"; }\n        text[i] = content;\n        if (++read == n) {\n          pos = clipPos(cm.doc, pos);\n          var change = {from: pos, to: pos,\n                        text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                        origin: \"paste\"};\n          makeChange(cm.doc, change);\n          setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n        }\n      });\n      reader.readAsText(file);\n    };\n    for (var i = 0; i < n; ++i) { loadFile(files[i], i); }\n  } else { // Normal drop\n    // Don't do a replace if the drop happened inside of the selected text.\n    if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n      cm.state.draggingText(e);\n      // Ensure the editor is re-focused\n      setTimeout(function () { return cm.display.input.focus(); }, 20);\n      return\n    }\n    try {\n      var text$1 = e.dataTransfer.getData(\"Text\");\n      if (text$1) {\n        var selected;\n        if (cm.state.draggingText && !cm.state.draggingText.copy)\n          { selected = cm.listSelections(); }\n        setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n        if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n          { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n        cm.replaceSelection(text$1, \"around\", \"paste\");\n        cm.display.input.focus();\n      }\n    }\n    catch(e){}\n  }\n}\n\nfunction onDragStart(cm, e) {\n  if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n  e.dataTransfer.setData(\"Text\", cm.getSelection());\n  e.dataTransfer.effectAllowed = \"copyMove\";\n\n  // Use dummy image instead of default browsers image.\n  // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n  if (e.dataTransfer.setDragImage && !safari) {\n    var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n    img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n    if (presto) {\n      img.width = img.height = 1;\n      cm.display.wrapper.appendChild(img);\n      // Force a relayout, or Opera won't use our image for some obscure reason\n      img._top = img.offsetTop;\n    }\n    e.dataTransfer.setDragImage(img, 0, 0);\n    if (presto) { img.parentNode.removeChild(img); }\n  }\n}\n\nfunction onDragOver(cm, e) {\n  var pos = posFromMouse(cm, e);\n  if (!pos) { return }\n  var frag = document.createDocumentFragment();\n  drawSelectionCursor(cm, pos, frag);\n  if (!cm.display.dragCursor) {\n    cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n    cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n  }\n  removeChildrenAndAdd(cm.display.dragCursor, frag);\n}\n\nfunction clearDragCursor(cm) {\n  if (cm.display.dragCursor) {\n    cm.display.lineSpace.removeChild(cm.display.dragCursor);\n    cm.display.dragCursor = null;\n  }\n}\n\n// These must be handled carefully, because naively registering a\n// handler for each editor will cause the editors to never be\n// garbage collected.\n\nfunction forEachCodeMirror(f) {\n  if (!document.getElementsByClassName) { return }\n  var byClass = document.getElementsByClassName(\"CodeMirror\");\n  for (var i = 0; i < byClass.length; i++) {\n    var cm = byClass[i].CodeMirror;\n    if (cm) { f(cm); }\n  }\n}\n\nvar globalsRegistered = false;\nfunction ensureGlobalHandlers() {\n  if (globalsRegistered) { return }\n  registerGlobalHandlers();\n  globalsRegistered = true;\n}\nfunction registerGlobalHandlers() {\n  // When the window resizes, we need to refresh active editors.\n  var resizeTimer;\n  on(window, \"resize\", function () {\n    if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n      resizeTimer = null;\n      forEachCodeMirror(onResize);\n    }, 100); }\n  });\n  // When the window loses focus, we want to show the editor as blurred\n  on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n}\n// Called when the window resizes\nfunction onResize(cm) {\n  var d = cm.display;\n  // Might be a text scaling operation, clear size caches.\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n  d.scrollbarsClipped = false;\n  cm.setSize();\n}\n\nvar keyNames = {\n  3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n  19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n  36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n  46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n  106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 127: \"Delete\", 145: \"ScrollLock\",\n  173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n  221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n  63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n};\n\n// Number keys\nfor (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n// Alphabetic keys\nfor (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n// Function keys\nfor (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\nvar keyMap = {};\n\nkeyMap.basic = {\n  \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n  \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n  \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n  \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n  \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n  \"Esc\": \"singleSelection\"\n};\n// Note that the save and find-related commands aren't defined by\n// default. User code or addons can define them. Unknown commands\n// are simply ignored.\nkeyMap.pcDefault = {\n  \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n  \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n  \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n  \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n  \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n  \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n  \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n  \"fallthrough\": \"basic\"\n};\n// Very basic readline/emacs-style bindings, which are standard on Mac.\nkeyMap.emacsy = {\n  \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n  \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n  \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n  \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n  \"Ctrl-O\": \"openLine\"\n};\nkeyMap.macDefault = {\n  \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n  \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n  \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n  \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n  \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n  \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n  \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n  \"fallthrough\": [\"basic\", \"emacsy\"]\n};\nkeyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n// KEYMAP DISPATCH\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/);\n  name = parts[parts.length - 1];\n  var alt, ctrl, shift, cmd;\n  for (var i = 0; i < parts.length - 1; i++) {\n    var mod = parts[i];\n    if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n    else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n    else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n    else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n    else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n  }\n  if (alt) { name = \"Alt-\" + name; }\n  if (ctrl) { name = \"Ctrl-\" + name; }\n  if (cmd) { name = \"Cmd-\" + name; }\n  if (shift) { name = \"Shift-\" + name; }\n  return name\n}\n\n// This is a kludge to keep keymaps mostly working as raw objects\n// (backwards compatibility) while at the same time support features\n// like normalization and multi-stroke key bindings. It compiles a\n// new normalized keymap, and then updates the old object to reflect\n// this.\nfunction normalizeKeyMap(keymap) {\n  var copy = {};\n  for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n    var value = keymap[keyname];\n    if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n    if (value == \"...\") { delete keymap[keyname]; continue }\n\n    var keys = map(keyname.split(\" \"), normalizeKeyName);\n    for (var i = 0; i < keys.length; i++) {\n      var val = (void 0), name = (void 0);\n      if (i == keys.length - 1) {\n        name = keys.join(\" \");\n        val = value;\n      } else {\n        name = keys.slice(0, i + 1).join(\" \");\n        val = \"...\";\n      }\n      var prev = copy[name];\n      if (!prev) { copy[name] = val; }\n      else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n    }\n    delete keymap[keyname];\n  } }\n  for (var prop in copy) { keymap[prop] = copy[prop]; }\n  return keymap\n}\n\nfunction lookupKey(key, map$$1, handle, context) {\n  map$$1 = getKeyMap(map$$1);\n  var found = map$$1.call ? map$$1.call(key, context) : map$$1[key];\n  if (found === false) { return \"nothing\" }\n  if (found === \"...\") { return \"multi\" }\n  if (found != null && handle(found)) { return \"handled\" }\n\n  if (map$$1.fallthrough) {\n    if (Object.prototype.toString.call(map$$1.fallthrough) != \"[object Array]\")\n      { return lookupKey(key, map$$1.fallthrough, handle, context) }\n    for (var i = 0; i < map$$1.fallthrough.length; i++) {\n      var result = lookupKey(key, map$$1.fallthrough[i], handle, context);\n      if (result) { return result }\n    }\n  }\n}\n\n// Modifier key presses don't count as 'real' key presses for the\n// purpose of keymap fallthrough.\nfunction isModifierKey(value) {\n  var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n  return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n}\n\nfunction addModifierNames(name, event, noShift) {\n  var base = name;\n  if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n  if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n  if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n  if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n  return name\n}\n\n// Look up the name of a key as indicated by an event object.\nfunction keyName(event, noShift) {\n  if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n  var name = keyNames[event.keyCode];\n  if (name == null || event.altGraphKey) { return false }\n  // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n  // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n  if (event.keyCode == 3 && event.code) { name = event.code; }\n  return addModifierNames(name, event, noShift)\n}\n\nfunction getKeyMap(val) {\n  return typeof val == \"string\" ? keyMap[val] : val\n}\n\n// Helper for deleting text near the selection(s), used to implement\n// backspace, delete, and similar functionality.\nfunction deleteNearSelection(cm, compute) {\n  var ranges = cm.doc.sel.ranges, kill = [];\n  // Build up a set of ranges to kill first, merging overlapping\n  // ranges.\n  for (var i = 0; i < ranges.length; i++) {\n    var toKill = compute(ranges[i]);\n    while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n      var replaced = kill.pop();\n      if (cmp(replaced.from, toKill.from) < 0) {\n        toKill.from = replaced.from;\n        break\n      }\n    }\n    kill.push(toKill);\n  }\n  // Next, remove those actual ranges.\n  runInOp(cm, function () {\n    for (var i = kill.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n    ensureCursorVisible(cm);\n  });\n}\n\nfunction moveCharLogically(line, ch, dir) {\n  var target = skipExtendingChars(line.text, ch + dir, dir);\n  return target < 0 || target > line.text.length ? null : target\n}\n\nfunction moveLogically(line, start, dir) {\n  var ch = moveCharLogically(line, start.ch, dir);\n  return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n}\n\nfunction endOfLine(visually, cm, lineObj, lineNo, dir) {\n  if (visually) {\n    var order = getOrder(lineObj, cm.doc.direction);\n    if (order) {\n      var part = dir < 0 ? lst(order) : order[0];\n      var moveInStorageOrder = (dir < 0) == (part.level == 1);\n      var sticky = moveInStorageOrder ? \"after\" : \"before\";\n      var ch;\n      // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n      // it could be that the last bidi part is not on the last visual line,\n      // since visual lines contain content order-consecutive chunks.\n      // Thus, in rtl, we are looking for the first (content-order) character\n      // in the rtl chunk that is on the last line (that is, the same line\n      // as the last (content-order) character).\n      if (part.level > 0 || cm.doc.direction == \"rtl\") {\n        var prep = prepareMeasureForLine(cm, lineObj);\n        ch = dir < 0 ? lineObj.text.length - 1 : 0;\n        var targetTop = measureCharPrepared(cm, prep, ch).top;\n        ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n        if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n      } else { ch = dir < 0 ? part.to : part.from; }\n      return new Pos(lineNo, ch, sticky)\n    }\n  }\n  return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n}\n\nfunction moveVisually(cm, line, start, dir) {\n  var bidi = getOrder(line, cm.doc.direction);\n  if (!bidi) { return moveLogically(line, start, dir) }\n  if (start.ch >= line.text.length) {\n    start.ch = line.text.length;\n    start.sticky = \"before\";\n  } else if (start.ch <= 0) {\n    start.ch = 0;\n    start.sticky = \"after\";\n  }\n  var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n  if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n    // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n    // nothing interesting happens.\n    return moveLogically(line, start, dir)\n  }\n\n  var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n  var prep;\n  var getWrappedLineExtent = function (ch) {\n    if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n    prep = prep || prepareMeasureForLine(cm, line);\n    return wrappedLineExtentChar(cm, line, prep, ch)\n  };\n  var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n  if (cm.doc.direction == \"rtl\" || part.level == 1) {\n    var moveInStorageOrder = (part.level == 1) == (dir < 0);\n    var ch = mv(start, moveInStorageOrder ? 1 : -1);\n    if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n      // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n      var sticky = moveInStorageOrder ? \"before\" : \"after\";\n      return new Pos(start.line, ch, sticky)\n    }\n  }\n\n  // Case 3: Could not move within this bidi part in this visual line, so leave\n  // the current bidi part\n\n  var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n    var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n      ? new Pos(start.line, mv(ch, 1), \"before\")\n      : new Pos(start.line, ch, \"after\"); };\n\n    for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n      var part = bidi[partPos];\n      var moveInStorageOrder = (dir > 0) == (part.level != 1);\n      var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n      if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n      ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n      if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n    }\n  };\n\n  // Case 3a: Look for other bidi parts on the same visual line\n  var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n  if (res) { return res }\n\n  // Case 3b: Look for other bidi parts on the next visual line\n  var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n  if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n    res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n    if (res) { return res }\n  }\n\n  // Case 4: Nowhere to move\n  return null\n}\n\n// Commands are parameter-less actions that can be performed on an\n// editor, mostly used for keybindings.\nvar commands = {\n  selectAll: selectAll,\n  singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n  killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n    if (range.empty()) {\n      var len = getLine(cm.doc, range.head.line).text.length;\n      if (range.head.ch == len && range.head.line < cm.lastLine())\n        { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n      else\n        { return {from: range.head, to: Pos(range.head.line, len)} }\n    } else {\n      return {from: range.from(), to: range.to()}\n    }\n  }); },\n  deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0),\n    to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n  }); }); },\n  delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0), to: range.from()\n  }); }); },\n  delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n    return {from: leftPos, to: range.from()}\n  }); },\n  delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n    return {from: range.from(), to: rightPos }\n  }); },\n  undo: function (cm) { return cm.undo(); },\n  redo: function (cm) { return cm.redo(); },\n  undoSelection: function (cm) { return cm.undoSelection(); },\n  redoSelection: function (cm) { return cm.redoSelection(); },\n  goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n  goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n  goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n    {origin: \"+move\", bias: -1}\n  ); },\n  goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.cursorCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.cursorCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: 0, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.cursorCoords(range.head, \"div\").top + 5;\n    var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n    if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n    return pos\n  }, sel_move); },\n  goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n  goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n  goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n  goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n  goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n  goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n  goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n  goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n  goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n  goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n  goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n  goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n  delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n  delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n  delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n  delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n  delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n  delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n  indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n  indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n  indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n  insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n  insertSoftTab: function (cm) {\n    var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n    for (var i = 0; i < ranges.length; i++) {\n      var pos = ranges[i].from();\n      var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n      spaces.push(spaceStr(tabSize - col % tabSize));\n    }\n    cm.replaceSelections(spaces);\n  },\n  defaultTab: function (cm) {\n    if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n    else { cm.execCommand(\"insertTab\"); }\n  },\n  // Swap the two chars left and right of each selection's head.\n  // Move cursor behind the two swapped characters afterwards.\n  //\n  // Doesn't consider line feeds a character.\n  // Doesn't scan more than one line above to find a character.\n  // Doesn't do anything on an empty line.\n  // Doesn't do anything with non-empty selections.\n  transposeChars: function (cm) { return runInOp(cm, function () {\n    var ranges = cm.listSelections(), newSel = [];\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) { continue }\n      var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n      if (line) {\n        if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n        if (cur.ch > 0) {\n          cur = new Pos(cur.line, cur.ch + 1);\n          cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                          Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n        } else if (cur.line > cm.doc.first) {\n          var prev = getLine(cm.doc, cur.line - 1).text;\n          if (prev) {\n            cur = new Pos(cur.line, 1);\n            cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                            prev.charAt(prev.length - 1),\n                            Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n          }\n        }\n      }\n      newSel.push(new Range(cur, cur));\n    }\n    cm.setSelections(newSel);\n  }); },\n  newlineAndIndent: function (cm) { return runInOp(cm, function () {\n    var sels = cm.listSelections();\n    for (var i = sels.length - 1; i >= 0; i--)\n      { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n    sels = cm.listSelections();\n    for (var i$1 = 0; i$1 < sels.length; i$1++)\n      { cm.indentLine(sels[i$1].from().line, null, true); }\n    ensureCursorVisible(cm);\n  }); },\n  openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n  toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n};\n\n\nfunction lineStart(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLine(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, visual, lineN, 1)\n}\nfunction lineEnd(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLineEnd(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, line, lineN, -1)\n}\nfunction lineStartSmart(cm, pos) {\n  var start = lineStart(cm, pos.line);\n  var line = getLine(cm.doc, start.line);\n  var order = getOrder(line, cm.doc.direction);\n  if (!order || order[0].level == 0) {\n    var firstNonWS = Math.max(0, line.text.search(/\\S/));\n    var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n    return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n  }\n  return start\n}\n\n// Run a handler that was bound to a key.\nfunction doHandleBinding(cm, bound, dropShift) {\n  if (typeof bound == \"string\") {\n    bound = commands[bound];\n    if (!bound) { return false }\n  }\n  // Ensure previous input has been read, so that the handler sees a\n  // consistent view of the document\n  cm.display.input.ensurePolled();\n  var prevShift = cm.display.shift, done = false;\n  try {\n    if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n    if (dropShift) { cm.display.shift = false; }\n    done = bound(cm) != Pass;\n  } finally {\n    cm.display.shift = prevShift;\n    cm.state.suppressEdits = false;\n  }\n  return done\n}\n\nfunction lookupKeyForEditor(cm, name, handle) {\n  for (var i = 0; i < cm.state.keyMaps.length; i++) {\n    var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n    if (result) { return result }\n  }\n  return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n    || lookupKey(name, cm.options.keyMap, handle, cm)\n}\n\n// Note that, despite the name, this function is also used to check\n// for bound mouse clicks.\n\nvar stopSeq = new Delayed;\n\nfunction dispatchKey(cm, name, e, handle) {\n  var seq = cm.state.keySeq;\n  if (seq) {\n    if (isModifierKey(name)) { return \"handled\" }\n    if (/\\'$/.test(name))\n      { cm.state.keySeq = null; }\n    else\n      { stopSeq.set(50, function () {\n        if (cm.state.keySeq == seq) {\n          cm.state.keySeq = null;\n          cm.display.input.reset();\n        }\n      }); }\n    if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n  }\n  return dispatchKeyInner(cm, name, e, handle)\n}\n\nfunction dispatchKeyInner(cm, name, e, handle) {\n  var result = lookupKeyForEditor(cm, name, handle);\n\n  if (result == \"multi\")\n    { cm.state.keySeq = name; }\n  if (result == \"handled\")\n    { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n  if (result == \"handled\" || result == \"multi\") {\n    e_preventDefault(e);\n    restartBlink(cm);\n  }\n\n  return !!result\n}\n\n// Handle a key from the keydown event.\nfunction handleKeyBinding(cm, e) {\n  var name = keyName(e, true);\n  if (!name) { return false }\n\n  if (e.shiftKey && !cm.state.keySeq) {\n    // First try to resolve full name (including 'Shift-'). Failing\n    // that, see if there is a cursor-motion command (starting with\n    // 'go') bound to the keyname without 'Shift-'.\n    return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n        || dispatchKey(cm, name, e, function (b) {\n             if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n               { return doHandleBinding(cm, b) }\n           })\n  } else {\n    return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n  }\n}\n\n// Handle a key from the keypress event\nfunction handleCharBinding(cm, e, ch) {\n  return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n}\n\nvar lastStoppedKey = null;\nfunction onKeyDown(e) {\n  var cm = this;\n  cm.curOp.focus = activeElt();\n  if (signalDOMEvent(cm, e)) { return }\n  // IE does strange things with escape.\n  if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n  var code = e.keyCode;\n  cm.display.shift = code == 16 || e.shiftKey;\n  var handled = handleKeyBinding(cm, e);\n  if (presto) {\n    lastStoppedKey = handled ? code : null;\n    // Opera has no cut event... we try to at least catch the key combo\n    if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n      { cm.replaceSelection(\"\", null, \"cut\"); }\n  }\n\n  // Turn mouse into crosshair when Alt is held on Mac.\n  if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n    { showCrossHair(cm); }\n}\n\nfunction showCrossHair(cm) {\n  var lineDiv = cm.display.lineDiv;\n  addClass(lineDiv, \"CodeMirror-crosshair\");\n\n  function up(e) {\n    if (e.keyCode == 18 || !e.altKey) {\n      rmClass(lineDiv, \"CodeMirror-crosshair\");\n      off(document, \"keyup\", up);\n      off(document, \"mouseover\", up);\n    }\n  }\n  on(document, \"keyup\", up);\n  on(document, \"mouseover\", up);\n}\n\nfunction onKeyUp(e) {\n  if (e.keyCode == 16) { this.doc.sel.shift = false; }\n  signalDOMEvent(this, e);\n}\n\nfunction onKeyPress(e) {\n  var cm = this;\n  if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n  var keyCode = e.keyCode, charCode = e.charCode;\n  if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n  if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n  var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n  // Some browsers fire keypress events for backspace\n  if (ch == \"\\x08\") { return }\n  if (handleCharBinding(cm, e, ch)) { return }\n  cm.display.input.onKeyPress(e);\n}\n\nvar DOUBLECLICK_DELAY = 400;\n\nvar PastClick = function(time, pos, button) {\n  this.time = time;\n  this.pos = pos;\n  this.button = button;\n};\n\nPastClick.prototype.compare = function (time, pos, button) {\n  return this.time + DOUBLECLICK_DELAY > time &&\n    cmp(pos, this.pos) == 0 && button == this.button\n};\n\nvar lastClick;\nvar lastDoubleClick;\nfunction clickRepeat(pos, button) {\n  var now = +new Date;\n  if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n    lastClick = lastDoubleClick = null;\n    return \"triple\"\n  } else if (lastClick && lastClick.compare(now, pos, button)) {\n    lastDoubleClick = new PastClick(now, pos, button);\n    lastClick = null;\n    return \"double\"\n  } else {\n    lastClick = new PastClick(now, pos, button);\n    lastDoubleClick = null;\n    return \"single\"\n  }\n}\n\n// A mouse down can be a single click, double click, triple click,\n// start of selection drag, start of text drag, new cursor\n// (ctrl-click), rectangle drag (alt-drag), or xwin\n// middle-click-paste. Or it might be a click on something we should\n// not interfere with, such as a scrollbar or widget.\nfunction onMouseDown(e) {\n  var cm = this, display = cm.display;\n  if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n  display.input.ensurePolled();\n  display.shift = e.shiftKey;\n\n  if (eventInWidget(display, e)) {\n    if (!webkit) {\n      // Briefly turn off draggability, to allow widgets to do\n      // normal dragging things.\n      display.scroller.draggable = false;\n      setTimeout(function () { return display.scroller.draggable = true; }, 100);\n    }\n    return\n  }\n  if (clickInGutter(cm, e)) { return }\n  var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n  window.focus();\n\n  // #3261: make sure, that we're not starting a second selection\n  if (button == 1 && cm.state.selectingText)\n    { cm.state.selectingText(e); }\n\n  if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n  if (button == 1) {\n    if (pos) { leftButtonDown(cm, pos, repeat, e); }\n    else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n  } else if (button == 2) {\n    if (pos) { extendSelection(cm.doc, pos); }\n    setTimeout(function () { return display.input.focus(); }, 20);\n  } else if (button == 3) {\n    if (captureRightClick) { onContextMenu(cm, e); }\n    else { delayBlurEvent(cm); }\n  }\n}\n\nfunction handleMappedButton(cm, button, pos, repeat, event) {\n  var name = \"Click\";\n  if (repeat == \"double\") { name = \"Double\" + name; }\n  else if (repeat == \"triple\") { name = \"Triple\" + name; }\n  name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n  return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n    if (typeof bound == \"string\") { bound = commands[bound]; }\n    if (!bound) { return false }\n    var done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      done = bound(cm, pos) != Pass;\n    } finally {\n      cm.state.suppressEdits = false;\n    }\n    return done\n  })\n}\n\nfunction configureMouse(cm, repeat, event) {\n  var option = cm.getOption(\"configureMouse\");\n  var value = option ? option(cm, repeat, event) : {};\n  if (value.unit == null) {\n    var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n    value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n  }\n  if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n  if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n  if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n  return value\n}\n\nfunction leftButtonDown(cm, pos, repeat, event) {\n  if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n  else { cm.curOp.focus = activeElt(); }\n\n  var behavior = configureMouse(cm, repeat, event);\n\n  var sel = cm.doc.sel, contained;\n  if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n      repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n      (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n      (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n    { leftButtonStartDrag(cm, event, pos, behavior); }\n  else\n    { leftButtonSelect(cm, event, pos, behavior); }\n}\n\n// Start a text drag. When it ends, see if any dragging actually\n// happen, and treat as a click if it didn't.\nfunction leftButtonStartDrag(cm, event, pos, behavior) {\n  var display = cm.display, moved = false;\n  var dragEnd = operation(cm, function (e) {\n    if (webkit) { display.scroller.draggable = false; }\n    cm.state.draggingText = false;\n    off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    off(display.scroller, \"dragstart\", dragStart);\n    off(display.scroller, \"drop\", dragEnd);\n    if (!moved) {\n      e_preventDefault(e);\n      if (!behavior.addNew)\n        { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n      // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n      if (webkit || ie && ie_version == 9)\n        { setTimeout(function () {display.wrapper.ownerDocument.body.focus(); display.input.focus();}, 20); }\n      else\n        { display.input.focus(); }\n    }\n  });\n  var mouseMove = function(e2) {\n    moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n  };\n  var dragStart = function () { return moved = true; };\n  // Let the drag handler handle this.\n  if (webkit) { display.scroller.draggable = true; }\n  cm.state.draggingText = dragEnd;\n  dragEnd.copy = !behavior.moveOnDrag;\n  // IE's approach to draggable\n  if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n  on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n  on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n  on(display.scroller, \"dragstart\", dragStart);\n  on(display.scroller, \"drop\", dragEnd);\n\n  delayBlurEvent(cm);\n  setTimeout(function () { return display.input.focus(); }, 20);\n}\n\nfunction rangeForUnit(cm, pos, unit) {\n  if (unit == \"char\") { return new Range(pos, pos) }\n  if (unit == \"word\") { return cm.findWordAt(pos) }\n  if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n  var result = unit(cm, pos);\n  return new Range(result.from, result.to)\n}\n\n// Normal selection, as opposed to text dragging.\nfunction leftButtonSelect(cm, event, start, behavior) {\n  var display = cm.display, doc = cm.doc;\n  e_preventDefault(event);\n\n  var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n  if (behavior.addNew && !behavior.extend) {\n    ourIndex = doc.sel.contains(start);\n    if (ourIndex > -1)\n      { ourRange = ranges[ourIndex]; }\n    else\n      { ourRange = new Range(start, start); }\n  } else {\n    ourRange = doc.sel.primary();\n    ourIndex = doc.sel.primIndex;\n  }\n\n  if (behavior.unit == \"rectangle\") {\n    if (!behavior.addNew) { ourRange = new Range(start, start); }\n    start = posFromMouse(cm, event, true, true);\n    ourIndex = -1;\n  } else {\n    var range$$1 = rangeForUnit(cm, start, behavior.unit);\n    if (behavior.extend)\n      { ourRange = extendRange(ourRange, range$$1.anchor, range$$1.head, behavior.extend); }\n    else\n      { ourRange = range$$1; }\n  }\n\n  if (!behavior.addNew) {\n    ourIndex = 0;\n    setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n    startSel = doc.sel;\n  } else if (ourIndex == -1) {\n    ourIndex = ranges.length;\n    setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex),\n                 {scroll: false, origin: \"*mouse\"});\n  } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n    setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                 {scroll: false, origin: \"*mouse\"});\n    startSel = doc.sel;\n  } else {\n    replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n  }\n\n  var lastPos = start;\n  function extendTo(pos) {\n    if (cmp(lastPos, pos) == 0) { return }\n    lastPos = pos;\n\n    if (behavior.unit == \"rectangle\") {\n      var ranges = [], tabSize = cm.options.tabSize;\n      var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n      var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n      var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n      for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n           line <= end; line++) {\n        var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n        if (left == right)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n        else if (text.length > leftPos)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n      }\n      if (!ranges.length) { ranges.push(new Range(start, start)); }\n      setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                   {origin: \"*mouse\", scroll: false});\n      cm.scrollIntoView(pos);\n    } else {\n      var oldRange = ourRange;\n      var range$$1 = rangeForUnit(cm, pos, behavior.unit);\n      var anchor = oldRange.anchor, head;\n      if (cmp(range$$1.anchor, anchor) > 0) {\n        head = range$$1.head;\n        anchor = minPos(oldRange.from(), range$$1.anchor);\n      } else {\n        head = range$$1.anchor;\n        anchor = maxPos(oldRange.to(), range$$1.head);\n      }\n      var ranges$1 = startSel.ranges.slice(0);\n      ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n      setSelection(doc, normalizeSelection(ranges$1, ourIndex), sel_mouse);\n    }\n  }\n\n  var editorSize = display.wrapper.getBoundingClientRect();\n  // Used to ensure timeout re-tries don't fire when another extend\n  // happened in the meantime (clearTimeout isn't reliable -- at\n  // least on Chrome, the timeouts still happen even when cleared,\n  // if the clear happens after their scheduled firing time).\n  var counter = 0;\n\n  function extend(e) {\n    var curCount = ++counter;\n    var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n    if (!cur) { return }\n    if (cmp(cur, lastPos) != 0) {\n      cm.curOp.focus = activeElt();\n      extendTo(cur);\n      var visible = visibleLines(display, doc);\n      if (cur.line >= visible.to || cur.line < visible.from)\n        { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n    } else {\n      var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n      if (outside) { setTimeout(operation(cm, function () {\n        if (counter != curCount) { return }\n        display.scroller.scrollTop += outside;\n        extend(e);\n      }), 50); }\n    }\n  }\n\n  function done(e) {\n    cm.state.selectingText = false;\n    counter = Infinity;\n    e_preventDefault(e);\n    display.input.focus();\n    off(display.wrapper.ownerDocument, \"mousemove\", move);\n    off(display.wrapper.ownerDocument, \"mouseup\", up);\n    doc.history.lastSelOrigin = null;\n  }\n\n  var move = operation(cm, function (e) {\n    if (e.buttons === 0 || !e_button(e)) { done(e); }\n    else { extend(e); }\n  });\n  var up = operation(cm, done);\n  cm.state.selectingText = up;\n  on(display.wrapper.ownerDocument, \"mousemove\", move);\n  on(display.wrapper.ownerDocument, \"mouseup\", up);\n}\n\n// Used when mouse-selecting to adjust the anchor to the proper side\n// of a bidi jump depending on the visual position of the head.\nfunction bidiSimplify(cm, range$$1) {\n  var anchor = range$$1.anchor;\n  var head = range$$1.head;\n  var anchorLine = getLine(cm.doc, anchor.line);\n  if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range$$1 }\n  var order = getOrder(anchorLine);\n  if (!order) { return range$$1 }\n  var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n  if (part.from != anchor.ch && part.to != anchor.ch) { return range$$1 }\n  var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n  if (boundary == 0 || boundary == order.length) { return range$$1 }\n\n  // Compute the relative visual position of the head compared to the\n  // anchor (<0 is to the left, >0 to the right)\n  var leftSide;\n  if (head.line != anchor.line) {\n    leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n  } else {\n    var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n    var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n    if (headIndex == boundary - 1 || headIndex == boundary)\n      { leftSide = dir < 0; }\n    else\n      { leftSide = dir > 0; }\n  }\n\n  var usePart = order[boundary + (leftSide ? -1 : 0)];\n  var from = leftSide == (usePart.level == 1);\n  var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n  return anchor.ch == ch && anchor.sticky == sticky ? range$$1 : new Range(new Pos(anchor.line, ch, sticky), head)\n}\n\n\n// Determines whether an event happened in the gutter, and fires the\n// handlers for the corresponding event.\nfunction gutterEvent(cm, e, type, prevent) {\n  var mX, mY;\n  if (e.touches) {\n    mX = e.touches[0].clientX;\n    mY = e.touches[0].clientY;\n  } else {\n    try { mX = e.clientX; mY = e.clientY; }\n    catch(e) { return false }\n  }\n  if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n  if (prevent) { e_preventDefault(e); }\n\n  var display = cm.display;\n  var lineBox = display.lineDiv.getBoundingClientRect();\n\n  if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n  mY -= lineBox.top - display.viewOffset;\n\n  for (var i = 0; i < cm.options.gutters.length; ++i) {\n    var g = display.gutters.childNodes[i];\n    if (g && g.getBoundingClientRect().right >= mX) {\n      var line = lineAtHeight(cm.doc, mY);\n      var gutter = cm.options.gutters[i];\n      signal(cm, type, cm, line, gutter, e);\n      return e_defaultPrevented(e)\n    }\n  }\n}\n\nfunction clickInGutter(cm, e) {\n  return gutterEvent(cm, e, \"gutterClick\", true)\n}\n\n// CONTEXT MENU HANDLING\n\n// To make the context menu work, we need to briefly unhide the\n// textarea (making it as unobtrusive as possible) to let the\n// right-click take effect on it.\nfunction onContextMenu(cm, e) {\n  if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n  if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n  cm.display.input.onContextMenu(e);\n}\n\nfunction contextMenuInGutter(cm, e) {\n  if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n  return gutterEvent(cm, e, \"gutterContextMenu\", false)\n}\n\nfunction themeChanged(cm) {\n  cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n    cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n  clearCaches(cm);\n}\n\nvar Init = {toString: function(){return \"CodeMirror.Init\"}};\n\nvar defaults = {};\nvar optionHandlers = {};\n\nfunction defineOptions(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  function option(name, deflt, handle, notOnInit) {\n    CodeMirror.defaults[name] = deflt;\n    if (handle) { optionHandlers[name] =\n      notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n  }\n\n  CodeMirror.defineOption = option;\n\n  // Passed to option handlers when there is no old value.\n  CodeMirror.Init = Init;\n\n  // These two are, on init, called from the constructor because they\n  // have to be initialized before the editor can start at all.\n  option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n  option(\"mode\", null, function (cm, val) {\n    cm.doc.modeOption = val;\n    loadMode(cm);\n  }, true);\n\n  option(\"indentUnit\", 2, loadMode, true);\n  option(\"indentWithTabs\", false);\n  option(\"smartIndent\", true);\n  option(\"tabSize\", 4, function (cm) {\n    resetModeState(cm);\n    clearCaches(cm);\n    regChange(cm);\n  }, true);\n\n  option(\"lineSeparator\", null, function (cm, val) {\n    cm.doc.lineSep = val;\n    if (!val) { return }\n    var newBreaks = [], lineNo = cm.doc.first;\n    cm.doc.iter(function (line) {\n      for (var pos = 0;;) {\n        var found = line.text.indexOf(val, pos);\n        if (found == -1) { break }\n        pos = found + val.length;\n        newBreaks.push(Pos(lineNo, found));\n      }\n      lineNo++;\n    });\n    for (var i = newBreaks.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n  });\n  option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n    cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n    if (old != Init) { cm.refresh(); }\n  });\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n  option(\"electricChars\", true);\n  option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n    throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n  }, true);\n  option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n  option(\"rtlMoveVisually\", !windows);\n  option(\"wholeLineUpdateBefore\", true);\n\n  option(\"theme\", \"default\", function (cm) {\n    themeChanged(cm);\n    guttersChanged(cm);\n  }, true);\n  option(\"keyMap\", \"default\", function (cm, val, old) {\n    var next = getKeyMap(val);\n    var prev = old != Init && getKeyMap(old);\n    if (prev && prev.detach) { prev.detach(cm, next); }\n    if (next.attach) { next.attach(cm, prev || null); }\n  });\n  option(\"extraKeys\", null);\n  option(\"configureMouse\", null);\n\n  option(\"lineWrapping\", false, wrappingChanged, true);\n  option(\"gutters\", [], function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"fixedGutter\", true, function (cm, val) {\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n    cm.refresh();\n  }, true);\n  option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n  option(\"scrollbarStyle\", \"native\", function (cm) {\n    initScrollbars(cm);\n    updateScrollbars(cm);\n    cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n    cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n  }, true);\n  option(\"lineNumbers\", false, function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"firstLineNumber\", 1, guttersChanged, true);\n  option(\"lineNumberFormatter\", function (integer) { return integer; }, guttersChanged, true);\n  option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n  option(\"resetSelectionOnContextMenu\", true);\n  option(\"lineWiseCopyCut\", true);\n  option(\"pasteLinesPerSelection\", true);\n\n  option(\"readOnly\", false, function (cm, val) {\n    if (val == \"nocursor\") {\n      onBlur(cm);\n      cm.display.input.blur();\n    }\n    cm.display.input.readOnlyChanged(val);\n  });\n  option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n  option(\"dragDrop\", true, dragDropChanged);\n  option(\"allowDropFileTypes\", null);\n\n  option(\"cursorBlinkRate\", 530);\n  option(\"cursorScrollMargin\", 0);\n  option(\"cursorHeight\", 1, updateSelection, true);\n  option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n  option(\"workTime\", 100);\n  option(\"workDelay\", 100);\n  option(\"flattenSpans\", true, resetModeState, true);\n  option(\"addModeClass\", false, resetModeState, true);\n  option(\"pollInterval\", 100);\n  option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n  option(\"historyEventDelay\", 1250);\n  option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n  option(\"maxHighlightLength\", 10000, resetModeState, true);\n  option(\"moveInputWithCursor\", true, function (cm, val) {\n    if (!val) { cm.display.input.resetPosition(); }\n  });\n\n  option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n  option(\"autofocus\", null);\n  option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n  option(\"phrases\", null);\n}\n\nfunction guttersChanged(cm) {\n  updateGutters(cm);\n  regChange(cm);\n  alignHorizontally(cm);\n}\n\nfunction dragDropChanged(cm, value, old) {\n  var wasOn = old && old != Init;\n  if (!value != !wasOn) {\n    var funcs = cm.display.dragFunctions;\n    var toggle = value ? on : off;\n    toggle(cm.display.scroller, \"dragstart\", funcs.start);\n    toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n    toggle(cm.display.scroller, \"dragover\", funcs.over);\n    toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n    toggle(cm.display.scroller, \"drop\", funcs.drop);\n  }\n}\n\nfunction wrappingChanged(cm) {\n  if (cm.options.lineWrapping) {\n    addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    cm.display.sizer.style.minWidth = \"\";\n    cm.display.sizerWidth = null;\n  } else {\n    rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    findMaxLine(cm);\n  }\n  estimateLineHeights(cm);\n  regChange(cm);\n  clearCaches(cm);\n  setTimeout(function () { return updateScrollbars(cm); }, 100);\n}\n\n// A CodeMirror instance represents an editor. This is the object\n// that user code is usually dealing with.\n\nfunction CodeMirror$1(place, options) {\n  var this$1 = this;\n\n  if (!(this instanceof CodeMirror$1)) { return new CodeMirror$1(place, options) }\n\n  this.options = options = options ? copyObj(options) : {};\n  // Determine effective options based on given values and defaults.\n  copyObj(defaults, options, false);\n  setGuttersForLineNumbers(options);\n\n  var doc = options.value;\n  if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n  else if (options.mode) { doc.modeOption = options.mode; }\n  this.doc = doc;\n\n  var input = new CodeMirror$1.inputStyles[options.inputStyle](this);\n  var display = this.display = new Display(place, doc, input);\n  display.wrapper.CodeMirror = this;\n  updateGutters(this);\n  themeChanged(this);\n  if (options.lineWrapping)\n    { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n  initScrollbars(this);\n\n  this.state = {\n    keyMaps: [],  // stores maps added by addKeyMap\n    overlays: [], // highlighting overlays, as added by addOverlay\n    modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n    overwrite: false,\n    delayingBlurEvent: false,\n    focused: false,\n    suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n    pasteIncoming: false, cutIncoming: false, // help recognize paste/cut edits in input.poll\n    selectingText: false,\n    draggingText: false,\n    highlight: new Delayed(), // stores highlight worker timeout\n    keySeq: null,  // Unfinished key sequence\n    specialChars: null\n  };\n\n  if (options.autofocus && !mobile) { display.input.focus(); }\n\n  // Override magic textarea content restore that IE sometimes does\n  // on our hidden textarea on reload\n  if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n  registerEventHandlers(this);\n  ensureGlobalHandlers();\n\n  startOperation(this);\n  this.curOp.forceUpdate = true;\n  attachDoc(this, doc);\n\n  if ((options.autofocus && !mobile) || this.hasFocus())\n    { setTimeout(bind(onFocus, this), 20); }\n  else\n    { onBlur(this); }\n\n  for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n    { optionHandlers[opt](this$1, options[opt], Init); } }\n  maybeUpdateLineNumberWidth(this);\n  if (options.finishInit) { options.finishInit(this); }\n  for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this$1); }\n  endOperation(this);\n  // Suppress optimizelegibility in Webkit, since it breaks text\n  // measuring on line wrapping boundaries.\n  if (webkit && options.lineWrapping &&\n      getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n    { display.lineDiv.style.textRendering = \"auto\"; }\n}\n\n// The default configuration options.\nCodeMirror$1.defaults = defaults;\n// Functions to run when options are changed.\nCodeMirror$1.optionHandlers = optionHandlers;\n\n// Attach the necessary event handlers when initializing the editor\nfunction registerEventHandlers(cm) {\n  var d = cm.display;\n  on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n  // Older IE's will not fire a second mousedown for a double click\n  if (ie && ie_version < 11)\n    { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n      if (signalDOMEvent(cm, e)) { return }\n      var pos = posFromMouse(cm, e);\n      if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n      e_preventDefault(e);\n      var word = cm.findWordAt(pos);\n      extendSelection(cm.doc, word.anchor, word.head);\n    })); }\n  else\n    { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n  // Some browsers fire contextmenu *after* opening the menu, at\n  // which point we can't mess with it anymore. Context menu is\n  // handled in onMouseDown for these browsers.\n  if (!captureRightClick) { on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); }); }\n\n  // Used to suppress mouse event handling when a touch happens\n  var touchFinished, prevTouch = {end: 0};\n  function finishTouch() {\n    if (d.activeTouch) {\n      touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n      prevTouch = d.activeTouch;\n      prevTouch.end = +new Date;\n    }\n  }\n  function isMouseLikeTouchEvent(e) {\n    if (e.touches.length != 1) { return false }\n    var touch = e.touches[0];\n    return touch.radiusX <= 1 && touch.radiusY <= 1\n  }\n  function farAway(touch, other) {\n    if (other.left == null) { return true }\n    var dx = other.left - touch.left, dy = other.top - touch.top;\n    return dx * dx + dy * dy > 20 * 20\n  }\n  on(d.scroller, \"touchstart\", function (e) {\n    if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n      d.input.ensurePolled();\n      clearTimeout(touchFinished);\n      var now = +new Date;\n      d.activeTouch = {start: now, moved: false,\n                       prev: now - prevTouch.end <= 300 ? prevTouch : null};\n      if (e.touches.length == 1) {\n        d.activeTouch.left = e.touches[0].pageX;\n        d.activeTouch.top = e.touches[0].pageY;\n      }\n    }\n  });\n  on(d.scroller, \"touchmove\", function () {\n    if (d.activeTouch) { d.activeTouch.moved = true; }\n  });\n  on(d.scroller, \"touchend\", function (e) {\n    var touch = d.activeTouch;\n    if (touch && !eventInWidget(d, e) && touch.left != null &&\n        !touch.moved && new Date - touch.start < 300) {\n      var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n      if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n        { range = new Range(pos, pos); }\n      else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n        { range = cm.findWordAt(pos); }\n      else // Triple tap\n        { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n      cm.setSelection(range.anchor, range.head);\n      cm.focus();\n      e_preventDefault(e);\n    }\n    finishTouch();\n  });\n  on(d.scroller, \"touchcancel\", finishTouch);\n\n  // Sync scrolling between fake scrollbars and real scrollable\n  // area, ensure viewport is updated when scrolling.\n  on(d.scroller, \"scroll\", function () {\n    if (d.scroller.clientHeight) {\n      updateScrollTop(cm, d.scroller.scrollTop);\n      setScrollLeft(cm, d.scroller.scrollLeft, true);\n      signal(cm, \"scroll\", cm);\n    }\n  });\n\n  // Listen to wheel events in order to try and update the viewport on time.\n  on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n  on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n  // Prevent wrapper from ever scrolling\n  on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n  d.dragFunctions = {\n    enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n    over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n    start: function (e) { return onDragStart(cm, e); },\n    drop: operation(cm, onDrop),\n    leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n  };\n\n  var inp = d.input.getField();\n  on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n  on(inp, \"keydown\", operation(cm, onKeyDown));\n  on(inp, \"keypress\", operation(cm, onKeyPress));\n  on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n  on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n}\n\nvar initHooks = [];\nCodeMirror$1.defineInitHook = function (f) { return initHooks.push(f); };\n\n// Indent the given line. The how parameter can be \"smart\",\n// \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n// (typically set to true for forced single-line indents), empty\n// lines are not indented, and places where the mode returns Pass\n// are left alone.\nfunction indentLine(cm, n, how, aggressive) {\n  var doc = cm.doc, state;\n  if (how == null) { how = \"add\"; }\n  if (how == \"smart\") {\n    // Fall back to \"prev\" when the mode doesn't have an indentation\n    // method.\n    if (!doc.mode.indent) { how = \"prev\"; }\n    else { state = getContextBefore(cm, n).state; }\n  }\n\n  var tabSize = cm.options.tabSize;\n  var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n  if (line.stateAfter) { line.stateAfter = null; }\n  var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n  if (!aggressive && !/\\S/.test(line.text)) {\n    indentation = 0;\n    how = \"not\";\n  } else if (how == \"smart\") {\n    indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n    if (indentation == Pass || indentation > 150) {\n      if (!aggressive) { return }\n      how = \"prev\";\n    }\n  }\n  if (how == \"prev\") {\n    if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n    else { indentation = 0; }\n  } else if (how == \"add\") {\n    indentation = curSpace + cm.options.indentUnit;\n  } else if (how == \"subtract\") {\n    indentation = curSpace - cm.options.indentUnit;\n  } else if (typeof how == \"number\") {\n    indentation = curSpace + how;\n  }\n  indentation = Math.max(0, indentation);\n\n  var indentString = \"\", pos = 0;\n  if (cm.options.indentWithTabs)\n    { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n  if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n  if (indentString != curSpaceString) {\n    replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n    line.stateAfter = null;\n    return true\n  } else {\n    // Ensure that, if the cursor was in the whitespace at the start\n    // of the line, it is moved to the end of that space.\n    for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n      var range = doc.sel.ranges[i$1];\n      if (range.head.line == n && range.head.ch < curSpaceString.length) {\n        var pos$1 = Pos(n, curSpaceString.length);\n        replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n        break\n      }\n    }\n  }\n}\n\n// This will be set to a {lineWise: bool, text: [string]} object, so\n// that, when pasting, we know what kind of selections the copied\n// text was made out of.\nvar lastCopied = null;\n\nfunction setLastCopied(newLastCopied) {\n  lastCopied = newLastCopied;\n}\n\nfunction applyTextInput(cm, inserted, deleted, sel, origin) {\n  var doc = cm.doc;\n  cm.display.shift = false;\n  if (!sel) { sel = doc.sel; }\n\n  var paste = cm.state.pasteIncoming || origin == \"paste\";\n  var textLines = splitLinesAuto(inserted), multiPaste = null;\n  // When pasting N lines into N selections, insert one line per selection\n  if (paste && sel.ranges.length > 1) {\n    if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n      if (sel.ranges.length % lastCopied.text.length == 0) {\n        multiPaste = [];\n        for (var i = 0; i < lastCopied.text.length; i++)\n          { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n      }\n    } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n      multiPaste = map(textLines, function (l) { return [l]; });\n    }\n  }\n\n  var updateInput;\n  // Normal behavior is to insert the new text into every selection\n  for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n    var range$$1 = sel.ranges[i$1];\n    var from = range$$1.from(), to = range$$1.to();\n    if (range$$1.empty()) {\n      if (deleted && deleted > 0) // Handle deletion\n        { from = Pos(from.line, from.ch - deleted); }\n      else if (cm.state.overwrite && !paste) // Handle overwrite\n        { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n      else if (lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n        { from = to = Pos(from.line, 0); }\n    }\n    updateInput = cm.curOp.updateInput;\n    var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                       origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")};\n    makeChange(cm.doc, changeEvent);\n    signalLater(cm, \"inputRead\", cm, changeEvent);\n  }\n  if (inserted && !paste)\n    { triggerElectric(cm, inserted); }\n\n  ensureCursorVisible(cm);\n  cm.curOp.updateInput = updateInput;\n  cm.curOp.typing = true;\n  cm.state.pasteIncoming = cm.state.cutIncoming = false;\n}\n\nfunction handlePaste(e, cm) {\n  var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n  if (pasted) {\n    e.preventDefault();\n    if (!cm.isReadOnly() && !cm.options.disableInput)\n      { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n    return true\n  }\n}\n\nfunction triggerElectric(cm, inserted) {\n  // When an 'electric' character is inserted, immediately trigger a reindent\n  if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n  var sel = cm.doc.sel;\n\n  for (var i = sel.ranges.length - 1; i >= 0; i--) {\n    var range$$1 = sel.ranges[i];\n    if (range$$1.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range$$1.head.line)) { continue }\n    var mode = cm.getModeAt(range$$1.head);\n    var indented = false;\n    if (mode.electricChars) {\n      for (var j = 0; j < mode.electricChars.length; j++)\n        { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n          indented = indentLine(cm, range$$1.head.line, \"smart\");\n          break\n        } }\n    } else if (mode.electricInput) {\n      if (mode.electricInput.test(getLine(cm.doc, range$$1.head.line).text.slice(0, range$$1.head.ch)))\n        { indented = indentLine(cm, range$$1.head.line, \"smart\"); }\n    }\n    if (indented) { signalLater(cm, \"electricInput\", cm, range$$1.head.line); }\n  }\n}\n\nfunction copyableRanges(cm) {\n  var text = [], ranges = [];\n  for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n    var line = cm.doc.sel.ranges[i].head.line;\n    var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n    ranges.push(lineRange);\n    text.push(cm.getRange(lineRange.anchor, lineRange.head));\n  }\n  return {text: text, ranges: ranges}\n}\n\nfunction disableBrowserMagic(field, spellcheck) {\n  field.setAttribute(\"autocorrect\", \"off\");\n  field.setAttribute(\"autocapitalize\", \"off\");\n  field.setAttribute(\"spellcheck\", !!spellcheck);\n}\n\nfunction hiddenTextarea() {\n  var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n  var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n  // The textarea is kept positioned near the cursor to prevent the\n  // fact that it'll be scrolled into view on input from scrolling\n  // our fake cursor out of view. On webkit, when wrap=off, paste is\n  // very slow. So make the area wide instead.\n  if (webkit) { te.style.width = \"1000px\"; }\n  else { te.setAttribute(\"wrap\", \"off\"); }\n  // If border: 0; -- iOS fails to open keyboard (issue #1287)\n  if (ios) { te.style.border = \"1px solid black\"; }\n  disableBrowserMagic(te);\n  return div\n}\n\n// The publicly visible API. Note that methodOp(f) means\n// 'wrap f in an operation, performed on its `this` parameter'.\n\n// This is not the complete set of editor methods. Most of the\n// methods defined on the Doc type are also injected into\n// CodeMirror.prototype, for backwards compatibility and\n// convenience.\n\nvar addEditorMethods = function(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  var helpers = CodeMirror.helpers = {};\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); this.display.input.focus();},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") { return }\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        { operation(this, optionHandlers[option])(this, value, old); }\n      signal(this, \"optionChange\", this, option);\n    },\n\n    getOption: function(option) {return this.options[option]},\n    getDoc: function() {return this.doc},\n\n    addKeyMap: function(map$$1, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map$$1));\n    },\n    removeKeyMap: function(map$$1) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        { if (maps[i] == map$$1 || maps[i].name == map$$1) {\n          maps.splice(i, 1);\n          return true\n        } }\n    },\n\n    addOverlay: methodOp(function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n      insertSorted(this.state.overlays,\n                   {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                    priority: (options && options.priority) || 0},\n                   function (overlay) { return overlay.priority; });\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: methodOp(function(spec) {\n      var this$1 = this;\n\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this$1.state.modeGen++;\n          regChange(this$1);\n          return\n        }\n      }\n    }),\n\n    indentLine: methodOp(function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n        else { dir = dir ? \"add\" : \"subtract\"; }\n      }\n      if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n    }),\n    indentSelection: methodOp(function(how) {\n      var this$1 = this;\n\n      var ranges = this.doc.sel.ranges, end = -1;\n      for (var i = 0; i < ranges.length; i++) {\n        var range$$1 = ranges[i];\n        if (!range$$1.empty()) {\n          var from = range$$1.from(), to = range$$1.to();\n          var start = Math.max(end, from.line);\n          end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n          for (var j = start; j < end; ++j)\n            { indentLine(this$1, j, how); }\n          var newRanges = this$1.doc.sel.ranges;\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n            { replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n        } else if (range$$1.head.line > end) {\n          indentLine(this$1, range$$1.head.line, how, true);\n          end = range$$1.head.line;\n          if (i == this$1.doc.sel.primIndex) { ensureCursorVisible(this$1); }\n        }\n      }\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      return takeToken(this, pos, precise)\n    },\n\n    getLineTokens: function(line, precise) {\n      return takeToken(this, Pos(line), precise, true)\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      var type;\n      if (ch == 0) { type = styles[2]; }\n      else { for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n        else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n        else { type = styles[mid * 2 + 2]; break }\n      } }\n      var cut = type ? type.indexOf(\"overlay \") : -1;\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) { return mode }\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0]\n    },\n\n    getHelpers: function(pos, type) {\n      var this$1 = this;\n\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) { return found }\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) { found.push(help[mode[type]]); }\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) { found.push(val); }\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n        var cur = help._global[i$1];\n        if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1)\n          { found.push(cur.val); }\n      }\n      return found\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getContextBefore(this, line + 1, precise).state\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, range$$1 = this.doc.sel.primary();\n      if (start == null) { pos = range$$1.head; }\n      else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n      else { pos = start ? range$$1.from() : range$$1.to(); }\n      return cursorCoords(this, pos, mode || \"page\")\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top)\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset)\n    },\n    heightAtLine: function(line, mode, includeWidgets) {\n      var end = false, lineObj;\n      if (typeof line == \"number\") {\n        var last = this.doc.first + this.doc.size - 1;\n        if (line < this.doc.first) { line = this.doc.first; }\n        else if (line > last) { line = last; end = true; }\n        lineObj = getLine(this.doc, line);\n      } else {\n        lineObj = line;\n      }\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n        (end ? this.doc.height - heightAtLine(lineObj) : 0)\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display) },\n    defaultCharWidth: function() { return charWidth(this.display) },\n\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      node.setAttribute(\"cm-ignore-events\", \"true\");\n      this.display.input.setUneditable(node);\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          { top = pos.top - node.offsetHeight; }\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          { top = pos.bottom; }\n        if (left + node.offsetWidth > hspace)\n          { left = hspace - node.offsetWidth; }\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") { left = 0; }\n        else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n    },\n\n    triggerOnKeyDown: methodOp(onKeyDown),\n    triggerOnKeyPress: methodOp(onKeyPress),\n    triggerOnKeyUp: onKeyUp,\n    triggerOnMouseDown: methodOp(onMouseDown),\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        { return commands[cmd].call(null, this) }\n    },\n\n    triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n    findPosH: function(from, amount, unit, visually) {\n      var this$1 = this;\n\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        cur = findPosH(this$1.doc, cur, dir, unit, visually);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveH: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      this.extendSelectionsBy(function (range$$1) {\n        if (this$1.display.shift || this$1.doc.extend || range$$1.empty())\n          { return findPosH(this$1.doc, range$$1.head, dir, unit, this$1.options.rtlMoveVisually) }\n        else\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n      }, sel_move);\n    }),\n\n    deleteH: methodOp(function(dir, unit) {\n      var sel = this.doc.sel, doc = this.doc;\n      if (sel.somethingSelected())\n        { doc.replaceSelection(\"\", null, \"+delete\"); }\n      else\n        { deleteNearSelection(this, function (range$$1) {\n          var other = findPosH(doc, range$$1.head, dir, unit, false);\n          return dir < 0 ? {from: other, to: range$$1.head} : {from: range$$1.head, to: other}\n        }); }\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var this$1 = this;\n\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        var coords = cursorCoords(this$1, cur, \"div\");\n        if (x == null) { x = coords.left; }\n        else { coords.left = x; }\n        cur = findPosV(this$1, coords, dir, unit);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveV: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      var doc = this.doc, goals = [];\n      var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n      doc.extendSelectionsBy(function (range$$1) {\n        if (collapse)\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n        var headPos = cursorCoords(this$1, range$$1.head, \"div\");\n        if (range$$1.goalColumn != null) { headPos.left = range$$1.goalColumn; }\n        goals.push(headPos.left);\n        var pos = findPosV(this$1, headPos, dir, unit);\n        if (unit == \"page\" && range$$1 == doc.sel.primary())\n          { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n        return pos\n      }, sel_move);\n      if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n        { doc.sel.ranges[i].goalColumn = goals[i]; } }\n    }),\n\n    // Find the word at the given position (as returned by coordsChar).\n    findWordAt: function(pos) {\n      var doc = this.doc, line = getLine(doc, pos.line).text;\n      var start = pos.ch, end = pos.ch;\n      if (line) {\n        var helper = this.getHelper(pos, \"wordChars\");\n        if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n        var startChar = line.charAt(start);\n        var check = isWordChar(startChar, helper)\n          ? function (ch) { return isWordChar(ch, helper); }\n          : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n          : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n        while (start > 0 && check(line.charAt(start - 1))) { --start; }\n        while (end < line.length && check(line.charAt(end))) { ++end; }\n      }\n      return new Range(Pos(pos.line, start), Pos(pos.line, end))\n    },\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) { return }\n      if (this.state.overwrite = !this.state.overwrite)\n        { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n      else\n        { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return this.display.input.getField() == activeElt() },\n    isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n    scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n              width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n              clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n    },\n\n    scrollIntoView: methodOp(function(range$$1, margin) {\n      if (range$$1 == null) {\n        range$$1 = {from: this.doc.sel.primary().head, to: null};\n        if (margin == null) { margin = this.options.cursorScrollMargin; }\n      } else if (typeof range$$1 == \"number\") {\n        range$$1 = {from: Pos(range$$1, 0), to: null};\n      } else if (range$$1.from == null) {\n        range$$1 = {from: range$$1, to: null};\n      }\n      if (!range$$1.to) { range$$1.to = range$$1.from; }\n      range$$1.margin = margin || 0;\n\n      if (range$$1.from.line != null) {\n        scrollToRange(this, range$$1);\n      } else {\n        scrollToCoordsRange(this, range$$1.from, range$$1.to, range$$1.margin);\n      }\n    }),\n\n    setSize: methodOp(function(width, height) {\n      var this$1 = this;\n\n      var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n      if (width != null) { this.display.wrapper.style.width = interpret(width); }\n      if (height != null) { this.display.wrapper.style.height = interpret(height); }\n      if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n      var lineNo$$1 = this.display.viewFrom;\n      this.doc.iter(lineNo$$1, this.display.viewTo, function (line) {\n        if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n          { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo$$1, \"widget\"); break } } }\n        ++lineNo$$1;\n      });\n      this.curOp.forceUpdate = true;\n      signal(this, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f)},\n    startOperation: function(){return startOperation(this)},\n    endOperation: function(){return endOperation(this)},\n\n    refresh: methodOp(function() {\n      var oldHeight = this.display.cachedTextHeight;\n      regChange(this);\n      this.curOp.forceUpdate = true;\n      clearCaches(this);\n      scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n      updateGutterSpace(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        { estimateLineHeights(this); }\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: methodOp(function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      this.display.input.reset();\n      scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n      this.curOp.forceScroll = true;\n      signalLater(this, \"swapDoc\", this, old);\n      return old\n    }),\n\n    phrase: function(phraseText) {\n      var phrases = this.options.phrases;\n      return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n    },\n\n    getInputField: function(){return this.display.input.getField()},\n    getWrapperElement: function(){return this.display.wrapper},\n    getScrollerElement: function(){return this.display.scroller},\n    getGutterElement: function(){return this.display.gutters}\n  };\n  eventMixin(CodeMirror);\n\n  CodeMirror.registerHelper = function(type, name, value) {\n    if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n    helpers[type][name] = value;\n  };\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n    CodeMirror.registerHelper(type, name, value);\n    helpers[type]._global.push({pred: predicate, val: value});\n  };\n};\n\n// Used for horizontal relative motion. Dir is -1 or 1 (left or\n// right), unit can be \"char\", \"column\" (like char, but doesn't\n// cross line boundaries), \"word\" (across next word), or \"group\" (to\n// the start of next group of word or non-word-non-whitespace\n// chars). The visually param controls whether, in right-to-left\n// text, direction 1 means to move towards the next index in the\n// string, or towards the character to the right of the current\n// position. The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosH(doc, pos, dir, unit, visually) {\n  var oldPos = pos;\n  var origDir = dir;\n  var lineObj = getLine(doc, pos.line);\n  function findNextLine() {\n    var l = pos.line + dir;\n    if (l < doc.first || l >= doc.first + doc.size) { return false }\n    pos = new Pos(l, pos.ch, pos.sticky);\n    return lineObj = getLine(doc, l)\n  }\n  function moveOnce(boundToLine) {\n    var next;\n    if (visually) {\n      next = moveVisually(doc.cm, lineObj, pos, dir);\n    } else {\n      next = moveLogically(lineObj, pos, dir);\n    }\n    if (next == null) {\n      if (!boundToLine && findNextLine())\n        { pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir); }\n      else\n        { return false }\n    } else {\n      pos = next;\n    }\n    return true\n  }\n\n  if (unit == \"char\") {\n    moveOnce();\n  } else if (unit == \"column\") {\n    moveOnce(true);\n  } else if (unit == \"word\" || unit == \"group\") {\n    var sawType = null, group = unit == \"group\";\n    var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n    for (var first = true;; first = false) {\n      if (dir < 0 && !moveOnce(!first)) { break }\n      var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n      var type = isWordChar(cur, helper) ? \"w\"\n        : group && cur == \"\\n\" ? \"n\"\n        : !group || /\\s/.test(cur) ? null\n        : \"p\";\n      if (group && !first && !type) { type = \"s\"; }\n      if (sawType && sawType != type) {\n        if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n        break\n      }\n\n      if (type) { sawType = type; }\n      if (dir > 0 && !moveOnce(!first)) { break }\n    }\n  }\n  var result = skipAtomic(doc, pos, oldPos, origDir, true);\n  if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n  return result\n}\n\n// For relative vertical movement. Dir may be -1 or 1. Unit can be\n// \"page\" or \"line\". The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosV(cm, pos, dir, unit) {\n  var doc = cm.doc, x = pos.left, y;\n  if (unit == \"page\") {\n    var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n    var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n    y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n  } else if (unit == \"line\") {\n    y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n  }\n  var target;\n  for (;;) {\n    target = coordsChar(cm, x, y);\n    if (!target.outside) { break }\n    if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n    y += dir * 5;\n  }\n  return target\n}\n\n// CONTENTEDITABLE INPUT STYLE\n\nvar ContentEditableInput = function(cm) {\n  this.cm = cm;\n  this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n  this.polling = new Delayed();\n  this.composing = null;\n  this.gracePeriod = false;\n  this.readDOMTimeout = null;\n};\n\nContentEditableInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = input.cm;\n  var div = input.div = display.lineDiv;\n  disableBrowserMagic(div, cm.options.spellcheck);\n\n  on(div, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n    // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n    if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n  });\n\n  on(div, \"compositionstart\", function (e) {\n    this$1.composing = {data: e.data, done: false};\n  });\n  on(div, \"compositionupdate\", function (e) {\n    if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n  });\n  on(div, \"compositionend\", function (e) {\n    if (this$1.composing) {\n      if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n      this$1.composing.done = true;\n    }\n  });\n\n  on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n  on(div, \"input\", function () {\n    if (!this$1.composing) { this$1.readFromDOMSoon(); }\n  });\n\n  function onCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n      if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.operation(function () {\n          cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n          cm.replaceSelection(\"\", null, \"cut\");\n        });\n      }\n    }\n    if (e.clipboardData) {\n      e.clipboardData.clearData();\n      var content = lastCopied.text.join(\"\\n\");\n      // iOS exposes the clipboard API, but seems to discard content inserted into it\n      e.clipboardData.setData(\"Text\", content);\n      if (e.clipboardData.getData(\"Text\") == content) {\n        e.preventDefault();\n        return\n      }\n    }\n    // Old-fashioned briefly-focus-a-textarea hack\n    var kludge = hiddenTextarea(), te = kludge.firstChild;\n    cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n    te.value = lastCopied.text.join(\"\\n\");\n    var hadFocus = document.activeElement;\n    selectInput(te);\n    setTimeout(function () {\n      cm.display.lineSpace.removeChild(kludge);\n      hadFocus.focus();\n      if (hadFocus == div) { input.showPrimarySelection(); }\n    }, 50);\n  }\n  on(div, \"copy\", onCopyCut);\n  on(div, \"cut\", onCopyCut);\n};\n\nContentEditableInput.prototype.prepareSelection = function () {\n  var result = prepareSelection(this.cm, false);\n  result.focus = this.cm.state.focused;\n  return result\n};\n\nContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n  if (!info || !this.cm.display.view.length) { return }\n  if (info.focus || takeFocus) { this.showPrimarySelection(); }\n  this.showMultipleSelections(info);\n};\n\nContentEditableInput.prototype.getSelection = function () {\n  return this.cm.display.wrapper.ownerDocument.getSelection()\n};\n\nContentEditableInput.prototype.showPrimarySelection = function () {\n  var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n  var from = prim.from(), to = prim.to();\n\n  if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n      cmp(minPos(curAnchor, curFocus), from) == 0 &&\n      cmp(maxPos(curAnchor, curFocus), to) == 0)\n    { return }\n\n  var view = cm.display.view;\n  var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n      {node: view[0].measure.map[2], offset: 0};\n  var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n  if (!end) {\n    var measure = view[view.length - 1].measure;\n    var map$$1 = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n    end = {node: map$$1[map$$1.length - 1], offset: map$$1[map$$1.length - 2] - map$$1[map$$1.length - 3]};\n  }\n\n  if (!start || !end) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var old = sel.rangeCount && sel.getRangeAt(0), rng;\n  try { rng = range(start.node, start.offset, end.offset, end.node); }\n  catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n  if (rng) {\n    if (!gecko && cm.state.focused) {\n      sel.collapse(start.node, start.offset);\n      if (!rng.collapsed) {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n    } else {\n      sel.removeAllRanges();\n      sel.addRange(rng);\n    }\n    if (old && sel.anchorNode == null) { sel.addRange(old); }\n    else if (gecko) { this.startGracePeriod(); }\n  }\n  this.rememberSelection();\n};\n\nContentEditableInput.prototype.startGracePeriod = function () {\n    var this$1 = this;\n\n  clearTimeout(this.gracePeriod);\n  this.gracePeriod = setTimeout(function () {\n    this$1.gracePeriod = false;\n    if (this$1.selectionChanged())\n      { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n  }, 20);\n};\n\nContentEditableInput.prototype.showMultipleSelections = function (info) {\n  removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n  removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n};\n\nContentEditableInput.prototype.rememberSelection = function () {\n  var sel = this.getSelection();\n  this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n  this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n};\n\nContentEditableInput.prototype.selectionInEditor = function () {\n  var sel = this.getSelection();\n  if (!sel.rangeCount) { return false }\n  var node = sel.getRangeAt(0).commonAncestorContainer;\n  return contains(this.div, node)\n};\n\nContentEditableInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\") {\n    if (!this.selectionInEditor())\n      { this.showSelection(this.prepareSelection(), true); }\n    this.div.focus();\n  }\n};\nContentEditableInput.prototype.blur = function () { this.div.blur(); };\nContentEditableInput.prototype.getField = function () { return this.div };\n\nContentEditableInput.prototype.supportsTouch = function () { return true };\n\nContentEditableInput.prototype.receivedFocus = function () {\n  var input = this;\n  if (this.selectionInEditor())\n    { this.pollSelection(); }\n  else\n    { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n  function poll() {\n    if (input.cm.state.focused) {\n      input.pollSelection();\n      input.polling.set(input.cm.options.pollInterval, poll);\n    }\n  }\n  this.polling.set(this.cm.options.pollInterval, poll);\n};\n\nContentEditableInput.prototype.selectionChanged = function () {\n  var sel = this.getSelection();\n  return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n    sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n};\n\nContentEditableInput.prototype.pollSelection = function () {\n  if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n  var sel = this.getSelection(), cm = this.cm;\n  // On Android Chrome (version 56, at least), backspacing into an\n  // uneditable block element will put the cursor in that element,\n  // and then, because it's not editable, hide the virtual keyboard.\n  // Because Android doesn't allow us to actually detect backspace\n  // presses in a sane way, this code checks for when that happens\n  // and simulates a backspace press in this case.\n  if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\n    this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n    this.blur();\n    this.focus();\n    return\n  }\n  if (this.composing) { return }\n  this.rememberSelection();\n  var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (anchor && head) { runInOp(cm, function () {\n    setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n    if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n  }); }\n};\n\nContentEditableInput.prototype.pollContent = function () {\n  if (this.readDOMTimeout != null) {\n    clearTimeout(this.readDOMTimeout);\n    this.readDOMTimeout = null;\n  }\n\n  var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n  var from = sel.from(), to = sel.to();\n  if (from.ch == 0 && from.line > cm.firstLine())\n    { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n  if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n    { to = Pos(to.line + 1, 0); }\n  if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n  var fromIndex, fromLine, fromNode;\n  if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n    fromLine = lineNo(display.view[0].line);\n    fromNode = display.view[0].node;\n  } else {\n    fromLine = lineNo(display.view[fromIndex].line);\n    fromNode = display.view[fromIndex - 1].node.nextSibling;\n  }\n  var toIndex = findViewIndex(cm, to.line);\n  var toLine, toNode;\n  if (toIndex == display.view.length - 1) {\n    toLine = display.viewTo - 1;\n    toNode = display.lineDiv.lastChild;\n  } else {\n    toLine = lineNo(display.view[toIndex + 1].line) - 1;\n    toNode = display.view[toIndex + 1].node.previousSibling;\n  }\n\n  if (!fromNode) { return false }\n  var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n  var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n  while (newText.length > 1 && oldText.length > 1) {\n    if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n    else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n    else { break }\n  }\n\n  var cutFront = 0, cutEnd = 0;\n  var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n  while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n    { ++cutFront; }\n  var newBot = lst(newText), oldBot = lst(oldText);\n  var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                           oldBot.length - (oldText.length == 1 ? cutFront : 0));\n  while (cutEnd < maxCutEnd &&\n         newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n    { ++cutEnd; }\n  // Try to move start of change to start of selection if ambiguous\n  if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n    while (cutFront && cutFront > from.ch &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n      cutFront--;\n      cutEnd++;\n    }\n  }\n\n  newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n  newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n  var chFrom = Pos(fromLine, cutFront);\n  var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n  if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n    replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n    return true\n  }\n};\n\nContentEditableInput.prototype.ensurePolled = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.reset = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.forceCompositionEnd = function () {\n  if (!this.composing) { return }\n  clearTimeout(this.readDOMTimeout);\n  this.composing = null;\n  this.updateFromDOM();\n  this.div.blur();\n  this.div.focus();\n};\nContentEditableInput.prototype.readFromDOMSoon = function () {\n    var this$1 = this;\n\n  if (this.readDOMTimeout != null) { return }\n  this.readDOMTimeout = setTimeout(function () {\n    this$1.readDOMTimeout = null;\n    if (this$1.composing) {\n      if (this$1.composing.done) { this$1.composing = null; }\n      else { return }\n    }\n    this$1.updateFromDOM();\n  }, 80);\n};\n\nContentEditableInput.prototype.updateFromDOM = function () {\n    var this$1 = this;\n\n  if (this.cm.isReadOnly() || !this.pollContent())\n    { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n};\n\nContentEditableInput.prototype.setUneditable = function (node) {\n  node.contentEditable = \"false\";\n};\n\nContentEditableInput.prototype.onKeyPress = function (e) {\n  if (e.charCode == 0 || this.composing) { return }\n  e.preventDefault();\n  if (!this.cm.isReadOnly())\n    { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n};\n\nContentEditableInput.prototype.readOnlyChanged = function (val) {\n  this.div.contentEditable = String(val != \"nocursor\");\n};\n\nContentEditableInput.prototype.onContextMenu = function () {};\nContentEditableInput.prototype.resetPosition = function () {};\n\nContentEditableInput.prototype.needsContentAttribute = true;\n\nfunction posToDOM(cm, pos) {\n  var view = findViewForLine(cm, pos.line);\n  if (!view || view.hidden) { return null }\n  var line = getLine(cm.doc, pos.line);\n  var info = mapFromLineView(view, line, pos.line);\n\n  var order = getOrder(line, cm.doc.direction), side = \"left\";\n  if (order) {\n    var partPos = getBidiPartAt(order, pos.ch);\n    side = partPos % 2 ? \"right\" : \"left\";\n  }\n  var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n  result.offset = result.collapse == \"right\" ? result.end : result.start;\n  return result\n}\n\nfunction isInGutter(node) {\n  for (var scan = node; scan; scan = scan.parentNode)\n    { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n  return false\n}\n\nfunction badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\nfunction domTextBetween(cm, from, to, fromLine, toLine) {\n  var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n  function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n  function close() {\n    if (closing) {\n      text += lineSep;\n      if (extraLinebreak) { text += lineSep; }\n      closing = extraLinebreak = false;\n    }\n  }\n  function addText(str) {\n    if (str) {\n      close();\n      text += str;\n    }\n  }\n  function walk(node) {\n    if (node.nodeType == 1) {\n      var cmText = node.getAttribute(\"cm-text\");\n      if (cmText) {\n        addText(cmText);\n        return\n      }\n      var markerID = node.getAttribute(\"cm-marker\"), range$$1;\n      if (markerID) {\n        var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n        if (found.length && (range$$1 = found[0].find(0)))\n          { addText(getBetween(cm.doc, range$$1.from, range$$1.to).join(lineSep)); }\n        return\n      }\n      if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n      var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n      if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n      if (isBlock) { close(); }\n      for (var i = 0; i < node.childNodes.length; i++)\n        { walk(node.childNodes[i]); }\n\n      if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n      if (isBlock) { closing = true; }\n    } else if (node.nodeType == 3) {\n      addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n    }\n  }\n  for (;;) {\n    walk(from);\n    if (from == to) { break }\n    from = from.nextSibling;\n    extraLinebreak = false;\n  }\n  return text\n}\n\nfunction domToPos(cm, node, offset) {\n  var lineNode;\n  if (node == cm.display.lineDiv) {\n    lineNode = cm.display.lineDiv.childNodes[offset];\n    if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n    node = null; offset = 0;\n  } else {\n    for (lineNode = node;; lineNode = lineNode.parentNode) {\n      if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n      if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n    }\n  }\n  for (var i = 0; i < cm.display.view.length; i++) {\n    var lineView = cm.display.view[i];\n    if (lineView.node == lineNode)\n      { return locateNodeInLineView(lineView, node, offset) }\n  }\n}\n\nfunction locateNodeInLineView(lineView, node, offset) {\n  var wrapper = lineView.text.firstChild, bad = false;\n  if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n  if (node == wrapper) {\n    bad = true;\n    node = wrapper.childNodes[offset];\n    offset = 0;\n    if (!node) {\n      var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n      return badPos(Pos(lineNo(line), line.text.length), bad)\n    }\n  }\n\n  var textNode = node.nodeType == 3 ? node : null, topNode = node;\n  if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n    textNode = node.firstChild;\n    if (offset) { offset = textNode.nodeValue.length; }\n  }\n  while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n  var measure = lineView.measure, maps = measure.maps;\n\n  function find(textNode, topNode, offset) {\n    for (var i = -1; i < (maps ? maps.length : 0); i++) {\n      var map$$1 = i < 0 ? measure.map : maps[i];\n      for (var j = 0; j < map$$1.length; j += 3) {\n        var curNode = map$$1[j + 2];\n        if (curNode == textNode || curNode == topNode) {\n          var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n          var ch = map$$1[j] + offset;\n          if (offset < 0 || curNode != textNode) { ch = map$$1[j + (offset ? 1 : 0)]; }\n          return Pos(line, ch)\n        }\n      }\n    }\n  }\n  var found = find(textNode, topNode, offset);\n  if (found) { return badPos(found, bad) }\n\n  // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n  for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n    found = find(after, after.firstChild, 0);\n    if (found)\n      { return badPos(Pos(found.line, found.ch - dist), bad) }\n    else\n      { dist += after.textContent.length; }\n  }\n  for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n    found = find(before, before.firstChild, -1);\n    if (found)\n      { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n    else\n      { dist$1 += before.textContent.length; }\n  }\n}\n\n// TEXTAREA INPUT STYLE\n\nvar TextareaInput = function(cm) {\n  this.cm = cm;\n  // See input.poll and input.reset\n  this.prevInput = \"\";\n\n  // Flag that indicates whether we expect input to appear real soon\n  // now (after some event like 'keypress' or 'input') and are\n  // polling intensively.\n  this.pollingFast = false;\n  // Self-resetting timeout for the poller\n  this.polling = new Delayed();\n  // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n  this.hasSelection = false;\n  this.composing = null;\n};\n\nTextareaInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = this.cm;\n  this.createField(display);\n  var te = this.textarea;\n\n  display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n  // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n  if (ios) { te.style.width = \"0px\"; }\n\n  on(te, \"input\", function () {\n    if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n    input.poll();\n  });\n\n  on(te, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n    cm.state.pasteIncoming = true;\n    input.fastPoll();\n  });\n\n  function prepareCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.setSelections(ranges.ranges, null, sel_dontScroll);\n      } else {\n        input.prevInput = \"\";\n        te.value = ranges.text.join(\"\\n\");\n        selectInput(te);\n      }\n    }\n    if (e.type == \"cut\") { cm.state.cutIncoming = true; }\n  }\n  on(te, \"cut\", prepareCopyCut);\n  on(te, \"copy\", prepareCopyCut);\n\n  on(display.scroller, \"paste\", function (e) {\n    if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n    cm.state.pasteIncoming = true;\n    input.focus();\n  });\n\n  // Prevent normal selection in the editor (we handle our own)\n  on(display.lineSpace, \"selectstart\", function (e) {\n    if (!eventInWidget(display, e)) { e_preventDefault(e); }\n  });\n\n  on(te, \"compositionstart\", function () {\n    var start = cm.getCursor(\"from\");\n    if (input.composing) { input.composing.range.clear(); }\n    input.composing = {\n      start: start,\n      range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n    };\n  });\n  on(te, \"compositionend\", function () {\n    if (input.composing) {\n      input.poll();\n      input.composing.range.clear();\n      input.composing = null;\n    }\n  });\n};\n\nTextareaInput.prototype.createField = function (_display) {\n  // Wraps and hides input textarea\n  this.wrapper = hiddenTextarea();\n  // The semihidden textarea that is focused when the editor is\n  // focused, and receives input.\n  this.textarea = this.wrapper.firstChild;\n};\n\nTextareaInput.prototype.prepareSelection = function () {\n  // Redraw the selection and/or cursor\n  var cm = this.cm, display = cm.display, doc = cm.doc;\n  var result = prepareSelection(cm);\n\n  // Move the hidden textarea near the cursor to prevent scrolling artifacts\n  if (cm.options.moveInputWithCursor) {\n    var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n    var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n    result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                        headPos.top + lineOff.top - wrapOff.top));\n    result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                         headPos.left + lineOff.left - wrapOff.left));\n  }\n\n  return result\n};\n\nTextareaInput.prototype.showSelection = function (drawn) {\n  var cm = this.cm, display = cm.display;\n  removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n  removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n  if (drawn.teTop != null) {\n    this.wrapper.style.top = drawn.teTop + \"px\";\n    this.wrapper.style.left = drawn.teLeft + \"px\";\n  }\n};\n\n// Reset the input to correspond to the selection (or to be empty,\n// when not typing and nothing is selected)\nTextareaInput.prototype.reset = function (typing) {\n  if (this.contextMenuPending || this.composing) { return }\n  var cm = this.cm;\n  if (cm.somethingSelected()) {\n    this.prevInput = \"\";\n    var content = cm.getSelection();\n    this.textarea.value = content;\n    if (cm.state.focused) { selectInput(this.textarea); }\n    if (ie && ie_version >= 9) { this.hasSelection = content; }\n  } else if (!typing) {\n    this.prevInput = this.textarea.value = \"\";\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n  }\n};\n\nTextareaInput.prototype.getField = function () { return this.textarea };\n\nTextareaInput.prototype.supportsTouch = function () { return false };\n\nTextareaInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n    try { this.textarea.focus(); }\n    catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n  }\n};\n\nTextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\nTextareaInput.prototype.resetPosition = function () {\n  this.wrapper.style.top = this.wrapper.style.left = 0;\n};\n\nTextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n// Poll for input changes, using the normal rate of polling. This\n// runs as long as the editor is focused.\nTextareaInput.prototype.slowPoll = function () {\n    var this$1 = this;\n\n  if (this.pollingFast) { return }\n  this.polling.set(this.cm.options.pollInterval, function () {\n    this$1.poll();\n    if (this$1.cm.state.focused) { this$1.slowPoll(); }\n  });\n};\n\n// When an event has just come in that is likely to add or change\n// something in the input textarea, we poll faster, to ensure that\n// the change appears on the screen quickly.\nTextareaInput.prototype.fastPoll = function () {\n  var missed = false, input = this;\n  input.pollingFast = true;\n  function p() {\n    var changed = input.poll();\n    if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n    else {input.pollingFast = false; input.slowPoll();}\n  }\n  input.polling.set(20, p);\n};\n\n// Read input from the textarea, and update the document to match.\n// When something is selected, it is present in the textarea, and\n// selected (unless it is huge, in which case a placeholder is\n// used). When nothing is selected, the cursor sits after previously\n// seen text (can be empty), which is stored in prevInput (we must\n// not reset the textarea when typing, because that breaks IME).\nTextareaInput.prototype.poll = function () {\n    var this$1 = this;\n\n  var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n  // Since this is called a *lot*, try to bail out as cheaply as\n  // possible when it is clear that nothing happened. hasSelection\n  // will be the case when there is a lot of text in the textarea,\n  // in which case reading its value would be expensive.\n  if (this.contextMenuPending || !cm.state.focused ||\n      (hasSelection(input) && !prevInput && !this.composing) ||\n      cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n    { return false }\n\n  var text = input.value;\n  // If nothing changed, bail.\n  if (text == prevInput && !cm.somethingSelected()) { return false }\n  // Work around nonsensical selection resetting in IE9/10, and\n  // inexplicable appearance of private area unicode characters on\n  // some key combos in Mac (#2689).\n  if (ie && ie_version >= 9 && this.hasSelection === text ||\n      mac && /[\\uf700-\\uf7ff]/.test(text)) {\n    cm.display.input.reset();\n    return false\n  }\n\n  if (cm.doc.sel == cm.display.selForContextMenu) {\n    var first = text.charCodeAt(0);\n    if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n    if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n  }\n  // Find the part of the input that is actually new\n  var same = 0, l = Math.min(prevInput.length, text.length);\n  while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n  runInOp(cm, function () {\n    applyTextInput(cm, text.slice(same), prevInput.length - same,\n                   null, this$1.composing ? \"*compose\" : null);\n\n    // Don't leave long text in the textarea, since it makes further polling slow\n    if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n    else { this$1.prevInput = text; }\n\n    if (this$1.composing) {\n      this$1.composing.range.clear();\n      this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                         {className: \"CodeMirror-composing\"});\n    }\n  });\n  return true\n};\n\nTextareaInput.prototype.ensurePolled = function () {\n  if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n};\n\nTextareaInput.prototype.onKeyPress = function () {\n  if (ie && ie_version >= 9) { this.hasSelection = null; }\n  this.fastPoll();\n};\n\nTextareaInput.prototype.onContextMenu = function (e) {\n  var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n  var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n  if (!pos || presto) { return } // Opera is difficult.\n\n  // Reset the current text selection only if the click is done outside of the selection\n  // and 'resetSelectionOnContextMenu' option is true.\n  var reset = cm.options.resetSelectionOnContextMenu;\n  if (reset && cm.doc.sel.contains(pos) == -1)\n    { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n  var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n  input.wrapper.style.cssText = \"position: absolute\";\n  var wrapperBox = input.wrapper.getBoundingClientRect();\n  te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n  var oldScrollY;\n  if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n  display.input.focus();\n  if (webkit) { window.scrollTo(null, oldScrollY); }\n  display.input.reset();\n  // Adds \"Select all\" to context menu in FF\n  if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n  input.contextMenuPending = true;\n  display.selForContextMenu = cm.doc.sel;\n  clearTimeout(display.detectingSelectAll);\n\n  // Select-all will be greyed out if there's nothing to select, so\n  // this adds a zero-width space so that we can later check whether\n  // it got selected.\n  function prepareSelectAllHack() {\n    if (te.selectionStart != null) {\n      var selected = cm.somethingSelected();\n      var extval = \"\\u200b\" + (selected ? te.value : \"\");\n      te.value = \"\\u21da\"; // Used to catch context-menu undo\n      te.value = extval;\n      input.prevInput = selected ? \"\" : \"\\u200b\";\n      te.selectionStart = 1; te.selectionEnd = extval.length;\n      // Re-set this, in case some other handler touched the\n      // selection in the meantime.\n      display.selForContextMenu = cm.doc.sel;\n    }\n  }\n  function rehide() {\n    input.contextMenuPending = false;\n    input.wrapper.style.cssText = oldWrapperCSS;\n    te.style.cssText = oldCSS;\n    if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n    // Try to detect the user choosing select-all\n    if (te.selectionStart != null) {\n      if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n      var i = 0, poll = function () {\n        if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n            te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n          operation(cm, selectAll)(cm);\n        } else if (i++ < 10) {\n          display.detectingSelectAll = setTimeout(poll, 500);\n        } else {\n          display.selForContextMenu = null;\n          display.input.reset();\n        }\n      };\n      display.detectingSelectAll = setTimeout(poll, 200);\n    }\n  }\n\n  if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n  if (captureRightClick) {\n    e_stop(e);\n    var mouseup = function () {\n      off(window, \"mouseup\", mouseup);\n      setTimeout(rehide, 20);\n    };\n    on(window, \"mouseup\", mouseup);\n  } else {\n    setTimeout(rehide, 50);\n  }\n};\n\nTextareaInput.prototype.readOnlyChanged = function (val) {\n  if (!val) { this.reset(); }\n  this.textarea.disabled = val == \"nocursor\";\n};\n\nTextareaInput.prototype.setUneditable = function () {};\n\nTextareaInput.prototype.needsContentAttribute = false;\n\nfunction fromTextArea(textarea, options) {\n  options = options ? copyObj(options) : {};\n  options.value = textarea.value;\n  if (!options.tabindex && textarea.tabIndex)\n    { options.tabindex = textarea.tabIndex; }\n  if (!options.placeholder && textarea.placeholder)\n    { options.placeholder = textarea.placeholder; }\n  // Set autofocus to true if this textarea is focused, or if it has\n  // autofocus and no other element is focused.\n  if (options.autofocus == null) {\n    var hasFocus = activeElt();\n    options.autofocus = hasFocus == textarea ||\n      textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n  }\n\n  function save() {textarea.value = cm.getValue();}\n\n  var realSubmit;\n  if (textarea.form) {\n    on(textarea.form, \"submit\", save);\n    // Deplorable hack to make the submit method do the right thing.\n    if (!options.leaveSubmitMethodAlone) {\n      var form = textarea.form;\n      realSubmit = form.submit;\n      try {\n        var wrappedSubmit = form.submit = function () {\n          save();\n          form.submit = realSubmit;\n          form.submit();\n          form.submit = wrappedSubmit;\n        };\n      } catch(e) {}\n    }\n  }\n\n  options.finishInit = function (cm) {\n    cm.save = save;\n    cm.getTextArea = function () { return textarea; };\n    cm.toTextArea = function () {\n      cm.toTextArea = isNaN; // Prevent this from being ran twice\n      save();\n      textarea.parentNode.removeChild(cm.getWrapperElement());\n      textarea.style.display = \"\";\n      if (textarea.form) {\n        off(textarea.form, \"submit\", save);\n        if (typeof textarea.form.submit == \"function\")\n          { textarea.form.submit = realSubmit; }\n      }\n    };\n  };\n\n  textarea.style.display = \"none\";\n  var cm = CodeMirror$1(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n    options);\n  return cm\n}\n\nfunction addLegacyProps(CodeMirror) {\n  CodeMirror.off = off;\n  CodeMirror.on = on;\n  CodeMirror.wheelEventPixels = wheelEventPixels;\n  CodeMirror.Doc = Doc;\n  CodeMirror.splitLines = splitLinesAuto;\n  CodeMirror.countColumn = countColumn;\n  CodeMirror.findColumn = findColumn;\n  CodeMirror.isWordChar = isWordCharBasic;\n  CodeMirror.Pass = Pass;\n  CodeMirror.signal = signal;\n  CodeMirror.Line = Line;\n  CodeMirror.changeEnd = changeEnd;\n  CodeMirror.scrollbarModel = scrollbarModel;\n  CodeMirror.Pos = Pos;\n  CodeMirror.cmpPos = cmp;\n  CodeMirror.modes = modes;\n  CodeMirror.mimeModes = mimeModes;\n  CodeMirror.resolveMode = resolveMode;\n  CodeMirror.getMode = getMode;\n  CodeMirror.modeExtensions = modeExtensions;\n  CodeMirror.extendMode = extendMode;\n  CodeMirror.copyState = copyState;\n  CodeMirror.startState = startState;\n  CodeMirror.innerMode = innerMode;\n  CodeMirror.commands = commands;\n  CodeMirror.keyMap = keyMap;\n  CodeMirror.keyName = keyName;\n  CodeMirror.isModifierKey = isModifierKey;\n  CodeMirror.lookupKey = lookupKey;\n  CodeMirror.normalizeKeyMap = normalizeKeyMap;\n  CodeMirror.StringStream = StringStream;\n  CodeMirror.SharedTextMarker = SharedTextMarker;\n  CodeMirror.TextMarker = TextMarker;\n  CodeMirror.LineWidget = LineWidget;\n  CodeMirror.e_preventDefault = e_preventDefault;\n  CodeMirror.e_stopPropagation = e_stopPropagation;\n  CodeMirror.e_stop = e_stop;\n  CodeMirror.addClass = addClass;\n  CodeMirror.contains = contains;\n  CodeMirror.rmClass = rmClass;\n  CodeMirror.keyNames = keyNames;\n}\n\n// EDITOR CONSTRUCTOR\n\ndefineOptions(CodeMirror$1);\n\naddEditorMethods(CodeMirror$1);\n\n// Set up methods on CodeMirror's prototype to redirect to the editor's document.\nvar dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\nfor (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n  { CodeMirror$1.prototype[prop] = (function(method) {\n    return function() {return method.apply(this.doc, arguments)}\n  })(Doc.prototype[prop]); } }\n\neventMixin(Doc);\n\n// INPUT HANDLING\n\nCodeMirror$1.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n// MODE DEFINITION AND QUERYING\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nCodeMirror$1.defineMode = function(name/*, mode, */) {\n  if (!CodeMirror$1.defaults.mode && name != \"null\") { CodeMirror$1.defaults.mode = name; }\n  defineMode.apply(this, arguments);\n};\n\nCodeMirror$1.defineMIME = defineMIME;\n\n// Minimal default mode.\nCodeMirror$1.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\nCodeMirror$1.defineMIME(\"text/plain\", \"null\");\n\n// EXTENSIONS\n\nCodeMirror$1.defineExtension = function (name, func) {\n  CodeMirror$1.prototype[name] = func;\n};\nCodeMirror$1.defineDocExtension = function (name, func) {\n  Doc.prototype[name] = func;\n};\n\nCodeMirror$1.fromTextArea = fromTextArea;\n\naddLegacyProps(CodeMirror$1);\n\nCodeMirror$1.version = \"5.40.0\";\n\nreturn CodeMirror$1;\n\n})));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/codemirror/lib/codemirror.js\n// module id = 15\n// module chunks = 0","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"))\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod)\n  else // Plain browser env\n    mod(CodeMirror)\n})(function(CodeMirror) {\n  \"use strict\"\n  var Pos = CodeMirror.Pos\n\n  function regexpFlags(regexp) {\n    var flags = regexp.flags\n    return flags != null ? flags : (regexp.ignoreCase ? \"i\" : \"\")\n      + (regexp.global ? \"g\" : \"\")\n      + (regexp.multiline ? \"m\" : \"\")\n  }\n\n  function ensureFlags(regexp, flags) {\n    var current = regexpFlags(regexp), target = current\n    for (var i = 0; i < flags.length; i++) if (target.indexOf(flags.charAt(i)) == -1)\n      target += flags.charAt(i)\n    return current == target ? regexp : new RegExp(regexp.source, target)\n  }\n\n  function maybeMultiline(regexp) {\n    return /\\\\s|\\\\n|\\n|\\\\W|\\\\D|\\[\\^/.test(regexp.source)\n  }\n\n  function searchRegexpForward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, last = doc.lastLine(); line <= last; line++, ch = 0) {\n      regexp.lastIndex = ch\n      var string = doc.getLine(line), match = regexp.exec(string)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpForwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpForward(doc, regexp, start)\n\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunk = 1\n    for (var line = start.line, last = doc.lastLine(); line <= last;) {\n      // This grows the search buffer in exponentially-sized chunks\n      // between matches, so that nearby matches are fast and don't\n      // require concatenating the whole document (in case we're\n      // searching for something that has tons of matches), but at the\n      // same time, the amount of retries is limited.\n      for (var i = 0; i < chunk; i++) {\n        if (line > last) break\n        var curLine = doc.getLine(line++)\n        string = string == null ? curLine : string + \"\\n\" + curLine\n      }\n      chunk = chunk * 2\n      regexp.lastIndex = start.ch\n      var match = regexp.exec(string)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = start.line + before.length - 1, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  function lastMatchIn(string, regexp) {\n    var cutOff = 0, match\n    for (;;) {\n      regexp.lastIndex = cutOff\n      var newMatch = regexp.exec(string)\n      if (!newMatch) return match\n      match = newMatch\n      cutOff = match.index + (match[0].length || 1)\n      if (cutOff == string.length) return match\n    }\n  }\n\n  function searchRegexpBackward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, first = doc.firstLine(); line >= first; line--, ch = -1) {\n      var string = doc.getLine(line)\n      if (ch > -1) string = string.slice(0, ch)\n      var match = lastMatchIn(string, regexp)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpBackwardMultiline(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunk = 1\n    for (var line = start.line, first = doc.firstLine(); line >= first;) {\n      for (var i = 0; i < chunk; i++) {\n        var curLine = doc.getLine(line--)\n        string = string == null ? curLine.slice(0, start.ch) : curLine + \"\\n\" + string\n      }\n      chunk *= 2\n\n      var match = lastMatchIn(string, regexp)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = line + before.length, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  var doFold, noFold\n  if (String.prototype.normalize) {\n    doFold = function(str) { return str.normalize(\"NFD\").toLowerCase() }\n    noFold = function(str) { return str.normalize(\"NFD\") }\n  } else {\n    doFold = function(str) { return str.toLowerCase() }\n    noFold = function(str) { return str }\n  }\n\n  // Maps a position in a case-folded line back to a position in the original line\n  // (compensating for codepoints increasing in number during folding)\n  function adjustPos(orig, folded, pos, foldFunc) {\n    if (orig.length == folded.length) return pos\n    for (var min = 0, max = pos + Math.max(0, orig.length - folded.length);;) {\n      if (min == max) return min\n      var mid = (min + max) >> 1\n      var len = foldFunc(orig.slice(0, mid)).length\n      if (len == pos) return mid\n      else if (len > pos) max = mid\n      else min = mid + 1\n    }\n  }\n\n  function searchStringForward(doc, query, start, caseFold) {\n    // Empty string would match anything and never progress, so we\n    // define it to match nothing instead.\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, last = doc.lastLine() + 1 - lines.length; line <= last; line++, ch = 0) {\n      var orig = doc.getLine(line).slice(ch), string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.indexOf(lines[0])\n        if (found == -1) continue search\n        var start = adjustPos(orig, string, found, fold) + ch\n        return {from: Pos(line, adjustPos(orig, string, found, fold) + ch),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold) + ch)}\n      } else {\n        var cutFrom = string.length - lines[0].length\n        if (string.slice(cutFrom) != lines[0]) continue search\n        for (var i = 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(line + i)) != lines[i]) continue search\n        var end = doc.getLine(line + lines.length - 1), endString = fold(end), lastLine = lines[lines.length - 1]\n        if (endString.slice(0, lastLine.length) != lastLine) continue search\n        return {from: Pos(line, adjustPos(orig, string, cutFrom, fold) + ch),\n                to: Pos(line + lines.length - 1, adjustPos(end, endString, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function searchStringBackward(doc, query, start, caseFold) {\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, first = doc.firstLine() - 1 + lines.length; line >= first; line--, ch = -1) {\n      var orig = doc.getLine(line)\n      if (ch > -1) orig = orig.slice(0, ch)\n      var string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.lastIndexOf(lines[0])\n        if (found == -1) continue search\n        return {from: Pos(line, adjustPos(orig, string, found, fold)),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold))}\n      } else {\n        var lastLine = lines[lines.length - 1]\n        if (string.slice(0, lastLine.length) != lastLine) continue search\n        for (var i = 1, start = line - lines.length + 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(start + i)) != lines[i]) continue search\n        var top = doc.getLine(line + 1 - lines.length), topString = fold(top)\n        if (topString.slice(topString.length - lines[0].length) != lines[0]) continue search\n        return {from: Pos(line + 1 - lines.length, adjustPos(top, topString, top.length - lines[0].length, fold)),\n                to: Pos(line, adjustPos(orig, string, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function SearchCursor(doc, query, pos, options) {\n    this.atOccurrence = false\n    this.doc = doc\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0)\n    this.pos = {from: pos, to: pos}\n\n    var caseFold\n    if (typeof options == \"object\") {\n      caseFold = options.caseFold\n    } else { // Backwards compat for when caseFold was the 4th argument\n      caseFold = options\n      options = null\n    }\n\n    if (typeof query == \"string\") {\n      if (caseFold == null) caseFold = false\n      this.matches = function(reverse, pos) {\n        return (reverse ? searchStringBackward : searchStringForward)(doc, query, pos, caseFold)\n      }\n    } else {\n      query = ensureFlags(query, \"gm\")\n      if (!options || options.multiline !== false)\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackwardMultiline : searchRegexpForwardMultiline)(doc, query, pos)\n        }\n      else\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackward : searchRegexpForward)(doc, query, pos)\n        }\n    }\n  }\n\n  SearchCursor.prototype = {\n    findNext: function() {return this.find(false)},\n    findPrevious: function() {return this.find(true)},\n\n    find: function(reverse) {\n      var result = this.matches(reverse, this.doc.clipPos(reverse ? this.pos.from : this.pos.to))\n\n      // Implements weird auto-growing behavior on null-matches for\n      // backwards-compatiblity with the vim code (unfortunately)\n      while (result && CodeMirror.cmpPos(result.from, result.to) == 0) {\n        if (reverse) {\n          if (result.from.ch) result.from = Pos(result.from.line, result.from.ch - 1)\n          else if (result.from.line == this.doc.firstLine()) result = null\n          else result = this.matches(reverse, this.doc.clipPos(Pos(result.from.line - 1)))\n        } else {\n          if (result.to.ch < this.doc.getLine(result.to.line).length) result.to = Pos(result.to.line, result.to.ch + 1)\n          else if (result.to.line == this.doc.lastLine()) result = null\n          else result = this.matches(reverse, Pos(result.to.line + 1, 0))\n        }\n      }\n\n      if (result) {\n        this.pos = result\n        this.atOccurrence = true\n        return this.pos.match || true\n      } else {\n        var end = Pos(reverse ? this.doc.firstLine() : this.doc.lastLine() + 1, 0)\n        this.pos = {from: end, to: end}\n        return this.atOccurrence = false\n      }\n    },\n\n    from: function() {if (this.atOccurrence) return this.pos.from},\n    to: function() {if (this.atOccurrence) return this.pos.to},\n\n    replace: function(newText, origin) {\n      if (!this.atOccurrence) return\n      var lines = CodeMirror.splitLines(newText)\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin)\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0))\n    }\n  }\n\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this.doc, query, pos, caseFold)\n  })\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this, query, pos, caseFold)\n  })\n\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\n    var ranges = []\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold)\n    while (cur.findNext()) {\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break\n      ranges.push({anchor: cur.from(), head: cur.to()})\n    }\n    if (ranges.length)\n      this.setSelections(ranges, 0)\n  })\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/codemirror/addon/search/searchcursor.js\n// module id = 16\n// module chunks = 0","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var ie_lt8 = /MSIE \\d/.test(navigator.userAgent) &&\n    (document.documentMode == null || document.documentMode < 8);\n\n  var Pos = CodeMirror.Pos;\n\n  var matching = {\"(\": \")>\", \")\": \"(<\", \"[\": \"]>\", \"]\": \"[<\", \"{\": \"}>\", \"}\": \"{<\"};\n\n  function findMatchingBracket(cm, where, config) {\n    var line = cm.getLineHandle(where.line), pos = where.ch - 1;\n    var afterCursor = config && config.afterCursor\n    if (afterCursor == null)\n      afterCursor = /(^| )cm-fat-cursor($| )/.test(cm.getWrapperElement().className)\n\n    // A cursor is defined as between two characters, but in in vim command mode\n    // (i.e. not insert mode), the cursor is visually represented as a\n    // highlighted box on top of the 2nd character. Otherwise, we allow matches\n    // from before or after the cursor.\n    var match = (!afterCursor && pos >= 0 && matching[line.text.charAt(pos)]) ||\n        matching[line.text.charAt(++pos)];\n    if (!match) return null;\n    var dir = match.charAt(1) == \">\" ? 1 : -1;\n    if (config && config.strict && (dir > 0) != (pos == where.ch)) return null;\n    var style = cm.getTokenTypeAt(Pos(where.line, pos + 1));\n\n    var found = scanForBracket(cm, Pos(where.line, pos + (dir > 0 ? 1 : 0)), dir, style || null, config);\n    if (found == null) return null;\n    return {from: Pos(where.line, pos), to: found && found.pos,\n            match: found && found.ch == match.charAt(0), forward: dir > 0};\n  }\n\n  // bracketRegex is used to specify which type of bracket to scan\n  // should be a regexp, e.g. /[[\\]]/\n  //\n  // Note: If \"where\" is on an open bracket, then this bracket is ignored.\n  //\n  // Returns false when no bracket was found, null when it reached\n  // maxScanLines and gave up\n  function scanForBracket(cm, where, dir, style, config) {\n    var maxScanLen = (config && config.maxScanLineLength) || 10000;\n    var maxScanLines = (config && config.maxScanLines) || 1000;\n\n    var stack = [];\n    var re = config && config.bracketRegex ? config.bracketRegex : /[(){}[\\]]/;\n    var lineEnd = dir > 0 ? Math.min(where.line + maxScanLines, cm.lastLine() + 1)\n                          : Math.max(cm.firstLine() - 1, where.line - maxScanLines);\n    for (var lineNo = where.line; lineNo != lineEnd; lineNo += dir) {\n      var line = cm.getLine(lineNo);\n      if (!line) continue;\n      var pos = dir > 0 ? 0 : line.length - 1, end = dir > 0 ? line.length : -1;\n      if (line.length > maxScanLen) continue;\n      if (lineNo == where.line) pos = where.ch - (dir < 0 ? 1 : 0);\n      for (; pos != end; pos += dir) {\n        var ch = line.charAt(pos);\n        if (re.test(ch) && (style === undefined || cm.getTokenTypeAt(Pos(lineNo, pos + 1)) == style)) {\n          var match = matching[ch];\n          if ((match.charAt(1) == \">\") == (dir > 0)) stack.push(ch);\n          else if (!stack.length) return {pos: Pos(lineNo, pos), ch: ch};\n          else stack.pop();\n        }\n      }\n    }\n    return lineNo - dir == (dir > 0 ? cm.lastLine() : cm.firstLine()) ? false : null;\n  }\n\n  function matchBrackets(cm, autoclear, config) {\n    // Disable brace matching in long lines, since it'll cause hugely slow updates\n    var maxHighlightLen = cm.state.matchBrackets.maxHighlightLineLength || 1000;\n    var marks = [], ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      var match = ranges[i].empty() && findMatchingBracket(cm, ranges[i].head, config);\n      if (match && cm.getLine(match.from.line).length <= maxHighlightLen) {\n        var style = match.match ? \"CodeMirror-matchingbracket\" : \"CodeMirror-nonmatchingbracket\";\n        marks.push(cm.markText(match.from, Pos(match.from.line, match.from.ch + 1), {className: style}));\n        if (match.to && cm.getLine(match.to.line).length <= maxHighlightLen)\n          marks.push(cm.markText(match.to, Pos(match.to.line, match.to.ch + 1), {className: style}));\n      }\n    }\n\n    if (marks.length) {\n      // Kludge to work around the IE bug from issue #1193, where text\n      // input stops going to the textare whever this fires.\n      if (ie_lt8 && cm.state.focused) cm.focus();\n\n      var clear = function() {\n        cm.operation(function() {\n          for (var i = 0; i < marks.length; i++) marks[i].clear();\n        });\n      };\n      if (autoclear) setTimeout(clear, 800);\n      else return clear;\n    }\n  }\n\n  function doMatchBrackets(cm) {\n    cm.operation(function() {\n      if (cm.state.matchBrackets.currentlyHighlighted) {\n        cm.state.matchBrackets.currentlyHighlighted();\n        cm.state.matchBrackets.currentlyHighlighted = null;\n      }\n      cm.state.matchBrackets.currentlyHighlighted = matchBrackets(cm, false, cm.state.matchBrackets);\n    });\n  }\n\n  CodeMirror.defineOption(\"matchBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.off(\"cursorActivity\", doMatchBrackets);\n      if (cm.state.matchBrackets && cm.state.matchBrackets.currentlyHighlighted) {\n        cm.state.matchBrackets.currentlyHighlighted();\n        cm.state.matchBrackets.currentlyHighlighted = null;\n      }\n    }\n    if (val) {\n      cm.state.matchBrackets = typeof val == \"object\" ? val : {};\n      cm.on(\"cursorActivity\", doMatchBrackets);\n    }\n  });\n\n  CodeMirror.defineExtension(\"matchBrackets\", function() {matchBrackets(this, true);});\n  CodeMirror.defineExtension(\"findMatchingBracket\", function(pos, config, oldConfig){\n    // Backwards-compatibility kludge\n    if (oldConfig || typeof config == \"boolean\") {\n      if (!oldConfig) {\n        config = config ? {strict: true} : null\n      } else {\n        oldConfig.strict = config\n        config = oldConfig\n      }\n    }\n    return findMatchingBracket(this, pos, config)\n  });\n  CodeMirror.defineExtension(\"scanForBracket\", function(pos, dir, style, config){\n    return scanForBracket(this, pos, dir, style, config);\n  });\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/codemirror/addon/edit/matchbrackets.js\n// module id = 17\n// module chunks = 0","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nfunction Context(indented, column, type, info, align, prev) {\n  this.indented = indented;\n  this.column = column;\n  this.type = type;\n  this.info = info;\n  this.align = align;\n  this.prev = prev;\n}\nfunction pushContext(state, col, type, info) {\n  var indent = state.indented;\n  if (state.context && state.context.type == \"statement\" && type != \"statement\")\n    indent = state.context.indented;\n  return state.context = new Context(indent, col, type, info, null, state.context);\n}\nfunction popContext(state) {\n  var t = state.context.type;\n  if (t == \")\" || t == \"]\" || t == \"}\")\n    state.indented = state.context.indented;\n  return state.context = state.context.prev;\n}\n\nfunction typeBefore(stream, state, pos) {\n  if (state.prevToken == \"variable\" || state.prevToken == \"type\") return true;\n  if (/\\S(?:[^- ]>|[*\\]])\\s*$|\\*$/.test(stream.string.slice(0, pos))) return true;\n  if (state.typeAtEndOfLine && stream.column() == stream.indentation()) return true;\n}\n\nfunction isTopScope(context) {\n  for (;;) {\n    if (!context || context.type == \"top\") return true;\n    if (context.type == \"}\" && context.prev.info != \"namespace\") return false;\n    context = context.prev;\n  }\n}\n\nCodeMirror.defineMode(\"clike\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit,\n      statementIndentUnit = parserConfig.statementIndentUnit || indentUnit,\n      dontAlignCalls = parserConfig.dontAlignCalls,\n      keywords = parserConfig.keywords || {},\n      types = parserConfig.types || {},\n      builtin = parserConfig.builtin || {},\n      blockKeywords = parserConfig.blockKeywords || {},\n      defKeywords = parserConfig.defKeywords || {},\n      atoms = parserConfig.atoms || {},\n      hooks = parserConfig.hooks || {},\n      multiLineStrings = parserConfig.multiLineStrings,\n      indentStatements = parserConfig.indentStatements !== false,\n      indentSwitch = parserConfig.indentSwitch !== false,\n      namespaceSeparator = parserConfig.namespaceSeparator,\n      isPunctuationChar = parserConfig.isPunctuationChar || /[\\[\\]{}\\(\\),;\\:\\.]/,\n      numberStart = parserConfig.numberStart || /[\\d\\.]/,\n      number = parserConfig.number || /^(?:0x[a-f\\d]+|0b[01]+|(?:\\d+\\.?\\d*|\\.\\d+)(?:e[-+]?\\d+)?)(u|ll?|l|f)?/i,\n      isOperatorChar = parserConfig.isOperatorChar || /[+\\-*&%=<>!?|\\/]/,\n      isIdentifierChar = parserConfig.isIdentifierChar || /[\\w\\$_\\xa1-\\uffff]/;\n\n  var curPunc, isDefKeyword;\n\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (hooks[ch]) {\n      var result = hooks[ch](stream, state);\n      if (result !== false) return result;\n    }\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    }\n    if (isPunctuationChar.test(ch)) {\n      curPunc = ch;\n      return null;\n    }\n    if (numberStart.test(ch)) {\n      stream.backUp(1)\n      if (stream.match(number)) return \"number\"\n      stream.next()\n    }\n    if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      }\n      if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return \"comment\";\n      }\n    }\n    if (isOperatorChar.test(ch)) {\n      while (!stream.match(/^\\/[\\/*]/, false) && stream.eat(isOperatorChar)) {}\n      return \"operator\";\n    }\n    stream.eatWhile(isIdentifierChar);\n    if (namespaceSeparator) while (stream.match(namespaceSeparator))\n      stream.eatWhile(isIdentifierChar);\n\n    var cur = stream.current();\n    if (contains(keywords, cur)) {\n      if (contains(blockKeywords, cur)) curPunc = \"newstatement\";\n      if (contains(defKeywords, cur)) isDefKeyword = true;\n      return \"keyword\";\n    }\n    if (contains(types, cur)) return \"type\";\n    if (contains(builtin, cur)) {\n      if (contains(blockKeywords, cur)) curPunc = \"newstatement\";\n      return \"builtin\";\n    }\n    if (contains(atoms, cur)) return \"atom\";\n    return \"variable\";\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next, end = false;\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) {end = true; break;}\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (end || !(escaped || multiLineStrings))\n        state.tokenize = null;\n      return \"string\";\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = null;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return \"comment\";\n  }\n\n  function maybeEOL(stream, state) {\n    if (parserConfig.typeFirstDefinitions && stream.eol() && isTopScope(state.context))\n      state.typeAtEndOfLine = typeBefore(stream, state, stream.pos)\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      return {\n        tokenize: null,\n        context: new Context((basecolumn || 0) - indentUnit, 0, \"top\", null, false),\n        indented: 0,\n        startOfLine: true,\n        prevToken: null\n      };\n    },\n\n    token: function(stream, state) {\n      var ctx = state.context;\n      if (stream.sol()) {\n        if (ctx.align == null) ctx.align = false;\n        state.indented = stream.indentation();\n        state.startOfLine = true;\n      }\n      if (stream.eatSpace()) { maybeEOL(stream, state); return null; }\n      curPunc = isDefKeyword = null;\n      var style = (state.tokenize || tokenBase)(stream, state);\n      if (style == \"comment\" || style == \"meta\") return style;\n      if (ctx.align == null) ctx.align = true;\n\n      if (curPunc == \";\" || curPunc == \":\" || (curPunc == \",\" && stream.match(/^\\s*(?:\\/\\/.*)?$/, false)))\n        while (state.context.type == \"statement\") popContext(state);\n      else if (curPunc == \"{\") pushContext(state, stream.column(), \"}\");\n      else if (curPunc == \"[\") pushContext(state, stream.column(), \"]\");\n      else if (curPunc == \"(\") pushContext(state, stream.column(), \")\");\n      else if (curPunc == \"}\") {\n        while (ctx.type == \"statement\") ctx = popContext(state);\n        if (ctx.type == \"}\") ctx = popContext(state);\n        while (ctx.type == \"statement\") ctx = popContext(state);\n      }\n      else if (curPunc == ctx.type) popContext(state);\n      else if (indentStatements &&\n               (((ctx.type == \"}\" || ctx.type == \"top\") && curPunc != \";\") ||\n                (ctx.type == \"statement\" && curPunc == \"newstatement\"))) {\n        pushContext(state, stream.column(), \"statement\", stream.current());\n      }\n\n      if (style == \"variable\" &&\n          ((state.prevToken == \"def\" ||\n            (parserConfig.typeFirstDefinitions && typeBefore(stream, state, stream.start) &&\n             isTopScope(state.context) && stream.match(/^\\s*\\(/, false)))))\n        style = \"def\";\n\n      if (hooks.token) {\n        var result = hooks.token(stream, state, style);\n        if (result !== undefined) style = result;\n      }\n\n      if (style == \"def\" && parserConfig.styleDefs === false) style = \"variable\";\n\n      state.startOfLine = false;\n      state.prevToken = isDefKeyword ? \"def\" : style || curPunc;\n      maybeEOL(stream, state);\n      return style;\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize != tokenBase && state.tokenize != null || state.typeAtEndOfLine) return CodeMirror.Pass;\n      var ctx = state.context, firstChar = textAfter && textAfter.charAt(0);\n      var closing = firstChar == ctx.type;\n      if (ctx.type == \"statement\" && firstChar == \"}\") ctx = ctx.prev;\n      if (parserConfig.dontIndentStatements)\n        while (ctx.type == \"statement\" && parserConfig.dontIndentStatements.test(ctx.info))\n          ctx = ctx.prev\n      if (hooks.indent) {\n        var hook = hooks.indent(state, ctx, textAfter, indentUnit);\n        if (typeof hook == \"number\") return hook\n      }\n      var switchBlock = ctx.prev && ctx.prev.info == \"switch\";\n      if (parserConfig.allmanIndentation && /[{(]/.test(firstChar)) {\n        while (ctx.type != \"top\" && ctx.type != \"}\") ctx = ctx.prev\n        return ctx.indented\n      }\n      if (ctx.type == \"statement\")\n        return ctx.indented + (firstChar == \"{\" ? 0 : statementIndentUnit);\n      if (ctx.align && (!dontAlignCalls || ctx.type != \")\"))\n        return ctx.column + (closing ? 0 : 1);\n      if (ctx.type == \")\" && !closing)\n        return ctx.indented + statementIndentUnit;\n\n      return ctx.indented + (closing ? 0 : indentUnit) +\n        (!closing && switchBlock && !/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 0);\n    },\n\n    electricInput: indentSwitch ? /^\\s*(?:case .*?:|default:|\\{\\}?|\\})$/ : /^\\s*[{}]$/,\n    blockCommentStart: \"/*\",\n    blockCommentEnd: \"*/\",\n    blockCommentContinue: \" * \",\n    lineComment: \"//\",\n    fold: \"brace\"\n  };\n});\n\n  function words(str) {\n    var obj = {}, words = str.split(\" \");\n    for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n    return obj;\n  }\n  function contains(words, word) {\n    if (typeof words === \"function\") {\n      return words(word);\n    } else {\n      return words.propertyIsEnumerable(word);\n    }\n  }\n  var cKeywords = \"auto if break case register continue return default do sizeof \" +\n    \"static else struct switch extern typedef union for goto while enum const volatile\";\n  var cTypes = \"int long char short double float unsigned signed void size_t ptrdiff_t\";\n\n  function cppHook(stream, state) {\n    if (!state.startOfLine) return false\n    for (var ch, next = null; ch = stream.peek();) {\n      if (ch == \"\\\\\" && stream.match(/^.$/)) {\n        next = cppHook\n        break\n      } else if (ch == \"/\" && stream.match(/^\\/[\\/\\*]/, false)) {\n        break\n      }\n      stream.next()\n    }\n    state.tokenize = next\n    return \"meta\"\n  }\n\n  function pointerHook(_stream, state) {\n    if (state.prevToken == \"type\") return \"type\";\n    return false;\n  }\n\n  function cpp14Literal(stream) {\n    stream.eatWhile(/[\\w\\.']/);\n    return \"number\";\n  }\n\n  function cpp11StringHook(stream, state) {\n    stream.backUp(1);\n    // Raw strings.\n    if (stream.match(/(R|u8R|uR|UR|LR)/)) {\n      var match = stream.match(/\"([^\\s\\\\()]{0,16})\\(/);\n      if (!match) {\n        return false;\n      }\n      state.cpp11RawStringDelim = match[1];\n      state.tokenize = tokenRawString;\n      return tokenRawString(stream, state);\n    }\n    // Unicode strings/chars.\n    if (stream.match(/(u8|u|U|L)/)) {\n      if (stream.match(/[\"']/, /* eat */ false)) {\n        return \"string\";\n      }\n      return false;\n    }\n    // Ignore this hook.\n    stream.next();\n    return false;\n  }\n\n  function cppLooksLikeConstructor(word) {\n    var lastTwo = /(\\w+)::~?(\\w+)$/.exec(word);\n    return lastTwo && lastTwo[1] == lastTwo[2];\n  }\n\n  // C#-style strings where \"\" escapes a quote.\n  function tokenAtString(stream, state) {\n    var next;\n    while ((next = stream.next()) != null) {\n      if (next == '\"' && !stream.eat('\"')) {\n        state.tokenize = null;\n        break;\n      }\n    }\n    return \"string\";\n  }\n\n  // C++11 raw string literal is <prefix>\"<delim>( anything )<delim>\", where\n  // <delim> can be a string up to 16 characters long.\n  function tokenRawString(stream, state) {\n    // Escape characters that have special regex meanings.\n    var delim = state.cpp11RawStringDelim.replace(/[^\\w\\s]/g, '\\\\$&');\n    var match = stream.match(new RegExp(\".*?\\\\)\" + delim + '\"'));\n    if (match)\n      state.tokenize = null;\n    else\n      stream.skipToEnd();\n    return \"string\";\n  }\n\n  function def(mimes, mode) {\n    if (typeof mimes == \"string\") mimes = [mimes];\n    var words = [];\n    function add(obj) {\n      if (obj) for (var prop in obj) if (obj.hasOwnProperty(prop))\n        words.push(prop);\n    }\n    add(mode.keywords);\n    add(mode.types);\n    add(mode.builtin);\n    add(mode.atoms);\n    if (words.length) {\n      mode.helperType = mimes[0];\n      CodeMirror.registerHelper(\"hintWords\", mimes[0], words);\n    }\n\n    for (var i = 0; i < mimes.length; ++i)\n      CodeMirror.defineMIME(mimes[i], mode);\n  }\n\n  def([\"text/x-csrc\", \"text/x-c\", \"text/x-chdr\"], {\n    name: \"clike\",\n    keywords: words(cKeywords),\n    types: words(cTypes + \" bool _Complex _Bool float_t double_t intptr_t intmax_t \" +\n                 \"int8_t int16_t int32_t int64_t uintptr_t uintmax_t uint8_t uint16_t \" +\n                 \"uint32_t uint64_t\"),\n    blockKeywords: words(\"case do else for if switch while struct\"),\n    defKeywords: words(\"struct\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"NULL true false\"),\n    hooks: {\"#\": cppHook, \"*\": pointerHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def([\"text/x-c++src\", \"text/x-c++hdr\"], {\n    name: \"clike\",\n    keywords: words(cKeywords + \" asm dynamic_cast namespace reinterpret_cast try explicit new \" +\n                    \"static_cast typeid catch operator template typename class friend private \" +\n                    \"this using const_cast inline public throw virtual delete mutable protected \" +\n                    \"alignas alignof constexpr decltype nullptr noexcept thread_local final \" +\n                    \"static_assert override\"),\n    types: words(cTypes + \" bool wchar_t\"),\n    blockKeywords: words(\"catch class do else finally for if struct switch try while\"),\n    defKeywords: words(\"class namespace struct enum union\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false NULL\"),\n    dontIndentStatements: /^template$/,\n    isIdentifierChar: /[\\w\\$_~\\xa1-\\uffff]/,\n    hooks: {\n      \"#\": cppHook,\n      \"*\": pointerHook,\n      \"u\": cpp11StringHook,\n      \"U\": cpp11StringHook,\n      \"L\": cpp11StringHook,\n      \"R\": cpp11StringHook,\n      \"0\": cpp14Literal,\n      \"1\": cpp14Literal,\n      \"2\": cpp14Literal,\n      \"3\": cpp14Literal,\n      \"4\": cpp14Literal,\n      \"5\": cpp14Literal,\n      \"6\": cpp14Literal,\n      \"7\": cpp14Literal,\n      \"8\": cpp14Literal,\n      \"9\": cpp14Literal,\n      token: function(stream, state, style) {\n        if (style == \"variable\" && stream.peek() == \"(\" &&\n            (state.prevToken == \";\" || state.prevToken == null ||\n             state.prevToken == \"}\") &&\n            cppLooksLikeConstructor(stream.current()))\n          return \"def\";\n      }\n    },\n    namespaceSeparator: \"::\",\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def(\"text/x-java\", {\n    name: \"clike\",\n    keywords: words(\"abstract assert break case catch class const continue default \" +\n                    \"do else enum extends final finally float for goto if implements import \" +\n                    \"instanceof interface native new package private protected public \" +\n                    \"return static strictfp super switch synchronized this throw throws transient \" +\n                    \"try volatile while @interface\"),\n    types: words(\"byte short int long float double boolean char void Boolean Byte Character Double Float \" +\n                 \"Integer Long Number Object Short String StringBuffer StringBuilder Void\"),\n    blockKeywords: words(\"catch class do else finally for if switch try while\"),\n    defKeywords: words(\"class interface enum @interface\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null\"),\n    number: /^(?:0x[a-f\\d_]+|0b[01_]+|(?:[\\d_]+\\.?\\d*|\\.\\d+)(?:e[-+]?[\\d_]+)?)(u|ll?|l|f)?/i,\n    hooks: {\n      \"@\": function(stream) {\n        // Don't match the @interface keyword.\n        if (stream.match('interface', false)) return false;\n\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      }\n    },\n    modeProps: {fold: [\"brace\", \"import\"]}\n  });\n\n  def(\"text/x-csharp\", {\n    name: \"clike\",\n    keywords: words(\"abstract as async await base break case catch checked class const continue\" +\n                    \" default delegate do else enum event explicit extern finally fixed for\" +\n                    \" foreach goto if implicit in interface internal is lock namespace new\" +\n                    \" operator out override params private protected public readonly ref return sealed\" +\n                    \" sizeof stackalloc static struct switch this throw try typeof unchecked\" +\n                    \" unsafe using virtual void volatile while add alias ascending descending dynamic from get\" +\n                    \" global group into join let orderby partial remove select set value var yield\"),\n    types: words(\"Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func\" +\n                 \" Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32\" +\n                 \" UInt64 bool byte char decimal double short int long object\"  +\n                 \" sbyte float string ushort uint ulong\"),\n    blockKeywords: words(\"catch class do else finally for foreach if struct switch try while\"),\n    defKeywords: words(\"class interface namespace struct var\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null\"),\n    hooks: {\n      \"@\": function(stream, state) {\n        if (stream.eat('\"')) {\n          state.tokenize = tokenAtString;\n          return tokenAtString(stream, state);\n        }\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      }\n    }\n  });\n\n  function tokenTripleString(stream, state) {\n    var escaped = false;\n    while (!stream.eol()) {\n      if (!escaped && stream.match('\"\"\"')) {\n        state.tokenize = null;\n        break;\n      }\n      escaped = stream.next() == \"\\\\\" && !escaped;\n    }\n    return \"string\";\n  }\n\n  function tokenNestedComment(depth) {\n    return function (stream, state) {\n      var ch\n      while (ch = stream.next()) {\n        if (ch == \"*\" && stream.eat(\"/\")) {\n          if (depth == 1) {\n            state.tokenize = null\n            break\n          } else {\n            state.tokenize = tokenNestedComment(depth - 1)\n            return state.tokenize(stream, state)\n          }\n        } else if (ch == \"/\" && stream.eat(\"*\")) {\n          state.tokenize = tokenNestedComment(depth + 1)\n          return state.tokenize(stream, state)\n        }\n      }\n      return \"comment\"\n    }\n  }\n\n  def(\"text/x-scala\", {\n    name: \"clike\",\n    keywords: words(\n\n      /* scala */\n      \"abstract case catch class def do else extends final finally for forSome if \" +\n      \"implicit import lazy match new null object override package private protected return \" +\n      \"sealed super this throw trait try type val var while with yield _ \" +\n\n      /* package scala */\n      \"assert assume require print println printf readLine readBoolean readByte readShort \" +\n      \"readChar readInt readLong readFloat readDouble\"\n    ),\n    types: words(\n      \"AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either \" +\n      \"Enumeration Equiv Error Exception Fractional Function IndexedSeq Int Integral Iterable \" +\n      \"Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering \" +\n      \"Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder \" +\n      \"StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector \" +\n\n      /* package java.lang */\n      \"Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable \" +\n      \"Compiler Double Exception Float Integer Long Math Number Object Package Pair Process \" +\n      \"Runtime Runnable SecurityManager Short StackTraceElement StrictMath String \" +\n      \"StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void\"\n    ),\n    multiLineStrings: true,\n    blockKeywords: words(\"catch class enum do else finally for forSome if match switch try while\"),\n    defKeywords: words(\"class enum def object package trait type val var\"),\n    atoms: words(\"true false null\"),\n    indentStatements: false,\n    indentSwitch: false,\n    isOperatorChar: /[+\\-*&%=<>!?|\\/#:@]/,\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      },\n      '\"': function(stream, state) {\n        if (!stream.match('\"\"')) return false;\n        state.tokenize = tokenTripleString;\n        return state.tokenize(stream, state);\n      },\n      \"'\": function(stream) {\n        stream.eatWhile(/[\\w\\$_\\xa1-\\uffff]/);\n        return \"atom\";\n      },\n      \"=\": function(stream, state) {\n        var cx = state.context\n        if (cx.type == \"}\" && cx.align && stream.eat(\">\")) {\n          state.context = new Context(cx.indented, cx.column, cx.type, cx.info, null, cx.prev)\n          return \"operator\"\n        } else {\n          return false\n        }\n      },\n\n      \"/\": function(stream, state) {\n        if (!stream.eat(\"*\")) return false\n        state.tokenize = tokenNestedComment(1)\n        return state.tokenize(stream, state)\n      }\n    },\n    modeProps: {closeBrackets: {triples: '\"'}}\n  });\n\n  function tokenKotlinString(tripleString){\n    return function (stream, state) {\n      var escaped = false, next, end = false;\n      while (!stream.eol()) {\n        if (!tripleString && !escaped && stream.match('\"') ) {end = true; break;}\n        if (tripleString && stream.match('\"\"\"')) {end = true; break;}\n        next = stream.next();\n        if(!escaped && next == \"$\" && stream.match('{'))\n          stream.skipTo(\"}\");\n        escaped = !escaped && next == \"\\\\\" && !tripleString;\n      }\n      if (end || !tripleString)\n        state.tokenize = null;\n      return \"string\";\n    }\n  }\n\n  def(\"text/x-kotlin\", {\n    name: \"clike\",\n    keywords: words(\n      /*keywords*/\n      \"package as typealias class interface this super val operator \" +\n      \"var fun for is in This throw return annotation \" +\n      \"break continue object if else while do try when !in !is as? \" +\n\n      /*soft keywords*/\n      \"file import where by get set abstract enum open inner override private public internal \" +\n      \"protected catch finally out final vararg reified dynamic companion constructor init \" +\n      \"sealed field property receiver param sparam lateinit data inline noinline tailrec \" +\n      \"external annotation crossinline const operator infix suspend actual expect setparam\"\n    ),\n    types: words(\n      /* package java.lang */\n      \"Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable \" +\n      \"Compiler Double Exception Float Integer Long Math Number Object Package Pair Process \" +\n      \"Runtime Runnable SecurityManager Short StackTraceElement StrictMath String \" +\n      \"StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void Annotation Any BooleanArray \" +\n      \"ByteArray Char CharArray DeprecationLevel DoubleArray Enum FloatArray Function Int IntArray Lazy \" +\n      \"LazyThreadSafetyMode LongArray Nothing ShortArray Unit\"\n    ),\n    intendSwitch: false,\n    indentStatements: false,\n    multiLineStrings: true,\n    number: /^(?:0x[a-f\\d_]+|0b[01_]+|(?:[\\d_]+(\\.\\d+)?|\\.\\d+)(?:e[-+]?[\\d_]+)?)(u|ll?|l|f)?/i,\n    blockKeywords: words(\"catch class do else finally for if where try while enum\"),\n    defKeywords: words(\"class val var object interface fun\"),\n    atoms: words(\"true false null this\"),\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      },\n      '\"': function(stream, state) {\n        state.tokenize = tokenKotlinString(stream.match('\"\"'));\n        return state.tokenize(stream, state);\n      },\n      indent: function(state, ctx, textAfter, indentUnit) {\n        var firstChar = textAfter && textAfter.charAt(0);\n        if ((state.prevToken == \"}\" || state.prevToken == \")\") && textAfter == \"\")\n          return state.indented;\n        if (state.prevToken == \"operator\" && textAfter != \"}\" ||\n          state.prevToken == \"variable\" && firstChar == \".\" ||\n          (state.prevToken == \"}\" || state.prevToken == \")\") && firstChar == \".\")\n          return indentUnit * 2 + ctx.indented;\n        if (ctx.align && ctx.type == \"}\")\n          return ctx.indented + (state.context.type == (textAfter || \"\").charAt(0) ? 0 : indentUnit);\n      }\n    },\n    modeProps: {closeBrackets: {triples: '\"'}}\n  });\n\n  def([\"x-shader/x-vertex\", \"x-shader/x-fragment\"], {\n    name: \"clike\",\n    keywords: words(\"sampler1D sampler2D sampler3D samplerCube \" +\n                    \"sampler1DShadow sampler2DShadow \" +\n                    \"const attribute uniform varying \" +\n                    \"break continue discard return \" +\n                    \"for while do if else struct \" +\n                    \"in out inout\"),\n    types: words(\"float int bool void \" +\n                 \"vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 \" +\n                 \"mat2 mat3 mat4\"),\n    blockKeywords: words(\"for while do if else struct\"),\n    builtin: words(\"radians degrees sin cos tan asin acos atan \" +\n                    \"pow exp log exp2 sqrt inversesqrt \" +\n                    \"abs sign floor ceil fract mod min max clamp mix step smoothstep \" +\n                    \"length distance dot cross normalize ftransform faceforward \" +\n                    \"reflect refract matrixCompMult \" +\n                    \"lessThan lessThanEqual greaterThan greaterThanEqual \" +\n                    \"equal notEqual any all not \" +\n                    \"texture1D texture1DProj texture1DLod texture1DProjLod \" +\n                    \"texture2D texture2DProj texture2DLod texture2DProjLod \" +\n                    \"texture3D texture3DProj texture3DLod texture3DProjLod \" +\n                    \"textureCube textureCubeLod \" +\n                    \"shadow1D shadow2D shadow1DProj shadow2DProj \" +\n                    \"shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod \" +\n                    \"dFdx dFdy fwidth \" +\n                    \"noise1 noise2 noise3 noise4\"),\n    atoms: words(\"true false \" +\n                \"gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex \" +\n                \"gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 \" +\n                \"gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 \" +\n                \"gl_FogCoord gl_PointCoord \" +\n                \"gl_Position gl_PointSize gl_ClipVertex \" +\n                \"gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor \" +\n                \"gl_TexCoord gl_FogFragCoord \" +\n                \"gl_FragCoord gl_FrontFacing \" +\n                \"gl_FragData gl_FragDepth \" +\n                \"gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix \" +\n                \"gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse \" +\n                \"gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse \" +\n                \"gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose \" +\n                \"gl_ProjectionMatrixInverseTranspose \" +\n                \"gl_ModelViewProjectionMatrixInverseTranspose \" +\n                \"gl_TextureMatrixInverseTranspose \" +\n                \"gl_NormalScale gl_DepthRange gl_ClipPlane \" +\n                \"gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel \" +\n                \"gl_FrontLightModelProduct gl_BackLightModelProduct \" +\n                \"gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ \" +\n                \"gl_FogParameters \" +\n                \"gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords \" +\n                \"gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats \" +\n                \"gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits \" +\n                \"gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits \" +\n                \"gl_MaxDrawBuffers\"),\n    indentSwitch: false,\n    hooks: {\"#\": cppHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def(\"text/x-nesc\", {\n    name: \"clike\",\n    keywords: words(cKeywords + \"as atomic async call command component components configuration event generic \" +\n                    \"implementation includes interface module new norace nx_struct nx_union post provides \" +\n                    \"signal task uses abstract extends\"),\n    types: words(cTypes),\n    blockKeywords: words(\"case do else for if switch while struct\"),\n    atoms: words(\"null true false\"),\n    hooks: {\"#\": cppHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def(\"text/x-objectivec\", {\n    name: \"clike\",\n    keywords: words(cKeywords + \"inline restrict _Bool _Complex _Imaginary BOOL Class bycopy byref id IMP in \" +\n                    \"inout nil oneway out Protocol SEL self super atomic nonatomic retain copy readwrite readonly\"),\n    types: words(cTypes),\n    atoms: words(\"YES NO NULL NILL ON OFF true false\"),\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$]/);\n        return \"keyword\";\n      },\n      \"#\": cppHook,\n      indent: function(_state, ctx, textAfter) {\n        if (ctx.type == \"statement\" && /^@\\w/.test(textAfter)) return ctx.indented\n      }\n    },\n    modeProps: {fold: \"brace\"}\n  });\n\n  def(\"text/x-squirrel\", {\n    name: \"clike\",\n    keywords: words(\"base break clone continue const default delete enum extends function in class\" +\n                    \" foreach local resume return this throw typeof yield constructor instanceof static\"),\n    types: words(cTypes),\n    blockKeywords: words(\"case catch class else for foreach if switch try while\"),\n    defKeywords: words(\"function local class\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null\"),\n    hooks: {\"#\": cppHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  // Ceylon Strings need to deal with interpolation\n  var stringTokenizer = null;\n  function tokenCeylonString(type) {\n    return function(stream, state) {\n      var escaped = false, next, end = false;\n      while (!stream.eol()) {\n        if (!escaped && stream.match('\"') &&\n              (type == \"single\" || stream.match('\"\"'))) {\n          end = true;\n          break;\n        }\n        if (!escaped && stream.match('``')) {\n          stringTokenizer = tokenCeylonString(type);\n          end = true;\n          break;\n        }\n        next = stream.next();\n        escaped = type == \"single\" && !escaped && next == \"\\\\\";\n      }\n      if (end)\n          state.tokenize = null;\n      return \"string\";\n    }\n  }\n\n  def(\"text/x-ceylon\", {\n    name: \"clike\",\n    keywords: words(\"abstracts alias assembly assert assign break case catch class continue dynamic else\" +\n                    \" exists extends finally for function given if import in interface is let module new\" +\n                    \" nonempty object of out outer package return satisfies super switch then this throw\" +\n                    \" try value void while\"),\n    types: function(word) {\n        // In Ceylon all identifiers that start with an uppercase are types\n        var first = word.charAt(0);\n        return (first === first.toUpperCase() && first !== first.toLowerCase());\n    },\n    blockKeywords: words(\"case catch class dynamic else finally for function if interface module new object switch try while\"),\n    defKeywords: words(\"class dynamic function interface module object package value\"),\n    builtin: words(\"abstract actual aliased annotation by default deprecated doc final formal late license\" +\n                   \" native optional sealed see serializable shared suppressWarnings tagged throws variable\"),\n    isPunctuationChar: /[\\[\\]{}\\(\\),;\\:\\.`]/,\n    isOperatorChar: /[+\\-*&%=<>!?|^~:\\/]/,\n    numberStart: /[\\d#$]/,\n    number: /^(?:#[\\da-fA-F_]+|\\$[01_]+|[\\d_]+[kMGTPmunpf]?|[\\d_]+\\.[\\d_]+(?:[eE][-+]?\\d+|[kMGTPmunpf]|)|)/i,\n    multiLineStrings: true,\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null larger smaller equal empty finished\"),\n    indentSwitch: false,\n    styleDefs: false,\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      },\n      '\"': function(stream, state) {\n          state.tokenize = tokenCeylonString(stream.match('\"\"') ? \"triple\" : \"single\");\n          return state.tokenize(stream, state);\n        },\n      '`': function(stream, state) {\n          if (!stringTokenizer || !stream.match('`')) return false;\n          state.tokenize = stringTokenizer;\n          stringTokenizer = null;\n          return state.tokenize(stream, state);\n        },\n      \"'\": function(stream) {\n        stream.eatWhile(/[\\w\\$_\\xa1-\\uffff]/);\n        return \"atom\";\n      },\n      token: function(_stream, state, style) {\n          if ((style == \"variable\" || style == \"type\") &&\n              state.prevToken == \".\") {\n            return \"variable-2\";\n          }\n        }\n    },\n    modeProps: {\n        fold: [\"brace\", \"import\"],\n        closeBrackets: {triples: '\"'}\n    }\n  });\n\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/codemirror/mode/clike/clike.js\n// module id = 18\n// module chunks = 0","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function (mod) {\n    if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n        mod(require(\"../../lib/codemirror\"));\n    else if (typeof define == \"function\" && define.amd) // AMD\n        define([\"../../lib/codemirror\"], mod);\n    else // Plain browser env\n        mod(CodeMirror);\n})(function (CodeMirror) {\n    CodeMirror.defineMode(\"glsl\", function (config, parserConfig) {\n        var indentUnit = config.indentUnit,\n            keywords = parserConfig.keywords || {},\n            builtins = parserConfig.builtins || {},\n            blockKeywords = parserConfig.blockKeywords || {},\n            atoms = parserConfig.atoms || {},\n            hooks = parserConfig.hooks || {},\n            multiLineStrings = parserConfig.multiLineStrings;\n        var isOperatorChar = /[+\\-*&%=<>!?|\\/]/;\n\n        var curPunc;\n\n        function tokenBase(stream, state) {\n            var ch = stream.next();\n            if (hooks[ch]) {\n                var result = hooks[ch](stream, state);\n                if (result !== false) return result;\n            }\n            if (ch == '\"' || ch == \"'\") {\n                state.tokenize = tokenString(ch);\n                return state.tokenize(stream, state);\n            }\n            if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n                curPunc = ch;\n                return \"bracket\";\n            }\n            if (/\\d/.test(ch)) {\n                stream.eatWhile(/[\\w\\.]/);\n                return \"number\";\n            }\n            if (ch == \"/\") {\n                if (stream.eat(\"*\")) {\n                    state.tokenize = tokenComment;\n                    return tokenComment(stream, state);\n                }\n                if (stream.eat(\"/\")) {\n                    stream.skipToEnd();\n                    return \"comment\";\n                }\n            }\n            if (isOperatorChar.test(ch)) {\n                stream.eatWhile(isOperatorChar);\n                return \"operator\";\n            }\n            stream.eatWhile(/[\\w\\$_]/);\n            var cur = stream.current();\n            if (keywords.propertyIsEnumerable(cur)) {\n                if (blockKeywords.propertyIsEnumerable(cur)) curPunc = \"newstatement\";\n                return \"keyword\";\n            }\n            if (builtins.propertyIsEnumerable(cur)) {\n                return \"builtin\";\n            }\n            if (atoms.propertyIsEnumerable(cur)) return \"atom\";\n            return \"word\";\n        }\n\n        function tokenString(quote) {\n            return function (stream, state) {\n                var escaped = false, next, end = false;\n                while ((next = stream.next()) != null) {\n                    if (next == quote && !escaped) { end = true; break; }\n                    escaped = !escaped && next == \"\\\\\";\n                }\n                if (end || !(escaped || multiLineStrings))\n                    state.tokenize = tokenBase;\n                return \"string\";\n            };\n        }\n\n        function tokenComment(stream, state) {\n            var maybeEnd = false, ch;\n            while (ch = stream.next()) {\n                if (ch == \"/\" && maybeEnd) {\n                    state.tokenize = tokenBase;\n                    break;\n                }\n                maybeEnd = (ch == \"*\");\n            }\n            return \"comment\";\n        }\n\n        function Context(indented, column, type, align, prev) {\n            this.indented = indented;\n            this.column = column;\n            this.type = type;\n            this.align = align;\n            this.prev = prev;\n        }\n        function pushContext(state, col, type) {\n            return state.context = new Context(state.indented, col, type, null, state.context);\n        }\n        function popContext(state) {\n            var t = state.context.type;\n            if (t == \")\" || t == \"]\" || t == \"}\")\n                state.indented = state.context.indented;\n            return state.context = state.context.prev;\n        }\n\n        // Interface\n\n        return {\n            startState: function (basecolumn) {\n                return {\n                    tokenize: null,\n                    context: new Context((basecolumn || 0) - indentUnit, 0, \"top\", false),\n                    indented: 0,\n                    startOfLine: true\n                };\n            },\n\n            token: function (stream, state) {\n                var ctx = state.context;\n                if (stream.sol()) {\n                    if (ctx.align == null) ctx.align = false;\n                    state.indented = stream.indentation();\n                    state.startOfLine = true;\n                }\n                if (stream.eatSpace()) return null;\n                curPunc = null;\n                var style = (state.tokenize || tokenBase)(stream, state);\n                if (style == \"comment\" || style == \"meta\") return style;\n                if (ctx.align == null) ctx.align = true;\n\n                if ((curPunc == \";\" || curPunc == \":\") && ctx.type == \"statement\") popContext(state);\n                else if (curPunc == \"{\") pushContext(state, stream.column(), \"}\");\n                else if (curPunc == \"[\") pushContext(state, stream.column(), \"]\");\n                else if (curPunc == \"(\") pushContext(state, stream.column(), \")\");\n                else if (curPunc == \"}\") {\n                    while (ctx.type == \"statement\") ctx = popContext(state);\n                    if (ctx.type == \"}\") ctx = popContext(state);\n                    while (ctx.type == \"statement\") ctx = popContext(state);\n                }\n                else if (curPunc == ctx.type) popContext(state);\n                else if (ctx.type == \"}\" || ctx.type == \"top\" || (ctx.type == \"statement\" && curPunc == \"newstatement\"))\n                    pushContext(state, stream.column(), \"statement\");\n                state.startOfLine = false;\n                return style;\n            },\n\n            indent: function (state, textAfter) {\n                if (state.tokenize != tokenBase && state.tokenize != null) return 0;\n                var firstChar = textAfter && textAfter.charAt(0), ctx = state.context, closing = firstChar == ctx.type;\n                if (ctx.type == \"statement\") return ctx.indented + (firstChar == \"{\" ? 0 : indentUnit);\n                else if (ctx.align) return ctx.column + (closing ? 0 : 1);\n                else return ctx.indented + (closing ? 0 : indentUnit);\n            },\n\n            electricChars: \"{}\"\n        };\n    });\n\n    (function () {\n        function words(str) {\n            var obj = {}, words = str.split(\" \");\n            for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n            return obj;\n        }\n        var glslKeywords = \"float vec2 vec3 vec4 int ivec2 ivec3 ivec4 bool bvec2 bvec3 bvec4 mat2 mat3 mat4 \" +\n            \"void sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow \" +\n            \"uniform attribute varying const in out inout const \" +\n            \"#define #undef #if #ifdef #ifndef #else #elif #endif #error #pragma #line #version #extension \" +\n            \"break continue do for while if else true false \" +\n            \"lowp mediump highp precision invariant discard return \" +\n            \"gl_Position gl_PointSize gl_ClipVertex gl_Vertex gl_Normal gl_Color \" +\n            \"gl_SecondaryColor gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 \" +\n            \"gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 \" +\n            \"gl_MultiTexCoord7 gl_FogCoord gl_FrontColor gl_BackColor \" +\n            \"gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord \" +\n            \"gl_FragColor gl_FragData gl_FragDepth gl_Color gl_SecondaryColor gl_FogFragCoord \" +\n            \"gl_FragCoord gl_FrontFacing\";\n\n        var glslBuiltins = \"sin cos tan asin acos atan atan radians degrees \" +\n            \"pow exp log exp2 log2 sqrt inversesqrt abs ceil \" +\n            \"clamp floor fract max min mix mod sign smoothstep \" +\n            \"step ftransform cross distance dot faceforward \" +\n            \"length normalize reflect refract dFdx dFdy fwidth \" +\n            \"matrixCompMult all any equal greaterThan greaterThanEqual \" +\n            \"lessThan lessThanEqual notEqual \" +\n            \"texture1D texture1DProj texture1DProj \" +\n            \"texture2D texture2DProj texture2DProj \" +\n            \"texture3D texture3DProj \" +\n            \"textureCube shadow1D shadow2D shadow1DProj shadow2DProj \" +\n            \"texture1DLod texture1DProjLod texture1DProjLod \" +\n            \"texture2DLod texture2DProjLod texture2DProjLod texture3DProjLod \" +\n            \"textureCubeLod shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod \" +\n            \"gl_ModelViewMatrix gl_ModelViewProjectionMatrix gl_ProjectionMatrix \" +\n            \"gl_TextureMatrix gl_ModelViewMatrixInverse gl_ModelViewProjectionMatrixInverse \" +\n            \"gl_ProjectionMatrixInverse gl_TextureMatrixInverse gl_ModelViewMatrixTranspose \" +\n            \"gl_ModelViewProjectionMatrixTranspose gl_ProjectionMatrixTranspose \" +\n            \"gl_TextureMatrixTranspose gl_ModelViewMatrixInverseTranspose \" +\n            \"gl_ModelViewProjectionMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose \" +\n            \"gl_TextureMatrixInverseTranspose gl_NormalMatrix gl_NormalScale \";\n\n        function cppHook(stream, state) {\n            if (!state.startOfLine) return false;\n            stream.skipToEnd();\n            return \"meta\";\n        }\n\n        // C#-style strings where \"\" escapes a quote.\n        function tokenAtString(stream, state) {\n            var next;\n            while ((next = stream.next()) != null) {\n                if (next == '\"' && !stream.eat('\"')) {\n                    state.tokenize = null;\n                    break;\n                }\n            }\n            return \"string\";\n        }\n\n        CodeMirror.defineMIME(\"text/x-glsl\", {\n            name: \"glsl\",\n            keywords: words(glslKeywords),\n            builtins: words(glslBuiltins),\n            blockKeywords: words(\"case do else for if switch while struct\"),\n            atoms: words(\"null\"),\n            hooks: { \"#\": cppHook }\n        });\n    })();\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/mode/glsl/glsl.js","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tmodule.children = [];\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n}\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/module.js\n// module id = 20\n// module chunks = 0","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// This is CodeMirror (http://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n// Kludges for bugs and behavior differences that can't be feature\n// detected are enabled based on userAgent etc sniffing.\nvar userAgent = navigator.userAgent;\nvar platform = navigator.platform;\n\nvar gecko = /gecko\\/\\d/i.test(userAgent);\nvar ie_upto10 = /MSIE \\d/.test(userAgent);\nvar ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\nvar edge = /Edge\\/(\\d+)/.exec(userAgent);\nvar ie = ie_upto10 || ie_11up || edge;\nvar ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\nvar webkit = !edge && /WebKit\\//.test(userAgent);\nvar qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\nvar chrome = !edge && /Chrome\\//.test(userAgent);\nvar presto = /Opera\\//.test(userAgent);\nvar safari = /Apple Computer/.test(navigator.vendor);\nvar mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\nvar phantom = /PhantomJS/.test(userAgent);\n\nvar ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\nvar android = /Android/.test(userAgent);\n// This is woefully incomplete. Suggestions for alternative methods welcome.\nvar mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\nvar mac = ios || /Mac/.test(platform);\nvar chromeOS = /\\bCrOS\\b/.test(userAgent);\nvar windows = /win/i.test(platform);\n\nvar presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\nif (presto_version) { presto_version = Number(presto_version[1]); }\nif (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n// Some browsers use the wrong event properties to signal cmd/ctrl on OS X\nvar flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\nvar captureRightClick = gecko || (ie && ie_version >= 9);\n\nfunction classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\nvar rmClass = function(node, cls) {\n  var current = node.className;\n  var match = classTest(cls).exec(current);\n  if (match) {\n    var after = current.slice(match.index + match[0].length);\n    node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n  }\n};\n\nfunction removeChildren(e) {\n  for (var count = e.childNodes.length; count > 0; --count)\n    { e.removeChild(e.firstChild); }\n  return e\n}\n\nfunction removeChildrenAndAdd(parent, e) {\n  return removeChildren(parent).appendChild(e)\n}\n\nfunction elt(tag, content, className, style) {\n  var e = document.createElement(tag);\n  if (className) { e.className = className; }\n  if (style) { e.style.cssText = style; }\n  if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n  else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n  return e\n}\n// wrapper for elt, which removes the elt from the accessibility tree\nfunction eltP(tag, content, className, style) {\n  var e = elt(tag, content, className, style);\n  e.setAttribute(\"role\", \"presentation\");\n  return e\n}\n\nvar range;\nif (document.createRange) { range = function(node, start, end, endNode) {\n  var r = document.createRange();\n  r.setEnd(endNode || node, end);\n  r.setStart(node, start);\n  return r\n}; }\nelse { range = function(node, start, end) {\n  var r = document.body.createTextRange();\n  try { r.moveToElementText(node.parentNode); }\n  catch(e) { return r }\n  r.collapse(true);\n  r.moveEnd(\"character\", end);\n  r.moveStart(\"character\", start);\n  return r\n}; }\n\nfunction contains(parent, child) {\n  if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n    { child = child.parentNode; }\n  if (parent.contains)\n    { return parent.contains(child) }\n  do {\n    if (child.nodeType == 11) { child = child.host; }\n    if (child == parent) { return true }\n  } while (child = child.parentNode)\n}\n\nfunction activeElt() {\n  // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n  // IE < 10 will throw when accessed while the page is loading or in an iframe.\n  // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n  var activeElement;\n  try {\n    activeElement = document.activeElement;\n  } catch(e) {\n    activeElement = document.body || null;\n  }\n  while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n    { activeElement = activeElement.shadowRoot.activeElement; }\n  return activeElement\n}\n\nfunction addClass(node, cls) {\n  var current = node.className;\n  if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n}\nfunction joinClasses(a, b) {\n  var as = a.split(\" \");\n  for (var i = 0; i < as.length; i++)\n    { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n  return b\n}\n\nvar selectInput = function(node) { node.select(); };\nif (ios) // Mobile Safari apparently has a bug where select() is broken.\n  { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\nelse if (ie) // Suppress mysterious IE10 errors\n  { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\nfunction bind(f) {\n  var args = Array.prototype.slice.call(arguments, 1);\n  return function(){return f.apply(null, args)}\n}\n\nfunction copyObj(obj, target, overwrite) {\n  if (!target) { target = {}; }\n  for (var prop in obj)\n    { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n      { target[prop] = obj[prop]; } }\n  return target\n}\n\n// Counts the column offset in a string, taking tabs into account.\n// Used mostly to find indentation.\nfunction countColumn(string, end, tabSize, startIndex, startValue) {\n  if (end == null) {\n    end = string.search(/[^\\s\\u00a0]/);\n    if (end == -1) { end = string.length; }\n  }\n  for (var i = startIndex || 0, n = startValue || 0;;) {\n    var nextTab = string.indexOf(\"\\t\", i);\n    if (nextTab < 0 || nextTab >= end)\n      { return n + (end - i) }\n    n += nextTab - i;\n    n += tabSize - (n % tabSize);\n    i = nextTab + 1;\n  }\n}\n\nvar Delayed = function() {this.id = null;};\nDelayed.prototype.set = function (ms, f) {\n  clearTimeout(this.id);\n  this.id = setTimeout(f, ms);\n};\n\nfunction indexOf(array, elt) {\n  for (var i = 0; i < array.length; ++i)\n    { if (array[i] == elt) { return i } }\n  return -1\n}\n\n// Number of pixels added to scroller and sizer to hide scrollbar\nvar scrollerGap = 30;\n\n// Returned or thrown by various protocols to signal 'I'm not\n// handling this'.\nvar Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n// Reused option objects for setSelection & friends\nvar sel_dontScroll = {scroll: false};\nvar sel_mouse = {origin: \"*mouse\"};\nvar sel_move = {origin: \"+move\"};\n\n// The inverse of countColumn -- find the offset that corresponds to\n// a particular column.\nfunction findColumn(string, goal, tabSize) {\n  for (var pos = 0, col = 0;;) {\n    var nextTab = string.indexOf(\"\\t\", pos);\n    if (nextTab == -1) { nextTab = string.length; }\n    var skipped = nextTab - pos;\n    if (nextTab == string.length || col + skipped >= goal)\n      { return pos + Math.min(skipped, goal - col) }\n    col += nextTab - pos;\n    col += tabSize - (col % tabSize);\n    pos = nextTab + 1;\n    if (col >= goal) { return pos }\n  }\n}\n\nvar spaceStrs = [\"\"];\nfunction spaceStr(n) {\n  while (spaceStrs.length <= n)\n    { spaceStrs.push(lst(spaceStrs) + \" \"); }\n  return spaceStrs[n]\n}\n\nfunction lst(arr) { return arr[arr.length-1] }\n\nfunction map(array, f) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n  return out\n}\n\nfunction insertSorted(array, value, score) {\n  var pos = 0, priority = score(value);\n  while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n  array.splice(pos, 0, value);\n}\n\nfunction nothing() {}\n\nfunction createObj(base, props) {\n  var inst;\n  if (Object.create) {\n    inst = Object.create(base);\n  } else {\n    nothing.prototype = base;\n    inst = new nothing();\n  }\n  if (props) { copyObj(props, inst); }\n  return inst\n}\n\nvar nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\nfunction isWordCharBasic(ch) {\n  return /\\w/.test(ch) || ch > \"\\x80\" &&\n    (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n}\nfunction isWordChar(ch, helper) {\n  if (!helper) { return isWordCharBasic(ch) }\n  if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n  return helper.test(ch)\n}\n\nfunction isEmpty(obj) {\n  for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n  return true\n}\n\n// Extending unicode characters. A series of a non-extending char +\n// any number of extending chars is treated as a single unit as far\n// as editing and measuring is concerned. This is not fully correct,\n// since some scripts/fonts/browsers also treat other configurations\n// of code points as a group.\nvar extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\nfunction isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n// Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\nfunction skipExtendingChars(str, pos, dir) {\n  while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n  return pos\n}\n\n// Returns the value from the range [`from`; `to`] that satisfies\n// `pred` and is closest to `from`. Assumes that at least `to` satisfies `pred`.\nfunction findFirst(pred, from, to) {\n  for (;;) {\n    if (Math.abs(from - to) <= 1) { return pred(from) ? from : to }\n    var mid = Math.floor((from + to) / 2);\n    if (pred(mid)) { to = mid; }\n    else { from = mid; }\n  }\n}\n\n// The display handles the DOM integration, both for input reading\n// and content drawing. It holds references to DOM nodes and\n// display-related state.\n\nfunction Display(place, doc, input) {\n  var d = this;\n  this.input = input;\n\n  // Covers bottom-right square when both scrollbars are present.\n  d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n  d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Covers bottom of gutter when coverGutterNextToScrollbar is on\n  // and h scrollbar is present.\n  d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n  d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n  // Will contain the actual code, positioned to cover the viewport.\n  d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n  // Elements are added to these to represent selection and cursors.\n  d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n  d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n  // A visibility: hidden element used to find the size of things.\n  d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n  // When lines outside of the viewport are measured, they are drawn in this.\n  d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n  // Wraps everything that needs to exist inside the vertically-padded coordinate system\n  d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                    null, \"position: relative; outline: none\");\n  var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n  // Moved around its parent to cover visible view.\n  d.mover = elt(\"div\", [lines], null, \"position: relative\");\n  // Set to the height of the document, allowing scrolling.\n  d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n  d.sizerWidth = null;\n  // Behavior of elts with overflow: auto and padding is\n  // inconsistent across browsers. This is used to ensure the\n  // scrollable area is big enough.\n  d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n  // Will contain the gutters, if any.\n  d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n  d.lineGutter = null;\n  // Actual scrollable element.\n  d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n  d.scroller.setAttribute(\"tabIndex\", \"-1\");\n  // The element in which the editor lives.\n  d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n  // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n  if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n  if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n  if (place) {\n    if (place.appendChild) { place.appendChild(d.wrapper); }\n    else { place(d.wrapper); }\n  }\n\n  // Current rendered range (may be bigger than the view window).\n  d.viewFrom = d.viewTo = doc.first;\n  d.reportedViewFrom = d.reportedViewTo = doc.first;\n  // Information about the rendered lines.\n  d.view = [];\n  d.renderedView = null;\n  // Holds info about a single rendered line when it was rendered\n  // for measurement, while not in view.\n  d.externalMeasured = null;\n  // Empty space (in pixels) above the view\n  d.viewOffset = 0;\n  d.lastWrapHeight = d.lastWrapWidth = 0;\n  d.updateLineNumbers = null;\n\n  d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n  d.scrollbarsClipped = false;\n\n  // Used to only resize the line number gutter when necessary (when\n  // the amount of lines crosses a boundary that makes its width change)\n  d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n  // Set to true when a non-horizontal-scrolling line widget is\n  // added. As an optimization, line widget aligning is skipped when\n  // this is false.\n  d.alignWidgets = false;\n\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n  // Tracks the maximum line length so that the horizontal scrollbar\n  // can be kept static when scrolling.\n  d.maxLine = null;\n  d.maxLineLength = 0;\n  d.maxLineChanged = false;\n\n  // Used for measuring wheel scrolling granularity\n  d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n  // True when shift is held down.\n  d.shift = false;\n\n  // Used to track whether anything happened since the context menu\n  // was opened.\n  d.selForContextMenu = null;\n\n  d.activeTouch = null;\n\n  input.init(d);\n}\n\n// Find the line object corresponding to the given line number.\nfunction getLine(doc, n) {\n  n -= doc.first;\n  if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n  var chunk = doc;\n  while (!chunk.lines) {\n    for (var i = 0;; ++i) {\n      var child = chunk.children[i], sz = child.chunkSize();\n      if (n < sz) { chunk = child; break }\n      n -= sz;\n    }\n  }\n  return chunk.lines[n]\n}\n\n// Get the part of a document between two positions, as an array of\n// strings.\nfunction getBetween(doc, start, end) {\n  var out = [], n = start.line;\n  doc.iter(start.line, end.line + 1, function (line) {\n    var text = line.text;\n    if (n == end.line) { text = text.slice(0, end.ch); }\n    if (n == start.line) { text = text.slice(start.ch); }\n    out.push(text);\n    ++n;\n  });\n  return out\n}\n// Get the lines between from and to, as array of strings.\nfunction getLines(doc, from, to) {\n  var out = [];\n  doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n  return out\n}\n\n// Update the height of a line, propagating the height change\n// upwards to parent nodes.\nfunction updateLineHeight(line, height) {\n  var diff = height - line.height;\n  if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n}\n\n// Given a line object, find its line number by walking up through\n// its parent links.\nfunction lineNo(line) {\n  if (line.parent == null) { return null }\n  var cur = line.parent, no = indexOf(cur.lines, line);\n  for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n    for (var i = 0;; ++i) {\n      if (chunk.children[i] == cur) { break }\n      no += chunk.children[i].chunkSize();\n    }\n  }\n  return no + cur.first\n}\n\n// Find the line at the given vertical position, using the height\n// information in the document tree.\nfunction lineAtHeight(chunk, h) {\n  var n = chunk.first;\n  outer: do {\n    for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n      var child = chunk.children[i$1], ch = child.height;\n      if (h < ch) { chunk = child; continue outer }\n      h -= ch;\n      n += child.chunkSize();\n    }\n    return n\n  } while (!chunk.lines)\n  var i = 0;\n  for (; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i], lh = line.height;\n    if (h < lh) { break }\n    h -= lh;\n  }\n  return n + i\n}\n\nfunction isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\nfunction lineNumberFor(options, i) {\n  return String(options.lineNumberFormatter(i + options.firstLineNumber))\n}\n\n// A Pos instance represents a position within the text.\nfunction Pos(line, ch, sticky) {\n  if ( sticky === void 0 ) sticky = null;\n\n  if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n  this.line = line;\n  this.ch = ch;\n  this.sticky = sticky;\n}\n\n// Compare two positions, return 0 if they are the same, a negative\n// number when a is less, and a positive number otherwise.\nfunction cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\nfunction equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\nfunction copyPos(x) {return Pos(x.line, x.ch)}\nfunction maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\nfunction minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n// Most of the external API clips given positions to make sure they\n// actually exist within the document.\nfunction clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\nfunction clipPos(doc, pos) {\n  if (pos.line < doc.first) { return Pos(doc.first, 0) }\n  var last = doc.first + doc.size - 1;\n  if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n  return clipToLen(pos, getLine(doc, pos.line).text.length)\n}\nfunction clipToLen(pos, linelen) {\n  var ch = pos.ch;\n  if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n  else if (ch < 0) { return Pos(pos.line, 0) }\n  else { return pos }\n}\nfunction clipPosArray(doc, array) {\n  var out = [];\n  for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n  return out\n}\n\n// Optimize some code when these features are not used.\nvar sawReadOnlySpans = false;\nvar sawCollapsedSpans = false;\n\nfunction seeReadOnlySpans() {\n  sawReadOnlySpans = true;\n}\n\nfunction seeCollapsedSpans() {\n  sawCollapsedSpans = true;\n}\n\n// TEXTMARKER SPANS\n\nfunction MarkedSpan(marker, from, to) {\n  this.marker = marker;\n  this.from = from; this.to = to;\n}\n\n// Search an array of spans for a span matching the given marker.\nfunction getMarkedSpanFor(spans, marker) {\n  if (spans) { for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.marker == marker) { return span }\n  } }\n}\n// Remove a span from an array, returning undefined if no spans are\n// left (we don't store arrays for lines without spans).\nfunction removeMarkedSpan(spans, span) {\n  var r;\n  for (var i = 0; i < spans.length; ++i)\n    { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n  return r\n}\n// Add a span to a line.\nfunction addMarkedSpan(line, span) {\n  line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n  span.marker.attachLine(line);\n}\n\n// Used for the algorithm that adjusts markers for a change in the\n// document. These functions cut an array of spans at a given\n// character position, returning an array of remaining chunks (or\n// undefined if nothing remains).\nfunction markedSpansBefore(old, startCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n    if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n    }\n  } }\n  return nw\n}\nfunction markedSpansAfter(old, endCh, isInsert) {\n  var nw;\n  if (old) { for (var i = 0; i < old.length; ++i) {\n    var span = old[i], marker = span.marker;\n    var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n    if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                            span.to == null ? null : span.to - endCh));\n    }\n  } }\n  return nw\n}\n\n// Given a change object, compute the new set of marker spans that\n// cover the line in which the change took place. Removes spans\n// entirely within the change, reconnects spans belonging to the\n// same marker that appear on both sides of the change, and cuts off\n// spans partially within the change. Returns an array of span\n// arrays with one element for each line in (after) the change.\nfunction stretchSpansOverChange(doc, change) {\n  if (change.full) { return null }\n  var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n  var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n  if (!oldFirst && !oldLast) { return null }\n\n  var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n  // Get the spans that 'stick out' on both sides\n  var first = markedSpansBefore(oldFirst, startCh, isInsert);\n  var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n  // Next, merge those two ends\n  var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n  if (first) {\n    // Fix up .to properties of first\n    for (var i = 0; i < first.length; ++i) {\n      var span = first[i];\n      if (span.to == null) {\n        var found = getMarkedSpanFor(last, span.marker);\n        if (!found) { span.to = startCh; }\n        else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n      }\n    }\n  }\n  if (last) {\n    // Fix up .from in last (or move them into first in case of sameLine)\n    for (var i$1 = 0; i$1 < last.length; ++i$1) {\n      var span$1 = last[i$1];\n      if (span$1.to != null) { span$1.to += offset; }\n      if (span$1.from == null) {\n        var found$1 = getMarkedSpanFor(first, span$1.marker);\n        if (!found$1) {\n          span$1.from = offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      } else {\n        span$1.from += offset;\n        if (sameLine) { (first || (first = [])).push(span$1); }\n      }\n    }\n  }\n  // Make sure we didn't create any zero-length spans\n  if (first) { first = clearEmptySpans(first); }\n  if (last && last != first) { last = clearEmptySpans(last); }\n\n  var newMarkers = [first];\n  if (!sameLine) {\n    // Fill gap with whole-line-spans\n    var gap = change.text.length - 2, gapMarkers;\n    if (gap > 0 && first)\n      { for (var i$2 = 0; i$2 < first.length; ++i$2)\n        { if (first[i$2].to == null)\n          { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n    for (var i$3 = 0; i$3 < gap; ++i$3)\n      { newMarkers.push(gapMarkers); }\n    newMarkers.push(last);\n  }\n  return newMarkers\n}\n\n// Remove spans that are empty and don't have a clearWhenEmpty\n// option of false.\nfunction clearEmptySpans(spans) {\n  for (var i = 0; i < spans.length; ++i) {\n    var span = spans[i];\n    if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n      { spans.splice(i--, 1); }\n  }\n  if (!spans.length) { return null }\n  return spans\n}\n\n// Used to 'clip' out readOnly ranges when making a change.\nfunction removeReadOnlyRanges(doc, from, to) {\n  var markers = null;\n  doc.iter(from.line, to.line + 1, function (line) {\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var mark = line.markedSpans[i].marker;\n      if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n        { (markers || (markers = [])).push(mark); }\n    } }\n  });\n  if (!markers) { return null }\n  var parts = [{from: from, to: to}];\n  for (var i = 0; i < markers.length; ++i) {\n    var mk = markers[i], m = mk.find(0);\n    for (var j = 0; j < parts.length; ++j) {\n      var p = parts[j];\n      if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n      var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n      if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n        { newParts.push({from: p.from, to: m.from}); }\n      if (dto > 0 || !mk.inclusiveRight && !dto)\n        { newParts.push({from: m.to, to: p.to}); }\n      parts.splice.apply(parts, newParts);\n      j += newParts.length - 3;\n    }\n  }\n  return parts\n}\n\n// Connect or disconnect spans from a line.\nfunction detachMarkedSpans(line) {\n  var spans = line.markedSpans;\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.detachLine(line); }\n  line.markedSpans = null;\n}\nfunction attachMarkedSpans(line, spans) {\n  if (!spans) { return }\n  for (var i = 0; i < spans.length; ++i)\n    { spans[i].marker.attachLine(line); }\n  line.markedSpans = spans;\n}\n\n// Helpers used when computing which overlapping collapsed span\n// counts as the larger one.\nfunction extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\nfunction extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n// Returns a number indicating which of two overlapping collapsed\n// spans is larger (and thus includes the other). Falls back to\n// comparing ids when the spans cover exactly the same range.\nfunction compareCollapsedMarkers(a, b) {\n  var lenDiff = a.lines.length - b.lines.length;\n  if (lenDiff != 0) { return lenDiff }\n  var aPos = a.find(), bPos = b.find();\n  var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n  if (fromCmp) { return -fromCmp }\n  var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n  if (toCmp) { return toCmp }\n  return b.id - a.id\n}\n\n// Find out whether a line ends or starts in a collapsed span. If\n// so, return the marker for that span.\nfunction collapsedSpanAtSide(line, start) {\n  var sps = sawCollapsedSpans && line.markedSpans, found;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n        (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n      { found = sp.marker; }\n  } }\n  return found\n}\nfunction collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\nfunction collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n// Test whether there exists a collapsed span that partially\n// overlaps (covers the start or end, but not both) of a new span.\n// Such overlap is not allowed.\nfunction conflictingCollapsedRange(doc, lineNo$$1, from, to, marker) {\n  var line = getLine(doc, lineNo$$1);\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var i = 0; i < sps.length; ++i) {\n    var sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    var found = sp.marker.find(0);\n    var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n    var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n    if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n    if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n        fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n      { return true }\n  } }\n}\n\n// A visual line is a line as drawn on the screen. Folding, for\n// example, can cause multiple logical lines to appear on the same\n// visual line. This finds the start of the visual line that the\n// given line is part of (usually that is the line itself).\nfunction visualLine(line) {\n  var merged;\n  while (merged = collapsedSpanAtStart(line))\n    { line = merged.find(-1, true).line; }\n  return line\n}\n\nfunction visualLineEnd(line) {\n  var merged;\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return line\n}\n\n// Returns an array of logical lines that continue the visual line\n// started by the argument, or undefined if there are no such lines.\nfunction visualLineContinued(line) {\n  var merged, lines;\n  while (merged = collapsedSpanAtEnd(line)) {\n    line = merged.find(1, true).line\n    ;(lines || (lines = [])).push(line);\n  }\n  return lines\n}\n\n// Get the line number of the start of the visual line that the\n// given line number is part of.\nfunction visualLineNo(doc, lineN) {\n  var line = getLine(doc, lineN), vis = visualLine(line);\n  if (line == vis) { return lineN }\n  return lineNo(vis)\n}\n\n// Get the line number of the start of the next visual line after\n// the given line.\nfunction visualLineEndNo(doc, lineN) {\n  if (lineN > doc.lastLine()) { return lineN }\n  var line = getLine(doc, lineN), merged;\n  if (!lineIsHidden(doc, line)) { return lineN }\n  while (merged = collapsedSpanAtEnd(line))\n    { line = merged.find(1, true).line; }\n  return lineNo(line) + 1\n}\n\n// Compute whether a line is hidden. Lines count as hidden when they\n// are part of a visual line that starts with another line, or when\n// they are entirely covered by collapsed, non-widget span.\nfunction lineIsHidden(doc, line) {\n  var sps = sawCollapsedSpans && line.markedSpans;\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n    sp = sps[i];\n    if (!sp.marker.collapsed) { continue }\n    if (sp.from == null) { return true }\n    if (sp.marker.widgetNode) { continue }\n    if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n      { return true }\n  } }\n}\nfunction lineIsHiddenInner(doc, line, span) {\n  if (span.to == null) {\n    var end = span.marker.find(1, true);\n    return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n  }\n  if (span.marker.inclusiveRight && span.to == line.text.length)\n    { return true }\n  for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n    sp = line.markedSpans[i];\n    if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n        (sp.to == null || sp.to != span.from) &&\n        (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n        lineIsHiddenInner(doc, line, sp)) { return true }\n  }\n}\n\n// Find the height above the given line.\nfunction heightAtLine(lineObj) {\n  lineObj = visualLine(lineObj);\n\n  var h = 0, chunk = lineObj.parent;\n  for (var i = 0; i < chunk.lines.length; ++i) {\n    var line = chunk.lines[i];\n    if (line == lineObj) { break }\n    else { h += line.height; }\n  }\n  for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n    for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n      var cur = p.children[i$1];\n      if (cur == chunk) { break }\n      else { h += cur.height; }\n    }\n  }\n  return h\n}\n\n// Compute the character length of a line, taking into account\n// collapsed ranges (see markText) that might hide parts, and join\n// other lines onto it.\nfunction lineLength(line) {\n  if (line.height == 0) { return 0 }\n  var len = line.text.length, merged, cur = line;\n  while (merged = collapsedSpanAtStart(cur)) {\n    var found = merged.find(0, true);\n    cur = found.from.line;\n    len += found.from.ch - found.to.ch;\n  }\n  cur = line;\n  while (merged = collapsedSpanAtEnd(cur)) {\n    var found$1 = merged.find(0, true);\n    len -= cur.text.length - found$1.from.ch;\n    cur = found$1.to.line;\n    len += cur.text.length - found$1.to.ch;\n  }\n  return len\n}\n\n// Find the longest line in the document.\nfunction findMaxLine(cm) {\n  var d = cm.display, doc = cm.doc;\n  d.maxLine = getLine(doc, doc.first);\n  d.maxLineLength = lineLength(d.maxLine);\n  d.maxLineChanged = true;\n  doc.iter(function (line) {\n    var len = lineLength(line);\n    if (len > d.maxLineLength) {\n      d.maxLineLength = len;\n      d.maxLine = line;\n    }\n  });\n}\n\n// BIDI HELPERS\n\nfunction iterateBidiSections(order, from, to, f) {\n  if (!order) { return f(from, to, \"ltr\") }\n  var found = false;\n  for (var i = 0; i < order.length; ++i) {\n    var part = order[i];\n    if (part.from < to && part.to > from || from == to && part.to == from) {\n      f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\");\n      found = true;\n    }\n  }\n  if (!found) { f(from, to, \"ltr\"); }\n}\n\nvar bidiOther = null;\nfunction getBidiPartAt(order, ch, sticky) {\n  var found;\n  bidiOther = null;\n  for (var i = 0; i < order.length; ++i) {\n    var cur = order[i];\n    if (cur.from < ch && cur.to > ch) { return i }\n    if (cur.to == ch) {\n      if (cur.from != cur.to && sticky == \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n    if (cur.from == ch) {\n      if (cur.from != cur.to && sticky != \"before\") { found = i; }\n      else { bidiOther = i; }\n    }\n  }\n  return found != null ? found : bidiOther\n}\n\n// Bidirectional ordering algorithm\n// See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n// that this (partially) implements.\n\n// One-char codes used for character types:\n// L (L):   Left-to-Right\n// R (R):   Right-to-Left\n// r (AL):  Right-to-Left Arabic\n// 1 (EN):  European Number\n// + (ES):  European Number Separator\n// % (ET):  European Number Terminator\n// n (AN):  Arabic Number\n// , (CS):  Common Number Separator\n// m (NSM): Non-Spacing Mark\n// b (BN):  Boundary Neutral\n// s (B):   Paragraph Separator\n// t (S):   Segment Separator\n// w (WS):  Whitespace\n// N (ON):  Other Neutrals\n\n// Returns null if characters are ordered as they appear\n// (left-to-right), or an array of sections ({from, to, level}\n// objects) in the order in which they occur visually.\nvar bidiOrdering = (function() {\n  // Character types for codepoints 0 to 0xff\n  var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n  // Character types for codepoints 0x600 to 0x6f9\n  var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n  function charType(code) {\n    if (code <= 0xf7) { return lowTypes.charAt(code) }\n    else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n    else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n    else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n    else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n    else if (code == 0x200c) { return \"b\" }\n    else { return \"L\" }\n  }\n\n  var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n  var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n  function BidiSpan(level, from, to) {\n    this.level = level;\n    this.from = from; this.to = to;\n  }\n\n  return function(str, direction) {\n    var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n    if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n    var len = str.length, types = [];\n    for (var i = 0; i < len; ++i)\n      { types.push(charType(str.charCodeAt(i))); }\n\n    // W1. Examine each non-spacing mark (NSM) in the level run, and\n    // change the type of the NSM to the type of the previous\n    // character. If the NSM is at the start of the level run, it will\n    // get the type of sor.\n    for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n      var type = types[i$1];\n      if (type == \"m\") { types[i$1] = prev; }\n      else { prev = type; }\n    }\n\n    // W2. Search backwards from each instance of a European number\n    // until the first strong type (R, L, AL, or sor) is found. If an\n    // AL is found, change the type of the European number to Arabic\n    // number.\n    // W3. Change all ALs to R.\n    for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n      var type$1 = types[i$2];\n      if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n      else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n    }\n\n    // W4. A single European separator between two European numbers\n    // changes to a European number. A single common separator between\n    // two numbers of the same type changes to that type.\n    for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n      var type$2 = types[i$3];\n      if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n      else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n               (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n      prev$1 = type$2;\n    }\n\n    // W5. A sequence of European terminators adjacent to European\n    // numbers changes to all European numbers.\n    // W6. Otherwise, separators and terminators change to Other\n    // Neutral.\n    for (var i$4 = 0; i$4 < len; ++i$4) {\n      var type$3 = types[i$4];\n      if (type$3 == \",\") { types[i$4] = \"N\"; }\n      else if (type$3 == \"%\") {\n        var end = (void 0);\n        for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n        var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n        for (var j = i$4; j < end; ++j) { types[j] = replace; }\n        i$4 = end - 1;\n      }\n    }\n\n    // W7. Search backwards from each instance of a European number\n    // until the first strong type (R, L, or sor) is found. If an L is\n    // found, then change the type of the European number to L.\n    for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n      var type$4 = types[i$5];\n      if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n      else if (isStrong.test(type$4)) { cur$1 = type$4; }\n    }\n\n    // N1. A sequence of neutrals takes the direction of the\n    // surrounding strong text if the text on both sides has the same\n    // direction. European and Arabic numbers act as if they were R in\n    // terms of their influence on neutrals. Start-of-level-run (sor)\n    // and end-of-level-run (eor) are used at level run boundaries.\n    // N2. Any remaining neutrals take the embedding direction.\n    for (var i$6 = 0; i$6 < len; ++i$6) {\n      if (isNeutral.test(types[i$6])) {\n        var end$1 = (void 0);\n        for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n        var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n        var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n        var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n        for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n        i$6 = end$1 - 1;\n      }\n    }\n\n    // Here we depart from the documented algorithm, in order to avoid\n    // building up an actual levels array. Since there are only three\n    // levels (0, 1, 2) in an implementation that doesn't take\n    // explicit embedding into account, we can build up the order on\n    // the fly, without following the level-based algorithm.\n    var order = [], m;\n    for (var i$7 = 0; i$7 < len;) {\n      if (countsAsLeft.test(types[i$7])) {\n        var start = i$7;\n        for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n        order.push(new BidiSpan(0, start, i$7));\n      } else {\n        var pos = i$7, at = order.length;\n        for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n        for (var j$2 = pos; j$2 < i$7;) {\n          if (countsAsNum.test(types[j$2])) {\n            if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); }\n            var nstart = j$2;\n            for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n            order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n            pos = j$2;\n          } else { ++j$2; }\n        }\n        if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n      }\n    }\n    if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n      order[0].from = m[0].length;\n      order.unshift(new BidiSpan(0, 0, m[0].length));\n    }\n    if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n      lst(order).to -= m[0].length;\n      order.push(new BidiSpan(0, len - m[0].length, len));\n    }\n\n    return direction == \"rtl\" ? order.reverse() : order\n  }\n})();\n\n// Get the bidi ordering for the given line (and cache it). Returns\n// false for lines that are fully left-to-right, and an array of\n// BidiSpan objects otherwise.\nfunction getOrder(line, direction) {\n  var order = line.order;\n  if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n  return order\n}\n\nfunction moveCharLogically(line, ch, dir) {\n  var target = skipExtendingChars(line.text, ch + dir, dir);\n  return target < 0 || target > line.text.length ? null : target\n}\n\nfunction moveLogically(line, start, dir) {\n  var ch = moveCharLogically(line, start.ch, dir);\n  return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n}\n\nfunction endOfLine(visually, cm, lineObj, lineNo, dir) {\n  if (visually) {\n    var order = getOrder(lineObj, cm.doc.direction);\n    if (order) {\n      var part = dir < 0 ? lst(order) : order[0];\n      var moveInStorageOrder = (dir < 0) == (part.level == 1);\n      var sticky = moveInStorageOrder ? \"after\" : \"before\";\n      var ch;\n      // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n      // it could be that the last bidi part is not on the last visual line,\n      // since visual lines contain content order-consecutive chunks.\n      // Thus, in rtl, we are looking for the first (content-order) character\n      // in the rtl chunk that is on the last line (that is, the same line\n      // as the last (content-order) character).\n      if (part.level > 0) {\n        var prep = prepareMeasureForLine(cm, lineObj);\n        ch = dir < 0 ? lineObj.text.length - 1 : 0;\n        var targetTop = measureCharPrepared(cm, prep, ch).top;\n        ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n        if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n      } else { ch = dir < 0 ? part.to : part.from; }\n      return new Pos(lineNo, ch, sticky)\n    }\n  }\n  return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n}\n\nfunction moveVisually(cm, line, start, dir) {\n  var bidi = getOrder(line, cm.doc.direction);\n  if (!bidi) { return moveLogically(line, start, dir) }\n  if (start.ch >= line.text.length) {\n    start.ch = line.text.length;\n    start.sticky = \"before\";\n  } else if (start.ch <= 0) {\n    start.ch = 0;\n    start.sticky = \"after\";\n  }\n  var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n  if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n    // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n    // nothing interesting happens.\n    return moveLogically(line, start, dir)\n  }\n\n  var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n  var prep;\n  var getWrappedLineExtent = function (ch) {\n    if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n    prep = prep || prepareMeasureForLine(cm, line);\n    return wrappedLineExtentChar(cm, line, prep, ch)\n  };\n  var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n  if (cm.doc.direction == \"rtl\" || part.level == 1) {\n    var moveInStorageOrder = (part.level == 1) == (dir < 0);\n    var ch = mv(start, moveInStorageOrder ? 1 : -1);\n    if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n      // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n      var sticky = moveInStorageOrder ? \"before\" : \"after\";\n      return new Pos(start.line, ch, sticky)\n    }\n  }\n\n  // Case 3: Could not move within this bidi part in this visual line, so leave\n  // the current bidi part\n\n  var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n    var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n      ? new Pos(start.line, mv(ch, 1), \"before\")\n      : new Pos(start.line, ch, \"after\"); };\n\n    for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n      var part = bidi[partPos];\n      var moveInStorageOrder = (dir > 0) == (part.level != 1);\n      var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n      if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n      ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n      if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n    }\n  };\n\n  // Case 3a: Look for other bidi parts on the same visual line\n  var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n  if (res) { return res }\n\n  // Case 3b: Look for other bidi parts on the next visual line\n  var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n  if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n    res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n    if (res) { return res }\n  }\n\n  // Case 4: Nowhere to move\n  return null\n}\n\n// EVENT HANDLING\n\n// Lightweight event framework. on/off also work on DOM nodes,\n// registering native DOM handlers.\n\nvar noHandlers = [];\n\nvar on = function(emitter, type, f) {\n  if (emitter.addEventListener) {\n    emitter.addEventListener(type, f, false);\n  } else if (emitter.attachEvent) {\n    emitter.attachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers || (emitter._handlers = {});\n    map$$1[type] = (map$$1[type] || noHandlers).concat(f);\n  }\n};\n\nfunction getHandlers(emitter, type) {\n  return emitter._handlers && emitter._handlers[type] || noHandlers\n}\n\nfunction off(emitter, type, f) {\n  if (emitter.removeEventListener) {\n    emitter.removeEventListener(type, f, false);\n  } else if (emitter.detachEvent) {\n    emitter.detachEvent(\"on\" + type, f);\n  } else {\n    var map$$1 = emitter._handlers, arr = map$$1 && map$$1[type];\n    if (arr) {\n      var index = indexOf(arr, f);\n      if (index > -1)\n        { map$$1[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n    }\n  }\n}\n\nfunction signal(emitter, type /*, values...*/) {\n  var handlers = getHandlers(emitter, type);\n  if (!handlers.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2);\n  for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n}\n\n// The DOM events that CodeMirror handles can be overridden by\n// registering a (non-DOM) handler on the editor for the event name,\n// and preventDefault-ing the event in that handler.\nfunction signalDOMEvent(cm, e, override) {\n  if (typeof e == \"string\")\n    { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n  signal(cm, override || e.type, cm, e);\n  return e_defaultPrevented(e) || e.codemirrorIgnore\n}\n\nfunction signalCursorActivity(cm) {\n  var arr = cm._handlers && cm._handlers.cursorActivity;\n  if (!arr) { return }\n  var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n  for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n    { set.push(arr[i]); } }\n}\n\nfunction hasHandler(emitter, type) {\n  return getHandlers(emitter, type).length > 0\n}\n\n// Add on and off methods to a constructor's prototype, to make\n// registering events on such objects more convenient.\nfunction eventMixin(ctor) {\n  ctor.prototype.on = function(type, f) {on(this, type, f);};\n  ctor.prototype.off = function(type, f) {off(this, type, f);};\n}\n\n// Due to the fact that we still support jurassic IE versions, some\n// compatibility wrappers are needed.\n\nfunction e_preventDefault(e) {\n  if (e.preventDefault) { e.preventDefault(); }\n  else { e.returnValue = false; }\n}\nfunction e_stopPropagation(e) {\n  if (e.stopPropagation) { e.stopPropagation(); }\n  else { e.cancelBubble = true; }\n}\nfunction e_defaultPrevented(e) {\n  return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n}\nfunction e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\nfunction e_target(e) {return e.target || e.srcElement}\nfunction e_button(e) {\n  var b = e.which;\n  if (b == null) {\n    if (e.button & 1) { b = 1; }\n    else if (e.button & 2) { b = 3; }\n    else if (e.button & 4) { b = 2; }\n  }\n  if (mac && e.ctrlKey && b == 1) { b = 3; }\n  return b\n}\n\n// Detect drag-and-drop\nvar dragAndDrop = function() {\n  // There is *some* kind of drag-and-drop support in IE6-8, but I\n  // couldn't get it to work yet.\n  if (ie && ie_version < 9) { return false }\n  var div = elt('div');\n  return \"draggable\" in div || \"dragDrop\" in div\n}();\n\nvar zwspSupported;\nfunction zeroWidthElement(measure) {\n  if (zwspSupported == null) {\n    var test = elt(\"span\", \"\\u200b\");\n    removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n    if (measure.firstChild.offsetHeight != 0)\n      { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n  }\n  var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n    elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n  node.setAttribute(\"cm-text\", \"\");\n  return node\n}\n\n// Feature-detect IE's crummy client rect reporting for bidi text\nvar badBidiRects;\nfunction hasBadBidiRects(measure) {\n  if (badBidiRects != null) { return badBidiRects }\n  var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n  var r0 = range(txt, 0, 1).getBoundingClientRect();\n  var r1 = range(txt, 1, 2).getBoundingClientRect();\n  removeChildren(measure);\n  if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n  return badBidiRects = (r1.right - r0.right < 3)\n}\n\n// See if \"\".split is the broken IE version, if so, provide an\n// alternative way to split lines.\nvar splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n  var pos = 0, result = [], l = string.length;\n  while (pos <= l) {\n    var nl = string.indexOf(\"\\n\", pos);\n    if (nl == -1) { nl = string.length; }\n    var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n    var rt = line.indexOf(\"\\r\");\n    if (rt != -1) {\n      result.push(line.slice(0, rt));\n      pos += rt + 1;\n    } else {\n      result.push(line);\n      pos = nl + 1;\n    }\n  }\n  return result\n} : function (string) { return string.split(/\\r\\n?|\\n/); };\n\nvar hasSelection = window.getSelection ? function (te) {\n  try { return te.selectionStart != te.selectionEnd }\n  catch(e) { return false }\n} : function (te) {\n  var range$$1;\n  try {range$$1 = te.ownerDocument.selection.createRange();}\n  catch(e) {}\n  if (!range$$1 || range$$1.parentElement() != te) { return false }\n  return range$$1.compareEndPoints(\"StartToEnd\", range$$1) != 0\n};\n\nvar hasCopyEvent = (function () {\n  var e = elt(\"div\");\n  if (\"oncopy\" in e) { return true }\n  e.setAttribute(\"oncopy\", \"return;\");\n  return typeof e.oncopy == \"function\"\n})();\n\nvar badZoomedRects = null;\nfunction hasBadZoomedRects(measure) {\n  if (badZoomedRects != null) { return badZoomedRects }\n  var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n  var normal = node.getBoundingClientRect();\n  var fromRange = range(node, 0, 1).getBoundingClientRect();\n  return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n}\n\n// Known modes, by name and by MIME\nvar modes = {};\nvar mimeModes = {};\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nfunction defineMode(name, mode) {\n  if (arguments.length > 2)\n    { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n  modes[name] = mode;\n}\n\nfunction defineMIME(mime, spec) {\n  mimeModes[mime] = spec;\n}\n\n// Given a MIME type, a {name, ...options} config object, or a name\n// string, return a mode config object.\nfunction resolveMode(spec) {\n  if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n    spec = mimeModes[spec];\n  } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n    var found = mimeModes[spec.name];\n    if (typeof found == \"string\") { found = {name: found}; }\n    spec = createObj(found, spec);\n    spec.name = found.name;\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n    return resolveMode(\"application/xml\")\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n    return resolveMode(\"application/json\")\n  }\n  if (typeof spec == \"string\") { return {name: spec} }\n  else { return spec || {name: \"null\"} }\n}\n\n// Given a mode spec (anything that resolveMode accepts), find and\n// initialize an actual mode object.\nfunction getMode(options, spec) {\n  spec = resolveMode(spec);\n  var mfactory = modes[spec.name];\n  if (!mfactory) { return getMode(options, \"text/plain\") }\n  var modeObj = mfactory(options, spec);\n  if (modeExtensions.hasOwnProperty(spec.name)) {\n    var exts = modeExtensions[spec.name];\n    for (var prop in exts) {\n      if (!exts.hasOwnProperty(prop)) { continue }\n      if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n      modeObj[prop] = exts[prop];\n    }\n  }\n  modeObj.name = spec.name;\n  if (spec.helperType) { modeObj.helperType = spec.helperType; }\n  if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n    { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n  return modeObj\n}\n\n// This can be used to attach properties to mode objects from\n// outside the actual mode definition.\nvar modeExtensions = {};\nfunction extendMode(mode, properties) {\n  var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n  copyObj(properties, exts);\n}\n\nfunction copyState(mode, state) {\n  if (state === true) { return state }\n  if (mode.copyState) { return mode.copyState(state) }\n  var nstate = {};\n  for (var n in state) {\n    var val = state[n];\n    if (val instanceof Array) { val = val.concat([]); }\n    nstate[n] = val;\n  }\n  return nstate\n}\n\n// Given a mode and a state (for that mode), find the inner mode and\n// state at the position that the state refers to.\nfunction innerMode(mode, state) {\n  var info;\n  while (mode.innerMode) {\n    info = mode.innerMode(state);\n    if (!info || info.mode == mode) { break }\n    state = info.state;\n    mode = info.mode;\n  }\n  return info || {mode: mode, state: state}\n}\n\nfunction startState(mode, a1, a2) {\n  return mode.startState ? mode.startState(a1, a2) : true\n}\n\n// STRING STREAM\n\n// Fed to the mode parsers, provides helper functions to make\n// parsers more succinct.\n\nvar StringStream = function(string, tabSize) {\n  this.pos = this.start = 0;\n  this.string = string;\n  this.tabSize = tabSize || 8;\n  this.lastColumnPos = this.lastColumnValue = 0;\n  this.lineStart = 0;\n};\n\nStringStream.prototype.eol = function () {return this.pos >= this.string.length};\nStringStream.prototype.sol = function () {return this.pos == this.lineStart};\nStringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\nStringStream.prototype.next = function () {\n  if (this.pos < this.string.length)\n    { return this.string.charAt(this.pos++) }\n};\nStringStream.prototype.eat = function (match) {\n  var ch = this.string.charAt(this.pos);\n  var ok;\n  if (typeof match == \"string\") { ok = ch == match; }\n  else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n  if (ok) {++this.pos; return ch}\n};\nStringStream.prototype.eatWhile = function (match) {\n  var start = this.pos;\n  while (this.eat(match)){}\n  return this.pos > start\n};\nStringStream.prototype.eatSpace = function () {\n    var this$1 = this;\n\n  var start = this.pos;\n  while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this$1.pos; }\n  return this.pos > start\n};\nStringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\nStringStream.prototype.skipTo = function (ch) {\n  var found = this.string.indexOf(ch, this.pos);\n  if (found > -1) {this.pos = found; return true}\n};\nStringStream.prototype.backUp = function (n) {this.pos -= n;};\nStringStream.prototype.column = function () {\n  if (this.lastColumnPos < this.start) {\n    this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n    this.lastColumnPos = this.start;\n  }\n  return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.indentation = function () {\n  return countColumn(this.string, null, this.tabSize) -\n    (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n};\nStringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n  if (typeof pattern == \"string\") {\n    var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n    var substr = this.string.substr(this.pos, pattern.length);\n    if (cased(substr) == cased(pattern)) {\n      if (consume !== false) { this.pos += pattern.length; }\n      return true\n    }\n  } else {\n    var match = this.string.slice(this.pos).match(pattern);\n    if (match && match.index > 0) { return null }\n    if (match && consume !== false) { this.pos += match[0].length; }\n    return match\n  }\n};\nStringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\nStringStream.prototype.hideFirstChars = function (n, inner) {\n  this.lineStart += n;\n  try { return inner() }\n  finally { this.lineStart -= n; }\n};\n\n// Compute a style array (an array starting with a mode generation\n// -- for invalidation -- followed by pairs of end positions and\n// style strings), which is used to highlight the tokens on the\n// line.\nfunction highlightLine(cm, line, state, forceToEnd) {\n  // A styles array always starts with a number identifying the\n  // mode/overlays that it is based on (for easy invalidation).\n  var st = [cm.state.modeGen], lineClasses = {};\n  // Compute the base array of styles\n  runMode(cm, line.text, cm.doc.mode, state, function (end, style) { return st.push(end, style); },\n    lineClasses, forceToEnd);\n\n  // Run overlays, adjust style array.\n  var loop = function ( o ) {\n    var overlay = cm.state.overlays[o], i = 1, at = 0;\n    runMode(cm, line.text, overlay.mode, true, function (end, style) {\n      var start = i;\n      // Ensure there's a token end at the current position, and that i points at it\n      while (at < end) {\n        var i_end = st[i];\n        if (i_end > end)\n          { st.splice(i, 1, end, st[i+1], i_end); }\n        i += 2;\n        at = Math.min(end, i_end);\n      }\n      if (!style) { return }\n      if (overlay.opaque) {\n        st.splice(start, i - start, end, \"overlay \" + style);\n        i = start + 2;\n      } else {\n        for (; start < i; start += 2) {\n          var cur = st[start+1];\n          st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n        }\n      }\n    }, lineClasses);\n  };\n\n  for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n  return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n}\n\nfunction getLineStyles(cm, line, updateFrontier) {\n  if (!line.styles || line.styles[0] != cm.state.modeGen) {\n    var state = getStateBefore(cm, lineNo(line));\n    var result = highlightLine(cm, line, line.text.length > cm.options.maxHighlightLength ? copyState(cm.doc.mode, state) : state);\n    line.stateAfter = state;\n    line.styles = result.styles;\n    if (result.classes) { line.styleClasses = result.classes; }\n    else if (line.styleClasses) { line.styleClasses = null; }\n    if (updateFrontier === cm.doc.frontier) { cm.doc.frontier++; }\n  }\n  return line.styles\n}\n\nfunction getStateBefore(cm, n, precise) {\n  var doc = cm.doc, display = cm.display;\n  if (!doc.mode.startState) { return true }\n  var pos = findStartLine(cm, n, precise), state = pos > doc.first && getLine(doc, pos-1).stateAfter;\n  if (!state) { state = startState(doc.mode); }\n  else { state = copyState(doc.mode, state); }\n  doc.iter(pos, n, function (line) {\n    processLine(cm, line.text, state);\n    var save = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo;\n    line.stateAfter = save ? copyState(doc.mode, state) : null;\n    ++pos;\n  });\n  if (precise) { doc.frontier = pos; }\n  return state\n}\n\n// Lightweight form of highlight -- proceed over this line and\n// update state, but don't save a style array. Used for lines that\n// aren't currently visible.\nfunction processLine(cm, text, state, startAt) {\n  var mode = cm.doc.mode;\n  var stream = new StringStream(text, cm.options.tabSize);\n  stream.start = stream.pos = startAt || 0;\n  if (text == \"\") { callBlankLine(mode, state); }\n  while (!stream.eol()) {\n    readToken(mode, stream, state);\n    stream.start = stream.pos;\n  }\n}\n\nfunction callBlankLine(mode, state) {\n  if (mode.blankLine) { return mode.blankLine(state) }\n  if (!mode.innerMode) { return }\n  var inner = innerMode(mode, state);\n  if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n}\n\nfunction readToken(mode, stream, state, inner) {\n  for (var i = 0; i < 10; i++) {\n    if (inner) { inner[0] = innerMode(mode, state).mode; }\n    var style = mode.token(stream, state);\n    if (stream.pos > stream.start) { return style }\n  }\n  throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n}\n\n// Utility for getTokenAt and getLineTokens\nfunction takeToken(cm, pos, precise, asArray) {\n  var getObj = function (copy) { return ({\n    start: stream.start, end: stream.pos,\n    string: stream.current(),\n    type: style || null,\n    state: copy ? copyState(doc.mode, state) : state\n  }); };\n\n  var doc = cm.doc, mode = doc.mode, style;\n  pos = clipPos(doc, pos);\n  var line = getLine(doc, pos.line), state = getStateBefore(cm, pos.line, precise);\n  var stream = new StringStream(line.text, cm.options.tabSize), tokens;\n  if (asArray) { tokens = []; }\n  while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n    stream.start = stream.pos;\n    style = readToken(mode, stream, state);\n    if (asArray) { tokens.push(getObj(true)); }\n  }\n  return asArray ? tokens : getObj()\n}\n\nfunction extractLineClasses(type, output) {\n  if (type) { for (;;) {\n    var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n    if (!lineClass) { break }\n    type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n    var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n    if (output[prop] == null)\n      { output[prop] = lineClass[2]; }\n    else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n      { output[prop] += \" \" + lineClass[2]; }\n  } }\n  return type\n}\n\n// Run the given mode's parser over a line, calling f for each token.\nfunction runMode(cm, text, mode, state, f, lineClasses, forceToEnd) {\n  var flattenSpans = mode.flattenSpans;\n  if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n  var curStart = 0, curStyle = null;\n  var stream = new StringStream(text, cm.options.tabSize), style;\n  var inner = cm.options.addModeClass && [null];\n  if (text == \"\") { extractLineClasses(callBlankLine(mode, state), lineClasses); }\n  while (!stream.eol()) {\n    if (stream.pos > cm.options.maxHighlightLength) {\n      flattenSpans = false;\n      if (forceToEnd) { processLine(cm, text, state, stream.pos); }\n      stream.pos = text.length;\n      style = null;\n    } else {\n      style = extractLineClasses(readToken(mode, stream, state, inner), lineClasses);\n    }\n    if (inner) {\n      var mName = inner[0].name;\n      if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n    }\n    if (!flattenSpans || curStyle != style) {\n      while (curStart < stream.start) {\n        curStart = Math.min(stream.start, curStart + 5000);\n        f(curStart, curStyle);\n      }\n      curStyle = style;\n    }\n    stream.start = stream.pos;\n  }\n  while (curStart < stream.pos) {\n    // Webkit seems to refuse to render text nodes longer than 57444\n    // characters, and returns inaccurate measurements in nodes\n    // starting around 5000 chars.\n    var pos = Math.min(stream.pos, curStart + 5000);\n    f(pos, curStyle);\n    curStart = pos;\n  }\n}\n\n// Finds the line to start with when starting a parse. Tries to\n// find a line with a stateAfter, so that it can start with a\n// valid state. If that fails, it returns the line with the\n// smallest indentation, which tends to need the least context to\n// parse correctly.\nfunction findStartLine(cm, n, precise) {\n  var minindent, minline, doc = cm.doc;\n  var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n  for (var search = n; search > lim; --search) {\n    if (search <= doc.first) { return doc.first }\n    var line = getLine(doc, search - 1);\n    if (line.stateAfter && (!precise || search <= doc.frontier)) { return search }\n    var indented = countColumn(line.text, null, cm.options.tabSize);\n    if (minline == null || minindent > indented) {\n      minline = search - 1;\n      minindent = indented;\n    }\n  }\n  return minline\n}\n\n// LINE DATA STRUCTURE\n\n// Line objects. These hold state related to a line, including\n// highlighting info (the styles array).\nvar Line = function(text, markedSpans, estimateHeight) {\n  this.text = text;\n  attachMarkedSpans(this, markedSpans);\n  this.height = estimateHeight ? estimateHeight(this) : 1;\n};\n\nLine.prototype.lineNo = function () { return lineNo(this) };\neventMixin(Line);\n\n// Change the content (text, markers) of a line. Automatically\n// invalidates cached information and tries to re-estimate the\n// line's height.\nfunction updateLine(line, text, markedSpans, estimateHeight) {\n  line.text = text;\n  if (line.stateAfter) { line.stateAfter = null; }\n  if (line.styles) { line.styles = null; }\n  if (line.order != null) { line.order = null; }\n  detachMarkedSpans(line);\n  attachMarkedSpans(line, markedSpans);\n  var estHeight = estimateHeight ? estimateHeight(line) : 1;\n  if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n}\n\n// Detach a line from the document tree and its markers.\nfunction cleanUpLine(line) {\n  line.parent = null;\n  detachMarkedSpans(line);\n}\n\n// Convert a style as returned by a mode (either null, or a string\n// containing one or more styles) to a CSS style. This is cached,\n// and also looks for line-wide styles.\nvar styleToClassCache = {};\nvar styleToClassCacheWithMode = {};\nfunction interpretTokenStyle(style, options) {\n  if (!style || /^\\s*$/.test(style)) { return null }\n  var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n  return cache[style] ||\n    (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n}\n\n// Render the DOM representation of the text of a line. Also builds\n// up a 'line map', which points at the DOM nodes that represent\n// specific stretches of text, and is used by the measuring code.\n// The returned object contains the DOM node, this map, and\n// information about line-wide styles that were set by the mode.\nfunction buildLineContent(cm, lineView) {\n  // The padding-right forces the element to have a 'border', which\n  // is needed on Webkit to be able to get line-level bounding\n  // rectangles for it (in measureChar).\n  var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n  var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                 col: 0, pos: 0, cm: cm,\n                 trailingSpace: false,\n                 splitSpaces: (ie || webkit) && cm.getOption(\"lineWrapping\")};\n  lineView.measure = {};\n\n  // Iterate over the logical lines that make up this visual line.\n  for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n    var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n    builder.pos = 0;\n    builder.addToken = buildToken;\n    // Optionally wire in some hacks into the token-rendering\n    // algorithm, to deal with browser quirks.\n    if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n      { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n    builder.map = [];\n    var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n    insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n    if (line.styleClasses) {\n      if (line.styleClasses.bgClass)\n        { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n      if (line.styleClasses.textClass)\n        { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n    }\n\n    // Ensure at least a single node is present, for measuring.\n    if (builder.map.length == 0)\n      { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n    // Store the map and a cache object for the current logical line\n    if (i == 0) {\n      lineView.measure.map = builder.map;\n      lineView.measure.cache = {};\n    } else {\n      (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n      ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n    }\n  }\n\n  // See issue #2901\n  if (webkit) {\n    var last = builder.content.lastChild;\n    if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n      { builder.content.className = \"cm-tab-wrap-hack\"; }\n  }\n\n  signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n  if (builder.pre.className)\n    { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n  return builder\n}\n\nfunction defaultSpecialCharPlaceholder(ch) {\n  var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n  token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n  token.setAttribute(\"aria-label\", token.title);\n  return token\n}\n\n// Build up the DOM representation for a single token, and add it to\n// the line map. Takes care to render special characters separately.\nfunction buildToken(builder, text, style, startStyle, endStyle, title, css) {\n  if (!text) { return }\n  var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n  var special = builder.cm.state.specialChars, mustWrap = false;\n  var content;\n  if (!special.test(text)) {\n    builder.col += text.length;\n    content = document.createTextNode(displayText);\n    builder.map.push(builder.pos, builder.pos + text.length, content);\n    if (ie && ie_version < 9) { mustWrap = true; }\n    builder.pos += text.length;\n  } else {\n    content = document.createDocumentFragment();\n    var pos = 0;\n    while (true) {\n      special.lastIndex = pos;\n      var m = special.exec(text);\n      var skipped = m ? m.index - pos : text.length - pos;\n      if (skipped) {\n        var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n        else { content.appendChild(txt); }\n        builder.map.push(builder.pos, builder.pos + skipped, txt);\n        builder.col += skipped;\n        builder.pos += skipped;\n      }\n      if (!m) { break }\n      pos += skipped + 1;\n      var txt$1 = (void 0);\n      if (m[0] == \"\\t\") {\n        var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n        txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n        txt$1.setAttribute(\"role\", \"presentation\");\n        txt$1.setAttribute(\"cm-text\", \"\\t\");\n        builder.col += tabWidth;\n      } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n        txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        builder.col += 1;\n      } else {\n        txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n        txt$1.setAttribute(\"cm-text\", m[0]);\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n        else { content.appendChild(txt$1); }\n        builder.col += 1;\n      }\n      builder.map.push(builder.pos, builder.pos + 1, txt$1);\n      builder.pos++;\n    }\n  }\n  builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n  if (style || startStyle || endStyle || mustWrap || css) {\n    var fullStyle = style || \"\";\n    if (startStyle) { fullStyle += startStyle; }\n    if (endStyle) { fullStyle += endStyle; }\n    var token = elt(\"span\", [content], fullStyle, css);\n    if (title) { token.title = title; }\n    return builder.content.appendChild(token)\n  }\n  builder.content.appendChild(content);\n}\n\nfunction splitSpaces(text, trailingBefore) {\n  if (text.length > 1 && !/  /.test(text)) { return text }\n  var spaceBefore = trailingBefore, result = \"\";\n  for (var i = 0; i < text.length; i++) {\n    var ch = text.charAt(i);\n    if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n      { ch = \"\\u00a0\"; }\n    result += ch;\n    spaceBefore = ch == \" \";\n  }\n  return result\n}\n\n// Work around nonsense dimensions being reported for stretches of\n// right-to-left text.\nfunction buildTokenBadBidi(inner, order) {\n  return function (builder, text, style, startStyle, endStyle, title, css) {\n    style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n    var start = builder.pos, end = start + text.length;\n    for (;;) {\n      // Find the part that overlaps with the start of this text\n      var part = (void 0);\n      for (var i = 0; i < order.length; i++) {\n        part = order[i];\n        if (part.to > start && part.from <= start) { break }\n      }\n      if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, title, css) }\n      inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css);\n      startStyle = null;\n      text = text.slice(part.to - start);\n      start = part.to;\n    }\n  }\n}\n\nfunction buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n  var widget = !ignoreWidget && marker.widgetNode;\n  if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n  if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n    if (!widget)\n      { widget = builder.content.appendChild(document.createElement(\"span\")); }\n    widget.setAttribute(\"cm-marker\", marker.id);\n  }\n  if (widget) {\n    builder.cm.display.input.setUneditable(widget);\n    builder.content.appendChild(widget);\n  }\n  builder.pos += size;\n  builder.trailingSpace = false;\n}\n\n// Outputs a number of spans to make up a line, taking highlighting\n// and marked text into account.\nfunction insertLineContent(line, builder, styles) {\n  var spans = line.markedSpans, allText = line.text, at = 0;\n  if (!spans) {\n    for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n      { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n    return\n  }\n\n  var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n  var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed;\n  for (;;) {\n    if (nextChange == pos) { // Update current marker set\n      spanStyle = spanEndStyle = spanStartStyle = title = css = \"\";\n      collapsed = null; nextChange = Infinity;\n      var foundBookmarks = [], endStyles = (void 0);\n      for (var j = 0; j < spans.length; ++j) {\n        var sp = spans[j], m = sp.marker;\n        if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n          foundBookmarks.push(m);\n        } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n          if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n            nextChange = sp.to;\n            spanEndStyle = \"\";\n          }\n          if (m.className) { spanStyle += \" \" + m.className; }\n          if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n          if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n          if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n          if (m.title && !title) { title = m.title; }\n          if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n            { collapsed = sp; }\n        } else if (sp.from > pos && nextChange > sp.from) {\n          nextChange = sp.from;\n        }\n      }\n      if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n        { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n      if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n        { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n      if (collapsed && (collapsed.from || 0) == pos) {\n        buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                           collapsed.marker, collapsed.from == null);\n        if (collapsed.to == null) { return }\n        if (collapsed.to == pos) { collapsed = false; }\n      }\n    }\n    if (pos >= len) { break }\n\n    var upto = Math.min(len, nextChange);\n    while (true) {\n      if (text) {\n        var end = pos + text.length;\n        if (!collapsed) {\n          var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n          builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                           spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css);\n        }\n        if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n        pos = end;\n        spanStartStyle = \"\";\n      }\n      text = allText.slice(at, at = styles[i++]);\n      style = interpretTokenStyle(styles[i++], builder.cm.options);\n    }\n  }\n}\n\n\n// These objects are used to represent the visible (currently drawn)\n// part of the document. A LineView may correspond to multiple\n// logical lines, if those are connected by collapsed ranges.\nfunction LineView(doc, line, lineN) {\n  // The starting line\n  this.line = line;\n  // Continuing lines, if any\n  this.rest = visualLineContinued(line);\n  // Number of logical lines in this visual line\n  this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n  this.node = this.text = null;\n  this.hidden = lineIsHidden(doc, line);\n}\n\n// Create a range of LineView objects for the given lines.\nfunction buildViewArray(cm, from, to) {\n  var array = [], nextPos;\n  for (var pos = from; pos < to; pos = nextPos) {\n    var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n    nextPos = pos + view.size;\n    array.push(view);\n  }\n  return array\n}\n\nvar operationGroup = null;\n\nfunction pushOperation(op) {\n  if (operationGroup) {\n    operationGroup.ops.push(op);\n  } else {\n    op.ownsGroup = operationGroup = {\n      ops: [op],\n      delayedCallbacks: []\n    };\n  }\n}\n\nfunction fireCallbacksForOps(group) {\n  // Calls delayed callbacks and cursorActivity handlers until no\n  // new ones appear\n  var callbacks = group.delayedCallbacks, i = 0;\n  do {\n    for (; i < callbacks.length; i++)\n      { callbacks[i].call(null); }\n    for (var j = 0; j < group.ops.length; j++) {\n      var op = group.ops[j];\n      if (op.cursorActivityHandlers)\n        { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n          { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n    }\n  } while (i < callbacks.length)\n}\n\nfunction finishOperation(op, endCb) {\n  var group = op.ownsGroup;\n  if (!group) { return }\n\n  try { fireCallbacksForOps(group); }\n  finally {\n    operationGroup = null;\n    endCb(group);\n  }\n}\n\nvar orphanDelayedCallbacks = null;\n\n// Often, we want to signal events at a point where we are in the\n// middle of some work, but don't want the handler to start calling\n// other methods on the editor, which might be in an inconsistent\n// state or simply not expect any other events to happen.\n// signalLater looks whether there are any handlers, and schedules\n// them to be executed when the last operation ends, or, if no\n// operation is active, when a timeout fires.\nfunction signalLater(emitter, type /*, values...*/) {\n  var arr = getHandlers(emitter, type);\n  if (!arr.length) { return }\n  var args = Array.prototype.slice.call(arguments, 2), list;\n  if (operationGroup) {\n    list = operationGroup.delayedCallbacks;\n  } else if (orphanDelayedCallbacks) {\n    list = orphanDelayedCallbacks;\n  } else {\n    list = orphanDelayedCallbacks = [];\n    setTimeout(fireOrphanDelayed, 0);\n  }\n  var loop = function ( i ) {\n    list.push(function () { return arr[i].apply(null, args); });\n  };\n\n  for (var i = 0; i < arr.length; ++i)\n    loop( i );\n}\n\nfunction fireOrphanDelayed() {\n  var delayed = orphanDelayedCallbacks;\n  orphanDelayedCallbacks = null;\n  for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n}\n\n// When an aspect of a line changes, a string is added to\n// lineView.changes. This updates the relevant part of the line's\n// DOM structure.\nfunction updateLineForChanges(cm, lineView, lineN, dims) {\n  for (var j = 0; j < lineView.changes.length; j++) {\n    var type = lineView.changes[j];\n    if (type == \"text\") { updateLineText(cm, lineView); }\n    else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n    else if (type == \"class\") { updateLineClasses(cm, lineView); }\n    else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n  }\n  lineView.changes = null;\n}\n\n// Lines with gutter elements, widgets or a background class need to\n// be wrapped, and have the extra elements added to the wrapper div\nfunction ensureLineWrapped(lineView) {\n  if (lineView.node == lineView.text) {\n    lineView.node = elt(\"div\", null, null, \"position: relative\");\n    if (lineView.text.parentNode)\n      { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n    lineView.node.appendChild(lineView.text);\n    if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n  }\n  return lineView.node\n}\n\nfunction updateLineBackground(cm, lineView) {\n  var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n  if (cls) { cls += \" CodeMirror-linebackground\"; }\n  if (lineView.background) {\n    if (cls) { lineView.background.className = cls; }\n    else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n  } else if (cls) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n    cm.display.input.setUneditable(lineView.background);\n  }\n}\n\n// Wrapper around buildLineContent which will reuse the structure\n// in display.externalMeasured when possible.\nfunction getLineContent(cm, lineView) {\n  var ext = cm.display.externalMeasured;\n  if (ext && ext.line == lineView.line) {\n    cm.display.externalMeasured = null;\n    lineView.measure = ext.measure;\n    return ext.built\n  }\n  return buildLineContent(cm, lineView)\n}\n\n// Redraw the line's text. Interacts with the background and text\n// classes because the mode may output tokens that influence these\n// classes.\nfunction updateLineText(cm, lineView) {\n  var cls = lineView.text.className;\n  var built = getLineContent(cm, lineView);\n  if (lineView.text == lineView.node) { lineView.node = built.pre; }\n  lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n  lineView.text = built.pre;\n  if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n    lineView.bgClass = built.bgClass;\n    lineView.textClass = built.textClass;\n    updateLineClasses(cm, lineView);\n  } else if (cls) {\n    lineView.text.className = cls;\n  }\n}\n\nfunction updateLineClasses(cm, lineView) {\n  updateLineBackground(cm, lineView);\n  if (lineView.line.wrapClass)\n    { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n  else if (lineView.node != lineView.text)\n    { lineView.node.className = \"\"; }\n  var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n  lineView.text.className = textClass || \"\";\n}\n\nfunction updateLineGutter(cm, lineView, lineN, dims) {\n  if (lineView.gutter) {\n    lineView.node.removeChild(lineView.gutter);\n    lineView.gutter = null;\n  }\n  if (lineView.gutterBackground) {\n    lineView.node.removeChild(lineView.gutterBackground);\n    lineView.gutterBackground = null;\n  }\n  if (lineView.line.gutterClass) {\n    var wrap = ensureLineWrapped(lineView);\n    lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                    (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(lineView.gutterBackground);\n    wrap.insertBefore(lineView.gutterBackground, lineView.text);\n  }\n  var markers = lineView.line.gutterMarkers;\n  if (cm.options.lineNumbers || markers) {\n    var wrap$1 = ensureLineWrapped(lineView);\n    var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n    cm.display.input.setUneditable(gutterWrap);\n    wrap$1.insertBefore(gutterWrap, lineView.text);\n    if (lineView.line.gutterClass)\n      { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n    if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n      { lineView.lineNumber = gutterWrap.appendChild(\n        elt(\"div\", lineNumberFor(cm.options, lineN),\n            \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n            (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n    if (markers) { for (var k = 0; k < cm.options.gutters.length; ++k) {\n      var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n      if (found)\n        { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                   (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n    } }\n  }\n}\n\nfunction updateLineWidgets(cm, lineView, dims) {\n  if (lineView.alignable) { lineView.alignable = null; }\n  for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n    next = node.nextSibling;\n    if (node.className == \"CodeMirror-linewidget\")\n      { lineView.node.removeChild(node); }\n  }\n  insertLineWidgets(cm, lineView, dims);\n}\n\n// Build a line's DOM representation from scratch\nfunction buildLineElement(cm, lineView, lineN, dims) {\n  var built = getLineContent(cm, lineView);\n  lineView.text = lineView.node = built.pre;\n  if (built.bgClass) { lineView.bgClass = built.bgClass; }\n  if (built.textClass) { lineView.textClass = built.textClass; }\n\n  updateLineClasses(cm, lineView);\n  updateLineGutter(cm, lineView, lineN, dims);\n  insertLineWidgets(cm, lineView, dims);\n  return lineView.node\n}\n\n// A lineView may contain multiple logical lines (when merged by\n// collapsed spans). The widgets for all of them need to be drawn.\nfunction insertLineWidgets(cm, lineView, dims) {\n  insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n  if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n    { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n}\n\nfunction insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n  if (!line.widgets) { return }\n  var wrap = ensureLineWrapped(lineView);\n  for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n    var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n    if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n    positionLineWidget(widget, node, lineView, dims);\n    cm.display.input.setUneditable(node);\n    if (allowAbove && widget.above)\n      { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n    else\n      { wrap.appendChild(node); }\n    signalLater(widget, \"redraw\");\n  }\n}\n\nfunction positionLineWidget(widget, node, lineView, dims) {\n  if (widget.noHScroll) {\n    (lineView.alignable || (lineView.alignable = [])).push(node);\n    var width = dims.wrapperWidth;\n    node.style.left = dims.fixedPos + \"px\";\n    if (!widget.coverGutter) {\n      width -= dims.gutterTotalWidth;\n      node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n    }\n    node.style.width = width + \"px\";\n  }\n  if (widget.coverGutter) {\n    node.style.zIndex = 5;\n    node.style.position = \"relative\";\n    if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n  }\n}\n\nfunction widgetHeight(widget) {\n  if (widget.height != null) { return widget.height }\n  var cm = widget.doc.cm;\n  if (!cm) { return 0 }\n  if (!contains(document.body, widget.node)) {\n    var parentStyle = \"position: relative;\";\n    if (widget.coverGutter)\n      { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n    if (widget.noHScroll)\n      { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n    removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n  }\n  return widget.height = widget.node.parentNode.offsetHeight\n}\n\n// Return true when the given mouse event happened in a widget\nfunction eventInWidget(display, e) {\n  for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n    if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n        (n.parentNode == display.sizer && n != display.mover))\n      { return true }\n  }\n}\n\n// POSITION MEASUREMENT\n\nfunction paddingTop(display) {return display.lineSpace.offsetTop}\nfunction paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\nfunction paddingH(display) {\n  if (display.cachedPaddingH) { return display.cachedPaddingH }\n  var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n  var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n  var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n  if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n  return data\n}\n\nfunction scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\nfunction displayWidth(cm) {\n  return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n}\nfunction displayHeight(cm) {\n  return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n}\n\n// Ensure the lineView.wrapping.heights array is populated. This is\n// an array of bottom offsets for the lines that make up a drawn\n// line. When lineWrapping is on, there might be more than one\n// height.\nfunction ensureLineHeights(cm, lineView, rect) {\n  var wrapping = cm.options.lineWrapping;\n  var curWidth = wrapping && displayWidth(cm);\n  if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n    var heights = lineView.measure.heights = [];\n    if (wrapping) {\n      lineView.measure.width = curWidth;\n      var rects = lineView.text.firstChild.getClientRects();\n      for (var i = 0; i < rects.length - 1; i++) {\n        var cur = rects[i], next = rects[i + 1];\n        if (Math.abs(cur.bottom - next.bottom) > 2)\n          { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n      }\n    }\n    heights.push(rect.bottom - rect.top);\n  }\n}\n\n// Find a line map (mapping character offsets to text nodes) and a\n// measurement cache for the given line number. (A line view might\n// contain multiple lines when collapsed ranges are present.)\nfunction mapFromLineView(lineView, line, lineN) {\n  if (lineView.line == line)\n    { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n  for (var i = 0; i < lineView.rest.length; i++)\n    { if (lineView.rest[i] == line)\n      { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n  for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n    { if (lineNo(lineView.rest[i$1]) > lineN)\n      { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n}\n\n// Render a line into the hidden node display.externalMeasured. Used\n// when measurement is needed for a line that's not in the viewport.\nfunction updateExternalMeasurement(cm, line) {\n  line = visualLine(line);\n  var lineN = lineNo(line);\n  var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n  view.lineN = lineN;\n  var built = view.built = buildLineContent(cm, view);\n  view.text = built.pre;\n  removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n  return view\n}\n\n// Get a {top, bottom, left, right} box (in line-local coordinates)\n// for a given character.\nfunction measureChar(cm, line, ch, bias) {\n  return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n}\n\n// Find a line view that corresponds to the given line number.\nfunction findViewForLine(cm, lineN) {\n  if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n    { return cm.display.view[findViewIndex(cm, lineN)] }\n  var ext = cm.display.externalMeasured;\n  if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n    { return ext }\n}\n\n// Measurement can be split in two steps, the set-up work that\n// applies to the whole line, and the measurement of the actual\n// character. Functions like coordsChar, that need to do a lot of\n// measurements in a row, can thus ensure that the set-up work is\n// only done once.\nfunction prepareMeasureForLine(cm, line) {\n  var lineN = lineNo(line);\n  var view = findViewForLine(cm, lineN);\n  if (view && !view.text) {\n    view = null;\n  } else if (view && view.changes) {\n    updateLineForChanges(cm, view, lineN, getDimensions(cm));\n    cm.curOp.forceUpdate = true;\n  }\n  if (!view)\n    { view = updateExternalMeasurement(cm, line); }\n\n  var info = mapFromLineView(view, line, lineN);\n  return {\n    line: line, view: view, rect: null,\n    map: info.map, cache: info.cache, before: info.before,\n    hasHeights: false\n  }\n}\n\n// Given a prepared measurement object, measures the position of an\n// actual character (or fetches it from the cache).\nfunction measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n  if (prepared.before) { ch = -1; }\n  var key = ch + (bias || \"\"), found;\n  if (prepared.cache.hasOwnProperty(key)) {\n    found = prepared.cache[key];\n  } else {\n    if (!prepared.rect)\n      { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n    if (!prepared.hasHeights) {\n      ensureLineHeights(cm, prepared.view, prepared.rect);\n      prepared.hasHeights = true;\n    }\n    found = measureCharInner(cm, prepared, ch, bias);\n    if (!found.bogus) { prepared.cache[key] = found; }\n  }\n  return {left: found.left, right: found.right,\n          top: varHeight ? found.rtop : found.top,\n          bottom: varHeight ? found.rbottom : found.bottom}\n}\n\nvar nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\nfunction nodeAndOffsetInLineMap(map$$1, ch, bias) {\n  var node, start, end, collapse, mStart, mEnd;\n  // First, search the line map for the text node corresponding to,\n  // or closest to, the target character.\n  for (var i = 0; i < map$$1.length; i += 3) {\n    mStart = map$$1[i];\n    mEnd = map$$1[i + 1];\n    if (ch < mStart) {\n      start = 0; end = 1;\n      collapse = \"left\";\n    } else if (ch < mEnd) {\n      start = ch - mStart;\n      end = start + 1;\n    } else if (i == map$$1.length - 3 || ch == mEnd && map$$1[i + 3] > ch) {\n      end = mEnd - mStart;\n      start = end - 1;\n      if (ch >= mEnd) { collapse = \"right\"; }\n    }\n    if (start != null) {\n      node = map$$1[i + 2];\n      if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n        { collapse = bias; }\n      if (bias == \"left\" && start == 0)\n        { while (i && map$$1[i - 2] == map$$1[i - 3] && map$$1[i - 1].insertLeft) {\n          node = map$$1[(i -= 3) + 2];\n          collapse = \"left\";\n        } }\n      if (bias == \"right\" && start == mEnd - mStart)\n        { while (i < map$$1.length - 3 && map$$1[i + 3] == map$$1[i + 4] && !map$$1[i + 5].insertLeft) {\n          node = map$$1[(i += 3) + 2];\n          collapse = \"right\";\n        } }\n      break\n    }\n  }\n  return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n}\n\nfunction getUsefulRect(rects, bias) {\n  var rect = nullRect;\n  if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n    if ((rect = rects[i]).left != rect.right) { break }\n  } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n    if ((rect = rects[i$1]).left != rect.right) { break }\n  } }\n  return rect\n}\n\nfunction measureCharInner(cm, prepared, ch, bias) {\n  var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n  var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n  var rect;\n  if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n    for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n      while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n      while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n      if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n        { rect = node.parentNode.getBoundingClientRect(); }\n      else\n        { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n      if (rect.left || rect.right || start == 0) { break }\n      end = start;\n      start = start - 1;\n      collapse = \"right\";\n    }\n    if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n  } else { // If it is a widget, simply get the box for the whole widget.\n    if (start > 0) { collapse = bias = \"right\"; }\n    var rects;\n    if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n      { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n    else\n      { rect = node.getBoundingClientRect(); }\n  }\n  if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n    var rSpan = node.parentNode.getClientRects()[0];\n    if (rSpan)\n      { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n    else\n      { rect = nullRect; }\n  }\n\n  var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n  var mid = (rtop + rbot) / 2;\n  var heights = prepared.view.measure.heights;\n  var i = 0;\n  for (; i < heights.length - 1; i++)\n    { if (mid < heights[i]) { break } }\n  var top = i ? heights[i - 1] : 0, bot = heights[i];\n  var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                top: top, bottom: bot};\n  if (!rect.left && !rect.right) { result.bogus = true; }\n  if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n  return result\n}\n\n// Work around problem with bounding client rects on ranges being\n// returned incorrectly when zoomed on IE10 and below.\nfunction maybeUpdateRectForZooming(measure, rect) {\n  if (!window.screen || screen.logicalXDPI == null ||\n      screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n    { return rect }\n  var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n  var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n  return {left: rect.left * scaleX, right: rect.right * scaleX,\n          top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n}\n\nfunction clearLineMeasurementCacheFor(lineView) {\n  if (lineView.measure) {\n    lineView.measure.cache = {};\n    lineView.measure.heights = null;\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { lineView.measure.caches[i] = {}; } }\n  }\n}\n\nfunction clearLineMeasurementCache(cm) {\n  cm.display.externalMeasure = null;\n  removeChildren(cm.display.lineMeasure);\n  for (var i = 0; i < cm.display.view.length; i++)\n    { clearLineMeasurementCacheFor(cm.display.view[i]); }\n}\n\nfunction clearCaches(cm) {\n  clearLineMeasurementCache(cm);\n  cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n  if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n  cm.display.lineNumChars = null;\n}\n\nfunction pageScrollX() {\n  // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n  // which causes page_Offset and bounding client rects to use\n  // different reference viewports and invalidate our calculations.\n  if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n  return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n}\nfunction pageScrollY() {\n  if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n  return window.pageYOffset || (document.documentElement || document.body).scrollTop\n}\n\n// Converts a {top, bottom, left, right} box from line-local\n// coordinates into another coordinate system. Context may be one of\n// \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n// or \"page\".\nfunction intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n  if (!includeWidgets && lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above) {\n    var size = widgetHeight(lineObj.widgets[i]);\n    rect.top += size; rect.bottom += size;\n  } } }\n  if (context == \"line\") { return rect }\n  if (!context) { context = \"local\"; }\n  var yOff = heightAtLine(lineObj);\n  if (context == \"local\") { yOff += paddingTop(cm.display); }\n  else { yOff -= cm.display.viewOffset; }\n  if (context == \"page\" || context == \"window\") {\n    var lOff = cm.display.lineSpace.getBoundingClientRect();\n    yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n    var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n    rect.left += xOff; rect.right += xOff;\n  }\n  rect.top += yOff; rect.bottom += yOff;\n  return rect\n}\n\n// Coverts a box from \"div\" coords to another coordinate system.\n// Context may be \"window\", \"page\", \"div\", or \"local\"./null.\nfunction fromCoordSystem(cm, coords, context) {\n  if (context == \"div\") { return coords }\n  var left = coords.left, top = coords.top;\n  // First move into \"page\" coordinate system\n  if (context == \"page\") {\n    left -= pageScrollX();\n    top -= pageScrollY();\n  } else if (context == \"local\" || !context) {\n    var localBox = cm.display.sizer.getBoundingClientRect();\n    left += localBox.left;\n    top += localBox.top;\n  }\n\n  var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n  return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n}\n\nfunction charCoords(cm, pos, context, lineObj, bias) {\n  if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n  return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n}\n\n// Returns a box for a given cursor position, which may have an\n// 'other' property containing the position of the secondary cursor\n// on a bidi boundary.\n// A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n// and after `char - 1` in writing order of `char - 1`\n// A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n// and before `char` in writing order of `char`\n// Examples (upper-case letters are RTL, lower-case are LTR):\n//     Pos(0, 1, ...)\n//     before   after\n// ab     a|b     a|b\n// aB     a|B     aB|\n// Ab     |Ab     A|b\n// AB     B|A     B|A\n// Every position after the last character on a line is considered to stick\n// to the last character on the line.\nfunction cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n  lineObj = lineObj || getLine(cm.doc, pos.line);\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n  function get(ch, right) {\n    var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n    if (right) { m.left = m.right; } else { m.right = m.left; }\n    return intoCoordSystem(cm, lineObj, m, context)\n  }\n  var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n  if (ch >= lineObj.text.length) {\n    ch = lineObj.text.length;\n    sticky = \"before\";\n  } else if (ch <= 0) {\n    ch = 0;\n    sticky = \"after\";\n  }\n  if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n  function getBidi(ch, partPos, invert) {\n    var part = order[partPos], right = (part.level % 2) != 0;\n    return get(invert ? ch - 1 : ch, right != invert)\n  }\n  var partPos = getBidiPartAt(order, ch, sticky);\n  var other = bidiOther;\n  var val = getBidi(ch, partPos, sticky == \"before\");\n  if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n  return val\n}\n\n// Used to cheaply estimate the coordinates for a position. Used for\n// intermediate scroll updates.\nfunction estimateCoords(cm, pos) {\n  var left = 0;\n  pos = clipPos(cm.doc, pos);\n  if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n  var lineObj = getLine(cm.doc, pos.line);\n  var top = heightAtLine(lineObj) + paddingTop(cm.display);\n  return {left: left, right: left, top: top, bottom: top + lineObj.height}\n}\n\n// Positions returned by coordsChar contain some extra information.\n// xRel is the relative x position of the input coordinates compared\n// to the found position (so xRel > 0 means the coordinates are to\n// the right of the character position, for example). When outside\n// is true, that means the coordinates lie outside the line's\n// vertical range.\nfunction PosWithInfo(line, ch, sticky, outside, xRel) {\n  var pos = Pos(line, ch, sticky);\n  pos.xRel = xRel;\n  if (outside) { pos.outside = true; }\n  return pos\n}\n\n// Compute the character position closest to the given coordinates.\n// Input must be lineSpace-local (\"div\" coordinate system).\nfunction coordsChar(cm, x, y) {\n  var doc = cm.doc;\n  y += cm.display.viewOffset;\n  if (y < 0) { return PosWithInfo(doc.first, 0, null, true, -1) }\n  var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n  if (lineN > last)\n    { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1) }\n  if (x < 0) { x = 0; }\n\n  var lineObj = getLine(doc, lineN);\n  for (;;) {\n    var found = coordsCharInner(cm, lineObj, lineN, x, y);\n    var merged = collapsedSpanAtEnd(lineObj);\n    var mergedPos = merged && merged.find(0, true);\n    if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))\n      { lineN = lineNo(lineObj = mergedPos.to.line); }\n    else\n      { return found }\n  }\n}\n\nfunction wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n  var measure = function (ch) { return intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, ch), \"line\"); };\n  var end = lineObj.text.length;\n  var begin = findFirst(function (ch) { return measure(ch - 1).bottom <= y; }, end, 0);\n  end = findFirst(function (ch) { return measure(ch).top > y; }, begin, end);\n  return {begin: begin, end: end}\n}\n\nfunction wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n  var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n  return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n}\n\nfunction coordsCharInner(cm, lineObj, lineNo$$1, x, y) {\n  y -= heightAtLine(lineObj);\n  var begin = 0, end = lineObj.text.length;\n  var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n  var pos;\n  var order = getOrder(lineObj, cm.doc.direction);\n  if (order) {\n    if (cm.options.lineWrapping) {\n      var assign;\n      ((assign = wrappedLineExtent(cm, lineObj, preparedMeasure, y), begin = assign.begin, end = assign.end, assign));\n    }\n    pos = new Pos(lineNo$$1, begin);\n    var beginLeft = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure).left;\n    var dir = beginLeft < x ? 1 : -1;\n    var prevDiff, diff = beginLeft - x, prevPos;\n    do {\n      prevDiff = diff;\n      prevPos = pos;\n      pos = moveVisually(cm, lineObj, pos, dir);\n      if (pos == null || pos.ch < begin || end <= (pos.sticky == \"before\" ? pos.ch - 1 : pos.ch)) {\n        pos = prevPos;\n        break\n      }\n      diff = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure).left - x;\n    } while ((dir < 0) != (diff < 0) && (Math.abs(diff) <= Math.abs(prevDiff)))\n    if (Math.abs(diff) > Math.abs(prevDiff)) {\n      if ((diff < 0) == (prevDiff < 0)) { throw new Error(\"Broke out of infinite loop in coordsCharInner\") }\n      pos = prevPos;\n    }\n  } else {\n    var ch = findFirst(function (ch) {\n      var box = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, ch), \"line\");\n      if (box.top > y) {\n        // For the cursor stickiness\n        end = Math.min(ch, end);\n        return true\n      }\n      else if (box.bottom <= y) { return false }\n      else if (box.left > x) { return true }\n      else if (box.right < x) { return false }\n      else { return (x - box.left < box.right - x) }\n    }, begin, end);\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    pos = new Pos(lineNo$$1, ch, ch == end ? \"before\" : \"after\");\n  }\n  var coords = cursorCoords(cm, pos, \"line\", lineObj, preparedMeasure);\n  if (y < coords.top || coords.bottom < y) { pos.outside = true; }\n  pos.xRel = x < coords.left ? -1 : (x > coords.right ? 1 : 0);\n  return pos\n}\n\nvar measureText;\n// Compute the default text height.\nfunction textHeight(display) {\n  if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n  if (measureText == null) {\n    measureText = elt(\"pre\");\n    // Measure a bunch of lines, for browsers that compute\n    // fractional heights.\n    for (var i = 0; i < 49; ++i) {\n      measureText.appendChild(document.createTextNode(\"x\"));\n      measureText.appendChild(elt(\"br\"));\n    }\n    measureText.appendChild(document.createTextNode(\"x\"));\n  }\n  removeChildrenAndAdd(display.measure, measureText);\n  var height = measureText.offsetHeight / 50;\n  if (height > 3) { display.cachedTextHeight = height; }\n  removeChildren(display.measure);\n  return height || 1\n}\n\n// Compute the default character width.\nfunction charWidth(display) {\n  if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n  var anchor = elt(\"span\", \"xxxxxxxxxx\");\n  var pre = elt(\"pre\", [anchor]);\n  removeChildrenAndAdd(display.measure, pre);\n  var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n  if (width > 2) { display.cachedCharWidth = width; }\n  return width || 10\n}\n\n// Do a bulk-read of the DOM positions and sizes needed to draw the\n// view, so that we don't interleave reading and writing to the DOM.\nfunction getDimensions(cm) {\n  var d = cm.display, left = {}, width = {};\n  var gutterLeft = d.gutters.clientLeft;\n  for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n    left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n    width[cm.options.gutters[i]] = n.clientWidth;\n  }\n  return {fixedPos: compensateForHScroll(d),\n          gutterTotalWidth: d.gutters.offsetWidth,\n          gutterLeft: left,\n          gutterWidth: width,\n          wrapperWidth: d.wrapper.clientWidth}\n}\n\n// Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n// but using getBoundingClientRect to get a sub-pixel-accurate\n// result.\nfunction compensateForHScroll(display) {\n  return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n}\n\n// Returns a function that estimates the height of a line, to use as\n// first approximation until the line becomes visible (and is thus\n// properly measurable).\nfunction estimateHeight(cm) {\n  var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n  var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n  return function (line) {\n    if (lineIsHidden(cm.doc, line)) { return 0 }\n\n    var widgetsHeight = 0;\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n      if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n    } }\n\n    if (wrapping)\n      { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n    else\n      { return widgetsHeight + th }\n  }\n}\n\nfunction estimateLineHeights(cm) {\n  var doc = cm.doc, est = estimateHeight(cm);\n  doc.iter(function (line) {\n    var estHeight = est(line);\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  });\n}\n\n// Given a mouse event, find the corresponding position. If liberal\n// is false, it checks whether a gutter or scrollbar was clicked,\n// and returns null if it was. forRect is used by rectangular\n// selections, and tries to estimate a character position even for\n// coordinates beyond the right of the text.\nfunction posFromMouse(cm, e, liberal, forRect) {\n  var display = cm.display;\n  if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n  var x, y, space = display.lineSpace.getBoundingClientRect();\n  // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n  try { x = e.clientX - space.left; y = e.clientY - space.top; }\n  catch (e) { return null }\n  var coords = coordsChar(cm, x, y), line;\n  if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n    var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n    coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n  }\n  return coords\n}\n\n// Find the view element corresponding to a given line. Return null\n// when the line isn't visible.\nfunction findViewIndex(cm, n) {\n  if (n >= cm.display.viewTo) { return null }\n  n -= cm.display.viewFrom;\n  if (n < 0) { return null }\n  var view = cm.display.view;\n  for (var i = 0; i < view.length; i++) {\n    n -= view[i].size;\n    if (n < 0) { return i }\n  }\n}\n\nfunction updateSelection(cm) {\n  cm.display.input.showSelection(cm.display.input.prepareSelection());\n}\n\nfunction prepareSelection(cm, primary) {\n  var doc = cm.doc, result = {};\n  var curFragment = result.cursors = document.createDocumentFragment();\n  var selFragment = result.selection = document.createDocumentFragment();\n\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    if (primary === false && i == doc.sel.primIndex) { continue }\n    var range$$1 = doc.sel.ranges[i];\n    if (range$$1.from().line >= cm.display.viewTo || range$$1.to().line < cm.display.viewFrom) { continue }\n    var collapsed = range$$1.empty();\n    if (collapsed || cm.options.showCursorWhenSelecting)\n      { drawSelectionCursor(cm, range$$1.head, curFragment); }\n    if (!collapsed)\n      { drawSelectionRange(cm, range$$1, selFragment); }\n  }\n  return result\n}\n\n// Draws a cursor for the given range\nfunction drawSelectionCursor(cm, head, output) {\n  var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n  var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n  cursor.style.left = pos.left + \"px\";\n  cursor.style.top = pos.top + \"px\";\n  cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n  if (pos.other) {\n    // Secondary cursor, shown when on a 'jump' in bi-directional text\n    var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n    otherCursor.style.display = \"\";\n    otherCursor.style.left = pos.other.left + \"px\";\n    otherCursor.style.top = pos.other.top + \"px\";\n    otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n  }\n}\n\n// Draws the given range as a highlighted selection\nfunction drawSelectionRange(cm, range$$1, output) {\n  var display = cm.display, doc = cm.doc;\n  var fragment = document.createDocumentFragment();\n  var padding = paddingH(cm.display), leftSide = padding.left;\n  var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n\n  function add(left, top, width, bottom) {\n    if (top < 0) { top = 0; }\n    top = Math.round(top);\n    bottom = Math.round(bottom);\n    fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n  }\n\n  function drawForLine(line, fromArg, toArg) {\n    var lineObj = getLine(doc, line);\n    var lineLen = lineObj.text.length;\n    var start, end;\n    function coords(ch, bias) {\n      return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n    }\n\n    iterateBidiSections(getOrder(lineObj, doc.direction), fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir) {\n      var leftPos = coords(from, \"left\"), rightPos, left, right;\n      if (from == to) {\n        rightPos = leftPos;\n        left = right = leftPos.left;\n      } else {\n        rightPos = coords(to - 1, \"right\");\n        if (dir == \"rtl\") { var tmp = leftPos; leftPos = rightPos; rightPos = tmp; }\n        left = leftPos.left;\n        right = rightPos.right;\n      }\n      if (fromArg == null && from == 0) { left = leftSide; }\n      if (rightPos.top - leftPos.top > 3) { // Different lines, draw top part\n        add(left, leftPos.top, null, leftPos.bottom);\n        left = leftSide;\n        if (leftPos.bottom < rightPos.top) { add(left, leftPos.bottom, null, rightPos.top); }\n      }\n      if (toArg == null && to == lineLen) { right = rightSide; }\n      if (!start || leftPos.top < start.top || leftPos.top == start.top && leftPos.left < start.left)\n        { start = leftPos; }\n      if (!end || rightPos.bottom > end.bottom || rightPos.bottom == end.bottom && rightPos.right > end.right)\n        { end = rightPos; }\n      if (left < leftSide + 1) { left = leftSide; }\n      add(left, rightPos.top, right - left, rightPos.bottom);\n    });\n    return {start: start, end: end}\n  }\n\n  var sFrom = range$$1.from(), sTo = range$$1.to();\n  if (sFrom.line == sTo.line) {\n    drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n  } else {\n    var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n    var singleVLine = visualLine(fromLine) == visualLine(toLine);\n    var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n    var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n    if (singleVLine) {\n      if (leftEnd.top < rightStart.top - 2) {\n        add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n        add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n      } else {\n        add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n      }\n    }\n    if (leftEnd.bottom < rightStart.top)\n      { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n  }\n\n  output.appendChild(fragment);\n}\n\n// Cursor-blinking\nfunction restartBlink(cm) {\n  if (!cm.state.focused) { return }\n  var display = cm.display;\n  clearInterval(display.blinker);\n  var on = true;\n  display.cursorDiv.style.visibility = \"\";\n  if (cm.options.cursorBlinkRate > 0)\n    { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n      cm.options.cursorBlinkRate); }\n  else if (cm.options.cursorBlinkRate < 0)\n    { display.cursorDiv.style.visibility = \"hidden\"; }\n}\n\nfunction ensureFocus(cm) {\n  if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n}\n\nfunction delayBlurEvent(cm) {\n  cm.state.delayingBlurEvent = true;\n  setTimeout(function () { if (cm.state.delayingBlurEvent) {\n    cm.state.delayingBlurEvent = false;\n    onBlur(cm);\n  } }, 100);\n}\n\nfunction onFocus(cm, e) {\n  if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n  if (cm.options.readOnly == \"nocursor\") { return }\n  if (!cm.state.focused) {\n    signal(cm, \"focus\", cm, e);\n    cm.state.focused = true;\n    addClass(cm.display.wrapper, \"CodeMirror-focused\");\n    // This test prevents this from firing when a context\n    // menu is closed (since the input reset would kill the\n    // select-all detection hack)\n    if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n      cm.display.input.reset();\n      if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n    }\n    cm.display.input.receivedFocus();\n  }\n  restartBlink(cm);\n}\nfunction onBlur(cm, e) {\n  if (cm.state.delayingBlurEvent) { return }\n\n  if (cm.state.focused) {\n    signal(cm, \"blur\", cm, e);\n    cm.state.focused = false;\n    rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n  }\n  clearInterval(cm.display.blinker);\n  setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n}\n\n// Read the actual heights of the rendered lines, and update their\n// stored heights to match.\nfunction updateHeightsInViewport(cm) {\n  var display = cm.display;\n  var prevBottom = display.lineDiv.offsetTop;\n  for (var i = 0; i < display.view.length; i++) {\n    var cur = display.view[i], height = (void 0);\n    if (cur.hidden) { continue }\n    if (ie && ie_version < 8) {\n      var bot = cur.node.offsetTop + cur.node.offsetHeight;\n      height = bot - prevBottom;\n      prevBottom = bot;\n    } else {\n      var box = cur.node.getBoundingClientRect();\n      height = box.bottom - box.top;\n    }\n    var diff = cur.line.height - height;\n    if (height < 2) { height = textHeight(display); }\n    if (diff > .001 || diff < -.001) {\n      updateLineHeight(cur.line, height);\n      updateWidgetHeight(cur.line);\n      if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n        { updateWidgetHeight(cur.rest[j]); } }\n    }\n  }\n}\n\n// Read and store the height of line widgets associated with the\n// given line.\nfunction updateWidgetHeight(line) {\n  if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i)\n    { line.widgets[i].height = line.widgets[i].node.parentNode.offsetHeight; } }\n}\n\n// Compute the lines that are visible in a given viewport (defaults\n// the the current scroll position). viewport may contain top,\n// height, and ensure (see op.scrollToPos) properties.\nfunction visibleLines(display, doc, viewport) {\n  var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n  top = Math.floor(top - paddingTop(display));\n  var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n  var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n  // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n  // forces those lines into the viewport (if possible).\n  if (viewport && viewport.ensure) {\n    var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n    if (ensureFrom < from) {\n      from = ensureFrom;\n      to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n    } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n      from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n      to = ensureTo;\n    }\n  }\n  return {from: from, to: Math.max(to, from + 1)}\n}\n\n// Re-align line numbers and gutter marks to compensate for\n// horizontal scrolling.\nfunction alignHorizontally(cm) {\n  var display = cm.display, view = display.view;\n  if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n  var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n  var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n  for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n    if (cm.options.fixedGutter) {\n      if (view[i].gutter)\n        { view[i].gutter.style.left = left; }\n      if (view[i].gutterBackground)\n        { view[i].gutterBackground.style.left = left; }\n    }\n    var align = view[i].alignable;\n    if (align) { for (var j = 0; j < align.length; j++)\n      { align[j].style.left = left; } }\n  } }\n  if (cm.options.fixedGutter)\n    { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n}\n\n// Used to ensure that the line number gutter is still the right\n// size for the current document size. Returns true when an update\n// is needed.\nfunction maybeUpdateLineNumberWidth(cm) {\n  if (!cm.options.lineNumbers) { return false }\n  var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n  if (last.length != display.lineNumChars) {\n    var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                               \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n    var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n    display.lineGutter.style.width = \"\";\n    display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n    display.lineNumWidth = display.lineNumInnerWidth + padding;\n    display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n    display.lineGutter.style.width = display.lineNumWidth + \"px\";\n    updateGutterSpace(cm);\n    return true\n  }\n  return false\n}\n\n// SCROLLING THINGS INTO VIEW\n\n// If an editor sits on the top or bottom of the window, partially\n// scrolled out of view, this ensures that the cursor is visible.\nfunction maybeScrollWindow(cm, rect) {\n  if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n  var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n  if (rect.top + box.top < 0) { doScroll = true; }\n  else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n  if (doScroll != null && !phantom) {\n    var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n    cm.display.lineSpace.appendChild(scrollNode);\n    scrollNode.scrollIntoView(doScroll);\n    cm.display.lineSpace.removeChild(scrollNode);\n  }\n}\n\n// Scroll a given position into view (immediately), verifying that\n// it actually became visible (as line heights are accurately\n// measured, the position of something may 'drift' during drawing).\nfunction scrollPosIntoView(cm, pos, end, margin) {\n  if (margin == null) { margin = 0; }\n  var rect;\n  for (var limit = 0; limit < 5; limit++) {\n    var changed = false;\n    var coords = cursorCoords(cm, pos);\n    var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n    rect = {left: Math.min(coords.left, endCoords.left),\n            top: Math.min(coords.top, endCoords.top) - margin,\n            right: Math.max(coords.left, endCoords.left),\n            bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n    var scrollPos = calculateScrollPos(cm, rect);\n    var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n    if (scrollPos.scrollTop != null) {\n      updateScrollTop(cm, scrollPos.scrollTop);\n      if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n    }\n    if (scrollPos.scrollLeft != null) {\n      setScrollLeft(cm, scrollPos.scrollLeft);\n      if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n    }\n    if (!changed) { break }\n  }\n  return rect\n}\n\n// Scroll a given set of coordinates into view (immediately).\nfunction scrollIntoView(cm, rect) {\n  var scrollPos = calculateScrollPos(cm, rect);\n  if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n  if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n}\n\n// Calculate a new scroll position needed to scroll the given\n// rectangle into view. Returns an object with scrollTop and\n// scrollLeft properties. When these are undefined, the\n// vertical/horizontal position does not need to be adjusted.\nfunction calculateScrollPos(cm, rect) {\n  var display = cm.display, snapMargin = textHeight(cm.display);\n  if (rect.top < 0) { rect.top = 0; }\n  var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n  var screen = displayHeight(cm), result = {};\n  if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n  var docBottom = cm.doc.height + paddingVert(display);\n  var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n  if (rect.top < screentop) {\n    result.scrollTop = atTop ? 0 : rect.top;\n  } else if (rect.bottom > screentop + screen) {\n    var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n    if (newTop != screentop) { result.scrollTop = newTop; }\n  }\n\n  var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n  var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n  var tooWide = rect.right - rect.left > screenw;\n  if (tooWide) { rect.right = rect.left + screenw; }\n  if (rect.left < 10)\n    { result.scrollLeft = 0; }\n  else if (rect.left < screenleft)\n    { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n  else if (rect.right > screenw + screenleft - 3)\n    { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n  return result\n}\n\n// Store a relative adjustment to the scroll position in the current\n// operation (to be applied when the operation finishes).\nfunction addToScrollTop(cm, top) {\n  if (top == null) { return }\n  resolveScrollToPos(cm);\n  cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n}\n\n// Make sure that at the end of the operation the current cursor is\n// shown.\nfunction ensureCursorVisible(cm) {\n  resolveScrollToPos(cm);\n  var cur = cm.getCursor(), from = cur, to = cur;\n  if (!cm.options.lineWrapping) {\n    from = cur.ch ? Pos(cur.line, cur.ch - 1) : cur;\n    to = Pos(cur.line, cur.ch + 1);\n  }\n  cm.curOp.scrollToPos = {from: from, to: to, margin: cm.options.cursorScrollMargin};\n}\n\nfunction scrollToCoords(cm, x, y) {\n  if (x != null || y != null) { resolveScrollToPos(cm); }\n  if (x != null) { cm.curOp.scrollLeft = x; }\n  if (y != null) { cm.curOp.scrollTop = y; }\n}\n\nfunction scrollToRange(cm, range$$1) {\n  resolveScrollToPos(cm);\n  cm.curOp.scrollToPos = range$$1;\n}\n\n// When an operation has its scrollToPos property set, and another\n// scroll action is applied before the end of the operation, this\n// 'simulates' scrolling that position into view in a cheap way, so\n// that the effect of intermediate scroll commands is not ignored.\nfunction resolveScrollToPos(cm) {\n  var range$$1 = cm.curOp.scrollToPos;\n  if (range$$1) {\n    cm.curOp.scrollToPos = null;\n    var from = estimateCoords(cm, range$$1.from), to = estimateCoords(cm, range$$1.to);\n    scrollToCoordsRange(cm, from, to, range$$1.margin);\n  }\n}\n\nfunction scrollToCoordsRange(cm, from, to, margin) {\n  var sPos = calculateScrollPos(cm, {\n    left: Math.min(from.left, to.left),\n    top: Math.min(from.top, to.top) - margin,\n    right: Math.max(from.right, to.right),\n    bottom: Math.max(from.bottom, to.bottom) + margin\n  });\n  scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n}\n\n// Sync the scrollable area and scrollbars, ensure the viewport\n// covers the visible area.\nfunction updateScrollTop(cm, val) {\n  if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n  if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n  setScrollTop(cm, val, true);\n  if (gecko) { updateDisplaySimple(cm); }\n  startWorker(cm, 100);\n}\n\nfunction setScrollTop(cm, val, forceScroll) {\n  val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val);\n  if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n  cm.doc.scrollTop = val;\n  cm.display.scrollbars.setScrollTop(val);\n  if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n}\n\n// Sync scroller and scrollbar, ensure the gutter elements are\n// aligned.\nfunction setScrollLeft(cm, val, isScroller, forceScroll) {\n  val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n  if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n  cm.doc.scrollLeft = val;\n  alignHorizontally(cm);\n  if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n  cm.display.scrollbars.setScrollLeft(val);\n}\n\n// SCROLLBARS\n\n// Prepare DOM reads needed to update the scrollbars. Done in one\n// shot to minimize update/measure roundtrips.\nfunction measureForScrollbars(cm) {\n  var d = cm.display, gutterW = d.gutters.offsetWidth;\n  var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n  return {\n    clientHeight: d.scroller.clientHeight,\n    viewHeight: d.wrapper.clientHeight,\n    scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n    viewWidth: d.wrapper.clientWidth,\n    barLeft: cm.options.fixedGutter ? gutterW : 0,\n    docHeight: docH,\n    scrollHeight: docH + scrollGap(cm) + d.barHeight,\n    nativeBarWidth: d.nativeBarWidth,\n    gutterWidth: gutterW\n  }\n}\n\nvar NativeScrollbars = function(place, scroll, cm) {\n  this.cm = cm;\n  var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n  var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n  place(vert); place(horiz);\n\n  on(vert, \"scroll\", function () {\n    if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n  });\n  on(horiz, \"scroll\", function () {\n    if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n  });\n\n  this.checkedZeroWidth = false;\n  // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n  if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n};\n\nNativeScrollbars.prototype.update = function (measure) {\n  var needsH = measure.scrollWidth > measure.clientWidth + 1;\n  var needsV = measure.scrollHeight > measure.clientHeight + 1;\n  var sWidth = measure.nativeBarWidth;\n\n  if (needsV) {\n    this.vert.style.display = \"block\";\n    this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n    var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n    // A bug in IE8 can cause this value to be negative, so guard it.\n    this.vert.firstChild.style.height =\n      Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n  } else {\n    this.vert.style.display = \"\";\n    this.vert.firstChild.style.height = \"0\";\n  }\n\n  if (needsH) {\n    this.horiz.style.display = \"block\";\n    this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n    this.horiz.style.left = measure.barLeft + \"px\";\n    var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n    this.horiz.firstChild.style.width =\n      Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n  } else {\n    this.horiz.style.display = \"\";\n    this.horiz.firstChild.style.width = \"0\";\n  }\n\n  if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n    if (sWidth == 0) { this.zeroWidthHack(); }\n    this.checkedZeroWidth = true;\n  }\n\n  return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n};\n\nNativeScrollbars.prototype.setScrollLeft = function (pos) {\n  if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n  if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n};\n\nNativeScrollbars.prototype.setScrollTop = function (pos) {\n  if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n  if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n};\n\nNativeScrollbars.prototype.zeroWidthHack = function () {\n  var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n  this.horiz.style.height = this.vert.style.width = w;\n  this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n  this.disableHoriz = new Delayed;\n  this.disableVert = new Delayed;\n};\n\nNativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n  bar.style.pointerEvents = \"auto\";\n  function maybeDisable() {\n    // To find out whether the scrollbar is still visible, we\n    // check whether the element under the pixel in the bottom\n    // right corner of the scrollbar box is the scrollbar box\n    // itself (when the bar is still visible) or its filler child\n    // (when the bar is hidden). If it is still visible, we keep\n    // it enabled, if it's hidden, we disable pointer events.\n    var box = bar.getBoundingClientRect();\n    var elt$$1 = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n        : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n    if (elt$$1 != bar) { bar.style.pointerEvents = \"none\"; }\n    else { delay.set(1000, maybeDisable); }\n  }\n  delay.set(1000, maybeDisable);\n};\n\nNativeScrollbars.prototype.clear = function () {\n  var parent = this.horiz.parentNode;\n  parent.removeChild(this.horiz);\n  parent.removeChild(this.vert);\n};\n\nvar NullScrollbars = function () {};\n\nNullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\nNullScrollbars.prototype.setScrollLeft = function () {};\nNullScrollbars.prototype.setScrollTop = function () {};\nNullScrollbars.prototype.clear = function () {};\n\nfunction updateScrollbars(cm, measure) {\n  if (!measure) { measure = measureForScrollbars(cm); }\n  var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n  updateScrollbarsInner(cm, measure);\n  for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n    if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n      { updateHeightsInViewport(cm); }\n    updateScrollbarsInner(cm, measureForScrollbars(cm));\n    startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n  }\n}\n\n// Re-synchronize the fake scrollbars with the actual size of the\n// content.\nfunction updateScrollbarsInner(cm, measure) {\n  var d = cm.display;\n  var sizes = d.scrollbars.update(measure);\n\n  d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n  d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n  d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n  if (sizes.right && sizes.bottom) {\n    d.scrollbarFiller.style.display = \"block\";\n    d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n    d.scrollbarFiller.style.width = sizes.right + \"px\";\n  } else { d.scrollbarFiller.style.display = \"\"; }\n  if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n    d.gutterFiller.style.display = \"block\";\n    d.gutterFiller.style.height = sizes.bottom + \"px\";\n    d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n  } else { d.gutterFiller.style.display = \"\"; }\n}\n\nvar scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\nfunction initScrollbars(cm) {\n  if (cm.display.scrollbars) {\n    cm.display.scrollbars.clear();\n    if (cm.display.scrollbars.addClass)\n      { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n    cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n    // Prevent clicks in the scrollbars from killing focus\n    on(node, \"mousedown\", function () {\n      if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n    });\n    node.setAttribute(\"cm-not-content\", \"true\");\n  }, function (pos, axis) {\n    if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n    else { updateScrollTop(cm, pos); }\n  }, cm);\n  if (cm.display.scrollbars.addClass)\n    { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n}\n\n// Operations are used to wrap a series of changes to the editor\n// state in such a way that each change won't have to update the\n// cursor and display (which would be awkward, slow, and\n// error-prone). Instead, display updates are batched and then all\n// combined and executed at once.\n\nvar nextOpId = 0;\n// Start a new operation.\nfunction startOperation(cm) {\n  cm.curOp = {\n    cm: cm,\n    viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n    startHeight: cm.doc.height, // Used to detect need to update scrollbar\n    forceUpdate: false,      // Used to force a redraw\n    updateInput: null,       // Whether to reset the input textarea\n    typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n    changeObjs: null,        // Accumulated changes, for firing change events\n    cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n    cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n    selectionChanged: false, // Whether the selection needs to be redrawn\n    updateMaxLine: false,    // Set when the widest line needs to be determined anew\n    scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n    scrollToPos: null,       // Used to scroll to a specific position\n    focus: false,\n    id: ++nextOpId           // Unique ID\n  };\n  pushOperation(cm.curOp);\n}\n\n// Finish an operation, updating the display and signalling delayed events\nfunction endOperation(cm) {\n  var op = cm.curOp;\n  finishOperation(op, function (group) {\n    for (var i = 0; i < group.ops.length; i++)\n      { group.ops[i].cm.curOp = null; }\n    endOperations(group);\n  });\n}\n\n// The DOM updates done when an operation finishes are batched so\n// that the minimum number of relayouts are required.\nfunction endOperations(group) {\n  var ops = group.ops;\n  for (var i = 0; i < ops.length; i++) // Read DOM\n    { endOperation_R1(ops[i]); }\n  for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n    { endOperation_W1(ops[i$1]); }\n  for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n    { endOperation_R2(ops[i$2]); }\n  for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n    { endOperation_W2(ops[i$3]); }\n  for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n    { endOperation_finish(ops[i$4]); }\n}\n\nfunction endOperation_R1(op) {\n  var cm = op.cm, display = cm.display;\n  maybeClipScrollbars(cm);\n  if (op.updateMaxLine) { findMaxLine(cm); }\n\n  op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n    op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                       op.scrollToPos.to.line >= display.viewTo) ||\n    display.maxLineChanged && cm.options.lineWrapping;\n  op.update = op.mustUpdate &&\n    new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n}\n\nfunction endOperation_W1(op) {\n  op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n}\n\nfunction endOperation_R2(op) {\n  var cm = op.cm, display = cm.display;\n  if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n  op.barMeasure = measureForScrollbars(cm);\n\n  // If the max line changed since it was last measured, measure it,\n  // and ensure the document's width matches it.\n  // updateDisplay_W2 will use these properties to do the actual resizing\n  if (display.maxLineChanged && !cm.options.lineWrapping) {\n    op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n    cm.display.sizerWidth = op.adjustWidthTo;\n    op.barMeasure.scrollWidth =\n      Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n    op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n  }\n\n  if (op.updatedDisplay || op.selectionChanged)\n    { op.preparedSelection = display.input.prepareSelection(op.focus); }\n}\n\nfunction endOperation_W2(op) {\n  var cm = op.cm;\n\n  if (op.adjustWidthTo != null) {\n    cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n    if (op.maxScrollLeft < cm.doc.scrollLeft)\n      { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n    cm.display.maxLineChanged = false;\n  }\n\n  var takeFocus = op.focus && op.focus == activeElt() && (!document.hasFocus || document.hasFocus());\n  if (op.preparedSelection)\n    { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n  if (op.updatedDisplay || op.startHeight != cm.doc.height)\n    { updateScrollbars(cm, op.barMeasure); }\n  if (op.updatedDisplay)\n    { setDocumentHeight(cm, op.barMeasure); }\n\n  if (op.selectionChanged) { restartBlink(cm); }\n\n  if (cm.state.focused && op.updateInput)\n    { cm.display.input.reset(op.typing); }\n  if (takeFocus) { ensureFocus(op.cm); }\n}\n\nfunction endOperation_finish(op) {\n  var cm = op.cm, display = cm.display, doc = cm.doc;\n\n  if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n  // Abort mouse wheel delta measurement, when scrolling explicitly\n  if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n    { display.wheelStartX = display.wheelStartY = null; }\n\n  // Propagate the scroll position to the actual DOM scroller\n  if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n  if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n  // If we need to scroll a specific position into view, do so.\n  if (op.scrollToPos) {\n    var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                 clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n    maybeScrollWindow(cm, rect);\n  }\n\n  // Fire events for markers that are hidden/unidden by editing or\n  // undoing\n  var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n  if (hidden) { for (var i = 0; i < hidden.length; ++i)\n    { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n  if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n    { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n  if (display.wrapper.offsetHeight)\n    { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n  // Fire change events, and delayed event handlers\n  if (op.changeObjs)\n    { signal(cm, \"changes\", cm, op.changeObjs); }\n  if (op.update)\n    { op.update.finish(); }\n}\n\n// Run the given function in an operation\nfunction runInOp(cm, f) {\n  if (cm.curOp) { return f() }\n  startOperation(cm);\n  try { return f() }\n  finally { endOperation(cm); }\n}\n// Wraps a function in an operation. Returns the wrapped function.\nfunction operation(cm, f) {\n  return function() {\n    if (cm.curOp) { return f.apply(cm, arguments) }\n    startOperation(cm);\n    try { return f.apply(cm, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n// Used to add methods to editor and doc instances, wrapping them in\n// operations.\nfunction methodOp(f) {\n  return function() {\n    if (this.curOp) { return f.apply(this, arguments) }\n    startOperation(this);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(this); }\n  }\n}\nfunction docMethodOp(f) {\n  return function() {\n    var cm = this.cm;\n    if (!cm || cm.curOp) { return f.apply(this, arguments) }\n    startOperation(cm);\n    try { return f.apply(this, arguments) }\n    finally { endOperation(cm); }\n  }\n}\n\n// Updates the display.view data structure for a given change to the\n// document. From and to are in pre-change coordinates. Lendiff is\n// the amount of lines added or subtracted by the change. This is\n// used for changes that span multiple lines, or change the way\n// lines are divided into visual lines. regLineChange (below)\n// registers single-line changes.\nfunction regChange(cm, from, to, lendiff) {\n  if (from == null) { from = cm.doc.first; }\n  if (to == null) { to = cm.doc.first + cm.doc.size; }\n  if (!lendiff) { lendiff = 0; }\n\n  var display = cm.display;\n  if (lendiff && to < display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers > from))\n    { display.updateLineNumbers = from; }\n\n  cm.curOp.viewChanged = true;\n\n  if (from >= display.viewTo) { // Change after\n    if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n      { resetView(cm); }\n  } else if (to <= display.viewFrom) { // Change before\n    if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n      resetView(cm);\n    } else {\n      display.viewFrom += lendiff;\n      display.viewTo += lendiff;\n    }\n  } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n    resetView(cm);\n  } else if (from <= display.viewFrom) { // Top overlap\n    var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cut) {\n      display.view = display.view.slice(cut.index);\n      display.viewFrom = cut.lineN;\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  } else if (to >= display.viewTo) { // Bottom overlap\n    var cut$1 = viewCuttingPoint(cm, from, from, -1);\n    if (cut$1) {\n      display.view = display.view.slice(0, cut$1.index);\n      display.viewTo = cut$1.lineN;\n    } else {\n      resetView(cm);\n    }\n  } else { // Gap in the middle\n    var cutTop = viewCuttingPoint(cm, from, from, -1);\n    var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n    if (cutTop && cutBot) {\n      display.view = display.view.slice(0, cutTop.index)\n        .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n        .concat(display.view.slice(cutBot.index));\n      display.viewTo += lendiff;\n    } else {\n      resetView(cm);\n    }\n  }\n\n  var ext = display.externalMeasured;\n  if (ext) {\n    if (to < ext.lineN)\n      { ext.lineN += lendiff; }\n    else if (from < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n  }\n}\n\n// Register a change to a single line. Type must be one of \"text\",\n// \"gutter\", \"class\", \"widget\"\nfunction regLineChange(cm, line, type) {\n  cm.curOp.viewChanged = true;\n  var display = cm.display, ext = cm.display.externalMeasured;\n  if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n    { display.externalMeasured = null; }\n\n  if (line < display.viewFrom || line >= display.viewTo) { return }\n  var lineView = display.view[findViewIndex(cm, line)];\n  if (lineView.node == null) { return }\n  var arr = lineView.changes || (lineView.changes = []);\n  if (indexOf(arr, type) == -1) { arr.push(type); }\n}\n\n// Clear the view.\nfunction resetView(cm) {\n  cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n  cm.display.view = [];\n  cm.display.viewOffset = 0;\n}\n\nfunction viewCuttingPoint(cm, oldN, newN, dir) {\n  var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n  if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n    { return {index: index, lineN: newN} }\n  var n = cm.display.viewFrom;\n  for (var i = 0; i < index; i++)\n    { n += view[i].size; }\n  if (n != oldN) {\n    if (dir > 0) {\n      if (index == view.length - 1) { return null }\n      diff = (n + view[index].size) - oldN;\n      index++;\n    } else {\n      diff = n - oldN;\n    }\n    oldN += diff; newN += diff;\n  }\n  while (visualLineNo(cm.doc, newN) != newN) {\n    if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n    newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n    index += dir;\n  }\n  return {index: index, lineN: newN}\n}\n\n// Force the view to cover a given range, adding empty view element\n// or clipping off existing ones as needed.\nfunction adjustView(cm, from, to) {\n  var display = cm.display, view = display.view;\n  if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n    display.view = buildViewArray(cm, from, to);\n    display.viewFrom = from;\n  } else {\n    if (display.viewFrom > from)\n      { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n    else if (display.viewFrom < from)\n      { display.view = display.view.slice(findViewIndex(cm, from)); }\n    display.viewFrom = from;\n    if (display.viewTo < to)\n      { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n    else if (display.viewTo > to)\n      { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n  }\n  display.viewTo = to;\n}\n\n// Count the number of lines in the view whose DOM representation is\n// out of date (or nonexistent).\nfunction countDirtyView(cm) {\n  var view = cm.display.view, dirty = 0;\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n  }\n  return dirty\n}\n\n// HIGHLIGHT WORKER\n\nfunction startWorker(cm, time) {\n  if (cm.doc.mode.startState && cm.doc.frontier < cm.display.viewTo)\n    { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n}\n\nfunction highlightWorker(cm) {\n  var doc = cm.doc;\n  if (doc.frontier < doc.first) { doc.frontier = doc.first; }\n  if (doc.frontier >= cm.display.viewTo) { return }\n  var end = +new Date + cm.options.workTime;\n  var state = copyState(doc.mode, getStateBefore(cm, doc.frontier));\n  var changedLines = [];\n\n  doc.iter(doc.frontier, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n    if (doc.frontier >= cm.display.viewFrom) { // Visible\n      var oldStyles = line.styles, tooLong = line.text.length > cm.options.maxHighlightLength;\n      var highlighted = highlightLine(cm, line, tooLong ? copyState(doc.mode, state) : state, true);\n      line.styles = highlighted.styles;\n      var oldCls = line.styleClasses, newCls = highlighted.classes;\n      if (newCls) { line.styleClasses = newCls; }\n      else if (oldCls) { line.styleClasses = null; }\n      var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n        oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n      for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n      if (ischange) { changedLines.push(doc.frontier); }\n      line.stateAfter = tooLong ? state : copyState(doc.mode, state);\n    } else {\n      if (line.text.length <= cm.options.maxHighlightLength)\n        { processLine(cm, line.text, state); }\n      line.stateAfter = doc.frontier % 5 == 0 ? copyState(doc.mode, state) : null;\n    }\n    ++doc.frontier;\n    if (+new Date > end) {\n      startWorker(cm, cm.options.workDelay);\n      return true\n    }\n  });\n  if (changedLines.length) { runInOp(cm, function () {\n    for (var i = 0; i < changedLines.length; i++)\n      { regLineChange(cm, changedLines[i], \"text\"); }\n  }); }\n}\n\n// DISPLAY DRAWING\n\nvar DisplayUpdate = function(cm, viewport, force) {\n  var display = cm.display;\n\n  this.viewport = viewport;\n  // Store some values that we'll need later (but don't want to force a relayout for)\n  this.visible = visibleLines(display, cm.doc, viewport);\n  this.editorIsHidden = !display.wrapper.offsetWidth;\n  this.wrapperHeight = display.wrapper.clientHeight;\n  this.wrapperWidth = display.wrapper.clientWidth;\n  this.oldDisplayWidth = displayWidth(cm);\n  this.force = force;\n  this.dims = getDimensions(cm);\n  this.events = [];\n};\n\nDisplayUpdate.prototype.signal = function (emitter, type) {\n  if (hasHandler(emitter, type))\n    { this.events.push(arguments); }\n};\nDisplayUpdate.prototype.finish = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.events.length; i++)\n    { signal.apply(null, this$1.events[i]); }\n};\n\nfunction maybeClipScrollbars(cm) {\n  var display = cm.display;\n  if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n    display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n    display.heightForcer.style.height = scrollGap(cm) + \"px\";\n    display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n    display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n    display.scrollbarsClipped = true;\n  }\n}\n\nfunction selectionSnapshot(cm) {\n  if (cm.hasFocus()) { return null }\n  var active = activeElt();\n  if (!active || !contains(cm.display.lineDiv, active)) { return null }\n  var result = {activeElt: active};\n  if (window.getSelection) {\n    var sel = window.getSelection();\n    if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n      result.anchorNode = sel.anchorNode;\n      result.anchorOffset = sel.anchorOffset;\n      result.focusNode = sel.focusNode;\n      result.focusOffset = sel.focusOffset;\n    }\n  }\n  return result\n}\n\nfunction restoreSelection(snapshot) {\n  if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n  snapshot.activeElt.focus();\n  if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n    var sel = window.getSelection(), range$$1 = document.createRange();\n    range$$1.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n    range$$1.collapse(false);\n    sel.removeAllRanges();\n    sel.addRange(range$$1);\n    sel.extend(snapshot.focusNode, snapshot.focusOffset);\n  }\n}\n\n// Does the actual updating of the line display. Bails out\n// (returning false) when there is nothing to be done and forced is\n// false.\nfunction updateDisplayIfNeeded(cm, update) {\n  var display = cm.display, doc = cm.doc;\n\n  if (update.editorIsHidden) {\n    resetView(cm);\n    return false\n  }\n\n  // Bail out if the visible area is already rendered and nothing changed.\n  if (!update.force &&\n      update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n      display.renderedView == display.view && countDirtyView(cm) == 0)\n    { return false }\n\n  if (maybeUpdateLineNumberWidth(cm)) {\n    resetView(cm);\n    update.dims = getDimensions(cm);\n  }\n\n  // Compute a suitable new viewport (from & to)\n  var end = doc.first + doc.size;\n  var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n  var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n  if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n  if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n  if (sawCollapsedSpans) {\n    from = visualLineNo(cm.doc, from);\n    to = visualLineEndNo(cm.doc, to);\n  }\n\n  var different = from != display.viewFrom || to != display.viewTo ||\n    display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n  adjustView(cm, from, to);\n\n  display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n  // Position the mover div to align with the current scroll position\n  cm.display.mover.style.top = display.viewOffset + \"px\";\n\n  var toUpdate = countDirtyView(cm);\n  if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n    { return false }\n\n  // For big changes, we hide the enclosing element during the\n  // update, since that speeds up the operations on most browsers.\n  var selSnapshot = selectionSnapshot(cm);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n  patchDisplay(cm, display.updateLineNumbers, update.dims);\n  if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n  display.renderedView = display.view;\n  // There might have been a widget with a focused element that got\n  // hidden or updated, if so re-focus it.\n  restoreSelection(selSnapshot);\n\n  // Prevent selection and cursors from interfering with the scroll\n  // width and height.\n  removeChildren(display.cursorDiv);\n  removeChildren(display.selectionDiv);\n  display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n  if (different) {\n    display.lastWrapHeight = update.wrapperHeight;\n    display.lastWrapWidth = update.wrapperWidth;\n    startWorker(cm, 400);\n  }\n\n  display.updateLineNumbers = null;\n\n  return true\n}\n\nfunction postUpdateDisplay(cm, update) {\n  var viewport = update.viewport;\n\n  for (var first = true;; first = false) {\n    if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n      // Clip forced viewport to actual scrollable area.\n      if (viewport && viewport.top != null)\n        { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n      // Updated line heights might result in the drawn area not\n      // actually covering the viewport. Keep looping until it does.\n      update.visible = visibleLines(cm.display, cm.doc, viewport);\n      if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n        { break }\n    }\n    if (!updateDisplayIfNeeded(cm, update)) { break }\n    updateHeightsInViewport(cm);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n  }\n\n  update.signal(cm, \"update\", cm);\n  if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n    update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n    cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n  }\n}\n\nfunction updateDisplaySimple(cm, viewport) {\n  var update = new DisplayUpdate(cm, viewport);\n  if (updateDisplayIfNeeded(cm, update)) {\n    updateHeightsInViewport(cm);\n    postUpdateDisplay(cm, update);\n    var barMeasure = measureForScrollbars(cm);\n    updateSelection(cm);\n    updateScrollbars(cm, barMeasure);\n    setDocumentHeight(cm, barMeasure);\n    update.finish();\n  }\n}\n\n// Sync the actual display DOM structure with display.view, removing\n// nodes for lines that are no longer in view, and creating the ones\n// that are not there yet, and updating the ones that are out of\n// date.\nfunction patchDisplay(cm, updateNumbersFrom, dims) {\n  var display = cm.display, lineNumbers = cm.options.lineNumbers;\n  var container = display.lineDiv, cur = container.firstChild;\n\n  function rm(node) {\n    var next = node.nextSibling;\n    // Works around a throw-scroll bug in OS X Webkit\n    if (webkit && mac && cm.display.currentWheelTarget == node)\n      { node.style.display = \"none\"; }\n    else\n      { node.parentNode.removeChild(node); }\n    return next\n  }\n\n  var view = display.view, lineN = display.viewFrom;\n  // Loop over the elements in the view, syncing cur (the DOM nodes\n  // in display.lineDiv) with the view as we go.\n  for (var i = 0; i < view.length; i++) {\n    var lineView = view[i];\n    if (lineView.hidden) {\n    } else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n      var node = buildLineElement(cm, lineView, lineN, dims);\n      container.insertBefore(node, cur);\n    } else { // Already drawn\n      while (cur != lineView.node) { cur = rm(cur); }\n      var updateNumber = lineNumbers && updateNumbersFrom != null &&\n        updateNumbersFrom <= lineN && lineView.lineNumber;\n      if (lineView.changes) {\n        if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n        updateLineForChanges(cm, lineView, lineN, dims);\n      }\n      if (updateNumber) {\n        removeChildren(lineView.lineNumber);\n        lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n      }\n      cur = lineView.node.nextSibling;\n    }\n    lineN += lineView.size;\n  }\n  while (cur) { cur = rm(cur); }\n}\n\nfunction updateGutterSpace(cm) {\n  var width = cm.display.gutters.offsetWidth;\n  cm.display.sizer.style.marginLeft = width + \"px\";\n}\n\nfunction setDocumentHeight(cm, measure) {\n  cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n  cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n  cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n}\n\n// Rebuild the gutter elements, ensure the margin to the left of the\n// code matches their width.\nfunction updateGutters(cm) {\n  var gutters = cm.display.gutters, specs = cm.options.gutters;\n  removeChildren(gutters);\n  var i = 0;\n  for (; i < specs.length; ++i) {\n    var gutterClass = specs[i];\n    var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n    if (gutterClass == \"CodeMirror-linenumbers\") {\n      cm.display.lineGutter = gElt;\n      gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n    }\n  }\n  gutters.style.display = i ? \"\" : \"none\";\n  updateGutterSpace(cm);\n}\n\n// Make sure the gutters options contains the element\n// \"CodeMirror-linenumbers\" when the lineNumbers option is true.\nfunction setGuttersForLineNumbers(options) {\n  var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n  if (found == -1 && options.lineNumbers) {\n    options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n  } else if (found > -1 && !options.lineNumbers) {\n    options.gutters = options.gutters.slice(0);\n    options.gutters.splice(found, 1);\n  }\n}\n\n// Since the delta values reported on mouse wheel events are\n// unstandardized between browsers and even browser versions, and\n// generally horribly unpredictable, this code starts by measuring\n// the scroll effect that the first few mouse wheel events have,\n// and, from that, detects the way it can convert deltas to pixel\n// offsets afterwards.\n//\n// The reason we want to know the amount a wheel event will scroll\n// is that it gives us a chance to update the display before the\n// actual scrolling happens, reducing flickering.\n\nvar wheelSamples = 0;\nvar wheelPixelsPerUnit = null;\n// Fill in a browser-detected starting value on browsers where we\n// know one. These don't have to be accurate -- the result of them\n// being wrong would just be a slight flicker on the first wheel\n// scroll (if it is large enough).\nif (ie) { wheelPixelsPerUnit = -.53; }\nelse if (gecko) { wheelPixelsPerUnit = 15; }\nelse if (chrome) { wheelPixelsPerUnit = -.7; }\nelse if (safari) { wheelPixelsPerUnit = -1/3; }\n\nfunction wheelEventDelta(e) {\n  var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n  if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n  if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n  else if (dy == null) { dy = e.wheelDelta; }\n  return {x: dx, y: dy}\n}\nfunction wheelEventPixels(e) {\n  var delta = wheelEventDelta(e);\n  delta.x *= wheelPixelsPerUnit;\n  delta.y *= wheelPixelsPerUnit;\n  return delta\n}\n\nfunction onScrollWheel(cm, e) {\n  var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n  var display = cm.display, scroll = display.scroller;\n  // Quit if there's nothing to scroll here\n  var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n  var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n  if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n  // Webkit browsers on OS X abort momentum scrolls when the target\n  // of the scroll event is removed from the scrollable element.\n  // This hack (see related code in patchDisplay) makes sure the\n  // element is kept around.\n  if (dy && mac && webkit) {\n    outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n      for (var i = 0; i < view.length; i++) {\n        if (view[i].node == cur) {\n          cm.display.currentWheelTarget = cur;\n          break outer\n        }\n      }\n    }\n  }\n\n  // On some browsers, horizontal scrolling will cause redraws to\n  // happen before the gutter has been realigned, causing it to\n  // wriggle around in a most unseemly way. When we have an\n  // estimated pixels/delta value, we just handle horizontal\n  // scrolling entirely here. It'll be slightly off from native, but\n  // better than glitching out.\n  if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n    if (dy && canScrollY)\n      { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n    setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n    // Only prevent default scrolling if vertical scrolling is\n    // actually possible. Otherwise, it causes vertical scroll\n    // jitter on OSX trackpads when deltaX is small and deltaY\n    // is large (issue #3579)\n    if (!dy || (dy && canScrollY))\n      { e_preventDefault(e); }\n    display.wheelStartX = null; // Abort measurement, if in progress\n    return\n  }\n\n  // 'Project' the visible viewport to cover the area that is being\n  // scrolled into view (if we know enough to estimate it).\n  if (dy && wheelPixelsPerUnit != null) {\n    var pixels = dy * wheelPixelsPerUnit;\n    var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n    if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n    else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n    updateDisplaySimple(cm, {top: top, bottom: bot});\n  }\n\n  if (wheelSamples < 20) {\n    if (display.wheelStartX == null) {\n      display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n      display.wheelDX = dx; display.wheelDY = dy;\n      setTimeout(function () {\n        if (display.wheelStartX == null) { return }\n        var movedX = scroll.scrollLeft - display.wheelStartX;\n        var movedY = scroll.scrollTop - display.wheelStartY;\n        var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n          (movedX && display.wheelDX && movedX / display.wheelDX);\n        display.wheelStartX = display.wheelStartY = null;\n        if (!sample) { return }\n        wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n        ++wheelSamples;\n      }, 200);\n    } else {\n      display.wheelDX += dx; display.wheelDY += dy;\n    }\n  }\n}\n\n// Selection objects are immutable. A new one is created every time\n// the selection changes. A selection is one or more non-overlapping\n// (and non-touching) ranges, sorted, and an integer that indicates\n// which one is the primary selection (the one that's scrolled into\n// view, that getCursor returns, etc).\nvar Selection = function(ranges, primIndex) {\n  this.ranges = ranges;\n  this.primIndex = primIndex;\n};\n\nSelection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\nSelection.prototype.equals = function (other) {\n    var this$1 = this;\n\n  if (other == this) { return true }\n  if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var here = this$1.ranges[i], there = other.ranges[i];\n    if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n  }\n  return true\n};\n\nSelection.prototype.deepCopy = function () {\n    var this$1 = this;\n\n  var out = [];\n  for (var i = 0; i < this.ranges.length; i++)\n    { out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head)); }\n  return new Selection(out, this.primIndex)\n};\n\nSelection.prototype.somethingSelected = function () {\n    var this$1 = this;\n\n  for (var i = 0; i < this.ranges.length; i++)\n    { if (!this$1.ranges[i].empty()) { return true } }\n  return false\n};\n\nSelection.prototype.contains = function (pos, end) {\n    var this$1 = this;\n\n  if (!end) { end = pos; }\n  for (var i = 0; i < this.ranges.length; i++) {\n    var range = this$1.ranges[i];\n    if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n      { return i }\n  }\n  return -1\n};\n\nvar Range = function(anchor, head) {\n  this.anchor = anchor; this.head = head;\n};\n\nRange.prototype.from = function () { return minPos(this.anchor, this.head) };\nRange.prototype.to = function () { return maxPos(this.anchor, this.head) };\nRange.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n// Take an unsorted, potentially overlapping set of ranges, and\n// build a selection out of it. 'Consumes' ranges array (modifying\n// it).\nfunction normalizeSelection(ranges, primIndex) {\n  var prim = ranges[primIndex];\n  ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n  primIndex = indexOf(ranges, prim);\n  for (var i = 1; i < ranges.length; i++) {\n    var cur = ranges[i], prev = ranges[i - 1];\n    if (cmp(prev.to(), cur.from()) >= 0) {\n      var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n      var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n      if (i <= primIndex) { --primIndex; }\n      ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n    }\n  }\n  return new Selection(ranges, primIndex)\n}\n\nfunction simpleSelection(anchor, head) {\n  return new Selection([new Range(anchor, head || anchor)], 0)\n}\n\n// Compute the position of the end of a change (its 'to' property\n// refers to the pre-change end).\nfunction changeEnd(change) {\n  if (!change.text) { return change.to }\n  return Pos(change.from.line + change.text.length - 1,\n             lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n}\n\n// Adjust a position to refer to the post-change position of the\n// same text, or the end of the change if the change covers it.\nfunction adjustForChange(pos, change) {\n  if (cmp(pos, change.from) < 0) { return pos }\n  if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n  var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n  if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n  return Pos(line, ch)\n}\n\nfunction computeSelAfterChange(doc, change) {\n  var out = [];\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\n    var range = doc.sel.ranges[i];\n    out.push(new Range(adjustForChange(range.anchor, change),\n                       adjustForChange(range.head, change)));\n  }\n  return normalizeSelection(out, doc.sel.primIndex)\n}\n\nfunction offsetPos(pos, old, nw) {\n  if (pos.line == old.line)\n    { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n  else\n    { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n}\n\n// Used by replaceSelections to allow moving the selection to the\n// start or around the replaced test. Hint may be \"start\" or \"around\".\nfunction computeReplacedSel(doc, changes, hint) {\n  var out = [];\n  var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n  for (var i = 0; i < changes.length; i++) {\n    var change = changes[i];\n    var from = offsetPos(change.from, oldPrev, newPrev);\n    var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n    oldPrev = change.to;\n    newPrev = to;\n    if (hint == \"around\") {\n      var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n      out[i] = new Range(inv ? to : from, inv ? from : to);\n    } else {\n      out[i] = new Range(from, from);\n    }\n  }\n  return new Selection(out, doc.sel.primIndex)\n}\n\n// Used to get the editor into a consistent state again when options change.\n\nfunction loadMode(cm) {\n  cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n  resetModeState(cm);\n}\n\nfunction resetModeState(cm) {\n  cm.doc.iter(function (line) {\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n  });\n  cm.doc.frontier = cm.doc.first;\n  startWorker(cm, 100);\n  cm.state.modeGen++;\n  if (cm.curOp) { regChange(cm); }\n}\n\n// DOCUMENT DATA STRUCTURE\n\n// By default, updates that start and end at the beginning of a line\n// are treated specially, in order to make the association of line\n// widgets and marker elements with the text behave more intuitive.\nfunction isWholeLineUpdate(doc, change) {\n  return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n    (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n}\n\n// Perform a change on the document data structure.\nfunction updateDoc(doc, change, markedSpans, estimateHeight$$1) {\n  function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n  function update(line, text, spans) {\n    updateLine(line, text, spans, estimateHeight$$1);\n    signalLater(line, \"change\", line, change);\n  }\n  function linesFor(start, end) {\n    var result = [];\n    for (var i = start; i < end; ++i)\n      { result.push(new Line(text[i], spansFor(i), estimateHeight$$1)); }\n    return result\n  }\n\n  var from = change.from, to = change.to, text = change.text;\n  var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n  var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n  // Adjust the line structure\n  if (change.full) {\n    doc.insert(0, linesFor(0, text.length));\n    doc.remove(text.length, doc.size - text.length);\n  } else if (isWholeLineUpdate(doc, change)) {\n    // This is a whole-line replace. Treated specially to make\n    // sure line objects move the way they are supposed to.\n    var added = linesFor(0, text.length - 1);\n    update(lastLine, lastLine.text, lastSpans);\n    if (nlines) { doc.remove(from.line, nlines); }\n    if (added.length) { doc.insert(from.line, added); }\n  } else if (firstLine == lastLine) {\n    if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n    } else {\n      var added$1 = linesFor(1, text.length - 1);\n      added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight$$1));\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      doc.insert(from.line + 1, added$1);\n    }\n  } else if (text.length == 1) {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n    doc.remove(from.line + 1, nlines);\n  } else {\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n    update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n    var added$2 = linesFor(1, text.length - 1);\n    if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n    doc.insert(from.line + 1, added$2);\n  }\n\n  signalLater(doc, \"change\", doc, change);\n}\n\n// Call f for all linked documents.\nfunction linkedDocs(doc, f, sharedHistOnly) {\n  function propagate(doc, skip, sharedHist) {\n    if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n      var rel = doc.linked[i];\n      if (rel.doc == skip) { continue }\n      var shared = sharedHist && rel.sharedHist;\n      if (sharedHistOnly && !shared) { continue }\n      f(rel.doc, shared);\n      propagate(rel.doc, doc, shared);\n    } }\n  }\n  propagate(doc, null, true);\n}\n\n// Attach a document to an editor.\nfunction attachDoc(cm, doc) {\n  if (doc.cm) { throw new Error(\"This document is already in use.\") }\n  cm.doc = doc;\n  doc.cm = cm;\n  estimateLineHeights(cm);\n  loadMode(cm);\n  setDirectionClass(cm);\n  if (!cm.options.lineWrapping) { findMaxLine(cm); }\n  cm.options.mode = doc.modeOption;\n  regChange(cm);\n}\n\nfunction setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n}\n\nfunction directionChanged(cm) {\n  runInOp(cm, function () {\n    setDirectionClass(cm);\n    regChange(cm);\n  });\n}\n\nfunction History(startGen) {\n  // Arrays of change events and selections. Doing something adds an\n  // event to done and clears undo. Undoing moves events from done\n  // to undone, redoing moves them in the other direction.\n  this.done = []; this.undone = [];\n  this.undoDepth = Infinity;\n  // Used to track when changes can be merged into a single undo\n  // event\n  this.lastModTime = this.lastSelTime = 0;\n  this.lastOp = this.lastSelOp = null;\n  this.lastOrigin = this.lastSelOrigin = null;\n  // Used by the isClean() method\n  this.generation = this.maxGeneration = startGen || 1;\n}\n\n// Create a history change event from an updateDoc-style change\n// object.\nfunction historyChangeFromChange(doc, change) {\n  var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n  attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n  linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n  return histChange\n}\n\n// Pop all selection events off the end of a history array. Stop at\n// a change event.\nfunction clearSelectionEvents(array) {\n  while (array.length) {\n    var last = lst(array);\n    if (last.ranges) { array.pop(); }\n    else { break }\n  }\n}\n\n// Find the top change event in the history. Pop off selection\n// events that are in the way.\nfunction lastChangeEvent(hist, force) {\n  if (force) {\n    clearSelectionEvents(hist.done);\n    return lst(hist.done)\n  } else if (hist.done.length && !lst(hist.done).ranges) {\n    return lst(hist.done)\n  } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n    hist.done.pop();\n    return lst(hist.done)\n  }\n}\n\n// Register a change in the history. Merges changes that are within\n// a single operation, or are close together with an origin that\n// allows merging (starting with \"+\") into a single event.\nfunction addChangeToHistory(doc, change, selAfter, opId) {\n  var hist = doc.history;\n  hist.undone.length = 0;\n  var time = +new Date, cur;\n  var last;\n\n  if ((hist.lastOp == opId ||\n       hist.lastOrigin == change.origin && change.origin &&\n       ((change.origin.charAt(0) == \"+\" && doc.cm && hist.lastModTime > time - doc.cm.options.historyEventDelay) ||\n        change.origin.charAt(0) == \"*\")) &&\n      (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n    // Merge this change into the last event\n    last = lst(cur.changes);\n    if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n      // Optimized case for simple insertion -- don't want to add\n      // new changesets for every character typed\n      last.to = changeEnd(change);\n    } else {\n      // Add new sub-event\n      cur.changes.push(historyChangeFromChange(doc, change));\n    }\n  } else {\n    // Can not be merged, start a new event.\n    var before = lst(hist.done);\n    if (!before || !before.ranges)\n      { pushSelectionToHistory(doc.sel, hist.done); }\n    cur = {changes: [historyChangeFromChange(doc, change)],\n           generation: hist.generation};\n    hist.done.push(cur);\n    while (hist.done.length > hist.undoDepth) {\n      hist.done.shift();\n      if (!hist.done[0].ranges) { hist.done.shift(); }\n    }\n  }\n  hist.done.push(selAfter);\n  hist.generation = ++hist.maxGeneration;\n  hist.lastModTime = hist.lastSelTime = time;\n  hist.lastOp = hist.lastSelOp = opId;\n  hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n  if (!last) { signal(doc, \"historyAdded\"); }\n}\n\nfunction selectionEventCanBeMerged(doc, origin, prev, sel) {\n  var ch = origin.charAt(0);\n  return ch == \"*\" ||\n    ch == \"+\" &&\n    prev.ranges.length == sel.ranges.length &&\n    prev.somethingSelected() == sel.somethingSelected() &&\n    new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n}\n\n// Called whenever the selection changes, sets the new selection as\n// the pending selection in the history, and pushes the old pending\n// selection into the 'done' array when it was significantly\n// different (in number of selected ranges, emptiness, or time).\nfunction addSelectionToHistory(doc, sel, opId, options) {\n  var hist = doc.history, origin = options && options.origin;\n\n  // A new event is started when the previous origin does not match\n  // the current, or the origins don't allow matching. Origins\n  // starting with * are always merged, those starting with + are\n  // merged when similar and close together in time.\n  if (opId == hist.lastSelOp ||\n      (origin && hist.lastSelOrigin == origin &&\n       (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n        selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n    { hist.done[hist.done.length - 1] = sel; }\n  else\n    { pushSelectionToHistory(sel, hist.done); }\n\n  hist.lastSelTime = +new Date;\n  hist.lastSelOrigin = origin;\n  hist.lastSelOp = opId;\n  if (options && options.clearRedo !== false)\n    { clearSelectionEvents(hist.undone); }\n}\n\nfunction pushSelectionToHistory(sel, dest) {\n  var top = lst(dest);\n  if (!(top && top.ranges && top.equals(sel)))\n    { dest.push(sel); }\n}\n\n// Used to store marked span information in the history.\nfunction attachLocalSpans(doc, change, from, to) {\n  var existing = change[\"spans_\" + doc.id], n = 0;\n  doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n    if (line.markedSpans)\n      { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n    ++n;\n  });\n}\n\n// When un/re-doing restores text containing marked spans, those\n// that have been explicitly cleared should not be restored.\nfunction removeClearedSpans(spans) {\n  if (!spans) { return null }\n  var out;\n  for (var i = 0; i < spans.length; ++i) {\n    if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n    else if (out) { out.push(spans[i]); }\n  }\n  return !out ? spans : out.length ? out : null\n}\n\n// Retrieve and filter the old marked spans stored in a change event.\nfunction getOldSpans(doc, change) {\n  var found = change[\"spans_\" + doc.id];\n  if (!found) { return null }\n  var nw = [];\n  for (var i = 0; i < change.text.length; ++i)\n    { nw.push(removeClearedSpans(found[i])); }\n  return nw\n}\n\n// Used for un/re-doing changes from the history. Combines the\n// result of computing the existing spans with the set of spans that\n// existed in the history (so that deleting around a span and then\n// undoing brings back the span).\nfunction mergeOldSpans(doc, change) {\n  var old = getOldSpans(doc, change);\n  var stretched = stretchSpansOverChange(doc, change);\n  if (!old) { return stretched }\n  if (!stretched) { return old }\n\n  for (var i = 0; i < old.length; ++i) {\n    var oldCur = old[i], stretchCur = stretched[i];\n    if (oldCur && stretchCur) {\n      spans: for (var j = 0; j < stretchCur.length; ++j) {\n        var span = stretchCur[j];\n        for (var k = 0; k < oldCur.length; ++k)\n          { if (oldCur[k].marker == span.marker) { continue spans } }\n        oldCur.push(span);\n      }\n    } else if (stretchCur) {\n      old[i] = stretchCur;\n    }\n  }\n  return old\n}\n\n// Used both to provide a JSON-safe object in .getHistory, and, when\n// detaching a document, to split the history in two\nfunction copyHistoryArray(events, newGroup, instantiateSel) {\n  var copy = [];\n  for (var i = 0; i < events.length; ++i) {\n    var event = events[i];\n    if (event.ranges) {\n      copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n      continue\n    }\n    var changes = event.changes, newChanges = [];\n    copy.push({changes: newChanges});\n    for (var j = 0; j < changes.length; ++j) {\n      var change = changes[j], m = (void 0);\n      newChanges.push({from: change.from, to: change.to, text: change.text});\n      if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n        if (indexOf(newGroup, Number(m[1])) > -1) {\n          lst(newChanges)[prop] = change[prop];\n          delete change[prop];\n        }\n      } } }\n    }\n  }\n  return copy\n}\n\n// The 'scroll' parameter given to many of these indicated whether\n// the new cursor position should be scrolled into view after\n// modifying the selection.\n\n// If shift is held or the extend flag is set, extends a range to\n// include a given position (and optionally a second position).\n// Otherwise, simply returns the range between the given positions.\n// Used for cursor motion and such.\nfunction extendRange(doc, range, head, other) {\n  if (doc.cm && doc.cm.display.shift || doc.extend) {\n    var anchor = range.anchor;\n    if (other) {\n      var posBefore = cmp(head, anchor) < 0;\n      if (posBefore != (cmp(other, anchor) < 0)) {\n        anchor = head;\n        head = other;\n      } else if (posBefore != (cmp(head, other) < 0)) {\n        head = other;\n      }\n    }\n    return new Range(anchor, head)\n  } else {\n    return new Range(other || head, head)\n  }\n}\n\n// Extend the primary selection range, discard the rest.\nfunction extendSelection(doc, head, other, options) {\n  setSelection(doc, new Selection([extendRange(doc, doc.sel.primary(), head, other)], 0), options);\n}\n\n// Extend all selections (pos is an array of selections with length\n// equal the number of selections)\nfunction extendSelections(doc, heads, options) {\n  var out = [];\n  for (var i = 0; i < doc.sel.ranges.length; i++)\n    { out[i] = extendRange(doc, doc.sel.ranges[i], heads[i], null); }\n  var newSel = normalizeSelection(out, doc.sel.primIndex);\n  setSelection(doc, newSel, options);\n}\n\n// Updates a single range in the selection.\nfunction replaceOneSelection(doc, i, range, options) {\n  var ranges = doc.sel.ranges.slice(0);\n  ranges[i] = range;\n  setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n}\n\n// Reset the selection to a single range.\nfunction setSimpleSelection(doc, anchor, head, options) {\n  setSelection(doc, simpleSelection(anchor, head), options);\n}\n\n// Give beforeSelectionChange handlers a change to influence a\n// selection update.\nfunction filterSelectionChange(doc, sel, options) {\n  var obj = {\n    ranges: sel.ranges,\n    update: function(ranges) {\n      var this$1 = this;\n\n      this.ranges = [];\n      for (var i = 0; i < ranges.length; i++)\n        { this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                   clipPos(doc, ranges[i].head)); }\n    },\n    origin: options && options.origin\n  };\n  signal(doc, \"beforeSelectionChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n  if (obj.ranges != sel.ranges) { return normalizeSelection(obj.ranges, obj.ranges.length - 1) }\n  else { return sel }\n}\n\nfunction setSelectionReplaceHistory(doc, sel, options) {\n  var done = doc.history.done, last = lst(done);\n  if (last && last.ranges) {\n    done[done.length - 1] = sel;\n    setSelectionNoUndo(doc, sel, options);\n  } else {\n    setSelection(doc, sel, options);\n  }\n}\n\n// Set a new selection.\nfunction setSelection(doc, sel, options) {\n  setSelectionNoUndo(doc, sel, options);\n  addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n}\n\nfunction setSelectionNoUndo(doc, sel, options) {\n  if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n    { sel = filterSelectionChange(doc, sel, options); }\n\n  var bias = options && options.bias ||\n    (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n  setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n  if (!(options && options.scroll === false) && doc.cm)\n    { ensureCursorVisible(doc.cm); }\n}\n\nfunction setSelectionInner(doc, sel) {\n  if (sel.equals(doc.sel)) { return }\n\n  doc.sel = sel;\n\n  if (doc.cm) {\n    doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n    signalCursorActivity(doc.cm);\n  }\n  signalLater(doc, \"cursorActivity\", doc);\n}\n\n// Verify that the selection does not partially select any atomic\n// marked ranges.\nfunction reCheckSelection(doc) {\n  setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n}\n\n// Return a selection that does not partially select any atomic\n// ranges.\nfunction skipAtomicInSelection(doc, sel, bias, mayClear) {\n  var out;\n  for (var i = 0; i < sel.ranges.length; i++) {\n    var range = sel.ranges[i];\n    var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n    var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n    var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n    if (out || newAnchor != range.anchor || newHead != range.head) {\n      if (!out) { out = sel.ranges.slice(0, i); }\n      out[i] = new Range(newAnchor, newHead);\n    }\n  }\n  return out ? normalizeSelection(out, sel.primIndex) : sel\n}\n\nfunction skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n  var line = getLine(doc, pos.line);\n  if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n    var sp = line.markedSpans[i], m = sp.marker;\n    if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n        (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n      if (mayClear) {\n        signal(m, \"beforeCursorEnter\");\n        if (m.explicitlyCleared) {\n          if (!line.markedSpans) { break }\n          else {--i; continue}\n        }\n      }\n      if (!m.atomic) { continue }\n\n      if (oldPos) {\n        var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n        if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft)\n          { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n        if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n          { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n      }\n\n      var far = m.find(dir < 0 ? -1 : 1);\n      if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight)\n        { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n      return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n    }\n  } }\n  return pos\n}\n\n// Ensure a given position is not inside an atomic range.\nfunction skipAtomic(doc, pos, oldPos, bias, mayClear) {\n  var dir = bias || 1;\n  var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n      skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n  if (!found) {\n    doc.cantEdit = true;\n    return Pos(doc.first, 0)\n  }\n  return found\n}\n\nfunction movePos(doc, pos, dir, line) {\n  if (dir < 0 && pos.ch == 0) {\n    if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n    else { return null }\n  } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n    if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n    else { return null }\n  } else {\n    return new Pos(pos.line, pos.ch + dir)\n  }\n}\n\nfunction selectAll(cm) {\n  cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n}\n\n// UPDATING\n\n// Allow \"beforeChange\" event handlers to influence a change\nfunction filterChange(doc, change, update) {\n  var obj = {\n    canceled: false,\n    from: change.from,\n    to: change.to,\n    text: change.text,\n    origin: change.origin,\n    cancel: function () { return obj.canceled = true; }\n  };\n  if (update) { obj.update = function (from, to, text, origin) {\n    if (from) { obj.from = clipPos(doc, from); }\n    if (to) { obj.to = clipPos(doc, to); }\n    if (text) { obj.text = text; }\n    if (origin !== undefined) { obj.origin = origin; }\n  }; }\n  signal(doc, \"beforeChange\", doc, obj);\n  if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n  if (obj.canceled) { return null }\n  return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n}\n\n// Apply a change to a document, and add it to the document's\n// history, and propagating it to all linked documents.\nfunction makeChange(doc, change, ignoreReadOnly) {\n  if (doc.cm) {\n    if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n    if (doc.cm.state.suppressEdits) { return }\n  }\n\n  if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n    change = filterChange(doc, change, true);\n    if (!change) { return }\n  }\n\n  // Possibly split or suppress the update based on the presence\n  // of read-only spans in its range.\n  var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n  if (split) {\n    for (var i = split.length - 1; i >= 0; --i)\n      { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text}); }\n  } else {\n    makeChangeInner(doc, change);\n  }\n}\n\nfunction makeChangeInner(doc, change) {\n  if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n  var selAfter = computeSelAfterChange(doc, change);\n  addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n  makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n  var rebased = [];\n\n  linkedDocs(doc, function (doc, sharedHist) {\n    if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n      rebaseHist(doc.history, change);\n      rebased.push(doc.history);\n    }\n    makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n  });\n}\n\n// Revert a change stored in a document's history.\nfunction makeChangeFromHistory(doc, type, allowSelectionOnly) {\n  if (doc.cm && doc.cm.state.suppressEdits && !allowSelectionOnly) { return }\n\n  var hist = doc.history, event, selAfter = doc.sel;\n  var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n  // Verify that there is a useable event (so that ctrl-z won't\n  // needlessly clear selection events)\n  var i = 0;\n  for (; i < source.length; i++) {\n    event = source[i];\n    if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n      { break }\n  }\n  if (i == source.length) { return }\n  hist.lastOrigin = hist.lastSelOrigin = null;\n\n  for (;;) {\n    event = source.pop();\n    if (event.ranges) {\n      pushSelectionToHistory(event, dest);\n      if (allowSelectionOnly && !event.equals(doc.sel)) {\n        setSelection(doc, event, {clearRedo: false});\n        return\n      }\n      selAfter = event;\n    }\n    else { break }\n  }\n\n  // Build up a reverse change object to add to the opposite history\n  // stack (redo when undoing, and vice versa).\n  var antiChanges = [];\n  pushSelectionToHistory(selAfter, dest);\n  dest.push({changes: antiChanges, generation: hist.generation});\n  hist.generation = event.generation || ++hist.maxGeneration;\n\n  var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n  var loop = function ( i ) {\n    var change = event.changes[i];\n    change.origin = type;\n    if (filter && !filterChange(doc, change, false)) {\n      source.length = 0;\n      return {}\n    }\n\n    antiChanges.push(historyChangeFromChange(doc, change));\n\n    var after = i ? computeSelAfterChange(doc, change) : lst(source);\n    makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n    if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n    var rebased = [];\n\n    // Propagate to the linked documents\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n    });\n  };\n\n  for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n    var returned = loop( i$1 );\n\n    if ( returned ) return returned.v;\n  }\n}\n\n// Sub-views need their line numbers shifted when text is added\n// above or below them in the parent document.\nfunction shiftDoc(doc, distance) {\n  if (distance == 0) { return }\n  doc.first += distance;\n  doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n    Pos(range.anchor.line + distance, range.anchor.ch),\n    Pos(range.head.line + distance, range.head.ch)\n  ); }), doc.sel.primIndex);\n  if (doc.cm) {\n    regChange(doc.cm, doc.first, doc.first - distance, distance);\n    for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n      { regLineChange(doc.cm, l, \"gutter\"); }\n  }\n}\n\n// More lower-level change function, handling only a single document\n// (not linked ones).\nfunction makeChangeSingleDoc(doc, change, selAfter, spans) {\n  if (doc.cm && !doc.cm.curOp)\n    { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n  if (change.to.line < doc.first) {\n    shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n    return\n  }\n  if (change.from.line > doc.lastLine()) { return }\n\n  // Clip the change to the size of this doc\n  if (change.from.line < doc.first) {\n    var shift = change.text.length - 1 - (doc.first - change.from.line);\n    shiftDoc(doc, shift);\n    change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n              text: [lst(change.text)], origin: change.origin};\n  }\n  var last = doc.lastLine();\n  if (change.to.line > last) {\n    change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n              text: [change.text[0]], origin: change.origin};\n  }\n\n  change.removed = getBetween(doc, change.from, change.to);\n\n  if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n  if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n  else { updateDoc(doc, change, spans); }\n  setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n}\n\n// Handle the interaction of a change to a document with the editor\n// that this document is part of.\nfunction makeChangeSingleDocInEditor(cm, change, spans) {\n  var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n  var recomputeMaxLength = false, checkWidthStart = from.line;\n  if (!cm.options.lineWrapping) {\n    checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n    doc.iter(checkWidthStart, to.line + 1, function (line) {\n      if (line == display.maxLine) {\n        recomputeMaxLength = true;\n        return true\n      }\n    });\n  }\n\n  if (doc.sel.contains(change.from, change.to) > -1)\n    { signalCursorActivity(cm); }\n\n  updateDoc(doc, change, spans, estimateHeight(cm));\n\n  if (!cm.options.lineWrapping) {\n    doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n      var len = lineLength(line);\n      if (len > display.maxLineLength) {\n        display.maxLine = line;\n        display.maxLineLength = len;\n        display.maxLineChanged = true;\n        recomputeMaxLength = false;\n      }\n    });\n    if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n  }\n\n  // Adjust frontier, schedule worker\n  doc.frontier = Math.min(doc.frontier, from.line);\n  startWorker(cm, 400);\n\n  var lendiff = change.text.length - (to.line - from.line) - 1;\n  // Remember that these lines changed, for updating the display\n  if (change.full)\n    { regChange(cm); }\n  else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n    { regLineChange(cm, from.line, \"text\"); }\n  else\n    { regChange(cm, from.line, to.line + 1, lendiff); }\n\n  var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n  if (changeHandler || changesHandler) {\n    var obj = {\n      from: from, to: to,\n      text: change.text,\n      removed: change.removed,\n      origin: change.origin\n    };\n    if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n    if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n  }\n  cm.display.selForContextMenu = null;\n}\n\nfunction replaceRange(doc, code, from, to, origin) {\n  if (!to) { to = from; }\n  if (cmp(to, from) < 0) { var tmp = to; to = from; from = tmp; }\n  if (typeof code == \"string\") { code = doc.splitLines(code); }\n  makeChange(doc, {from: from, to: to, text: code, origin: origin});\n}\n\n// Rebasing/resetting history to deal with externally-sourced changes\n\nfunction rebaseHistSelSingle(pos, from, to, diff) {\n  if (to < pos.line) {\n    pos.line += diff;\n  } else if (from < pos.line) {\n    pos.line = from;\n    pos.ch = 0;\n  }\n}\n\n// Tries to rebase an array of history events given a change in the\n// document. If the change touches the same lines as the event, the\n// event, and everything 'behind' it, is discarded. If the change is\n// before the event, the event's positions are updated. Uses a\n// copy-on-write scheme for the positions, to avoid having to\n// reallocate them all on every rebase, but also avoid problems with\n// shared position objects being unsafely updated.\nfunction rebaseHistArray(array, from, to, diff) {\n  for (var i = 0; i < array.length; ++i) {\n    var sub = array[i], ok = true;\n    if (sub.ranges) {\n      if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n      for (var j = 0; j < sub.ranges.length; j++) {\n        rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n        rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n      }\n      continue\n    }\n    for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n      var cur = sub.changes[j$1];\n      if (to < cur.from.line) {\n        cur.from = Pos(cur.from.line + diff, cur.from.ch);\n        cur.to = Pos(cur.to.line + diff, cur.to.ch);\n      } else if (from <= cur.to.line) {\n        ok = false;\n        break\n      }\n    }\n    if (!ok) {\n      array.splice(0, i + 1);\n      i = 0;\n    }\n  }\n}\n\nfunction rebaseHist(hist, change) {\n  var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n  rebaseHistArray(hist.done, from, to, diff);\n  rebaseHistArray(hist.undone, from, to, diff);\n}\n\n// Utility for applying a change to a line by handle or number,\n// returning the number and optionally registering the line as\n// changed.\nfunction changeLine(doc, handle, changeType, op) {\n  var no = handle, line = handle;\n  if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n  else { no = lineNo(handle); }\n  if (no == null) { return null }\n  if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n  return line\n}\n\n// The document is represented as a BTree consisting of leaves, with\n// chunk of lines in them, and branches, with up to ten leaves or\n// other branch nodes below them. The top node is always a branch\n// node, and is the document object itself (meaning it has\n// additional methods and properties).\n//\n// All nodes have parent links. The tree is used both to go from\n// line numbers to line objects, and to go from objects to numbers.\n// It also indexes by height, and is used to convert between height\n// and line object, and to find the total height of the document.\n//\n// See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\nvar LeafChunk = function(lines) {\n  var this$1 = this;\n\n  this.lines = lines;\n  this.parent = null;\n  var height = 0;\n  for (var i = 0; i < lines.length; ++i) {\n    lines[i].parent = this$1;\n    height += lines[i].height;\n  }\n  this.height = height;\n};\n\nLeafChunk.prototype.chunkSize = function () { return this.lines.length };\n\n// Remove the n lines at offset 'at'.\nLeafChunk.prototype.removeInner = function (at, n) {\n    var this$1 = this;\n\n  for (var i = at, e = at + n; i < e; ++i) {\n    var line = this$1.lines[i];\n    this$1.height -= line.height;\n    cleanUpLine(line);\n    signalLater(line, \"delete\");\n  }\n  this.lines.splice(at, n);\n};\n\n// Helper used to collapse a small branch into a single leaf.\nLeafChunk.prototype.collapse = function (lines) {\n  lines.push.apply(lines, this.lines);\n};\n\n// Insert the given array of lines at offset 'at', count them as\n// having the given height.\nLeafChunk.prototype.insertInner = function (at, lines, height) {\n    var this$1 = this;\n\n  this.height += height;\n  this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n  for (var i = 0; i < lines.length; ++i) { lines[i].parent = this$1; }\n};\n\n// Used to iterate over a part of the tree.\nLeafChunk.prototype.iterN = function (at, n, op) {\n    var this$1 = this;\n\n  for (var e = at + n; at < e; ++at)\n    { if (op(this$1.lines[at])) { return true } }\n};\n\nvar BranchChunk = function(children) {\n  var this$1 = this;\n\n  this.children = children;\n  var size = 0, height = 0;\n  for (var i = 0; i < children.length; ++i) {\n    var ch = children[i];\n    size += ch.chunkSize(); height += ch.height;\n    ch.parent = this$1;\n  }\n  this.size = size;\n  this.height = height;\n  this.parent = null;\n};\n\nBranchChunk.prototype.chunkSize = function () { return this.size };\n\nBranchChunk.prototype.removeInner = function (at, n) {\n    var this$1 = this;\n\n  this.size -= n;\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i], sz = child.chunkSize();\n    if (at < sz) {\n      var rm = Math.min(n, sz - at), oldHeight = child.height;\n      child.removeInner(at, rm);\n      this$1.height -= oldHeight - child.height;\n      if (sz == rm) { this$1.children.splice(i--, 1); child.parent = null; }\n      if ((n -= rm) == 0) { break }\n      at = 0;\n    } else { at -= sz; }\n  }\n  // If the result is smaller than 25 lines, ensure that it is a\n  // single leaf node.\n  if (this.size - n < 25 &&\n      (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n    var lines = [];\n    this.collapse(lines);\n    this.children = [new LeafChunk(lines)];\n    this.children[0].parent = this;\n  }\n};\n\nBranchChunk.prototype.collapse = function (lines) {\n    var this$1 = this;\n\n  for (var i = 0; i < this.children.length; ++i) { this$1.children[i].collapse(lines); }\n};\n\nBranchChunk.prototype.insertInner = function (at, lines, height) {\n    var this$1 = this;\n\n  this.size += lines.length;\n  this.height += height;\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i], sz = child.chunkSize();\n    if (at <= sz) {\n      child.insertInner(at, lines, height);\n      if (child.lines && child.lines.length > 50) {\n        // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n        // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n        var remaining = child.lines.length % 25 + 25;\n        for (var pos = remaining; pos < child.lines.length;) {\n          var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n          child.height -= leaf.height;\n          this$1.children.splice(++i, 0, leaf);\n          leaf.parent = this$1;\n        }\n        child.lines = child.lines.slice(0, remaining);\n        this$1.maybeSpill();\n      }\n      break\n    }\n    at -= sz;\n  }\n};\n\n// When a node has grown, check whether it should be split.\nBranchChunk.prototype.maybeSpill = function () {\n  if (this.children.length <= 10) { return }\n  var me = this;\n  do {\n    var spilled = me.children.splice(me.children.length - 5, 5);\n    var sibling = new BranchChunk(spilled);\n    if (!me.parent) { // Become the parent node\n      var copy = new BranchChunk(me.children);\n      copy.parent = me;\n      me.children = [copy, sibling];\n      me = copy;\n   } else {\n      me.size -= sibling.size;\n      me.height -= sibling.height;\n      var myIndex = indexOf(me.parent.children, me);\n      me.parent.children.splice(myIndex + 1, 0, sibling);\n    }\n    sibling.parent = me.parent;\n  } while (me.children.length > 10)\n  me.parent.maybeSpill();\n};\n\nBranchChunk.prototype.iterN = function (at, n, op) {\n    var this$1 = this;\n\n  for (var i = 0; i < this.children.length; ++i) {\n    var child = this$1.children[i], sz = child.chunkSize();\n    if (at < sz) {\n      var used = Math.min(n, sz - at);\n      if (child.iterN(at, used, op)) { return true }\n      if ((n -= used) == 0) { break }\n      at = 0;\n    } else { at -= sz; }\n  }\n};\n\n// Line widgets are block elements displayed above or below a line.\n\nvar LineWidget = function(doc, node, options) {\n  var this$1 = this;\n\n  if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n    { this$1[opt] = options[opt]; } } }\n  this.doc = doc;\n  this.node = node;\n};\n\nLineWidget.prototype.clear = function () {\n    var this$1 = this;\n\n  var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n  if (no == null || !ws) { return }\n  for (var i = 0; i < ws.length; ++i) { if (ws[i] == this$1) { ws.splice(i--, 1); } }\n  if (!ws.length) { line.widgets = null; }\n  var height = widgetHeight(this);\n  updateLineHeight(line, Math.max(0, line.height - height));\n  if (cm) {\n    runInOp(cm, function () {\n      adjustScrollWhenAboveVisible(cm, line, -height);\n      regLineChange(cm, no, \"widget\");\n    });\n    signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n  }\n};\n\nLineWidget.prototype.changed = function () {\n    var this$1 = this;\n\n  var oldH = this.height, cm = this.doc.cm, line = this.line;\n  this.height = null;\n  var diff = widgetHeight(this) - oldH;\n  if (!diff) { return }\n  updateLineHeight(line, line.height + diff);\n  if (cm) {\n    runInOp(cm, function () {\n      cm.curOp.forceUpdate = true;\n      adjustScrollWhenAboveVisible(cm, line, diff);\n      signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n    });\n  }\n};\neventMixin(LineWidget);\n\nfunction adjustScrollWhenAboveVisible(cm, line, diff) {\n  if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n    { addToScrollTop(cm, diff); }\n}\n\nfunction addLineWidget(doc, handle, node, options) {\n  var widget = new LineWidget(doc, node, options);\n  var cm = doc.cm;\n  if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n  changeLine(doc, handle, \"widget\", function (line) {\n    var widgets = line.widgets || (line.widgets = []);\n    if (widget.insertAt == null) { widgets.push(widget); }\n    else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n    widget.line = line;\n    if (cm && !lineIsHidden(doc, line)) {\n      var aboveVisible = heightAtLine(line) < doc.scrollTop;\n      updateLineHeight(line, line.height + widgetHeight(widget));\n      if (aboveVisible) { addToScrollTop(cm, widget.height); }\n      cm.curOp.forceUpdate = true;\n    }\n    return true\n  });\n  signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle));\n  return widget\n}\n\n// TEXTMARKERS\n\n// Created with markText and setBookmark methods. A TextMarker is a\n// handle that can be used to clear or find a marked position in the\n// document. Line objects hold arrays (markedSpans) containing\n// {from, to, marker} object pointing to such marker objects, and\n// indicating that such a marker is present on that line. Multiple\n// lines may point to the same marker when it spans across lines.\n// The spans will have null for their from/to properties when the\n// marker continues beyond the start/end of the line. Markers have\n// links back to the lines they currently touch.\n\n// Collapsed markers have unique ids, in order to be able to order\n// them, which is needed for uniquely determining an outer marker\n// when they overlap (they may nest, but not partially overlap).\nvar nextMarkerId = 0;\n\nvar TextMarker = function(doc, type) {\n  this.lines = [];\n  this.type = type;\n  this.doc = doc;\n  this.id = ++nextMarkerId;\n};\n\n// Clear the marker.\nTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  var cm = this.doc.cm, withOp = cm && !cm.curOp;\n  if (withOp) { startOperation(cm); }\n  if (hasHandler(this, \"clear\")) {\n    var found = this.find();\n    if (found) { signalLater(this, \"clear\", found.from, found.to); }\n  }\n  var min = null, max = null;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (cm && !this$1.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n    else if (cm) {\n      if (span.to != null) { max = lineNo(line); }\n      if (span.from != null) { min = lineNo(line); }\n    }\n    line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n    if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm)\n      { updateLineHeight(line, textHeight(cm.display)); }\n  }\n  if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n    var visual = visualLine(this$1.lines[i$1]), len = lineLength(visual);\n    if (len > cm.display.maxLineLength) {\n      cm.display.maxLine = visual;\n      cm.display.maxLineLength = len;\n      cm.display.maxLineChanged = true;\n    }\n  } }\n\n  if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n  this.lines.length = 0;\n  this.explicitlyCleared = true;\n  if (this.atomic && this.doc.cantEdit) {\n    this.doc.cantEdit = false;\n    if (cm) { reCheckSelection(cm.doc); }\n  }\n  if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n  if (withOp) { endOperation(cm); }\n  if (this.parent) { this.parent.clear(); }\n};\n\n// Find the position of the marker in the document. Returns a {from,\n// to} object by default. Side can be passed to get a specific side\n// -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n// Pos objects returned contain a line object, rather than a line\n// number (used to prevent looking up the same line twice).\nTextMarker.prototype.find = function (side, lineObj) {\n    var this$1 = this;\n\n  if (side == null && this.type == \"bookmark\") { side = 1; }\n  var from, to;\n  for (var i = 0; i < this.lines.length; ++i) {\n    var line = this$1.lines[i];\n    var span = getMarkedSpanFor(line.markedSpans, this$1);\n    if (span.from != null) {\n      from = Pos(lineObj ? line : lineNo(line), span.from);\n      if (side == -1) { return from }\n    }\n    if (span.to != null) {\n      to = Pos(lineObj ? line : lineNo(line), span.to);\n      if (side == 1) { return to }\n    }\n  }\n  return from && {from: from, to: to}\n};\n\n// Signals that the marker's widget changed, and surrounding layout\n// should be recomputed.\nTextMarker.prototype.changed = function () {\n    var this$1 = this;\n\n  var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n  if (!pos || !cm) { return }\n  runInOp(cm, function () {\n    var line = pos.line, lineN = lineNo(pos.line);\n    var view = findViewForLine(cm, lineN);\n    if (view) {\n      clearLineMeasurementCacheFor(view);\n      cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n    }\n    cm.curOp.updateMaxLine = true;\n    if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n      var oldHeight = widget.height;\n      widget.height = null;\n      var dHeight = widgetHeight(widget) - oldHeight;\n      if (dHeight)\n        { updateLineHeight(line, line.height + dHeight); }\n    }\n    signalLater(cm, \"markerChanged\", cm, this$1);\n  });\n};\n\nTextMarker.prototype.attachLine = function (line) {\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;\n    if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n      { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n  }\n  this.lines.push(line);\n};\n\nTextMarker.prototype.detachLine = function (line) {\n  this.lines.splice(indexOf(this.lines, line), 1);\n  if (!this.lines.length && this.doc.cm) {\n    var op = this.doc.cm.curOp;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n  }\n};\neventMixin(TextMarker);\n\n// Create a marker, wire it up to the right lines, and\nfunction markText(doc, from, to, options, type) {\n  // Shared markers (across linked documents) are handled separately\n  // (markTextShared will call out to this again, once per\n  // document).\n  if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n  // Ensure we are in an operation.\n  if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n  var marker = new TextMarker(doc, type), diff = cmp(from, to);\n  if (options) { copyObj(options, marker, false); }\n  // Don't connect empty markers unless clearWhenEmpty is false\n  if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n    { return marker }\n  if (marker.replacedWith) {\n    // Showing up as a widget implies collapsed (widget replaces text)\n    marker.collapsed = true;\n    marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n    if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n    if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n  }\n  if (marker.collapsed) {\n    if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n        from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n      { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n    seeCollapsedSpans();\n  }\n\n  if (marker.addToHistory)\n    { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n  var curLine = from.line, cm = doc.cm, updateMaxLine;\n  doc.iter(curLine, to.line + 1, function (line) {\n    if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n      { updateMaxLine = true; }\n    if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n    addMarkedSpan(line, new MarkedSpan(marker,\n                                       curLine == from.line ? from.ch : null,\n                                       curLine == to.line ? to.ch : null));\n    ++curLine;\n  });\n  // lineIsHidden depends on the presence of the spans, so needs a second pass\n  if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n    if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n  }); }\n\n  if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n  if (marker.readOnly) {\n    seeReadOnlySpans();\n    if (doc.history.done.length || doc.history.undone.length)\n      { doc.clearHistory(); }\n  }\n  if (marker.collapsed) {\n    marker.id = ++nextMarkerId;\n    marker.atomic = true;\n  }\n  if (cm) {\n    // Sync editor state\n    if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n    if (marker.collapsed)\n      { regChange(cm, from.line, to.line + 1); }\n    else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css)\n      { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n    if (marker.atomic) { reCheckSelection(cm.doc); }\n    signalLater(cm, \"markerAdded\", cm, marker);\n  }\n  return marker\n}\n\n// SHARED TEXTMARKERS\n\n// A shared marker spans multiple linked documents. It is\n// implemented as a meta-marker-object controlling multiple normal\n// markers.\nvar SharedTextMarker = function(markers, primary) {\n  var this$1 = this;\n\n  this.markers = markers;\n  this.primary = primary;\n  for (var i = 0; i < markers.length; ++i)\n    { markers[i].parent = this$1; }\n};\n\nSharedTextMarker.prototype.clear = function () {\n    var this$1 = this;\n\n  if (this.explicitlyCleared) { return }\n  this.explicitlyCleared = true;\n  for (var i = 0; i < this.markers.length; ++i)\n    { this$1.markers[i].clear(); }\n  signalLater(this, \"clear\");\n};\n\nSharedTextMarker.prototype.find = function (side, lineObj) {\n  return this.primary.find(side, lineObj)\n};\neventMixin(SharedTextMarker);\n\nfunction markTextShared(doc, from, to, options, type) {\n  options = copyObj(options);\n  options.shared = false;\n  var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n  var widget = options.widgetNode;\n  linkedDocs(doc, function (doc) {\n    if (widget) { options.widgetNode = widget.cloneNode(true); }\n    markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n    for (var i = 0; i < doc.linked.length; ++i)\n      { if (doc.linked[i].isParent) { return } }\n    primary = lst(markers);\n  });\n  return new SharedTextMarker(markers, primary)\n}\n\nfunction findSharedMarkers(doc) {\n  return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n}\n\nfunction copySharedMarkers(doc, markers) {\n  for (var i = 0; i < markers.length; i++) {\n    var marker = markers[i], pos = marker.find();\n    var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n    if (cmp(mFrom, mTo)) {\n      var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n      marker.markers.push(subMark);\n      subMark.parent = marker;\n    }\n  }\n}\n\nfunction detachSharedMarkers(markers) {\n  var loop = function ( i ) {\n    var marker = markers[i], linked = [marker.primary.doc];\n    linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n    for (var j = 0; j < marker.markers.length; j++) {\n      var subMarker = marker.markers[j];\n      if (indexOf(linked, subMarker.doc) == -1) {\n        subMarker.parent = null;\n        marker.markers.splice(j--, 1);\n      }\n    }\n  };\n\n  for (var i = 0; i < markers.length; i++) loop( i );\n}\n\nvar nextDocId = 0;\nvar Doc = function(text, mode, firstLine, lineSep, direction) {\n  if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n  if (firstLine == null) { firstLine = 0; }\n\n  BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n  this.first = firstLine;\n  this.scrollTop = this.scrollLeft = 0;\n  this.cantEdit = false;\n  this.cleanGeneration = 1;\n  this.frontier = firstLine;\n  var start = Pos(firstLine, 0);\n  this.sel = simpleSelection(start);\n  this.history = new History(null);\n  this.id = ++nextDocId;\n  this.modeOption = mode;\n  this.lineSep = lineSep;\n  this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n  this.extend = false;\n\n  if (typeof text == \"string\") { text = this.splitLines(text); }\n  updateDoc(this, {from: start, to: start, text: text});\n  setSelection(this, simpleSelection(start), sel_dontScroll);\n};\n\nDoc.prototype = createObj(BranchChunk.prototype, {\n  constructor: Doc,\n  // Iterate over the document. Supports two forms -- with only one\n  // argument, it calls that for each line in the document. With\n  // three, it iterates over the range given by the first two (with\n  // the second being non-inclusive).\n  iter: function(from, to, op) {\n    if (op) { this.iterN(from - this.first, to - from, op); }\n    else { this.iterN(this.first, this.first + this.size, from); }\n  },\n\n  // Non-public interface for adding and removing lines.\n  insert: function(at, lines) {\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n    this.insertInner(at - this.first, lines, height);\n  },\n  remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n  // From here, the methods are part of the public interface. Most\n  // are also available from CodeMirror (editor) instances.\n\n  getValue: function(lineSep) {\n    var lines = getLines(this, this.first, this.first + this.size);\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n  setValue: docMethodOp(function(code) {\n    var top = Pos(this.first, 0), last = this.first + this.size - 1;\n    makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                      text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n    if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n    setSelection(this, simpleSelection(top), sel_dontScroll);\n  }),\n  replaceRange: function(code, from, to, origin) {\n    from = clipPos(this, from);\n    to = to ? clipPos(this, to) : from;\n    replaceRange(this, code, from, to, origin);\n  },\n  getRange: function(from, to, lineSep) {\n    var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n    if (lineSep === false) { return lines }\n    return lines.join(lineSep || this.lineSeparator())\n  },\n\n  getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n  getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n  getLineNumber: function(line) {return lineNo(line)},\n\n  getLineHandleVisualStart: function(line) {\n    if (typeof line == \"number\") { line = getLine(this, line); }\n    return visualLine(line)\n  },\n\n  lineCount: function() {return this.size},\n  firstLine: function() {return this.first},\n  lastLine: function() {return this.first + this.size - 1},\n\n  clipPos: function(pos) {return clipPos(this, pos)},\n\n  getCursor: function(start) {\n    var range$$1 = this.sel.primary(), pos;\n    if (start == null || start == \"head\") { pos = range$$1.head; }\n    else if (start == \"anchor\") { pos = range$$1.anchor; }\n    else if (start == \"end\" || start == \"to\" || start === false) { pos = range$$1.to(); }\n    else { pos = range$$1.from(); }\n    return pos\n  },\n  listSelections: function() { return this.sel.ranges },\n  somethingSelected: function() {return this.sel.somethingSelected()},\n\n  setCursor: docMethodOp(function(line, ch, options) {\n    setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n  }),\n  setSelection: docMethodOp(function(anchor, head, options) {\n    setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n  }),\n  extendSelection: docMethodOp(function(head, other, options) {\n    extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n  }),\n  extendSelections: docMethodOp(function(heads, options) {\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  extendSelectionsBy: docMethodOp(function(f, options) {\n    var heads = map(this.sel.ranges, f);\n    extendSelections(this, clipPosArray(this, heads), options);\n  }),\n  setSelections: docMethodOp(function(ranges, primary, options) {\n    var this$1 = this;\n\n    if (!ranges.length) { return }\n    var out = [];\n    for (var i = 0; i < ranges.length; i++)\n      { out[i] = new Range(clipPos(this$1, ranges[i].anchor),\n                         clipPos(this$1, ranges[i].head)); }\n    if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n    setSelection(this, normalizeSelection(out, primary), options);\n  }),\n  addSelection: docMethodOp(function(anchor, head, options) {\n    var ranges = this.sel.ranges.slice(0);\n    ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n    setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n  }),\n\n  getSelection: function(lineSep) {\n    var this$1 = this;\n\n    var ranges = this.sel.ranges, lines;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      lines = lines ? lines.concat(sel) : sel;\n    }\n    if (lineSep === false) { return lines }\n    else { return lines.join(lineSep || this.lineSeparator()) }\n  },\n  getSelections: function(lineSep) {\n    var this$1 = this;\n\n    var parts = [], ranges = this.sel.ranges;\n    for (var i = 0; i < ranges.length; i++) {\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to());\n      if (lineSep !== false) { sel = sel.join(lineSep || this$1.lineSeparator()); }\n      parts[i] = sel;\n    }\n    return parts\n  },\n  replaceSelection: function(code, collapse, origin) {\n    var dup = [];\n    for (var i = 0; i < this.sel.ranges.length; i++)\n      { dup[i] = code; }\n    this.replaceSelections(dup, collapse, origin || \"+input\");\n  },\n  replaceSelections: docMethodOp(function(code, collapse, origin) {\n    var this$1 = this;\n\n    var changes = [], sel = this.sel;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range$$1 = sel.ranges[i];\n      changes[i] = {from: range$$1.from(), to: range$$1.to(), text: this$1.splitLines(code[i]), origin: origin};\n    }\n    var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n    for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n      { makeChange(this$1, changes[i$1]); }\n    if (newSel) { setSelectionReplaceHistory(this, newSel); }\n    else if (this.cm) { ensureCursorVisible(this.cm); }\n  }),\n  undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n  redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n  undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n  redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n  setExtending: function(val) {this.extend = val;},\n  getExtending: function() {return this.extend},\n\n  historySize: function() {\n    var hist = this.history, done = 0, undone = 0;\n    for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n    for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n    return {undo: done, redo: undone}\n  },\n  clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n  markClean: function() {\n    this.cleanGeneration = this.changeGeneration(true);\n  },\n  changeGeneration: function(forceSplit) {\n    if (forceSplit)\n      { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n    return this.history.generation\n  },\n  isClean: function (gen) {\n    return this.history.generation == (gen || this.cleanGeneration)\n  },\n\n  getHistory: function() {\n    return {done: copyHistoryArray(this.history.done),\n            undone: copyHistoryArray(this.history.undone)}\n  },\n  setHistory: function(histData) {\n    var hist = this.history = new History(this.history.maxGeneration);\n    hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n    hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n  },\n\n  setGutterMarker: docMethodOp(function(line, gutterID, value) {\n    return changeLine(this, line, \"gutter\", function (line) {\n      var markers = line.gutterMarkers || (line.gutterMarkers = {});\n      markers[gutterID] = value;\n      if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n      return true\n    })\n  }),\n\n  clearGutter: docMethodOp(function(gutterID) {\n    var this$1 = this;\n\n    this.iter(function (line) {\n      if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n        changeLine(this$1, line, \"gutter\", function () {\n          line.gutterMarkers[gutterID] = null;\n          if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n          return true\n        });\n      }\n    });\n  }),\n\n  lineInfo: function(line) {\n    var n;\n    if (typeof line == \"number\") {\n      if (!isLine(this, line)) { return null }\n      n = line;\n      line = getLine(this, line);\n      if (!line) { return null }\n    } else {\n      n = lineNo(line);\n      if (n == null) { return null }\n    }\n    return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n            textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n            widgets: line.widgets}\n  },\n\n  addLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      if (!line[prop]) { line[prop] = cls; }\n      else if (classTest(cls).test(line[prop])) { return false }\n      else { line[prop] += \" \" + cls; }\n      return true\n    })\n  }),\n  removeLineClass: docMethodOp(function(handle, where, cls) {\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n      var prop = where == \"text\" ? \"textClass\"\n               : where == \"background\" ? \"bgClass\"\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n      var cur = line[prop];\n      if (!cur) { return false }\n      else if (cls == null) { line[prop] = null; }\n      else {\n        var found = cur.match(classTest(cls));\n        if (!found) { return false }\n        var end = found.index + found[0].length;\n        line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n      }\n      return true\n    })\n  }),\n\n  addLineWidget: docMethodOp(function(handle, node, options) {\n    return addLineWidget(this, handle, node, options)\n  }),\n  removeLineWidget: function(widget) { widget.clear(); },\n\n  markText: function(from, to, options) {\n    return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n  },\n  setBookmark: function(pos, options) {\n    var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                    insertLeft: options && options.insertLeft,\n                    clearWhenEmpty: false, shared: options && options.shared,\n                    handleMouseEvents: options && options.handleMouseEvents};\n    pos = clipPos(this, pos);\n    return markText(this, pos, pos, realOpts, \"bookmark\")\n  },\n  findMarksAt: function(pos) {\n    pos = clipPos(this, pos);\n    var markers = [], spans = getLine(this, pos.line).markedSpans;\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if ((span.from == null || span.from <= pos.ch) &&\n          (span.to == null || span.to >= pos.ch))\n        { markers.push(span.marker.parent || span.marker); }\n    } }\n    return markers\n  },\n  findMarks: function(from, to, filter) {\n    from = clipPos(this, from); to = clipPos(this, to);\n    var found = [], lineNo$$1 = from.line;\n    this.iter(from.line, to.line + 1, function (line) {\n      var spans = line.markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; i++) {\n        var span = spans[i];\n        if (!(span.to != null && lineNo$$1 == from.line && from.ch >= span.to ||\n              span.from == null && lineNo$$1 != from.line ||\n              span.from != null && lineNo$$1 == to.line && span.from >= to.ch) &&\n            (!filter || filter(span.marker)))\n          { found.push(span.marker.parent || span.marker); }\n      } }\n      ++lineNo$$1;\n    });\n    return found\n  },\n  getAllMarks: function() {\n    var markers = [];\n    this.iter(function (line) {\n      var sps = line.markedSpans;\n      if (sps) { for (var i = 0; i < sps.length; ++i)\n        { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n    });\n    return markers\n  },\n\n  posFromIndex: function(off) {\n    var ch, lineNo$$1 = this.first, sepSize = this.lineSeparator().length;\n    this.iter(function (line) {\n      var sz = line.text.length + sepSize;\n      if (sz > off) { ch = off; return true }\n      off -= sz;\n      ++lineNo$$1;\n    });\n    return clipPos(this, Pos(lineNo$$1, ch))\n  },\n  indexFromPos: function (coords) {\n    coords = clipPos(this, coords);\n    var index = coords.ch;\n    if (coords.line < this.first || coords.ch < 0) { return 0 }\n    var sepSize = this.lineSeparator().length;\n    this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n      index += line.text.length + sepSize;\n    });\n    return index\n  },\n\n  copy: function(copyHistory) {\n    var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                      this.modeOption, this.first, this.lineSep, this.direction);\n    doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n    doc.sel = this.sel;\n    doc.extend = false;\n    if (copyHistory) {\n      doc.history.undoDepth = this.history.undoDepth;\n      doc.setHistory(this.getHistory());\n    }\n    return doc\n  },\n\n  linkedDoc: function(options) {\n    if (!options) { options = {}; }\n    var from = this.first, to = this.first + this.size;\n    if (options.from != null && options.from > from) { from = options.from; }\n    if (options.to != null && options.to < to) { to = options.to; }\n    var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n    if (options.sharedHist) { copy.history = this.history\n    ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n    copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n    copySharedMarkers(copy, findSharedMarkers(this));\n    return copy\n  },\n  unlinkDoc: function(other) {\n    var this$1 = this;\n\n    if (other instanceof CodeMirror$1) { other = other.doc; }\n    if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n      var link = this$1.linked[i];\n      if (link.doc != other) { continue }\n      this$1.linked.splice(i, 1);\n      other.unlinkDoc(this$1);\n      detachSharedMarkers(findSharedMarkers(this$1));\n      break\n    } }\n    // If the histories were shared, split them again\n    if (other.history == this.history) {\n      var splitIds = [other.id];\n      linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n      other.history = new History(null);\n      other.history.done = copyHistoryArray(this.history.done, splitIds);\n      other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n    }\n  },\n  iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n  getMode: function() {return this.mode},\n  getEditor: function() {return this.cm},\n\n  splitLines: function(str) {\n    if (this.lineSep) { return str.split(this.lineSep) }\n    return splitLinesAuto(str)\n  },\n  lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n  setDirection: docMethodOp(function (dir) {\n    if (dir != \"rtl\") { dir = \"ltr\"; }\n    if (dir == this.direction) { return }\n    this.direction = dir;\n    this.iter(function (line) { return line.order = null; });\n    if (this.cm) { directionChanged(this.cm); }\n  })\n});\n\n// Public alias.\nDoc.prototype.eachLine = Doc.prototype.iter;\n\n// Kludge to work around strange IE behavior where it'll sometimes\n// re-fire a series of drag-related events right after the drop (#1551)\nvar lastDrop = 0;\n\nfunction onDrop(e) {\n  var cm = this;\n  clearDragCursor(cm);\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n    { return }\n  e_preventDefault(e);\n  if (ie) { lastDrop = +new Date; }\n  var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n  if (!pos || cm.isReadOnly()) { return }\n  // Might be a file drop, in which case we simply extract the text\n  // and insert it.\n  if (files && files.length && window.FileReader && window.File) {\n    var n = files.length, text = Array(n), read = 0;\n    var loadFile = function (file, i) {\n      if (cm.options.allowDropFileTypes &&\n          indexOf(cm.options.allowDropFileTypes, file.type) == -1)\n        { return }\n\n      var reader = new FileReader;\n      reader.onload = operation(cm, function () {\n        var content = reader.result;\n        if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) { content = \"\"; }\n        text[i] = content;\n        if (++read == n) {\n          pos = clipPos(cm.doc, pos);\n          var change = {from: pos, to: pos,\n                        text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                        origin: \"paste\"};\n          makeChange(cm.doc, change);\n          setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n        }\n      });\n      reader.readAsText(file);\n    };\n    for (var i = 0; i < n; ++i) { loadFile(files[i], i); }\n  } else { // Normal drop\n    // Don't do a replace if the drop happened inside of the selected text.\n    if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n      cm.state.draggingText(e);\n      // Ensure the editor is re-focused\n      setTimeout(function () { return cm.display.input.focus(); }, 20);\n      return\n    }\n    try {\n      var text$1 = e.dataTransfer.getData(\"Text\");\n      if (text$1) {\n        var selected;\n        if (cm.state.draggingText && !cm.state.draggingText.copy)\n          { selected = cm.listSelections(); }\n        setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n        if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n          { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n        cm.replaceSelection(text$1, \"around\", \"paste\");\n        cm.display.input.focus();\n      }\n    }\n    catch(e){}\n  }\n}\n\nfunction onDragStart(cm, e) {\n  if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n  e.dataTransfer.setData(\"Text\", cm.getSelection());\n  e.dataTransfer.effectAllowed = \"copyMove\";\n\n  // Use dummy image instead of default browsers image.\n  // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n  if (e.dataTransfer.setDragImage && !safari) {\n    var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n    img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n    if (presto) {\n      img.width = img.height = 1;\n      cm.display.wrapper.appendChild(img);\n      // Force a relayout, or Opera won't use our image for some obscure reason\n      img._top = img.offsetTop;\n    }\n    e.dataTransfer.setDragImage(img, 0, 0);\n    if (presto) { img.parentNode.removeChild(img); }\n  }\n}\n\nfunction onDragOver(cm, e) {\n  var pos = posFromMouse(cm, e);\n  if (!pos) { return }\n  var frag = document.createDocumentFragment();\n  drawSelectionCursor(cm, pos, frag);\n  if (!cm.display.dragCursor) {\n    cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n    cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n  }\n  removeChildrenAndAdd(cm.display.dragCursor, frag);\n}\n\nfunction clearDragCursor(cm) {\n  if (cm.display.dragCursor) {\n    cm.display.lineSpace.removeChild(cm.display.dragCursor);\n    cm.display.dragCursor = null;\n  }\n}\n\n// These must be handled carefully, because naively registering a\n// handler for each editor will cause the editors to never be\n// garbage collected.\n\nfunction forEachCodeMirror(f) {\n  if (!document.body.getElementsByClassName) { return }\n  var byClass = document.body.getElementsByClassName(\"CodeMirror\");\n  for (var i = 0; i < byClass.length; i++) {\n    var cm = byClass[i].CodeMirror;\n    if (cm) { f(cm); }\n  }\n}\n\nvar globalsRegistered = false;\nfunction ensureGlobalHandlers() {\n  if (globalsRegistered) { return }\n  registerGlobalHandlers();\n  globalsRegistered = true;\n}\nfunction registerGlobalHandlers() {\n  // When the window resizes, we need to refresh active editors.\n  var resizeTimer;\n  on(window, \"resize\", function () {\n    if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n      resizeTimer = null;\n      forEachCodeMirror(onResize);\n    }, 100); }\n  });\n  // When the window loses focus, we want to show the editor as blurred\n  on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n}\n// Called when the window resizes\nfunction onResize(cm) {\n  var d = cm.display;\n  if (d.lastWrapHeight == d.wrapper.clientHeight && d.lastWrapWidth == d.wrapper.clientWidth)\n    { return }\n  // Might be a text scaling operation, clear size caches.\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n  d.scrollbarsClipped = false;\n  cm.setSize();\n}\n\nvar keyNames = {\n  3: \"Enter\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n  19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n  36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n  46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n  106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 127: \"Delete\",\n  173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n  221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n  63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n};\n\n// Number keys\nfor (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n// Alphabetic keys\nfor (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n// Function keys\nfor (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\nvar keyMap = {};\n\nkeyMap.basic = {\n  \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n  \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n  \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n  \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n  \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n  \"Esc\": \"singleSelection\"\n};\n// Note that the save and find-related commands aren't defined by\n// default. User code or addons can define them. Unknown commands\n// are simply ignored.\nkeyMap.pcDefault = {\n  \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n  \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n  \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n  \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n  \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n  \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n  \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n  fallthrough: \"basic\"\n};\n// Very basic readline/emacs-style bindings, which are standard on Mac.\nkeyMap.emacsy = {\n  \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n  \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n  \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n  \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n  \"Ctrl-O\": \"openLine\"\n};\nkeyMap.macDefault = {\n  \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n  \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n  \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n  \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n  \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n  \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n  \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n  fallthrough: [\"basic\", \"emacsy\"]\n};\nkeyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n// KEYMAP DISPATCH\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/);\n  name = parts[parts.length - 1];\n  var alt, ctrl, shift, cmd;\n  for (var i = 0; i < parts.length - 1; i++) {\n    var mod = parts[i];\n    if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n    else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n    else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n    else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n    else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n  }\n  if (alt) { name = \"Alt-\" + name; }\n  if (ctrl) { name = \"Ctrl-\" + name; }\n  if (cmd) { name = \"Cmd-\" + name; }\n  if (shift) { name = \"Shift-\" + name; }\n  return name\n}\n\n// This is a kludge to keep keymaps mostly working as raw objects\n// (backwards compatibility) while at the same time support features\n// like normalization and multi-stroke key bindings. It compiles a\n// new normalized keymap, and then updates the old object to reflect\n// this.\nfunction normalizeKeyMap(keymap) {\n  var copy = {};\n  for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n    var value = keymap[keyname];\n    if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n    if (value == \"...\") { delete keymap[keyname]; continue }\n\n    var keys = map(keyname.split(\" \"), normalizeKeyName);\n    for (var i = 0; i < keys.length; i++) {\n      var val = (void 0), name = (void 0);\n      if (i == keys.length - 1) {\n        name = keys.join(\" \");\n        val = value;\n      } else {\n        name = keys.slice(0, i + 1).join(\" \");\n        val = \"...\";\n      }\n      var prev = copy[name];\n      if (!prev) { copy[name] = val; }\n      else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n    }\n    delete keymap[keyname];\n  } }\n  for (var prop in copy) { keymap[prop] = copy[prop]; }\n  return keymap\n}\n\nfunction lookupKey(key, map$$1, handle, context) {\n  map$$1 = getKeyMap(map$$1);\n  var found = map$$1.call ? map$$1.call(key, context) : map$$1[key];\n  if (found === false) { return \"nothing\" }\n  if (found === \"...\") { return \"multi\" }\n  if (found != null && handle(found)) { return \"handled\" }\n\n  if (map$$1.fallthrough) {\n    if (Object.prototype.toString.call(map$$1.fallthrough) != \"[object Array]\")\n      { return lookupKey(key, map$$1.fallthrough, handle, context) }\n    for (var i = 0; i < map$$1.fallthrough.length; i++) {\n      var result = lookupKey(key, map$$1.fallthrough[i], handle, context);\n      if (result) { return result }\n    }\n  }\n}\n\n// Modifier key presses don't count as 'real' key presses for the\n// purpose of keymap fallthrough.\nfunction isModifierKey(value) {\n  var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n  return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n}\n\n// Look up the name of a key as indicated by an event object.\nfunction keyName(event, noShift) {\n  if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n  var base = keyNames[event.keyCode], name = base;\n  if (name == null || event.altGraphKey) { return false }\n  if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n  if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n  if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n  if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n  return name\n}\n\nfunction getKeyMap(val) {\n  return typeof val == \"string\" ? keyMap[val] : val\n}\n\n// Helper for deleting text near the selection(s), used to implement\n// backspace, delete, and similar functionality.\nfunction deleteNearSelection(cm, compute) {\n  var ranges = cm.doc.sel.ranges, kill = [];\n  // Build up a set of ranges to kill first, merging overlapping\n  // ranges.\n  for (var i = 0; i < ranges.length; i++) {\n    var toKill = compute(ranges[i]);\n    while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n      var replaced = kill.pop();\n      if (cmp(replaced.from, toKill.from) < 0) {\n        toKill.from = replaced.from;\n        break\n      }\n    }\n    kill.push(toKill);\n  }\n  // Next, remove those actual ranges.\n  runInOp(cm, function () {\n    for (var i = kill.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n    ensureCursorVisible(cm);\n  });\n}\n\n// Commands are parameter-less actions that can be performed on an\n// editor, mostly used for keybindings.\nvar commands = {\n  selectAll: selectAll,\n  singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n  killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n    if (range.empty()) {\n      var len = getLine(cm.doc, range.head.line).text.length;\n      if (range.head.ch == len && range.head.line < cm.lastLine())\n        { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n      else\n        { return {from: range.head, to: Pos(range.head.line, len)} }\n    } else {\n      return {from: range.from(), to: range.to()}\n    }\n  }); },\n  deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0),\n    to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n  }); }); },\n  delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n    from: Pos(range.from().line, 0), to: range.from()\n  }); }); },\n  delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n    return {from: leftPos, to: range.from()}\n  }); },\n  delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n    return {from: range.from(), to: rightPos }\n  }); },\n  undo: function (cm) { return cm.undo(); },\n  redo: function (cm) { return cm.redo(); },\n  undoSelection: function (cm) { return cm.undoSelection(); },\n  redoSelection: function (cm) { return cm.redoSelection(); },\n  goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n  goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n  goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n    {origin: \"+move\", bias: 1}\n  ); },\n  goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n    {origin: \"+move\", bias: -1}\n  ); },\n  goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    return cm.coordsChar({left: 0, top: top}, \"div\")\n  }, sel_move); },\n  goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n    var top = cm.charCoords(range.head, \"div\").top + 5;\n    var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n    if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n    return pos\n  }, sel_move); },\n  goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n  goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n  goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n  goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n  goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n  goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n  goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n  goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n  goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n  goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n  goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n  goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n  delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n  delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n  delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n  delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n  delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n  delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n  indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n  indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n  indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n  insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n  insertSoftTab: function (cm) {\n    var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n    for (var i = 0; i < ranges.length; i++) {\n      var pos = ranges[i].from();\n      var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n      spaces.push(spaceStr(tabSize - col % tabSize));\n    }\n    cm.replaceSelections(spaces);\n  },\n  defaultTab: function (cm) {\n    if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n    else { cm.execCommand(\"insertTab\"); }\n  },\n  // Swap the two chars left and right of each selection's head.\n  // Move cursor behind the two swapped characters afterwards.\n  //\n  // Doesn't consider line feeds a character.\n  // Doesn't scan more than one line above to find a character.\n  // Doesn't do anything on an empty line.\n  // Doesn't do anything with non-empty selections.\n  transposeChars: function (cm) { return runInOp(cm, function () {\n    var ranges = cm.listSelections(), newSel = [];\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) { continue }\n      var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n      if (line) {\n        if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n        if (cur.ch > 0) {\n          cur = new Pos(cur.line, cur.ch + 1);\n          cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                          Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n        } else if (cur.line > cm.doc.first) {\n          var prev = getLine(cm.doc, cur.line - 1).text;\n          if (prev) {\n            cur = new Pos(cur.line, 1);\n            cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                            prev.charAt(prev.length - 1),\n                            Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n          }\n        }\n      }\n      newSel.push(new Range(cur, cur));\n    }\n    cm.setSelections(newSel);\n  }); },\n  newlineAndIndent: function (cm) { return runInOp(cm, function () {\n    var sels = cm.listSelections();\n    for (var i = sels.length - 1; i >= 0; i--)\n      { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n    sels = cm.listSelections();\n    for (var i$1 = 0; i$1 < sels.length; i$1++)\n      { cm.indentLine(sels[i$1].from().line, null, true); }\n    ensureCursorVisible(cm);\n  }); },\n  openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n  toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n};\n\n\nfunction lineStart(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLine(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, visual, lineN, 1)\n}\nfunction lineEnd(cm, lineN) {\n  var line = getLine(cm.doc, lineN);\n  var visual = visualLineEnd(line);\n  if (visual != line) { lineN = lineNo(visual); }\n  return endOfLine(true, cm, line, lineN, -1)\n}\nfunction lineStartSmart(cm, pos) {\n  var start = lineStart(cm, pos.line);\n  var line = getLine(cm.doc, start.line);\n  var order = getOrder(line, cm.doc.direction);\n  if (!order || order[0].level == 0) {\n    var firstNonWS = Math.max(0, line.text.search(/\\S/));\n    var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n    return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n  }\n  return start\n}\n\n// Run a handler that was bound to a key.\nfunction doHandleBinding(cm, bound, dropShift) {\n  if (typeof bound == \"string\") {\n    bound = commands[bound];\n    if (!bound) { return false }\n  }\n  // Ensure previous input has been read, so that the handler sees a\n  // consistent view of the document\n  cm.display.input.ensurePolled();\n  var prevShift = cm.display.shift, done = false;\n  try {\n    if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n    if (dropShift) { cm.display.shift = false; }\n    done = bound(cm) != Pass;\n  } finally {\n    cm.display.shift = prevShift;\n    cm.state.suppressEdits = false;\n  }\n  return done\n}\n\nfunction lookupKeyForEditor(cm, name, handle) {\n  for (var i = 0; i < cm.state.keyMaps.length; i++) {\n    var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n    if (result) { return result }\n  }\n  return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n    || lookupKey(name, cm.options.keyMap, handle, cm)\n}\n\nvar stopSeq = new Delayed;\nfunction dispatchKey(cm, name, e, handle) {\n  var seq = cm.state.keySeq;\n  if (seq) {\n    if (isModifierKey(name)) { return \"handled\" }\n    stopSeq.set(50, function () {\n      if (cm.state.keySeq == seq) {\n        cm.state.keySeq = null;\n        cm.display.input.reset();\n      }\n    });\n    name = seq + \" \" + name;\n  }\n  var result = lookupKeyForEditor(cm, name, handle);\n\n  if (result == \"multi\")\n    { cm.state.keySeq = name; }\n  if (result == \"handled\")\n    { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n  if (result == \"handled\" || result == \"multi\") {\n    e_preventDefault(e);\n    restartBlink(cm);\n  }\n\n  if (seq && !result && /\\'$/.test(name)) {\n    e_preventDefault(e);\n    return true\n  }\n  return !!result\n}\n\n// Handle a key from the keydown event.\nfunction handleKeyBinding(cm, e) {\n  var name = keyName(e, true);\n  if (!name) { return false }\n\n  if (e.shiftKey && !cm.state.keySeq) {\n    // First try to resolve full name (including 'Shift-'). Failing\n    // that, see if there is a cursor-motion command (starting with\n    // 'go') bound to the keyname without 'Shift-'.\n    return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n        || dispatchKey(cm, name, e, function (b) {\n             if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n               { return doHandleBinding(cm, b) }\n           })\n  } else {\n    return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n  }\n}\n\n// Handle a key from the keypress event\nfunction handleCharBinding(cm, e, ch) {\n  return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n}\n\nvar lastStoppedKey = null;\nfunction onKeyDown(e) {\n  var cm = this;\n  cm.curOp.focus = activeElt();\n  if (signalDOMEvent(cm, e)) { return }\n  // IE does strange things with escape.\n  if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n  var code = e.keyCode;\n  cm.display.shift = code == 16 || e.shiftKey;\n  var handled = handleKeyBinding(cm, e);\n  if (presto) {\n    lastStoppedKey = handled ? code : null;\n    // Opera has no cut event... we try to at least catch the key combo\n    if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n      { cm.replaceSelection(\"\", null, \"cut\"); }\n  }\n\n  // Turn mouse into crosshair when Alt is held on Mac.\n  if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n    { showCrossHair(cm); }\n}\n\nfunction showCrossHair(cm) {\n  var lineDiv = cm.display.lineDiv;\n  addClass(lineDiv, \"CodeMirror-crosshair\");\n\n  function up(e) {\n    if (e.keyCode == 18 || !e.altKey) {\n      rmClass(lineDiv, \"CodeMirror-crosshair\");\n      off(document, \"keyup\", up);\n      off(document, \"mouseover\", up);\n    }\n  }\n  on(document, \"keyup\", up);\n  on(document, \"mouseover\", up);\n}\n\nfunction onKeyUp(e) {\n  if (e.keyCode == 16) { this.doc.sel.shift = false; }\n  signalDOMEvent(this, e);\n}\n\nfunction onKeyPress(e) {\n  var cm = this;\n  if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n  var keyCode = e.keyCode, charCode = e.charCode;\n  if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n  if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n  var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n  // Some browsers fire keypress events for backspace\n  if (ch == \"\\x08\") { return }\n  if (handleCharBinding(cm, e, ch)) { return }\n  cm.display.input.onKeyPress(e);\n}\n\n// A mouse down can be a single click, double click, triple click,\n// start of selection drag, start of text drag, new cursor\n// (ctrl-click), rectangle drag (alt-drag), or xwin\n// middle-click-paste. Or it might be a click on something we should\n// not interfere with, such as a scrollbar or widget.\nfunction onMouseDown(e) {\n  var cm = this, display = cm.display;\n  if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n  display.input.ensurePolled();\n  display.shift = e.shiftKey;\n\n  if (eventInWidget(display, e)) {\n    if (!webkit) {\n      // Briefly turn off draggability, to allow widgets to do\n      // normal dragging things.\n      display.scroller.draggable = false;\n      setTimeout(function () { return display.scroller.draggable = true; }, 100);\n    }\n    return\n  }\n  if (clickInGutter(cm, e)) { return }\n  var start = posFromMouse(cm, e);\n  window.focus();\n\n  switch (e_button(e)) {\n  case 1:\n    // #3261: make sure, that we're not starting a second selection\n    if (cm.state.selectingText)\n      { cm.state.selectingText(e); }\n    else if (start)\n      { leftButtonDown(cm, e, start); }\n    else if (e_target(e) == display.scroller)\n      { e_preventDefault(e); }\n    break\n  case 2:\n    if (webkit) { cm.state.lastMiddleDown = +new Date; }\n    if (start) { extendSelection(cm.doc, start); }\n    setTimeout(function () { return display.input.focus(); }, 20);\n    e_preventDefault(e);\n    break\n  case 3:\n    if (captureRightClick) { onContextMenu(cm, e); }\n    else { delayBlurEvent(cm); }\n    break\n  }\n}\n\nvar lastClick;\nvar lastDoubleClick;\nfunction leftButtonDown(cm, e, start) {\n  if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n  else { cm.curOp.focus = activeElt(); }\n\n  var now = +new Date, type;\n  if (lastDoubleClick && lastDoubleClick.time > now - 400 && cmp(lastDoubleClick.pos, start) == 0) {\n    type = \"triple\";\n  } else if (lastClick && lastClick.time > now - 400 && cmp(lastClick.pos, start) == 0) {\n    type = \"double\";\n    lastDoubleClick = {time: now, pos: start};\n  } else {\n    type = \"single\";\n    lastClick = {time: now, pos: start};\n  }\n\n  var sel = cm.doc.sel, modifier = mac ? e.metaKey : e.ctrlKey, contained;\n  if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n      type == \"single\" && (contained = sel.contains(start)) > -1 &&\n      (cmp((contained = sel.ranges[contained]).from(), start) < 0 || start.xRel > 0) &&\n      (cmp(contained.to(), start) > 0 || start.xRel < 0))\n    { leftButtonStartDrag(cm, e, start, modifier); }\n  else\n    { leftButtonSelect(cm, e, start, type, modifier); }\n}\n\n// Start a text drag. When it ends, see if any dragging actually\n// happen, and treat as a click if it didn't.\nfunction leftButtonStartDrag(cm, e, start, modifier) {\n  var display = cm.display, moved = false;\n  var dragEnd = operation(cm, function (e) {\n    if (webkit) { display.scroller.draggable = false; }\n    cm.state.draggingText = false;\n    off(document, \"mouseup\", dragEnd);\n    off(document, \"mousemove\", mouseMove);\n    off(display.scroller, \"dragstart\", dragStart);\n    off(display.scroller, \"drop\", dragEnd);\n    if (!moved) {\n      e_preventDefault(e);\n      if (!modifier)\n        { extendSelection(cm.doc, start); }\n      // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n      if (webkit || ie && ie_version == 9)\n        { setTimeout(function () {document.body.focus(); display.input.focus();}, 20); }\n      else\n        { display.input.focus(); }\n    }\n  });\n  var mouseMove = function(e2) {\n    moved = moved || Math.abs(e.clientX - e2.clientX) + Math.abs(e.clientY - e2.clientY) >= 10;\n  };\n  var dragStart = function () { return moved = true; };\n  // Let the drag handler handle this.\n  if (webkit) { display.scroller.draggable = true; }\n  cm.state.draggingText = dragEnd;\n  dragEnd.copy = mac ? e.altKey : e.ctrlKey;\n  // IE's approach to draggable\n  if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n  on(document, \"mouseup\", dragEnd);\n  on(document, \"mousemove\", mouseMove);\n  on(display.scroller, \"dragstart\", dragStart);\n  on(display.scroller, \"drop\", dragEnd);\n\n  delayBlurEvent(cm);\n  setTimeout(function () { return display.input.focus(); }, 20);\n}\n\n// Normal selection, as opposed to text dragging.\nfunction leftButtonSelect(cm, e, start, type, addNew) {\n  var display = cm.display, doc = cm.doc;\n  e_preventDefault(e);\n\n  var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n  if (addNew && !e.shiftKey) {\n    ourIndex = doc.sel.contains(start);\n    if (ourIndex > -1)\n      { ourRange = ranges[ourIndex]; }\n    else\n      { ourRange = new Range(start, start); }\n  } else {\n    ourRange = doc.sel.primary();\n    ourIndex = doc.sel.primIndex;\n  }\n\n  if (chromeOS ? e.shiftKey && e.metaKey : e.altKey) {\n    type = \"rect\";\n    if (!addNew) { ourRange = new Range(start, start); }\n    start = posFromMouse(cm, e, true, true);\n    ourIndex = -1;\n  } else if (type == \"double\") {\n    var word = cm.findWordAt(start);\n    if (cm.display.shift || doc.extend)\n      { ourRange = extendRange(doc, ourRange, word.anchor, word.head); }\n    else\n      { ourRange = word; }\n  } else if (type == \"triple\") {\n    var line = new Range(Pos(start.line, 0), clipPos(doc, Pos(start.line + 1, 0)));\n    if (cm.display.shift || doc.extend)\n      { ourRange = extendRange(doc, ourRange, line.anchor, line.head); }\n    else\n      { ourRange = line; }\n  } else {\n    ourRange = extendRange(doc, ourRange, start);\n  }\n\n  if (!addNew) {\n    ourIndex = 0;\n    setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n    startSel = doc.sel;\n  } else if (ourIndex == -1) {\n    ourIndex = ranges.length;\n    setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex),\n                 {scroll: false, origin: \"*mouse\"});\n  } else if (ranges.length > 1 && ranges[ourIndex].empty() && type == \"single\" && !e.shiftKey) {\n    setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                 {scroll: false, origin: \"*mouse\"});\n    startSel = doc.sel;\n  } else {\n    replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n  }\n\n  var lastPos = start;\n  function extendTo(pos) {\n    if (cmp(lastPos, pos) == 0) { return }\n    lastPos = pos;\n\n    if (type == \"rect\") {\n      var ranges = [], tabSize = cm.options.tabSize;\n      var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n      var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n      var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n      for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n           line <= end; line++) {\n        var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n        if (left == right)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n        else if (text.length > leftPos)\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n      }\n      if (!ranges.length) { ranges.push(new Range(start, start)); }\n      setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                   {origin: \"*mouse\", scroll: false});\n      cm.scrollIntoView(pos);\n    } else {\n      var oldRange = ourRange;\n      var anchor = oldRange.anchor, head = pos;\n      if (type != \"single\") {\n        var range$$1;\n        if (type == \"double\")\n          { range$$1 = cm.findWordAt(pos); }\n        else\n          { range$$1 = new Range(Pos(pos.line, 0), clipPos(doc, Pos(pos.line + 1, 0))); }\n        if (cmp(range$$1.anchor, anchor) > 0) {\n          head = range$$1.head;\n          anchor = minPos(oldRange.from(), range$$1.anchor);\n        } else {\n          head = range$$1.anchor;\n          anchor = maxPos(oldRange.to(), range$$1.head);\n        }\n      }\n      var ranges$1 = startSel.ranges.slice(0);\n      ranges$1[ourIndex] = new Range(clipPos(doc, anchor), head);\n      setSelection(doc, normalizeSelection(ranges$1, ourIndex), sel_mouse);\n    }\n  }\n\n  var editorSize = display.wrapper.getBoundingClientRect();\n  // Used to ensure timeout re-tries don't fire when another extend\n  // happened in the meantime (clearTimeout isn't reliable -- at\n  // least on Chrome, the timeouts still happen even when cleared,\n  // if the clear happens after their scheduled firing time).\n  var counter = 0;\n\n  function extend(e) {\n    var curCount = ++counter;\n    var cur = posFromMouse(cm, e, true, type == \"rect\");\n    if (!cur) { return }\n    if (cmp(cur, lastPos) != 0) {\n      cm.curOp.focus = activeElt();\n      extendTo(cur);\n      var visible = visibleLines(display, doc);\n      if (cur.line >= visible.to || cur.line < visible.from)\n        { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n    } else {\n      var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n      if (outside) { setTimeout(operation(cm, function () {\n        if (counter != curCount) { return }\n        display.scroller.scrollTop += outside;\n        extend(e);\n      }), 50); }\n    }\n  }\n\n  function done(e) {\n    cm.state.selectingText = false;\n    counter = Infinity;\n    e_preventDefault(e);\n    display.input.focus();\n    off(document, \"mousemove\", move);\n    off(document, \"mouseup\", up);\n    doc.history.lastSelOrigin = null;\n  }\n\n  var move = operation(cm, function (e) {\n    if (!e_button(e)) { done(e); }\n    else { extend(e); }\n  });\n  var up = operation(cm, done);\n  cm.state.selectingText = up;\n  on(document, \"mousemove\", move);\n  on(document, \"mouseup\", up);\n}\n\n\n// Determines whether an event happened in the gutter, and fires the\n// handlers for the corresponding event.\nfunction gutterEvent(cm, e, type, prevent) {\n  var mX, mY;\n  try { mX = e.clientX; mY = e.clientY; }\n  catch(e) { return false }\n  if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n  if (prevent) { e_preventDefault(e); }\n\n  var display = cm.display;\n  var lineBox = display.lineDiv.getBoundingClientRect();\n\n  if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n  mY -= lineBox.top - display.viewOffset;\n\n  for (var i = 0; i < cm.options.gutters.length; ++i) {\n    var g = display.gutters.childNodes[i];\n    if (g && g.getBoundingClientRect().right >= mX) {\n      var line = lineAtHeight(cm.doc, mY);\n      var gutter = cm.options.gutters[i];\n      signal(cm, type, cm, line, gutter, e);\n      return e_defaultPrevented(e)\n    }\n  }\n}\n\nfunction clickInGutter(cm, e) {\n  return gutterEvent(cm, e, \"gutterClick\", true)\n}\n\n// CONTEXT MENU HANDLING\n\n// To make the context menu work, we need to briefly unhide the\n// textarea (making it as unobtrusive as possible) to let the\n// right-click take effect on it.\nfunction onContextMenu(cm, e) {\n  if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n  if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n  cm.display.input.onContextMenu(e);\n}\n\nfunction contextMenuInGutter(cm, e) {\n  if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n  return gutterEvent(cm, e, \"gutterContextMenu\", false)\n}\n\nfunction themeChanged(cm) {\n  cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n    cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n  clearCaches(cm);\n}\n\nvar Init = {toString: function(){return \"CodeMirror.Init\"}};\n\nvar defaults = {};\nvar optionHandlers = {};\n\nfunction defineOptions(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  function option(name, deflt, handle, notOnInit) {\n    CodeMirror.defaults[name] = deflt;\n    if (handle) { optionHandlers[name] =\n      notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n  }\n\n  CodeMirror.defineOption = option;\n\n  // Passed to option handlers when there is no old value.\n  CodeMirror.Init = Init;\n\n  // These two are, on init, called from the constructor because they\n  // have to be initialized before the editor can start at all.\n  option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n  option(\"mode\", null, function (cm, val) {\n    cm.doc.modeOption = val;\n    loadMode(cm);\n  }, true);\n\n  option(\"indentUnit\", 2, loadMode, true);\n  option(\"indentWithTabs\", false);\n  option(\"smartIndent\", true);\n  option(\"tabSize\", 4, function (cm) {\n    resetModeState(cm);\n    clearCaches(cm);\n    regChange(cm);\n  }, true);\n  option(\"lineSeparator\", null, function (cm, val) {\n    cm.doc.lineSep = val;\n    if (!val) { return }\n    var newBreaks = [], lineNo = cm.doc.first;\n    cm.doc.iter(function (line) {\n      for (var pos = 0;;) {\n        var found = line.text.indexOf(val, pos);\n        if (found == -1) { break }\n        pos = found + val.length;\n        newBreaks.push(Pos(lineNo, found));\n      }\n      lineNo++;\n    });\n    for (var i = newBreaks.length - 1; i >= 0; i--)\n      { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n  });\n  option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\n    cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n    if (old != Init) { cm.refresh(); }\n  });\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n  option(\"electricChars\", true);\n  option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n    throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n  }, true);\n  option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n  option(\"rtlMoveVisually\", !windows);\n  option(\"wholeLineUpdateBefore\", true);\n\n  option(\"theme\", \"default\", function (cm) {\n    themeChanged(cm);\n    guttersChanged(cm);\n  }, true);\n  option(\"keyMap\", \"default\", function (cm, val, old) {\n    var next = getKeyMap(val);\n    var prev = old != Init && getKeyMap(old);\n    if (prev && prev.detach) { prev.detach(cm, next); }\n    if (next.attach) { next.attach(cm, prev || null); }\n  });\n  option(\"extraKeys\", null);\n\n  option(\"lineWrapping\", false, wrappingChanged, true);\n  option(\"gutters\", [], function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"fixedGutter\", true, function (cm, val) {\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n    cm.refresh();\n  }, true);\n  option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n  option(\"scrollbarStyle\", \"native\", function (cm) {\n    initScrollbars(cm);\n    updateScrollbars(cm);\n    cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n    cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n  }, true);\n  option(\"lineNumbers\", false, function (cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"firstLineNumber\", 1, guttersChanged, true);\n  option(\"lineNumberFormatter\", function (integer) { return integer; }, guttersChanged, true);\n  option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n  option(\"resetSelectionOnContextMenu\", true);\n  option(\"lineWiseCopyCut\", true);\n\n  option(\"readOnly\", false, function (cm, val) {\n    if (val == \"nocursor\") {\n      onBlur(cm);\n      cm.display.input.blur();\n      cm.display.disabled = true;\n    } else {\n      cm.display.disabled = false;\n    }\n    cm.display.input.readOnlyChanged(val);\n  });\n  option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n  option(\"dragDrop\", true, dragDropChanged);\n  option(\"allowDropFileTypes\", null);\n\n  option(\"cursorBlinkRate\", 530);\n  option(\"cursorScrollMargin\", 0);\n  option(\"cursorHeight\", 1, updateSelection, true);\n  option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n  option(\"workTime\", 100);\n  option(\"workDelay\", 100);\n  option(\"flattenSpans\", true, resetModeState, true);\n  option(\"addModeClass\", false, resetModeState, true);\n  option(\"pollInterval\", 100);\n  option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n  option(\"historyEventDelay\", 1250);\n  option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n  option(\"maxHighlightLength\", 10000, resetModeState, true);\n  option(\"moveInputWithCursor\", true, function (cm, val) {\n    if (!val) { cm.display.input.resetPosition(); }\n  });\n\n  option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n  option(\"autofocus\", null);\n  option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n}\n\nfunction guttersChanged(cm) {\n  updateGutters(cm);\n  regChange(cm);\n  alignHorizontally(cm);\n}\n\nfunction dragDropChanged(cm, value, old) {\n  var wasOn = old && old != Init;\n  if (!value != !wasOn) {\n    var funcs = cm.display.dragFunctions;\n    var toggle = value ? on : off;\n    toggle(cm.display.scroller, \"dragstart\", funcs.start);\n    toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n    toggle(cm.display.scroller, \"dragover\", funcs.over);\n    toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n    toggle(cm.display.scroller, \"drop\", funcs.drop);\n  }\n}\n\nfunction wrappingChanged(cm) {\n  if (cm.options.lineWrapping) {\n    addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    cm.display.sizer.style.minWidth = \"\";\n    cm.display.sizerWidth = null;\n  } else {\n    rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n    findMaxLine(cm);\n  }\n  estimateLineHeights(cm);\n  regChange(cm);\n  clearCaches(cm);\n  setTimeout(function () { return updateScrollbars(cm); }, 100);\n}\n\n// A CodeMirror instance represents an editor. This is the object\n// that user code is usually dealing with.\n\nfunction CodeMirror$1(place, options) {\n  var this$1 = this;\n\n  if (!(this instanceof CodeMirror$1)) { return new CodeMirror$1(place, options) }\n\n  this.options = options = options ? copyObj(options) : {};\n  // Determine effective options based on given values and defaults.\n  copyObj(defaults, options, false);\n  setGuttersForLineNumbers(options);\n\n  var doc = options.value;\n  if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n  this.doc = doc;\n\n  var input = new CodeMirror$1.inputStyles[options.inputStyle](this);\n  var display = this.display = new Display(place, doc, input);\n  display.wrapper.CodeMirror = this;\n  updateGutters(this);\n  themeChanged(this);\n  if (options.lineWrapping)\n    { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n  initScrollbars(this);\n\n  this.state = {\n    keyMaps: [],  // stores maps added by addKeyMap\n    overlays: [], // highlighting overlays, as added by addOverlay\n    modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n    overwrite: false,\n    delayingBlurEvent: false,\n    focused: false,\n    suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n    pasteIncoming: false, cutIncoming: false, // help recognize paste/cut edits in input.poll\n    selectingText: false,\n    draggingText: false,\n    highlight: new Delayed(), // stores highlight worker timeout\n    keySeq: null,  // Unfinished key sequence\n    specialChars: null\n  };\n\n  if (options.autofocus && !mobile) { display.input.focus(); }\n\n  // Override magic textarea content restore that IE sometimes does\n  // on our hidden textarea on reload\n  if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n  registerEventHandlers(this);\n  ensureGlobalHandlers();\n\n  startOperation(this);\n  this.curOp.forceUpdate = true;\n  attachDoc(this, doc);\n\n  if ((options.autofocus && !mobile) || this.hasFocus())\n    { setTimeout(bind(onFocus, this), 20); }\n  else\n    { onBlur(this); }\n\n  for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n    { optionHandlers[opt](this$1, options[opt], Init); } }\n  maybeUpdateLineNumberWidth(this);\n  if (options.finishInit) { options.finishInit(this); }\n  for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this$1); }\n  endOperation(this);\n  // Suppress optimizelegibility in Webkit, since it breaks text\n  // measuring on line wrapping boundaries.\n  if (webkit && options.lineWrapping &&\n      getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n    { display.lineDiv.style.textRendering = \"auto\"; }\n}\n\n// The default configuration options.\nCodeMirror$1.defaults = defaults;\n// Functions to run when options are changed.\nCodeMirror$1.optionHandlers = optionHandlers;\n\n// Attach the necessary event handlers when initializing the editor\nfunction registerEventHandlers(cm) {\n  var d = cm.display;\n  on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n  // Older IE's will not fire a second mousedown for a double click\n  if (ie && ie_version < 11)\n    { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n      if (signalDOMEvent(cm, e)) { return }\n      var pos = posFromMouse(cm, e);\n      if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n      e_preventDefault(e);\n      var word = cm.findWordAt(pos);\n      extendSelection(cm.doc, word.anchor, word.head);\n    })); }\n  else\n    { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n  // Some browsers fire contextmenu *after* opening the menu, at\n  // which point we can't mess with it anymore. Context menu is\n  // handled in onMouseDown for these browsers.\n  if (!captureRightClick) { on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); }); }\n\n  // Used to suppress mouse event handling when a touch happens\n  var touchFinished, prevTouch = {end: 0};\n  function finishTouch() {\n    if (d.activeTouch) {\n      touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n      prevTouch = d.activeTouch;\n      prevTouch.end = +new Date;\n    }\n  }\n  function isMouseLikeTouchEvent(e) {\n    if (e.touches.length != 1) { return false }\n    var touch = e.touches[0];\n    return touch.radiusX <= 1 && touch.radiusY <= 1\n  }\n  function farAway(touch, other) {\n    if (other.left == null) { return true }\n    var dx = other.left - touch.left, dy = other.top - touch.top;\n    return dx * dx + dy * dy > 20 * 20\n  }\n  on(d.scroller, \"touchstart\", function (e) {\n    if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e)) {\n      d.input.ensurePolled();\n      clearTimeout(touchFinished);\n      var now = +new Date;\n      d.activeTouch = {start: now, moved: false,\n                       prev: now - prevTouch.end <= 300 ? prevTouch : null};\n      if (e.touches.length == 1) {\n        d.activeTouch.left = e.touches[0].pageX;\n        d.activeTouch.top = e.touches[0].pageY;\n      }\n    }\n  });\n  on(d.scroller, \"touchmove\", function () {\n    if (d.activeTouch) { d.activeTouch.moved = true; }\n  });\n  on(d.scroller, \"touchend\", function (e) {\n    var touch = d.activeTouch;\n    if (touch && !eventInWidget(d, e) && touch.left != null &&\n        !touch.moved && new Date - touch.start < 300) {\n      var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n      if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n        { range = new Range(pos, pos); }\n      else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n        { range = cm.findWordAt(pos); }\n      else // Triple tap\n        { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n      cm.setSelection(range.anchor, range.head);\n      cm.focus();\n      e_preventDefault(e);\n    }\n    finishTouch();\n  });\n  on(d.scroller, \"touchcancel\", finishTouch);\n\n  // Sync scrolling between fake scrollbars and real scrollable\n  // area, ensure viewport is updated when scrolling.\n  on(d.scroller, \"scroll\", function () {\n    if (d.scroller.clientHeight) {\n      updateScrollTop(cm, d.scroller.scrollTop);\n      setScrollLeft(cm, d.scroller.scrollLeft, true);\n      signal(cm, \"scroll\", cm);\n    }\n  });\n\n  // Listen to wheel events in order to try and update the viewport on time.\n  on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n  on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n  // Prevent wrapper from ever scrolling\n  on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n  d.dragFunctions = {\n    enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n    over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n    start: function (e) { return onDragStart(cm, e); },\n    drop: operation(cm, onDrop),\n    leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n  };\n\n  var inp = d.input.getField();\n  on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n  on(inp, \"keydown\", operation(cm, onKeyDown));\n  on(inp, \"keypress\", operation(cm, onKeyPress));\n  on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n  on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n}\n\nvar initHooks = [];\nCodeMirror$1.defineInitHook = function (f) { return initHooks.push(f); };\n\n// Indent the given line. The how parameter can be \"smart\",\n// \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n// (typically set to true for forced single-line indents), empty\n// lines are not indented, and places where the mode returns Pass\n// are left alone.\nfunction indentLine(cm, n, how, aggressive) {\n  var doc = cm.doc, state;\n  if (how == null) { how = \"add\"; }\n  if (how == \"smart\") {\n    // Fall back to \"prev\" when the mode doesn't have an indentation\n    // method.\n    if (!doc.mode.indent) { how = \"prev\"; }\n    else { state = getStateBefore(cm, n); }\n  }\n\n  var tabSize = cm.options.tabSize;\n  var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n  if (line.stateAfter) { line.stateAfter = null; }\n  var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n  if (!aggressive && !/\\S/.test(line.text)) {\n    indentation = 0;\n    how = \"not\";\n  } else if (how == \"smart\") {\n    indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n    if (indentation == Pass || indentation > 150) {\n      if (!aggressive) { return }\n      how = \"prev\";\n    }\n  }\n  if (how == \"prev\") {\n    if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n    else { indentation = 0; }\n  } else if (how == \"add\") {\n    indentation = curSpace + cm.options.indentUnit;\n  } else if (how == \"subtract\") {\n    indentation = curSpace - cm.options.indentUnit;\n  } else if (typeof how == \"number\") {\n    indentation = curSpace + how;\n  }\n  indentation = Math.max(0, indentation);\n\n  var indentString = \"\", pos = 0;\n  if (cm.options.indentWithTabs)\n    { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n  if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n  if (indentString != curSpaceString) {\n    replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n    line.stateAfter = null;\n    return true\n  } else {\n    // Ensure that, if the cursor was in the whitespace at the start\n    // of the line, it is moved to the end of that space.\n    for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n      var range = doc.sel.ranges[i$1];\n      if (range.head.line == n && range.head.ch < curSpaceString.length) {\n        var pos$1 = Pos(n, curSpaceString.length);\n        replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n        break\n      }\n    }\n  }\n}\n\n// This will be set to a {lineWise: bool, text: [string]} object, so\n// that, when pasting, we know what kind of selections the copied\n// text was made out of.\nvar lastCopied = null;\n\nfunction setLastCopied(newLastCopied) {\n  lastCopied = newLastCopied;\n}\n\nfunction applyTextInput(cm, inserted, deleted, sel, origin) {\n  var doc = cm.doc;\n  cm.display.shift = false;\n  if (!sel) { sel = doc.sel; }\n\n  var paste = cm.state.pasteIncoming || origin == \"paste\";\n  var textLines = splitLinesAuto(inserted), multiPaste = null;\n  // When pasing N lines into N selections, insert one line per selection\n  if (paste && sel.ranges.length > 1) {\n    if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n      if (sel.ranges.length % lastCopied.text.length == 0) {\n        multiPaste = [];\n        for (var i = 0; i < lastCopied.text.length; i++)\n          { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n      }\n    } else if (textLines.length == sel.ranges.length) {\n      multiPaste = map(textLines, function (l) { return [l]; });\n    }\n  }\n\n  var updateInput;\n  // Normal behavior is to insert the new text into every selection\n  for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n    var range$$1 = sel.ranges[i$1];\n    var from = range$$1.from(), to = range$$1.to();\n    if (range$$1.empty()) {\n      if (deleted && deleted > 0) // Handle deletion\n        { from = Pos(from.line, from.ch - deleted); }\n      else if (cm.state.overwrite && !paste) // Handle overwrite\n        { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n      else if (lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n        { from = to = Pos(from.line, 0); }\n    }\n    updateInput = cm.curOp.updateInput;\n    var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                       origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")};\n    makeChange(cm.doc, changeEvent);\n    signalLater(cm, \"inputRead\", cm, changeEvent);\n  }\n  if (inserted && !paste)\n    { triggerElectric(cm, inserted); }\n\n  ensureCursorVisible(cm);\n  cm.curOp.updateInput = updateInput;\n  cm.curOp.typing = true;\n  cm.state.pasteIncoming = cm.state.cutIncoming = false;\n}\n\nfunction handlePaste(e, cm) {\n  var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n  if (pasted) {\n    e.preventDefault();\n    if (!cm.isReadOnly() && !cm.options.disableInput)\n      { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n    return true\n  }\n}\n\nfunction triggerElectric(cm, inserted) {\n  // When an 'electric' character is inserted, immediately trigger a reindent\n  if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n  var sel = cm.doc.sel;\n\n  for (var i = sel.ranges.length - 1; i >= 0; i--) {\n    var range$$1 = sel.ranges[i];\n    if (range$$1.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range$$1.head.line)) { continue }\n    var mode = cm.getModeAt(range$$1.head);\n    var indented = false;\n    if (mode.electricChars) {\n      for (var j = 0; j < mode.electricChars.length; j++)\n        { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n          indented = indentLine(cm, range$$1.head.line, \"smart\");\n          break\n        } }\n    } else if (mode.electricInput) {\n      if (mode.electricInput.test(getLine(cm.doc, range$$1.head.line).text.slice(0, range$$1.head.ch)))\n        { indented = indentLine(cm, range$$1.head.line, \"smart\"); }\n    }\n    if (indented) { signalLater(cm, \"electricInput\", cm, range$$1.head.line); }\n  }\n}\n\nfunction copyableRanges(cm) {\n  var text = [], ranges = [];\n  for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n    var line = cm.doc.sel.ranges[i].head.line;\n    var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n    ranges.push(lineRange);\n    text.push(cm.getRange(lineRange.anchor, lineRange.head));\n  }\n  return {text: text, ranges: ranges}\n}\n\nfunction disableBrowserMagic(field, spellcheck) {\n  field.setAttribute(\"autocorrect\", \"off\");\n  field.setAttribute(\"autocapitalize\", \"off\");\n  field.setAttribute(\"spellcheck\", !!spellcheck);\n}\n\nfunction hiddenTextarea() {\n  var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n  var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n  // The textarea is kept positioned near the cursor to prevent the\n  // fact that it'll be scrolled into view on input from scrolling\n  // our fake cursor out of view. On webkit, when wrap=off, paste is\n  // very slow. So make the area wide instead.\n  if (webkit) { te.style.width = \"1000px\"; }\n  else { te.setAttribute(\"wrap\", \"off\"); }\n  // If border: 0; -- iOS fails to open keyboard (issue #1287)\n  if (ios) { te.style.border = \"1px solid black\"; }\n  disableBrowserMagic(te);\n  return div\n}\n\n// The publicly visible API. Note that methodOp(f) means\n// 'wrap f in an operation, performed on its `this` parameter'.\n\n// This is not the complete set of editor methods. Most of the\n// methods defined on the Doc type are also injected into\n// CodeMirror.prototype, for backwards compatibility and\n// convenience.\n\nvar addEditorMethods = function(CodeMirror) {\n  var optionHandlers = CodeMirror.optionHandlers;\n\n  var helpers = CodeMirror.helpers = {};\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); this.display.input.focus();},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") { return }\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        { operation(this, optionHandlers[option])(this, value, old); }\n      signal(this, \"optionChange\", this, option);\n    },\n\n    getOption: function(option) {return this.options[option]},\n    getDoc: function() {return this.doc},\n\n    addKeyMap: function(map$$1, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map$$1));\n    },\n    removeKeyMap: function(map$$1) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        { if (maps[i] == map$$1 || maps[i].name == map$$1) {\n          maps.splice(i, 1);\n          return true\n        } }\n    },\n\n    addOverlay: methodOp(function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n      insertSorted(this.state.overlays,\n                   {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                    priority: (options && options.priority) || 0},\n                   function (overlay) { return overlay.priority; });\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: methodOp(function(spec) {\n      var this$1 = this;\n\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this$1.state.modeGen++;\n          regChange(this$1);\n          return\n        }\n      }\n    }),\n\n    indentLine: methodOp(function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n        else { dir = dir ? \"add\" : \"subtract\"; }\n      }\n      if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n    }),\n    indentSelection: methodOp(function(how) {\n      var this$1 = this;\n\n      var ranges = this.doc.sel.ranges, end = -1;\n      for (var i = 0; i < ranges.length; i++) {\n        var range$$1 = ranges[i];\n        if (!range$$1.empty()) {\n          var from = range$$1.from(), to = range$$1.to();\n          var start = Math.max(end, from.line);\n          end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n          for (var j = start; j < end; ++j)\n            { indentLine(this$1, j, how); }\n          var newRanges = this$1.doc.sel.ranges;\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n            { replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n        } else if (range$$1.head.line > end) {\n          indentLine(this$1, range$$1.head.line, how, true);\n          end = range$$1.head.line;\n          if (i == this$1.doc.sel.primIndex) { ensureCursorVisible(this$1); }\n        }\n      }\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      return takeToken(this, pos, precise)\n    },\n\n    getLineTokens: function(line, precise) {\n      return takeToken(this, Pos(line), precise, true)\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      var type;\n      if (ch == 0) { type = styles[2]; }\n      else { for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n        else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n        else { type = styles[mid * 2 + 2]; break }\n      } }\n      var cut = type ? type.indexOf(\"overlay \") : -1;\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) { return mode }\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0]\n    },\n\n    getHelpers: function(pos, type) {\n      var this$1 = this;\n\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) { return found }\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) { found.push(help[mode[type]]); }\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) { found.push(val); }\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n        var cur = help._global[i$1];\n        if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1)\n          { found.push(cur.val); }\n      }\n      return found\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getStateBefore(this, line + 1, precise)\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, range$$1 = this.doc.sel.primary();\n      if (start == null) { pos = range$$1.head; }\n      else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n      else { pos = start ? range$$1.from() : range$$1.to(); }\n      return cursorCoords(this, pos, mode || \"page\")\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top)\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset)\n    },\n    heightAtLine: function(line, mode, includeWidgets) {\n      var end = false, lineObj;\n      if (typeof line == \"number\") {\n        var last = this.doc.first + this.doc.size - 1;\n        if (line < this.doc.first) { line = this.doc.first; }\n        else if (line > last) { line = last; end = true; }\n        lineObj = getLine(this.doc, line);\n      } else {\n        lineObj = line;\n      }\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n        (end ? this.doc.height - heightAtLine(lineObj) : 0)\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display) },\n    defaultCharWidth: function() { return charWidth(this.display) },\n\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      node.setAttribute(\"cm-ignore-events\", \"true\");\n      this.display.input.setUneditable(node);\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          { top = pos.top - node.offsetHeight; }\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          { top = pos.bottom; }\n        if (left + node.offsetWidth > hspace)\n          { left = hspace - node.offsetWidth; }\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") { left = 0; }\n        else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n    },\n\n    triggerOnKeyDown: methodOp(onKeyDown),\n    triggerOnKeyPress: methodOp(onKeyPress),\n    triggerOnKeyUp: onKeyUp,\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        { return commands[cmd].call(null, this) }\n    },\n\n    triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n    findPosH: function(from, amount, unit, visually) {\n      var this$1 = this;\n\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        cur = findPosH(this$1.doc, cur, dir, unit, visually);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveH: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      this.extendSelectionsBy(function (range$$1) {\n        if (this$1.display.shift || this$1.doc.extend || range$$1.empty())\n          { return findPosH(this$1.doc, range$$1.head, dir, unit, this$1.options.rtlMoveVisually) }\n        else\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n      }, sel_move);\n    }),\n\n    deleteH: methodOp(function(dir, unit) {\n      var sel = this.doc.sel, doc = this.doc;\n      if (sel.somethingSelected())\n        { doc.replaceSelection(\"\", null, \"+delete\"); }\n      else\n        { deleteNearSelection(this, function (range$$1) {\n          var other = findPosH(doc, range$$1.head, dir, unit, false);\n          return dir < 0 ? {from: other, to: range$$1.head} : {from: range$$1.head, to: other}\n        }); }\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var this$1 = this;\n\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      var cur = clipPos(this.doc, from);\n      for (var i = 0; i < amount; ++i) {\n        var coords = cursorCoords(this$1, cur, \"div\");\n        if (x == null) { x = coords.left; }\n        else { coords.left = x; }\n        cur = findPosV(this$1, coords, dir, unit);\n        if (cur.hitSide) { break }\n      }\n      return cur\n    },\n\n    moveV: methodOp(function(dir, unit) {\n      var this$1 = this;\n\n      var doc = this.doc, goals = [];\n      var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n      doc.extendSelectionsBy(function (range$$1) {\n        if (collapse)\n          { return dir < 0 ? range$$1.from() : range$$1.to() }\n        var headPos = cursorCoords(this$1, range$$1.head, \"div\");\n        if (range$$1.goalColumn != null) { headPos.left = range$$1.goalColumn; }\n        goals.push(headPos.left);\n        var pos = findPosV(this$1, headPos, dir, unit);\n        if (unit == \"page\" && range$$1 == doc.sel.primary())\n          { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n        return pos\n      }, sel_move);\n      if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n        { doc.sel.ranges[i].goalColumn = goals[i]; } }\n    }),\n\n    // Find the word at the given position (as returned by coordsChar).\n    findWordAt: function(pos) {\n      var doc = this.doc, line = getLine(doc, pos.line).text;\n      var start = pos.ch, end = pos.ch;\n      if (line) {\n        var helper = this.getHelper(pos, \"wordChars\");\n        if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n        var startChar = line.charAt(start);\n        var check = isWordChar(startChar, helper)\n          ? function (ch) { return isWordChar(ch, helper); }\n          : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n          : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n        while (start > 0 && check(line.charAt(start - 1))) { --start; }\n        while (end < line.length && check(line.charAt(end))) { ++end; }\n      }\n      return new Range(Pos(pos.line, start), Pos(pos.line, end))\n    },\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) { return }\n      if (this.state.overwrite = !this.state.overwrite)\n        { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n      else\n        { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return this.display.input.getField() == activeElt() },\n    isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n    scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n              width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n              clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n    },\n\n    scrollIntoView: methodOp(function(range$$1, margin) {\n      if (range$$1 == null) {\n        range$$1 = {from: this.doc.sel.primary().head, to: null};\n        if (margin == null) { margin = this.options.cursorScrollMargin; }\n      } else if (typeof range$$1 == \"number\") {\n        range$$1 = {from: Pos(range$$1, 0), to: null};\n      } else if (range$$1.from == null) {\n        range$$1 = {from: range$$1, to: null};\n      }\n      if (!range$$1.to) { range$$1.to = range$$1.from; }\n      range$$1.margin = margin || 0;\n\n      if (range$$1.from.line != null) {\n        scrollToRange(this, range$$1);\n      } else {\n        scrollToCoordsRange(this, range$$1.from, range$$1.to, range$$1.margin);\n      }\n    }),\n\n    setSize: methodOp(function(width, height) {\n      var this$1 = this;\n\n      var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n      if (width != null) { this.display.wrapper.style.width = interpret(width); }\n      if (height != null) { this.display.wrapper.style.height = interpret(height); }\n      if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n      var lineNo$$1 = this.display.viewFrom;\n      this.doc.iter(lineNo$$1, this.display.viewTo, function (line) {\n        if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n          { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo$$1, \"widget\"); break } } }\n        ++lineNo$$1;\n      });\n      this.curOp.forceUpdate = true;\n      signal(this, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f)},\n\n    refresh: methodOp(function() {\n      var oldHeight = this.display.cachedTextHeight;\n      regChange(this);\n      this.curOp.forceUpdate = true;\n      clearCaches(this);\n      scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n      updateGutterSpace(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        { estimateLineHeights(this); }\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: methodOp(function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      this.display.input.reset();\n      scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n      this.curOp.forceScroll = true;\n      signalLater(this, \"swapDoc\", this, old);\n      return old\n    }),\n\n    getInputField: function(){return this.display.input.getField()},\n    getWrapperElement: function(){return this.display.wrapper},\n    getScrollerElement: function(){return this.display.scroller},\n    getGutterElement: function(){return this.display.gutters}\n  };\n  eventMixin(CodeMirror);\n\n  CodeMirror.registerHelper = function(type, name, value) {\n    if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n    helpers[type][name] = value;\n  };\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n    CodeMirror.registerHelper(type, name, value);\n    helpers[type]._global.push({pred: predicate, val: value});\n  };\n};\n\n// Used for horizontal relative motion. Dir is -1 or 1 (left or\n// right), unit can be \"char\", \"column\" (like char, but doesn't\n// cross line boundaries), \"word\" (across next word), or \"group\" (to\n// the start of next group of word or non-word-non-whitespace\n// chars). The visually param controls whether, in right-to-left\n// text, direction 1 means to move towards the next index in the\n// string, or towards the character to the right of the current\n// position. The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosH(doc, pos, dir, unit, visually) {\n  var oldPos = pos;\n  var origDir = dir;\n  var lineObj = getLine(doc, pos.line);\n  function findNextLine() {\n    var l = pos.line + dir;\n    if (l < doc.first || l >= doc.first + doc.size) { return false }\n    pos = new Pos(l, pos.ch, pos.sticky);\n    return lineObj = getLine(doc, l)\n  }\n  function moveOnce(boundToLine) {\n    var next;\n    if (visually) {\n      next = moveVisually(doc.cm, lineObj, pos, dir);\n    } else {\n      next = moveLogically(lineObj, pos, dir);\n    }\n    if (next == null) {\n      if (!boundToLine && findNextLine())\n        { pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir); }\n      else\n        { return false }\n    } else {\n      pos = next;\n    }\n    return true\n  }\n\n  if (unit == \"char\") {\n    moveOnce();\n  } else if (unit == \"column\") {\n    moveOnce(true);\n  } else if (unit == \"word\" || unit == \"group\") {\n    var sawType = null, group = unit == \"group\";\n    var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n    for (var first = true;; first = false) {\n      if (dir < 0 && !moveOnce(!first)) { break }\n      var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n      var type = isWordChar(cur, helper) ? \"w\"\n        : group && cur == \"\\n\" ? \"n\"\n        : !group || /\\s/.test(cur) ? null\n        : \"p\";\n      if (group && !first && !type) { type = \"s\"; }\n      if (sawType && sawType != type) {\n        if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n        break\n      }\n\n      if (type) { sawType = type; }\n      if (dir > 0 && !moveOnce(!first)) { break }\n    }\n  }\n  var result = skipAtomic(doc, pos, oldPos, origDir, true);\n  if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n  return result\n}\n\n// For relative vertical movement. Dir may be -1 or 1. Unit can be\n// \"page\" or \"line\". The resulting position will have a hitSide=true\n// property if it reached the end of the document.\nfunction findPosV(cm, pos, dir, unit) {\n  var doc = cm.doc, x = pos.left, y;\n  if (unit == \"page\") {\n    var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n    var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n    y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n  } else if (unit == \"line\") {\n    y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n  }\n  var target;\n  for (;;) {\n    target = coordsChar(cm, x, y);\n    if (!target.outside) { break }\n    if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n    y += dir * 5;\n  }\n  return target\n}\n\n// CONTENTEDITABLE INPUT STYLE\n\nvar ContentEditableInput = function(cm) {\n  this.cm = cm;\n  this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n  this.polling = new Delayed();\n  this.composing = null;\n  this.gracePeriod = false;\n  this.readDOMTimeout = null;\n};\n\nContentEditableInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = input.cm;\n  var div = input.div = display.lineDiv;\n  disableBrowserMagic(div, cm.options.spellcheck);\n\n  on(div, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n    // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n    if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n  });\n\n  on(div, \"compositionstart\", function (e) {\n    this$1.composing = {data: e.data, done: false};\n  });\n  on(div, \"compositionupdate\", function (e) {\n    if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n  });\n  on(div, \"compositionend\", function (e) {\n    if (this$1.composing) {\n      if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n      this$1.composing.done = true;\n    }\n  });\n\n  on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n  on(div, \"input\", function () {\n    if (!this$1.composing) { this$1.readFromDOMSoon(); }\n  });\n\n  function onCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n      if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.operation(function () {\n          cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n          cm.replaceSelection(\"\", null, \"cut\");\n        });\n      }\n    }\n    if (e.clipboardData) {\n      e.clipboardData.clearData();\n      var content = lastCopied.text.join(\"\\n\");\n      // iOS exposes the clipboard API, but seems to discard content inserted into it\n      e.clipboardData.setData(\"Text\", content);\n      if (e.clipboardData.getData(\"Text\") == content) {\n        e.preventDefault();\n        return\n      }\n    }\n    // Old-fashioned briefly-focus-a-textarea hack\n    var kludge = hiddenTextarea(), te = kludge.firstChild;\n    cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n    te.value = lastCopied.text.join(\"\\n\");\n    var hadFocus = document.activeElement;\n    selectInput(te);\n    setTimeout(function () {\n      cm.display.lineSpace.removeChild(kludge);\n      hadFocus.focus();\n      if (hadFocus == div) { input.showPrimarySelection(); }\n    }, 50);\n  }\n  on(div, \"copy\", onCopyCut);\n  on(div, \"cut\", onCopyCut);\n};\n\nContentEditableInput.prototype.prepareSelection = function () {\n  var result = prepareSelection(this.cm, false);\n  result.focus = this.cm.state.focused;\n  return result\n};\n\nContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n  if (!info || !this.cm.display.view.length) { return }\n  if (info.focus || takeFocus) { this.showPrimarySelection(); }\n  this.showMultipleSelections(info);\n};\n\nContentEditableInput.prototype.showPrimarySelection = function () {\n  var sel = window.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n  var from = prim.from(), to = prim.to();\n\n  if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n      cmp(minPos(curAnchor, curFocus), from) == 0 &&\n      cmp(maxPos(curAnchor, curFocus), to) == 0)\n    { return }\n\n  var view = cm.display.view;\n  var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n      {node: view[0].measure.map[2], offset: 0};\n  var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n  if (!end) {\n    var measure = view[view.length - 1].measure;\n    var map$$1 = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n    end = {node: map$$1[map$$1.length - 1], offset: map$$1[map$$1.length - 2] - map$$1[map$$1.length - 3]};\n  }\n\n  if (!start || !end) {\n    sel.removeAllRanges();\n    return\n  }\n\n  var old = sel.rangeCount && sel.getRangeAt(0), rng;\n  try { rng = range(start.node, start.offset, end.offset, end.node); }\n  catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n  if (rng) {\n    if (!gecko && cm.state.focused) {\n      sel.collapse(start.node, start.offset);\n      if (!rng.collapsed) {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n    } else {\n      sel.removeAllRanges();\n      sel.addRange(rng);\n    }\n    if (old && sel.anchorNode == null) { sel.addRange(old); }\n    else if (gecko) { this.startGracePeriod(); }\n  }\n  this.rememberSelection();\n};\n\nContentEditableInput.prototype.startGracePeriod = function () {\n    var this$1 = this;\n\n  clearTimeout(this.gracePeriod);\n  this.gracePeriod = setTimeout(function () {\n    this$1.gracePeriod = false;\n    if (this$1.selectionChanged())\n      { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n  }, 20);\n};\n\nContentEditableInput.prototype.showMultipleSelections = function (info) {\n  removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n  removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n};\n\nContentEditableInput.prototype.rememberSelection = function () {\n  var sel = window.getSelection();\n  this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n  this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n};\n\nContentEditableInput.prototype.selectionInEditor = function () {\n  var sel = window.getSelection();\n  if (!sel.rangeCount) { return false }\n  var node = sel.getRangeAt(0).commonAncestorContainer;\n  return contains(this.div, node)\n};\n\nContentEditableInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\") {\n    if (!this.selectionInEditor())\n      { this.showSelection(this.prepareSelection(), true); }\n    this.div.focus();\n  }\n};\nContentEditableInput.prototype.blur = function () { this.div.blur(); };\nContentEditableInput.prototype.getField = function () { return this.div };\n\nContentEditableInput.prototype.supportsTouch = function () { return true };\n\nContentEditableInput.prototype.receivedFocus = function () {\n  var input = this;\n  if (this.selectionInEditor())\n    { this.pollSelection(); }\n  else\n    { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n  function poll() {\n    if (input.cm.state.focused) {\n      input.pollSelection();\n      input.polling.set(input.cm.options.pollInterval, poll);\n    }\n  }\n  this.polling.set(this.cm.options.pollInterval, poll);\n};\n\nContentEditableInput.prototype.selectionChanged = function () {\n  var sel = window.getSelection();\n  return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n    sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n};\n\nContentEditableInput.prototype.pollSelection = function () {\n  if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n  var sel = window.getSelection(), cm = this.cm;\n  // On Android Chrome (version 56, at least), backspacing into an\n  // uneditable block element will put the cursor in that element,\n  // and then, because it's not editable, hide the virtual keyboard.\n  // Because Android doesn't allow us to actually detect backspace\n  // presses in a sane way, this code checks for when that happens\n  // and simulates a backspace press in this case.\n  if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\n    this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n    this.blur();\n    this.focus();\n    return\n  }\n  if (this.composing) { return }\n  this.rememberSelection();\n  var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n  var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n  if (anchor && head) { runInOp(cm, function () {\n    setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n    if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n  }); }\n};\n\nContentEditableInput.prototype.pollContent = function () {\n  if (this.readDOMTimeout != null) {\n    clearTimeout(this.readDOMTimeout);\n    this.readDOMTimeout = null;\n  }\n\n  var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n  var from = sel.from(), to = sel.to();\n  if (from.ch == 0 && from.line > cm.firstLine())\n    { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n  if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n    { to = Pos(to.line + 1, 0); }\n  if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n  var fromIndex, fromLine, fromNode;\n  if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n    fromLine = lineNo(display.view[0].line);\n    fromNode = display.view[0].node;\n  } else {\n    fromLine = lineNo(display.view[fromIndex].line);\n    fromNode = display.view[fromIndex - 1].node.nextSibling;\n  }\n  var toIndex = findViewIndex(cm, to.line);\n  var toLine, toNode;\n  if (toIndex == display.view.length - 1) {\n    toLine = display.viewTo - 1;\n    toNode = display.lineDiv.lastChild;\n  } else {\n    toLine = lineNo(display.view[toIndex + 1].line) - 1;\n    toNode = display.view[toIndex + 1].node.previousSibling;\n  }\n\n  if (!fromNode) { return false }\n  var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n  var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n  while (newText.length > 1 && oldText.length > 1) {\n    if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n    else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n    else { break }\n  }\n\n  var cutFront = 0, cutEnd = 0;\n  var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n  while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n    { ++cutFront; }\n  var newBot = lst(newText), oldBot = lst(oldText);\n  var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                           oldBot.length - (oldText.length == 1 ? cutFront : 0));\n  while (cutEnd < maxCutEnd &&\n         newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n    { ++cutEnd; }\n  // Try to move start of change to start of selection if ambiguous\n  if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n    while (cutFront && cutFront > from.ch &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n      cutFront--;\n      cutEnd++;\n    }\n  }\n\n  newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n  newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n  var chFrom = Pos(fromLine, cutFront);\n  var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n  if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n    replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n    return true\n  }\n};\n\nContentEditableInput.prototype.ensurePolled = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.reset = function () {\n  this.forceCompositionEnd();\n};\nContentEditableInput.prototype.forceCompositionEnd = function () {\n  if (!this.composing) { return }\n  clearTimeout(this.readDOMTimeout);\n  this.composing = null;\n  this.updateFromDOM();\n  this.div.blur();\n  this.div.focus();\n};\nContentEditableInput.prototype.readFromDOMSoon = function () {\n    var this$1 = this;\n\n  if (this.readDOMTimeout != null) { return }\n  this.readDOMTimeout = setTimeout(function () {\n    this$1.readDOMTimeout = null;\n    if (this$1.composing) {\n      if (this$1.composing.done) { this$1.composing = null; }\n      else { return }\n    }\n    this$1.updateFromDOM();\n  }, 80);\n};\n\nContentEditableInput.prototype.updateFromDOM = function () {\n    var this$1 = this;\n\n  if (this.cm.isReadOnly() || !this.pollContent())\n    { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n};\n\nContentEditableInput.prototype.setUneditable = function (node) {\n  node.contentEditable = \"false\";\n};\n\nContentEditableInput.prototype.onKeyPress = function (e) {\n  if (e.charCode == 0) { return }\n  e.preventDefault();\n  if (!this.cm.isReadOnly())\n    { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n};\n\nContentEditableInput.prototype.readOnlyChanged = function (val) {\n  this.div.contentEditable = String(val != \"nocursor\");\n};\n\nContentEditableInput.prototype.onContextMenu = function () {};\nContentEditableInput.prototype.resetPosition = function () {};\n\nContentEditableInput.prototype.needsContentAttribute = true;\n\nfunction posToDOM(cm, pos) {\n  var view = findViewForLine(cm, pos.line);\n  if (!view || view.hidden) { return null }\n  var line = getLine(cm.doc, pos.line);\n  var info = mapFromLineView(view, line, pos.line);\n\n  var order = getOrder(line, cm.doc.direction), side = \"left\";\n  if (order) {\n    var partPos = getBidiPartAt(order, pos.ch);\n    side = partPos % 2 ? \"right\" : \"left\";\n  }\n  var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n  result.offset = result.collapse == \"right\" ? result.end : result.start;\n  return result\n}\n\nfunction isInGutter(node) {\n  for (var scan = node; scan; scan = scan.parentNode)\n    { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n  return false\n}\n\nfunction badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\nfunction domTextBetween(cm, from, to, fromLine, toLine) {\n  var text = \"\", closing = false, lineSep = cm.doc.lineSeparator();\n  function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n  function close() {\n    if (closing) {\n      text += lineSep;\n      closing = false;\n    }\n  }\n  function addText(str) {\n    if (str) {\n      close();\n      text += str;\n    }\n  }\n  function walk(node) {\n    if (node.nodeType == 1) {\n      var cmText = node.getAttribute(\"cm-text\");\n      if (cmText != null) {\n        addText(cmText || node.textContent.replace(/\\u200b/g, \"\"));\n        return\n      }\n      var markerID = node.getAttribute(\"cm-marker\"), range$$1;\n      if (markerID) {\n        var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n        if (found.length && (range$$1 = found[0].find()))\n          { addText(getBetween(cm.doc, range$$1.from, range$$1.to).join(lineSep)); }\n        return\n      }\n      if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n      var isBlock = /^(pre|div|p)$/i.test(node.nodeName);\n      if (isBlock) { close(); }\n      for (var i = 0; i < node.childNodes.length; i++)\n        { walk(node.childNodes[i]); }\n      if (isBlock) { closing = true; }\n    } else if (node.nodeType == 3) {\n      addText(node.nodeValue);\n    }\n  }\n  for (;;) {\n    walk(from);\n    if (from == to) { break }\n    from = from.nextSibling;\n  }\n  return text\n}\n\nfunction domToPos(cm, node, offset) {\n  var lineNode;\n  if (node == cm.display.lineDiv) {\n    lineNode = cm.display.lineDiv.childNodes[offset];\n    if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n    node = null; offset = 0;\n  } else {\n    for (lineNode = node;; lineNode = lineNode.parentNode) {\n      if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n      if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n    }\n  }\n  for (var i = 0; i < cm.display.view.length; i++) {\n    var lineView = cm.display.view[i];\n    if (lineView.node == lineNode)\n      { return locateNodeInLineView(lineView, node, offset) }\n  }\n}\n\nfunction locateNodeInLineView(lineView, node, offset) {\n  var wrapper = lineView.text.firstChild, bad = false;\n  if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n  if (node == wrapper) {\n    bad = true;\n    node = wrapper.childNodes[offset];\n    offset = 0;\n    if (!node) {\n      var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n      return badPos(Pos(lineNo(line), line.text.length), bad)\n    }\n  }\n\n  var textNode = node.nodeType == 3 ? node : null, topNode = node;\n  if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n    textNode = node.firstChild;\n    if (offset) { offset = textNode.nodeValue.length; }\n  }\n  while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n  var measure = lineView.measure, maps = measure.maps;\n\n  function find(textNode, topNode, offset) {\n    for (var i = -1; i < (maps ? maps.length : 0); i++) {\n      var map$$1 = i < 0 ? measure.map : maps[i];\n      for (var j = 0; j < map$$1.length; j += 3) {\n        var curNode = map$$1[j + 2];\n        if (curNode == textNode || curNode == topNode) {\n          var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n          var ch = map$$1[j] + offset;\n          if (offset < 0 || curNode != textNode) { ch = map$$1[j + (offset ? 1 : 0)]; }\n          return Pos(line, ch)\n        }\n      }\n    }\n  }\n  var found = find(textNode, topNode, offset);\n  if (found) { return badPos(found, bad) }\n\n  // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n  for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n    found = find(after, after.firstChild, 0);\n    if (found)\n      { return badPos(Pos(found.line, found.ch - dist), bad) }\n    else\n      { dist += after.textContent.length; }\n  }\n  for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n    found = find(before, before.firstChild, -1);\n    if (found)\n      { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n    else\n      { dist$1 += before.textContent.length; }\n  }\n}\n\n// TEXTAREA INPUT STYLE\n\nvar TextareaInput = function(cm) {\n  this.cm = cm;\n  // See input.poll and input.reset\n  this.prevInput = \"\";\n\n  // Flag that indicates whether we expect input to appear real soon\n  // now (after some event like 'keypress' or 'input') and are\n  // polling intensively.\n  this.pollingFast = false;\n  // Self-resetting timeout for the poller\n  this.polling = new Delayed();\n  // Tracks when input.reset has punted to just putting a short\n  // string into the textarea instead of the full selection.\n  this.inaccurateSelection = false;\n  // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n  this.hasSelection = false;\n  this.composing = null;\n};\n\nTextareaInput.prototype.init = function (display) {\n    var this$1 = this;\n\n  var input = this, cm = this.cm;\n\n  // Wraps and hides input textarea\n  var div = this.wrapper = hiddenTextarea();\n  // The semihidden textarea that is focused when the editor is\n  // focused, and receives input.\n  var te = this.textarea = div.firstChild;\n  display.wrapper.insertBefore(div, display.wrapper.firstChild);\n\n  // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n  if (ios) { te.style.width = \"0px\"; }\n\n  on(te, \"input\", function () {\n    if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n    input.poll();\n  });\n\n  on(te, \"paste\", function (e) {\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n    cm.state.pasteIncoming = true;\n    input.fastPoll();\n  });\n\n  function prepareCopyCut(e) {\n    if (signalDOMEvent(cm, e)) { return }\n    if (cm.somethingSelected()) {\n      setLastCopied({lineWise: false, text: cm.getSelections()});\n      if (input.inaccurateSelection) {\n        input.prevInput = \"\";\n        input.inaccurateSelection = false;\n        te.value = lastCopied.text.join(\"\\n\");\n        selectInput(te);\n      }\n    } else if (!cm.options.lineWiseCopyCut) {\n      return\n    } else {\n      var ranges = copyableRanges(cm);\n      setLastCopied({lineWise: true, text: ranges.text});\n      if (e.type == \"cut\") {\n        cm.setSelections(ranges.ranges, null, sel_dontScroll);\n      } else {\n        input.prevInput = \"\";\n        te.value = ranges.text.join(\"\\n\");\n        selectInput(te);\n      }\n    }\n    if (e.type == \"cut\") { cm.state.cutIncoming = true; }\n  }\n  on(te, \"cut\", prepareCopyCut);\n  on(te, \"copy\", prepareCopyCut);\n\n  on(display.scroller, \"paste\", function (e) {\n    if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n    cm.state.pasteIncoming = true;\n    input.focus();\n  });\n\n  // Prevent normal selection in the editor (we handle our own)\n  on(display.lineSpace, \"selectstart\", function (e) {\n    if (!eventInWidget(display, e)) { e_preventDefault(e); }\n  });\n\n  on(te, \"compositionstart\", function () {\n    var start = cm.getCursor(\"from\");\n    if (input.composing) { input.composing.range.clear(); }\n    input.composing = {\n      start: start,\n      range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n    };\n  });\n  on(te, \"compositionend\", function () {\n    if (input.composing) {\n      input.poll();\n      input.composing.range.clear();\n      input.composing = null;\n    }\n  });\n};\n\nTextareaInput.prototype.prepareSelection = function () {\n  // Redraw the selection and/or cursor\n  var cm = this.cm, display = cm.display, doc = cm.doc;\n  var result = prepareSelection(cm);\n\n  // Move the hidden textarea near the cursor to prevent scrolling artifacts\n  if (cm.options.moveInputWithCursor) {\n    var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n    var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n    result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                        headPos.top + lineOff.top - wrapOff.top));\n    result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                         headPos.left + lineOff.left - wrapOff.left));\n  }\n\n  return result\n};\n\nTextareaInput.prototype.showSelection = function (drawn) {\n  var cm = this.cm, display = cm.display;\n  removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n  removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n  if (drawn.teTop != null) {\n    this.wrapper.style.top = drawn.teTop + \"px\";\n    this.wrapper.style.left = drawn.teLeft + \"px\";\n  }\n};\n\n// Reset the input to correspond to the selection (or to be empty,\n// when not typing and nothing is selected)\nTextareaInput.prototype.reset = function (typing) {\n  if (this.contextMenuPending || this.composing) { return }\n  var minimal, selected, cm = this.cm, doc = cm.doc;\n  if (cm.somethingSelected()) {\n    this.prevInput = \"\";\n    var range$$1 = doc.sel.primary();\n    minimal = hasCopyEvent &&\n      (range$$1.to().line - range$$1.from().line > 100 || (selected = cm.getSelection()).length > 1000);\n    var content = minimal ? \"-\" : selected || cm.getSelection();\n    this.textarea.value = content;\n    if (cm.state.focused) { selectInput(this.textarea); }\n    if (ie && ie_version >= 9) { this.hasSelection = content; }\n  } else if (!typing) {\n    this.prevInput = this.textarea.value = \"\";\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n  }\n  this.inaccurateSelection = minimal;\n};\n\nTextareaInput.prototype.getField = function () { return this.textarea };\n\nTextareaInput.prototype.supportsTouch = function () { return false };\n\nTextareaInput.prototype.focus = function () {\n  if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n    try { this.textarea.focus(); }\n    catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n  }\n};\n\nTextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\nTextareaInput.prototype.resetPosition = function () {\n  this.wrapper.style.top = this.wrapper.style.left = 0;\n};\n\nTextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n// Poll for input changes, using the normal rate of polling. This\n// runs as long as the editor is focused.\nTextareaInput.prototype.slowPoll = function () {\n    var this$1 = this;\n\n  if (this.pollingFast) { return }\n  this.polling.set(this.cm.options.pollInterval, function () {\n    this$1.poll();\n    if (this$1.cm.state.focused) { this$1.slowPoll(); }\n  });\n};\n\n// When an event has just come in that is likely to add or change\n// something in the input textarea, we poll faster, to ensure that\n// the change appears on the screen quickly.\nTextareaInput.prototype.fastPoll = function () {\n  var missed = false, input = this;\n  input.pollingFast = true;\n  function p() {\n    var changed = input.poll();\n    if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n    else {input.pollingFast = false; input.slowPoll();}\n  }\n  input.polling.set(20, p);\n};\n\n// Read input from the textarea, and update the document to match.\n// When something is selected, it is present in the textarea, and\n// selected (unless it is huge, in which case a placeholder is\n// used). When nothing is selected, the cursor sits after previously\n// seen text (can be empty), which is stored in prevInput (we must\n// not reset the textarea when typing, because that breaks IME).\nTextareaInput.prototype.poll = function () {\n    var this$1 = this;\n\n  var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n  // Since this is called a *lot*, try to bail out as cheaply as\n  // possible when it is clear that nothing happened. hasSelection\n  // will be the case when there is a lot of text in the textarea,\n  // in which case reading its value would be expensive.\n  if (this.contextMenuPending || !cm.state.focused ||\n      (hasSelection(input) && !prevInput && !this.composing) ||\n      cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n    { return false }\n\n  var text = input.value;\n  // If nothing changed, bail.\n  if (text == prevInput && !cm.somethingSelected()) { return false }\n  // Work around nonsensical selection resetting in IE9/10, and\n  // inexplicable appearance of private area unicode characters on\n  // some key combos in Mac (#2689).\n  if (ie && ie_version >= 9 && this.hasSelection === text ||\n      mac && /[\\uf700-\\uf7ff]/.test(text)) {\n    cm.display.input.reset();\n    return false\n  }\n\n  if (cm.doc.sel == cm.display.selForContextMenu) {\n    var first = text.charCodeAt(0);\n    if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n    if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n  }\n  // Find the part of the input that is actually new\n  var same = 0, l = Math.min(prevInput.length, text.length);\n  while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n  runInOp(cm, function () {\n    applyTextInput(cm, text.slice(same), prevInput.length - same,\n                   null, this$1.composing ? \"*compose\" : null);\n\n    // Don't leave long text in the textarea, since it makes further polling slow\n    if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n    else { this$1.prevInput = text; }\n\n    if (this$1.composing) {\n      this$1.composing.range.clear();\n      this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                         {className: \"CodeMirror-composing\"});\n    }\n  });\n  return true\n};\n\nTextareaInput.prototype.ensurePolled = function () {\n  if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n};\n\nTextareaInput.prototype.onKeyPress = function () {\n  if (ie && ie_version >= 9) { this.hasSelection = null; }\n  this.fastPoll();\n};\n\nTextareaInput.prototype.onContextMenu = function (e) {\n  var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n  var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n  if (!pos || presto) { return } // Opera is difficult.\n\n  // Reset the current text selection only if the click is done outside of the selection\n  // and 'resetSelectionOnContextMenu' option is true.\n  var reset = cm.options.resetSelectionOnContextMenu;\n  if (reset && cm.doc.sel.contains(pos) == -1)\n    { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n  var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n  input.wrapper.style.cssText = \"position: absolute\";\n  var wrapperBox = input.wrapper.getBoundingClientRect();\n  te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n  var oldScrollY;\n  if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n  display.input.focus();\n  if (webkit) { window.scrollTo(null, oldScrollY); }\n  display.input.reset();\n  // Adds \"Select all\" to context menu in FF\n  if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n  input.contextMenuPending = true;\n  display.selForContextMenu = cm.doc.sel;\n  clearTimeout(display.detectingSelectAll);\n\n  // Select-all will be greyed out if there's nothing to select, so\n  // this adds a zero-width space so that we can later check whether\n  // it got selected.\n  function prepareSelectAllHack() {\n    if (te.selectionStart != null) {\n      var selected = cm.somethingSelected();\n      var extval = \"\\u200b\" + (selected ? te.value : \"\");\n      te.value = \"\\u21da\"; // Used to catch context-menu undo\n      te.value = extval;\n      input.prevInput = selected ? \"\" : \"\\u200b\";\n      te.selectionStart = 1; te.selectionEnd = extval.length;\n      // Re-set this, in case some other handler touched the\n      // selection in the meantime.\n      display.selForContextMenu = cm.doc.sel;\n    }\n  }\n  function rehide() {\n    input.contextMenuPending = false;\n    input.wrapper.style.cssText = oldWrapperCSS;\n    te.style.cssText = oldCSS;\n    if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n    // Try to detect the user choosing select-all\n    if (te.selectionStart != null) {\n      if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n      var i = 0, poll = function () {\n        if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n            te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n          operation(cm, selectAll)(cm);\n        } else if (i++ < 10) {\n          display.detectingSelectAll = setTimeout(poll, 500);\n        } else {\n          display.selForContextMenu = null;\n          display.input.reset();\n        }\n      };\n      display.detectingSelectAll = setTimeout(poll, 200);\n    }\n  }\n\n  if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n  if (captureRightClick) {\n    e_stop(e);\n    var mouseup = function () {\n      off(window, \"mouseup\", mouseup);\n      setTimeout(rehide, 20);\n    };\n    on(window, \"mouseup\", mouseup);\n  } else {\n    setTimeout(rehide, 50);\n  }\n};\n\nTextareaInput.prototype.readOnlyChanged = function (val) {\n  if (!val) { this.reset(); }\n};\n\nTextareaInput.prototype.setUneditable = function () {};\n\nTextareaInput.prototype.needsContentAttribute = false;\n\nfunction fromTextArea(textarea, options) {\n  options = options ? copyObj(options) : {};\n  options.value = textarea.value;\n  if (!options.tabindex && textarea.tabIndex)\n    { options.tabindex = textarea.tabIndex; }\n  if (!options.placeholder && textarea.placeholder)\n    { options.placeholder = textarea.placeholder; }\n  // Set autofocus to true if this textarea is focused, or if it has\n  // autofocus and no other element is focused.\n  if (options.autofocus == null) {\n    var hasFocus = activeElt();\n    options.autofocus = hasFocus == textarea ||\n      textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n  }\n\n  function save() {textarea.value = cm.getValue();}\n\n  var realSubmit;\n  if (textarea.form) {\n    on(textarea.form, \"submit\", save);\n    // Deplorable hack to make the submit method do the right thing.\n    if (!options.leaveSubmitMethodAlone) {\n      var form = textarea.form;\n      realSubmit = form.submit;\n      try {\n        var wrappedSubmit = form.submit = function () {\n          save();\n          form.submit = realSubmit;\n          form.submit();\n          form.submit = wrappedSubmit;\n        };\n      } catch(e) {}\n    }\n  }\n\n  options.finishInit = function (cm) {\n    cm.save = save;\n    cm.getTextArea = function () { return textarea; };\n    cm.toTextArea = function () {\n      cm.toTextArea = isNaN; // Prevent this from being ran twice\n      save();\n      textarea.parentNode.removeChild(cm.getWrapperElement());\n      textarea.style.display = \"\";\n      if (textarea.form) {\n        off(textarea.form, \"submit\", save);\n        if (typeof textarea.form.submit == \"function\")\n          { textarea.form.submit = realSubmit; }\n      }\n    };\n  };\n\n  textarea.style.display = \"none\";\n  var cm = CodeMirror$1(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n    options);\n  return cm\n}\n\nfunction addLegacyProps(CodeMirror) {\n  CodeMirror.off = off;\n  CodeMirror.on = on;\n  CodeMirror.wheelEventPixels = wheelEventPixels;\n  CodeMirror.Doc = Doc;\n  CodeMirror.splitLines = splitLinesAuto;\n  CodeMirror.countColumn = countColumn;\n  CodeMirror.findColumn = findColumn;\n  CodeMirror.isWordChar = isWordCharBasic;\n  CodeMirror.Pass = Pass;\n  CodeMirror.signal = signal;\n  CodeMirror.Line = Line;\n  CodeMirror.changeEnd = changeEnd;\n  CodeMirror.scrollbarModel = scrollbarModel;\n  CodeMirror.Pos = Pos;\n  CodeMirror.cmpPos = cmp;\n  CodeMirror.modes = modes;\n  CodeMirror.mimeModes = mimeModes;\n  CodeMirror.resolveMode = resolveMode;\n  CodeMirror.getMode = getMode;\n  CodeMirror.modeExtensions = modeExtensions;\n  CodeMirror.extendMode = extendMode;\n  CodeMirror.copyState = copyState;\n  CodeMirror.startState = startState;\n  CodeMirror.innerMode = innerMode;\n  CodeMirror.commands = commands;\n  CodeMirror.keyMap = keyMap;\n  CodeMirror.keyName = keyName;\n  CodeMirror.isModifierKey = isModifierKey;\n  CodeMirror.lookupKey = lookupKey;\n  CodeMirror.normalizeKeyMap = normalizeKeyMap;\n  CodeMirror.StringStream = StringStream;\n  CodeMirror.SharedTextMarker = SharedTextMarker;\n  CodeMirror.TextMarker = TextMarker;\n  CodeMirror.LineWidget = LineWidget;\n  CodeMirror.e_preventDefault = e_preventDefault;\n  CodeMirror.e_stopPropagation = e_stopPropagation;\n  CodeMirror.e_stop = e_stop;\n  CodeMirror.addClass = addClass;\n  CodeMirror.contains = contains;\n  CodeMirror.rmClass = rmClass;\n  CodeMirror.keyNames = keyNames;\n}\n\n// EDITOR CONSTRUCTOR\n\ndefineOptions(CodeMirror$1);\n\naddEditorMethods(CodeMirror$1);\n\n// Set up methods on CodeMirror's prototype to redirect to the editor's document.\nvar dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\nfor (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n  { CodeMirror$1.prototype[prop] = (function(method) {\n    return function() {return method.apply(this.doc, arguments)}\n  })(Doc.prototype[prop]); } }\n\neventMixin(Doc);\n\n// INPUT HANDLING\n\nCodeMirror$1.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n// MODE DEFINITION AND QUERYING\n\n// Extra arguments are stored as the mode's dependencies, which is\n// used by (legacy) mechanisms like loadmode.js to automatically\n// load a mode. (Preferred mechanism is the require/define calls.)\nCodeMirror$1.defineMode = function(name/*, mode, */) {\n  if (!CodeMirror$1.defaults.mode && name != \"null\") { CodeMirror$1.defaults.mode = name; }\n  defineMode.apply(this, arguments);\n};\n\nCodeMirror$1.defineMIME = defineMIME;\n\n// Minimal default mode.\nCodeMirror$1.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\nCodeMirror$1.defineMIME(\"text/plain\", \"null\");\n\n// EXTENSIONS\n\nCodeMirror$1.defineExtension = function (name, func) {\n  CodeMirror$1.prototype[name] = func;\n};\nCodeMirror$1.defineDocExtension = function (name, func) {\n  Doc.prototype[name] = func;\n};\n\nCodeMirror$1.fromTextArea = fromTextArea;\n\naddLegacyProps(CodeMirror$1);\n\nCodeMirror$1.version = \"5.26.0\";\n\nreturn CodeMirror$1;\n\n})));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/lib/codemirror.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n  var WRAP_CLASS = \"CodeMirror-activeline\";\n  var BACK_CLASS = \"CodeMirror-activeline-background\";\n  var GUTT_CLASS = \"CodeMirror-activeline-gutter\";\n\n  CodeMirror.defineOption(\"styleActiveLine\", false, function(cm, val, old) {\n    var prev = old == CodeMirror.Init ? false : old;\n    if (val == prev) return\n    if (prev) {\n      cm.off(\"beforeSelectionChange\", selectionChange);\n      clearActiveLines(cm);\n      delete cm.state.activeLines;\n    }\n    if (val) {\n      cm.state.activeLines = [];\n      updateActiveLines(cm, cm.listSelections());\n      cm.on(\"beforeSelectionChange\", selectionChange);\n    }\n  });\n\n  function clearActiveLines(cm) {\n    for (var i = 0; i < cm.state.activeLines.length; i++) {\n      cm.removeLineClass(cm.state.activeLines[i], \"wrap\", WRAP_CLASS);\n      cm.removeLineClass(cm.state.activeLines[i], \"background\", BACK_CLASS);\n      cm.removeLineClass(cm.state.activeLines[i], \"gutter\", GUTT_CLASS);\n    }\n  }\n\n  function sameArray(a, b) {\n    if (a.length != b.length) return false;\n    for (var i = 0; i < a.length; i++)\n      if (a[i] != b[i]) return false;\n    return true;\n  }\n\n  function updateActiveLines(cm, ranges) {\n    var active = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      var option = cm.getOption(\"styleActiveLine\");\n      if (typeof option == \"object\" && option.nonEmpty ? range.anchor.line != range.head.line : !range.empty())\n        continue\n      var line = cm.getLineHandleVisualStart(range.head.line);\n      if (active[active.length - 1] != line) active.push(line);\n    }\n    if (sameArray(cm.state.activeLines, active)) return;\n    cm.operation(function() {\n      clearActiveLines(cm);\n      for (var i = 0; i < active.length; i++) {\n        cm.addLineClass(active[i], \"wrap\", WRAP_CLASS);\n        cm.addLineClass(active[i], \"background\", BACK_CLASS);\n        cm.addLineClass(active[i], \"gutter\", GUTT_CLASS);\n      }\n      cm.state.activeLines = active;\n    });\n  }\n\n  function selectionChange(cm, sel) {\n    updateActiveLines(cm, sel.ranges);\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/selection/active-line.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var defaults = {\n    pairs: \"()[]{}''\\\"\\\"\",\n    triples: \"\",\n    explode: \"[]{}\"\n  };\n\n  var Pos = CodeMirror.Pos;\n\n  CodeMirror.defineOption(\"autoCloseBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.removeKeyMap(keyMap);\n      cm.state.closeBrackets = null;\n    }\n    if (val) {\n      ensureBound(getOption(val, \"pairs\"))\n      cm.state.closeBrackets = val;\n      cm.addKeyMap(keyMap);\n    }\n  });\n\n  function getOption(conf, name) {\n    if (name == \"pairs\" && typeof conf == \"string\") return conf;\n    if (typeof conf == \"object\" && conf[name] != null) return conf[name];\n    return defaults[name];\n  }\n\n  var keyMap = {Backspace: handleBackspace, Enter: handleEnter};\n  function ensureBound(chars) {\n    for (var i = 0; i < chars.length; i++) {\n      var ch = chars.charAt(i), key = \"'\" + ch + \"'\"\n      if (!keyMap[key]) keyMap[key] = handler(ch)\n    }\n  }\n  ensureBound(defaults.pairs + \"`\")\n\n  function handler(ch) {\n    return function(cm) { return handleChar(cm, ch); };\n  }\n\n  function getConfig(cm) {\n    var deflt = cm.state.closeBrackets;\n    if (!deflt || deflt.override) return deflt;\n    var mode = cm.getModeAt(cm.getCursor());\n    return mode.closeBrackets || deflt;\n  }\n\n  function handleBackspace(cm) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || pairs.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var cur = ranges[i].head;\n      cm.replaceRange(\"\", Pos(cur.line, cur.ch - 1), Pos(cur.line, cur.ch + 1), \"+delete\");\n    }\n  }\n\n  function handleEnter(cm) {\n    var conf = getConfig(cm);\n    var explode = conf && getOption(conf, \"explode\");\n    if (!explode || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || explode.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    cm.operation(function() {\n      var linesep = cm.lineSeparator() || \"\\n\";\n      cm.replaceSelection(linesep + linesep, null);\n      cm.execCommand(\"goCharLeft\");\n      ranges = cm.listSelections();\n      for (var i = 0; i < ranges.length; i++) {\n        var line = ranges[i].head.line;\n        cm.indentLine(line, null, true);\n        cm.indentLine(line + 1, null, true);\n      }\n    });\n  }\n\n  function contractSelection(sel) {\n    var inverted = CodeMirror.cmpPos(sel.anchor, sel.head) > 0;\n    return {anchor: new Pos(sel.anchor.line, sel.anchor.ch + (inverted ? -1 : 1)),\n            head: new Pos(sel.head.line, sel.head.ch + (inverted ? 1 : -1))};\n  }\n\n  function handleChar(cm, ch) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var pos = pairs.indexOf(ch);\n    if (pos == -1) return CodeMirror.Pass;\n    var triples = getOption(conf, \"triples\");\n\n    var identical = pairs.charAt(pos + 1) == ch;\n    var ranges = cm.listSelections();\n    var opening = pos % 2 == 0;\n\n    var type;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], cur = range.head, curType;\n      var next = cm.getRange(cur, Pos(cur.line, cur.ch + 1));\n      if (opening && !range.empty()) {\n        curType = \"surround\";\n      } else if ((identical || !opening) && next == ch) {\n        if (identical && stringStartsAfter(cm, cur))\n          curType = \"both\";\n        else if (triples.indexOf(ch) >= 0 && cm.getRange(cur, Pos(cur.line, cur.ch + 3)) == ch + ch + ch)\n          curType = \"skipThree\";\n        else\n          curType = \"skip\";\n      } else if (identical && cur.ch > 1 && triples.indexOf(ch) >= 0 &&\n                 cm.getRange(Pos(cur.line, cur.ch - 2), cur) == ch + ch) {\n        if (cur.ch > 2 && /\\bstring/.test(cm.getTokenTypeAt(Pos(cur.line, cur.ch - 2)))) return CodeMirror.Pass;\n        curType = \"addFour\";\n      } else if (identical) {\n        var prev = cur.ch == 0 ? \" \" : cm.getRange(Pos(cur.line, cur.ch - 1), cur)\n        if (!CodeMirror.isWordChar(next) && prev != ch && !CodeMirror.isWordChar(prev)) curType = \"both\";\n        else return CodeMirror.Pass;\n      } else if (opening) {\n        curType = \"both\";\n      } else {\n        return CodeMirror.Pass;\n      }\n      if (!type) type = curType;\n      else if (type != curType) return CodeMirror.Pass;\n    }\n\n    var left = pos % 2 ? pairs.charAt(pos - 1) : ch;\n    var right = pos % 2 ? ch : pairs.charAt(pos + 1);\n    cm.operation(function() {\n      if (type == \"skip\") {\n        cm.execCommand(\"goCharRight\");\n      } else if (type == \"skipThree\") {\n        for (var i = 0; i < 3; i++)\n          cm.execCommand(\"goCharRight\");\n      } else if (type == \"surround\") {\n        var sels = cm.getSelections();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = left + sels[i] + right;\n        cm.replaceSelections(sels, \"around\");\n        sels = cm.listSelections().slice();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = contractSelection(sels[i]);\n        cm.setSelections(sels);\n      } else if (type == \"both\") {\n        cm.replaceSelection(left + right, null);\n        cm.triggerElectric(left + right);\n        cm.execCommand(\"goCharLeft\");\n      } else if (type == \"addFour\") {\n        cm.replaceSelection(left + left + left + left, \"before\");\n        cm.execCommand(\"goCharRight\");\n      }\n    });\n  }\n\n  function charsAround(cm, pos) {\n    var str = cm.getRange(Pos(pos.line, pos.ch - 1),\n                          Pos(pos.line, pos.ch + 1));\n    return str.length == 2 ? str : null;\n  }\n\n  function stringStartsAfter(cm, pos) {\n    var token = cm.getTokenAt(Pos(pos.line, pos.ch + 1))\n    return /\\bstring/.test(token.type) && token.start == pos.ch &&\n      (pos.ch == 0 || !/\\bstring/.test(cm.getTokenTypeAt(pos)))\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/edit/closebrackets.js","import CodeMirror from '../codemirror';\n\n(function () {\n\n  CodeMirror.extendMode(\"css\", {\n    commentStart: \"/*\",\n    commentEnd: \"*/\",\n    newlineAfterToken: function (type, content) {\n      return /^[;{}]$/.test(content);\n    }\n  });\n\n  CodeMirror.extendMode(\"javascript\", {\n    commentStart: \"/*\",\n    commentEnd: \"*/\",\n    // FIXME semicolons inside of for\n    newlineAfterToken: function (type, content, textAfter, state) {\n      if (this.jsonMode) {\n        return /^[\\[,{]$/.test(content) || /^}/.test(textAfter);\n      } else {\n        if (content == \";\" && state.lexical && state.lexical.type == \")\") return false;\n        return /^[;{}]$/.test(content) && !/^;/.test(textAfter);\n      }\n    }\n  });\n\n  CodeMirror.extendMode(\"xml\", {\n    commentStart: \"<!--\",\n    commentEnd: \"-->\",\n    newlineAfterToken: function (type, content, textAfter) {\n      return type == \"tag\" && />$/.test(content) || /^</.test(textAfter);\n    }\n  });\n\n  // Comment/uncomment the specified range\n  CodeMirror.defineExtension(\"commentRange\", function (isComment, from, to) {\n    var cm = this, curMode = CodeMirror.innerMode(cm.getMode(), cm.getTokenAt(from).state).mode;\n    cm.operation(function () {\n      if (isComment) { // Comment range\n        cm.replaceRange(curMode.commentEnd, to);\n        cm.replaceRange(curMode.commentStart, from);\n        if (from.line == to.line && from.ch == to.ch) // An empty comment inserted - put cursor inside\n          cm.setCursor(from.line, from.ch + curMode.commentStart.length);\n      } else { // Uncomment range\n        var selText = cm.getRange(from, to);\n        var startIndex = selText.indexOf(curMode.commentStart);\n        var endIndex = selText.lastIndexOf(curMode.commentEnd);\n        if (startIndex > -1 && endIndex > -1 && endIndex > startIndex) {\n          // Take string till comment start\n          selText = selText.substr(0, startIndex)\n            // From comment start till comment end\n            + selText.substring(startIndex + curMode.commentStart.length, endIndex)\n            // From comment end till string end\n            + selText.substr(endIndex + curMode.commentEnd.length);\n        }\n        cm.replaceRange(selText, from, to);\n      }\n    });\n  });\n\n  // Applies automatic mode-aware indentation to the specified range\n  CodeMirror.defineExtension(\"autoIndentRange\", function (from, to) {\n    var cmInstance = this;\n    this.operation(function () {\n      for (var i = from.line; i <= to.line; i++) {\n        cmInstance.indentLine(i, \"smart\");\n      }\n    });\n  });\n\n  // Applies automatic formatting to the specified range\n  CodeMirror.defineExtension(\"autoFormatRange\", function (from, to) {\n    var cm = this;\n    var outer = cm.getMode(), text = cm.getRange(from, to).split(\"\\n\");\n    var state = CodeMirror.copyState(outer, cm.getTokenAt(from).state);\n    var tabSize = cm.getOption(\"tabSize\");\n\n    var out = \"\", lines = 0, atSol = from.ch == 0;\n    function newline() {\n      out += \"\\n\";\n      atSol = true;\n      ++lines;\n    }\n\n    for (var i = 0; i < text.length; ++i) {\n      var stream = new CodeMirror.StringStream(text[i], tabSize);\n      while (!stream.eol()) {\n        var inner = CodeMirror.innerMode(outer, state);\n        var style = outer.token(stream, state), cur = stream.current();\n        stream.start = stream.pos;\n        if (!atSol || /\\S/.test(cur)) {\n          out += cur;\n          atSol = false;\n        }\n        if (!atSol && inner.mode.newlineAfterToken &&\n          inner.mode.newlineAfterToken(style, cur, stream.string.slice(stream.pos) || text[i + 1] || \"\", inner.state))\n          newline();\n      }\n      if (!stream.pos && outer.blankLine) outer.blankLine(state);\n      if (!atSol) newline();\n    }\n\n    cm.operation(function () {\n      cm.replaceRange(out, from, to);\n      for (var cur = from.line + 1, end = from.line + lines; cur <= end; ++cur)\n        cm.indentLine(cur, \"smart\");\n      cm.setSelection(from, cm.getCursor(false));\n    });\n  });\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/lib/util/formatting.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Highlighting text that matches the selection\n//\n// Defines an option highlightSelectionMatches, which, when enabled,\n// will style strings that match the selection throughout the\n// document.\n//\n// The option can be set to true to simply enable it, or to a\n// {minChars, style, wordsOnly, showToken, delay} object to explicitly\n// configure it. minChars is the minimum amount of characters that should be\n// selected for the behavior to occur, and style is the token style to\n// apply to the matches. This will be prefixed by \"cm-\" to create an\n// actual CSS class name. If wordsOnly is enabled, the matches will be\n// highlighted only if the selected text is a word. showToken, when enabled,\n// will cause the current token to be highlighted when nothing is selected.\n// delay is used to specify how much time to wait, in milliseconds, before\n// highlighting the matches. If annotateScrollbar is enabled, the occurences\n// will be highlighted on the scrollbar via the matchesonscrollbar addon.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./matchesonscrollbar\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./matchesonscrollbar\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var defaults = {\n    style: \"matchhighlight\",\n    minChars: 2,\n    delay: 100,\n    wordsOnly: false,\n    annotateScrollbar: false,\n    showToken: false,\n    trim: true\n  }\n\n  function State(options) {\n    this.options = {}\n    for (var name in defaults)\n      this.options[name] = (options && options.hasOwnProperty(name) ? options : defaults)[name]\n    this.overlay = this.timeout = null;\n    this.matchesonscroll = null;\n    this.active = false;\n  }\n\n  CodeMirror.defineOption(\"highlightSelectionMatches\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      removeOverlay(cm);\n      clearTimeout(cm.state.matchHighlighter.timeout);\n      cm.state.matchHighlighter = null;\n      cm.off(\"cursorActivity\", cursorActivity);\n      cm.off(\"focus\", onFocus)\n    }\n    if (val) {\n      var state = cm.state.matchHighlighter = new State(val);\n      if (cm.hasFocus()) {\n        state.active = true\n        highlightMatches(cm)\n      } else {\n        cm.on(\"focus\", onFocus)\n      }\n      cm.on(\"cursorActivity\", cursorActivity);\n    }\n  });\n\n  function cursorActivity(cm) {\n    var state = cm.state.matchHighlighter;\n    if (state.active || cm.hasFocus()) scheduleHighlight(cm, state)\n  }\n\n  function onFocus(cm) {\n    var state = cm.state.matchHighlighter\n    if (!state.active) {\n      state.active = true\n      scheduleHighlight(cm, state)\n    }\n  }\n\n  function scheduleHighlight(cm, state) {\n    clearTimeout(state.timeout);\n    state.timeout = setTimeout(function() {highlightMatches(cm);}, state.options.delay);\n  }\n\n  function addOverlay(cm, query, hasBoundary, style) {\n    var state = cm.state.matchHighlighter;\n    cm.addOverlay(state.overlay = makeOverlay(query, hasBoundary, style));\n    if (state.options.annotateScrollbar && cm.showMatchesOnScrollbar) {\n      var searchFor = hasBoundary ? new RegExp(\"\\\\b\" + query.replace(/[\\\\\\[.+*?(){|^$]/g, \"\\\\$&\") + \"\\\\b\") : query;\n      state.matchesonscroll = cm.showMatchesOnScrollbar(searchFor, false,\n        {className: \"CodeMirror-selection-highlight-scrollbar\"});\n    }\n  }\n\n  function removeOverlay(cm) {\n    var state = cm.state.matchHighlighter;\n    if (state.overlay) {\n      cm.removeOverlay(state.overlay);\n      state.overlay = null;\n      if (state.matchesonscroll) {\n        state.matchesonscroll.clear();\n        state.matchesonscroll = null;\n      }\n    }\n  }\n\n  function highlightMatches(cm) {\n    cm.operation(function() {\n      var state = cm.state.matchHighlighter;\n      removeOverlay(cm);\n      if (!cm.somethingSelected() && state.options.showToken) {\n        var re = state.options.showToken === true ? /[\\w$]/ : state.options.showToken;\n        var cur = cm.getCursor(), line = cm.getLine(cur.line), start = cur.ch, end = start;\n        while (start && re.test(line.charAt(start - 1))) --start;\n        while (end < line.length && re.test(line.charAt(end))) ++end;\n        if (start < end)\n          addOverlay(cm, line.slice(start, end), re, state.options.style);\n        return;\n      }\n      var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n      if (from.line != to.line) return;\n      if (state.options.wordsOnly && !isWord(cm, from, to)) return;\n      var selection = cm.getRange(from, to)\n      if (state.options.trim) selection = selection.replace(/^\\s+|\\s+$/g, \"\")\n      if (selection.length >= state.options.minChars)\n        addOverlay(cm, selection, false, state.options.style);\n    });\n  }\n\n  function isWord(cm, from, to) {\n    var str = cm.getRange(from, to);\n    if (str.match(/^\\w+$/) !== null) {\n        if (from.ch > 0) {\n            var pos = {line: from.line, ch: from.ch - 1};\n            var chr = cm.getRange(pos, from);\n            if (chr.match(/\\W/) === null) return false;\n        }\n        if (to.ch < cm.getLine(from.line).length) {\n            var pos = {line: to.line, ch: to.ch + 1};\n            var chr = cm.getRange(to, pos);\n            if (chr.match(/\\W/) === null) return false;\n        }\n        return true;\n    } else return false;\n  }\n\n  function boundariesAround(stream, re) {\n    return (!stream.start || !re.test(stream.string.charAt(stream.start - 1))) &&\n      (stream.pos == stream.string.length || !re.test(stream.string.charAt(stream.pos)));\n  }\n\n  function makeOverlay(query, hasBoundary, style) {\n    return {token: function(stream) {\n      if (stream.match(query) &&\n          (!hasBoundary || boundariesAround(stream, hasBoundary)))\n        return style;\n      stream.next();\n      stream.skipTo(query.charAt(0)) || stream.skipToEnd();\n    }};\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/search/match-highlighter.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./searchcursor\"), require(\"../scroll/annotatescrollbar\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./searchcursor\", \"../scroll/annotatescrollbar\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineExtension(\"showMatchesOnScrollbar\", function(query, caseFold, options) {\n    if (typeof options == \"string\") options = {className: options};\n    if (!options) options = {};\n    return new SearchAnnotation(this, query, caseFold, options);\n  });\n\n  function SearchAnnotation(cm, query, caseFold, options) {\n    this.cm = cm;\n    this.options = options;\n    var annotateOptions = {listenForChanges: false};\n    for (var prop in options) annotateOptions[prop] = options[prop];\n    if (!annotateOptions.className) annotateOptions.className = \"CodeMirror-search-match\";\n    this.annotation = cm.annotateScrollbar(annotateOptions);\n    this.query = query;\n    this.caseFold = caseFold;\n    this.gap = {from: cm.firstLine(), to: cm.lastLine() + 1};\n    this.matches = [];\n    this.update = null;\n\n    this.findMatches();\n    this.annotation.update(this.matches);\n\n    var self = this;\n    cm.on(\"change\", this.changeHandler = function(_cm, change) { self.onChange(change); });\n  }\n\n  var MAX_MATCHES = 1000;\n\n  SearchAnnotation.prototype.findMatches = function() {\n    if (!this.gap) return;\n    for (var i = 0; i < this.matches.length; i++) {\n      var match = this.matches[i];\n      if (match.from.line >= this.gap.to) break;\n      if (match.to.line >= this.gap.from) this.matches.splice(i--, 1);\n    }\n    var cursor = this.cm.getSearchCursor(this.query, CodeMirror.Pos(this.gap.from, 0), this.caseFold);\n    var maxMatches = this.options && this.options.maxMatches || MAX_MATCHES;\n    while (cursor.findNext()) {\n      var match = {from: cursor.from(), to: cursor.to()};\n      if (match.from.line >= this.gap.to) break;\n      this.matches.splice(i++, 0, match);\n      if (this.matches.length > maxMatches) break;\n    }\n    this.gap = null;\n  };\n\n  function offsetLine(line, changeStart, sizeChange) {\n    if (line <= changeStart) return line;\n    return Math.max(changeStart, line + sizeChange);\n  }\n\n  SearchAnnotation.prototype.onChange = function(change) {\n    var startLine = change.from.line;\n    var endLine = CodeMirror.changeEnd(change).line;\n    var sizeChange = endLine - change.to.line;\n    if (this.gap) {\n      this.gap.from = Math.min(offsetLine(this.gap.from, startLine, sizeChange), change.from.line);\n      this.gap.to = Math.max(offsetLine(this.gap.to, startLine, sizeChange), change.from.line);\n    } else {\n      this.gap = {from: change.from.line, to: endLine + 1};\n    }\n\n    if (sizeChange) for (var i = 0; i < this.matches.length; i++) {\n      var match = this.matches[i];\n      var newFrom = offsetLine(match.from.line, startLine, sizeChange);\n      if (newFrom != match.from.line) match.from = CodeMirror.Pos(newFrom, match.from.ch);\n      var newTo = offsetLine(match.to.line, startLine, sizeChange);\n      if (newTo != match.to.line) match.to = CodeMirror.Pos(newTo, match.to.ch);\n    }\n    clearTimeout(this.update);\n    var self = this;\n    this.update = setTimeout(function() { self.updateAfterChange(); }, 250);\n  };\n\n  SearchAnnotation.prototype.updateAfterChange = function() {\n    this.findMatches();\n    this.annotation.update(this.matches);\n  };\n\n  SearchAnnotation.prototype.clear = function() {\n    this.cm.off(\"change\", this.changeHandler);\n    this.annotation.clear();\n  };\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/search/matchesonscrollbar.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"))\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod)\n  else // Plain browser env\n    mod(CodeMirror)\n})(function(CodeMirror) {\n  \"use strict\"\n  var Pos = CodeMirror.Pos\n\n  function regexpFlags(regexp) {\n    var flags = regexp.flags\n    return flags != null ? flags : (regexp.ignoreCase ? \"i\" : \"\")\n      + (regexp.global ? \"g\" : \"\")\n      + (regexp.multiline ? \"m\" : \"\")\n  }\n\n  function ensureFlags(regexp, flags) {\n    var current = regexpFlags(regexp), target = current\n    for (var i = 0; i < flags.length; i++) if (target.indexOf(flags.charAt(i)) == -1)\n      target += flags.charAt(i)\n    return current == target ? regexp : new RegExp(regexp.source, target)\n  }\n\n  function maybeMultiline(regexp) {\n    return /\\\\s|\\\\n|\\n|\\\\W|\\\\D|\\[\\^/.test(regexp.source)\n  }\n\n  function searchRegexpForward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, last = doc.lastLine(); line <= last; line++, ch = 0) {\n      regexp.lastIndex = ch\n      var string = doc.getLine(line), match = regexp.exec(string)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpForwardMultiline(doc, regexp, start) {\n    if (!maybeMultiline(regexp)) return searchRegexpForward(doc, regexp, start)\n\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunk = 1\n    for (var line = start.line, last = doc.lastLine(); line <= last;) {\n      // This grows the search buffer in exponentially-sized chunks\n      // between matches, so that nearby matches are fast and don't\n      // require concatenating the whole document (in case we're\n      // searching for something that has tons of matches), but at the\n      // same time, the amount of retries is limited.\n      for (var i = 0; i < chunk; i++) {\n        if (line > last) break\n        var curLine = doc.getLine(line++)\n        string = string == null ? curLine : string + \"\\n\" + curLine\n      }\n      chunk = chunk * 2\n      regexp.lastIndex = start.ch\n      var match = regexp.exec(string)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = start.line + before.length - 1, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  function lastMatchIn(string, regexp) {\n    var cutOff = 0, match\n    for (;;) {\n      regexp.lastIndex = cutOff\n      var newMatch = regexp.exec(string)\n      if (!newMatch) return match\n      match = newMatch\n      cutOff = match.index + (match[0].length || 1)\n      if (cutOff == string.length) return match\n    }\n  }\n\n  function searchRegexpBackward(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"g\")\n    for (var line = start.line, ch = start.ch, first = doc.firstLine(); line >= first; line--, ch = -1) {\n      var string = doc.getLine(line)\n      if (ch > -1) string = string.slice(0, ch)\n      var match = lastMatchIn(string, regexp)\n      if (match)\n        return {from: Pos(line, match.index),\n                to: Pos(line, match.index + match[0].length),\n                match: match}\n    }\n  }\n\n  function searchRegexpBackwardMultiline(doc, regexp, start) {\n    regexp = ensureFlags(regexp, \"gm\")\n    var string, chunk = 1\n    for (var line = start.line, first = doc.firstLine(); line >= first;) {\n      for (var i = 0; i < chunk; i++) {\n        var curLine = doc.getLine(line--)\n        string = string == null ? curLine.slice(0, start.ch) : curLine + \"\\n\" + string\n      }\n      chunk *= 2\n\n      var match = lastMatchIn(string, regexp)\n      if (match) {\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\n        var startLine = line + before.length, startCh = before[before.length - 1].length\n        return {from: Pos(startLine, startCh),\n                to: Pos(startLine + inside.length - 1,\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\n                match: match}\n      }\n    }\n  }\n\n  var doFold, noFold\n  if (String.prototype.normalize) {\n    doFold = function(str) { return str.normalize(\"NFD\").toLowerCase() }\n    noFold = function(str) { return str.normalize(\"NFD\") }\n  } else {\n    doFold = function(str) { return str.toLowerCase() }\n    noFold = function(str) { return str }\n  }\n\n  // Maps a position in a case-folded line back to a position in the original line\n  // (compensating for codepoints increasing in number during folding)\n  function adjustPos(orig, folded, pos, foldFunc) {\n    if (orig.length == folded.length) return pos\n    for (var min = 0, max = pos + Math.max(0, orig.length - folded.length);;) {\n      if (min == max) return min\n      var mid = (min + max) >> 1\n      var len = foldFunc(orig.slice(0, mid)).length\n      if (len == pos) return mid\n      else if (len > pos) max = mid\n      else min = mid + 1\n    }\n  }\n\n  function searchStringForward(doc, query, start, caseFold) {\n    // Empty string would match anything and never progress, so we\n    // define it to match nothing instead.\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, last = doc.lastLine() + 1 - lines.length; line <= last; line++, ch = 0) {\n      var orig = doc.getLine(line).slice(ch), string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.indexOf(lines[0])\n        if (found == -1) continue search\n        var start = adjustPos(orig, string, found, fold) + ch\n        return {from: Pos(line, adjustPos(orig, string, found, fold) + ch),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold) + ch)}\n      } else {\n        var cutFrom = string.length - lines[0].length\n        if (string.slice(cutFrom) != lines[0]) continue search\n        for (var i = 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(line + i)) != lines[i]) continue search\n        var end = doc.getLine(line + lines.length - 1), endString = fold(end), lastLine = lines[lines.length - 1]\n        if (endString.slice(0, lastLine.length) != lastLine) continue search\n        return {from: Pos(line, adjustPos(orig, string, cutFrom, fold) + ch),\n                to: Pos(line + lines.length - 1, adjustPos(end, endString, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function searchStringBackward(doc, query, start, caseFold) {\n    if (!query.length) return null\n    var fold = caseFold ? doFold : noFold\n    var lines = fold(query).split(/\\r|\\n\\r?/)\n\n    search: for (var line = start.line, ch = start.ch, first = doc.firstLine() - 1 + lines.length; line >= first; line--, ch = -1) {\n      var orig = doc.getLine(line)\n      if (ch > -1) orig = orig.slice(0, ch)\n      var string = fold(orig)\n      if (lines.length == 1) {\n        var found = string.lastIndexOf(lines[0])\n        if (found == -1) continue search\n        return {from: Pos(line, adjustPos(orig, string, found, fold)),\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold))}\n      } else {\n        var lastLine = lines[lines.length - 1]\n        if (string.slice(0, lastLine.length) != lastLine) continue search\n        for (var i = 1, start = line - lines.length + 1; i < lines.length - 1; i++)\n          if (fold(doc.getLine(start + i)) != lines[i]) continue search\n        var top = doc.getLine(line + 1 - lines.length), topString = fold(top)\n        if (topString.slice(topString.length - lines[0].length) != lines[0]) continue search\n        return {from: Pos(line + 1 - lines.length, adjustPos(top, topString, top.length - lines[0].length, fold)),\n                to: Pos(line, adjustPos(orig, string, lastLine.length, fold))}\n      }\n    }\n  }\n\n  function SearchCursor(doc, query, pos, options) {\n    this.atOccurrence = false\n    this.doc = doc\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0)\n    this.pos = {from: pos, to: pos}\n\n    var caseFold\n    if (typeof options == \"object\") {\n      caseFold = options.caseFold\n    } else { // Backwards compat for when caseFold was the 4th argument\n      caseFold = options\n      options = null\n    }\n\n    if (typeof query == \"string\") {\n      if (caseFold == null) caseFold = false\n      this.matches = function(reverse, pos) {\n        return (reverse ? searchStringBackward : searchStringForward)(doc, query, pos, caseFold)\n      }\n    } else {\n      query = ensureFlags(query, \"gm\")\n      if (!options || options.multiline !== false)\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackwardMultiline : searchRegexpForwardMultiline)(doc, query, pos)\n        }\n      else\n        this.matches = function(reverse, pos) {\n          return (reverse ? searchRegexpBackward : searchRegexpForward)(doc, query, pos)\n        }\n    }\n  }\n\n  SearchCursor.prototype = {\n    findNext: function() {return this.find(false)},\n    findPrevious: function() {return this.find(true)},\n\n    find: function(reverse) {\n      var result = this.matches(reverse, this.doc.clipPos(reverse ? this.pos.from : this.pos.to))\n\n      // Implements weird auto-growing behavior on null-matches for\n      // backwards-compatiblity with the vim code (unfortunately)\n      while (result && CodeMirror.cmpPos(result.from, result.to) == 0) {\n        if (reverse) {\n          if (result.from.ch) result.from = Pos(result.from.line, result.from.ch - 1)\n          else if (result.from.line == this.doc.firstLine()) result = null\n          else result = this.matches(reverse, this.doc.clipPos(Pos(result.from.line - 1)))\n        } else {\n          if (result.to.ch < this.doc.getLine(result.to.line).length) result.to = Pos(result.to.line, result.to.ch + 1)\n          else if (result.to.line == this.doc.lastLine()) result = null\n          else result = this.matches(reverse, Pos(result.to.line + 1, 0))\n        }\n      }\n\n      if (result) {\n        this.pos = result\n        this.atOccurrence = true\n        return this.pos.match || true\n      } else {\n        var end = Pos(reverse ? this.doc.firstLine() : this.doc.lastLine() + 1, 0)\n        this.pos = {from: end, to: end}\n        return this.atOccurrence = false\n      }\n    },\n\n    from: function() {if (this.atOccurrence) return this.pos.from},\n    to: function() {if (this.atOccurrence) return this.pos.to},\n\n    replace: function(newText, origin) {\n      if (!this.atOccurrence) return\n      var lines = CodeMirror.splitLines(newText)\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin)\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0))\n    }\n  }\n\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this.doc, query, pos, caseFold)\n  })\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this, query, pos, caseFold)\n  })\n\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\n    var ranges = []\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold)\n    while (cur.findNext()) {\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break\n      ranges.push({anchor: cur.from(), head: cur.to()})\n    }\n    if (ranges.length)\n      this.setSelections(ranges, 0)\n  })\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/search/searchcursor.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineExtension(\"annotateScrollbar\", function(options) {\n    if (typeof options == \"string\") options = {className: options};\n    return new Annotation(this, options);\n  });\n\n  CodeMirror.defineOption(\"scrollButtonHeight\", 0);\n\n  function Annotation(cm, options) {\n    this.cm = cm;\n    this.options = options;\n    this.buttonHeight = options.scrollButtonHeight || cm.getOption(\"scrollButtonHeight\");\n    this.annotations = [];\n    this.doRedraw = this.doUpdate = null;\n    this.div = cm.getWrapperElement().appendChild(document.createElement(\"div\"));\n    this.div.style.cssText = \"position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none\";\n    this.computeScale();\n\n    function scheduleRedraw(delay) {\n      clearTimeout(self.doRedraw);\n      self.doRedraw = setTimeout(function() { self.redraw(); }, delay);\n    }\n\n    var self = this;\n    cm.on(\"refresh\", this.resizeHandler = function() {\n      clearTimeout(self.doUpdate);\n      self.doUpdate = setTimeout(function() {\n        if (self.computeScale()) scheduleRedraw(20);\n      }, 100);\n    });\n    cm.on(\"markerAdded\", this.resizeHandler);\n    cm.on(\"markerCleared\", this.resizeHandler);\n    if (options.listenForChanges !== false)\n      cm.on(\"change\", this.changeHandler = function() {\n        scheduleRedraw(250);\n      });\n  }\n\n  Annotation.prototype.computeScale = function() {\n    var cm = this.cm;\n    var hScale = (cm.getWrapperElement().clientHeight - cm.display.barHeight - this.buttonHeight * 2) /\n      cm.getScrollerElement().scrollHeight\n    if (hScale != this.hScale) {\n      this.hScale = hScale;\n      return true;\n    }\n  };\n\n  Annotation.prototype.update = function(annotations) {\n    this.annotations = annotations;\n    this.redraw();\n  };\n\n  Annotation.prototype.redraw = function(compute) {\n    if (compute !== false) this.computeScale();\n    var cm = this.cm, hScale = this.hScale;\n\n    var frag = document.createDocumentFragment(), anns = this.annotations;\n\n    var wrapping = cm.getOption(\"lineWrapping\");\n    var singleLineH = wrapping && cm.defaultTextHeight() * 1.5;\n    var curLine = null, curLineObj = null;\n    function getY(pos, top) {\n      if (curLine != pos.line) {\n        curLine = pos.line;\n        curLineObj = cm.getLineHandle(curLine);\n      }\n      if ((curLineObj.widgets && curLineObj.widgets.length) ||\n          (wrapping && curLineObj.height > singleLineH))\n        return cm.charCoords(pos, \"local\")[top ? \"top\" : \"bottom\"];\n      var topY = cm.heightAtLine(curLineObj, \"local\");\n      return topY + (top ? 0 : curLineObj.height);\n    }\n\n    var lastLine = cm.lastLine()\n    if (cm.display.barWidth) for (var i = 0, nextTop; i < anns.length; i++) {\n      var ann = anns[i];\n      if (ann.to.line > lastLine) continue;\n      var top = nextTop || getY(ann.from, true) * hScale;\n      var bottom = getY(ann.to, false) * hScale;\n      while (i < anns.length - 1) {\n        if (anns[i + 1].to.line > lastLine) break;\n        nextTop = getY(anns[i + 1].from, true) * hScale;\n        if (nextTop > bottom + .9) break;\n        ann = anns[++i];\n        bottom = getY(ann.to, false) * hScale;\n      }\n      if (bottom == top) continue;\n      var height = Math.max(bottom - top, 3);\n\n      var elt = frag.appendChild(document.createElement(\"div\"));\n      elt.style.cssText = \"position: absolute; right: 0px; width: \" + Math.max(cm.display.barWidth - 1, 2) + \"px; top: \"\n        + (top + this.buttonHeight) + \"px; height: \" + height + \"px\";\n      elt.className = this.options.className;\n      if (ann.id) {\n        elt.setAttribute(\"annotation-id\", ann.id);\n      }\n    }\n    this.div.textContent = \"\";\n    this.div.appendChild(frag);\n  };\n\n  Annotation.prototype.clear = function() {\n    this.cm.off(\"refresh\", this.resizeHandler);\n    this.cm.off(\"markerAdded\", this.resizeHandler);\n    this.cm.off(\"markerCleared\", this.resizeHandler);\n    if (this.changeHandler) this.cm.off(\"change\", this.changeHandler);\n    this.div.parentNode.removeChild(this.div);\n  };\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/scroll/annotatescrollbar.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var noOptions = {};\n  var nonWS = /[^\\s\\u00a0]/;\n  var Pos = CodeMirror.Pos;\n\n  function firstNonWS(str) {\n    var found = str.search(nonWS);\n    return found == -1 ? 0 : found;\n  }\n\n  CodeMirror.commands.toggleComment = function(cm) {\n    cm.toggleComment();\n  };\n\n  CodeMirror.defineExtension(\"toggleComment\", function(options) {\n    if (!options) options = noOptions;\n    var cm = this;\n    var minLine = Infinity, ranges = this.listSelections(), mode = null;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      if (from.line >= minLine) continue;\n      if (to.line >= minLine) to = Pos(minLine, 0);\n      minLine = from.line;\n      if (mode == null) {\n        if (cm.uncomment(from, to, options)) mode = \"un\";\n        else { cm.lineComment(from, to, options); mode = \"line\"; }\n      } else if (mode == \"un\") {\n        cm.uncomment(from, to, options);\n      } else {\n        cm.lineComment(from, to, options);\n      }\n    }\n  });\n\n  // Rough heuristic to try and detect lines that are part of multi-line string\n  function probablyInsideString(cm, pos, line) {\n    return /\\bstring\\b/.test(cm.getTokenTypeAt(Pos(pos.line, 0))) && !/^[\\'\\\"\\`]/.test(line)\n  }\n\n  function getMode(cm, pos) {\n    var mode = cm.getMode()\n    return mode.useInnerComments === false || !mode.innerMode ? mode : cm.getModeAt(pos)\n  }\n\n  CodeMirror.defineExtension(\"lineComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var firstLine = self.getLine(from.line);\n    if (firstLine == null || probablyInsideString(self, from, firstLine)) return;\n\n    var commentString = options.lineComment || mode.lineComment;\n    if (!commentString) {\n      if (options.blockCommentStart || mode.blockCommentStart) {\n        options.fullLines = true;\n        self.blockComment(from, to, options);\n      }\n      return;\n    }\n\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line + 1 : to.line, self.lastLine() + 1);\n    var pad = options.padding == null ? \" \" : options.padding;\n    var blankLines = options.commentBlankLines || from.line == to.line;\n\n    self.operation(function() {\n      if (options.indent) {\n        var baseString = null;\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i);\n          var whitespace = line.slice(0, firstNonWS(line));\n          if (baseString == null || baseString.length > whitespace.length) {\n            baseString = whitespace;\n          }\n        }\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i), cut = baseString.length;\n          if (!blankLines && !nonWS.test(line)) continue;\n          if (line.slice(0, cut) != baseString) cut = firstNonWS(line);\n          self.replaceRange(baseString + commentString + pad, Pos(i, 0), Pos(i, cut));\n        }\n      } else {\n        for (var i = from.line; i < end; ++i) {\n          if (blankLines || nonWS.test(self.getLine(i)))\n            self.replaceRange(commentString + pad, Pos(i, 0));\n        }\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"blockComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) {\n      if ((options.lineComment || mode.lineComment) && options.fullLines != false)\n        self.lineComment(from, to, options);\n      return;\n    }\n    if (/\\bcomment\\b/.test(self.getTokenTypeAt(Pos(from.line, 0)))) return\n\n    var end = Math.min(to.line, self.lastLine());\n    if (end != from.line && to.ch == 0 && nonWS.test(self.getLine(end))) --end;\n\n    var pad = options.padding == null ? \" \" : options.padding;\n    if (from.line > end) return;\n\n    self.operation(function() {\n      if (options.fullLines != false) {\n        var lastLineHasText = nonWS.test(self.getLine(end));\n        self.replaceRange(pad + endString, Pos(end));\n        self.replaceRange(startString + pad, Pos(from.line, 0));\n        var lead = options.blockCommentLead || mode.blockCommentLead;\n        if (lead != null) for (var i = from.line + 1; i <= end; ++i)\n          if (i != end || lastLineHasText)\n            self.replaceRange(lead + pad, Pos(i, 0));\n      } else {\n        self.replaceRange(endString, to);\n        self.replaceRange(startString, from);\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"uncomment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = getMode(self, from);\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line : to.line - 1, self.lastLine()), start = Math.min(from.line, end);\n\n    // Try finding line comments\n    var lineString = options.lineComment || mode.lineComment, lines = [];\n    var pad = options.padding == null ? \" \" : options.padding, didSomething;\n    lineComment: {\n      if (!lineString) break lineComment;\n      for (var i = start; i <= end; ++i) {\n        var line = self.getLine(i);\n        var found = line.indexOf(lineString);\n        if (found > -1 && !/comment/.test(self.getTokenTypeAt(Pos(i, found + 1)))) found = -1;\n        if (found == -1 && nonWS.test(line)) break lineComment;\n        if (found > -1 && nonWS.test(line.slice(0, found))) break lineComment;\n        lines.push(line);\n      }\n      self.operation(function() {\n        for (var i = start; i <= end; ++i) {\n          var line = lines[i - start];\n          var pos = line.indexOf(lineString), endPos = pos + lineString.length;\n          if (pos < 0) continue;\n          if (line.slice(endPos, endPos + pad.length) == pad) endPos += pad.length;\n          didSomething = true;\n          self.replaceRange(\"\", Pos(i, pos), Pos(i, endPos));\n        }\n      });\n      if (didSomething) return true;\n    }\n\n    // Try block comments\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) return false;\n    var lead = options.blockCommentLead || mode.blockCommentLead;\n    var startLine = self.getLine(start), open = startLine.indexOf(startString)\n    if (open == -1) return false\n    var endLine = end == start ? startLine : self.getLine(end)\n    var close = endLine.indexOf(endString, end == start ? open + startString.length : 0);\n    var insideStart = Pos(start, open + 1), insideEnd = Pos(end, close + 1)\n    if (close == -1 ||\n        !/comment/.test(self.getTokenTypeAt(insideStart)) ||\n        !/comment/.test(self.getTokenTypeAt(insideEnd)) ||\n        self.getRange(insideStart, insideEnd, \"\\n\").indexOf(endString) > -1)\n      return false;\n\n    // Avoid killing block comments completely outside the selection.\n    // Positions of the last startString before the start of the selection, and the first endString after it.\n    var lastStart = startLine.lastIndexOf(startString, from.ch);\n    var firstEnd = lastStart == -1 ? -1 : startLine.slice(0, from.ch).indexOf(endString, lastStart + startString.length);\n    if (lastStart != -1 && firstEnd != -1 && firstEnd + endString.length != from.ch) return false;\n    // Positions of the first endString after the end of the selection, and the last startString before it.\n    firstEnd = endLine.indexOf(endString, to.ch);\n    var almostLastStart = endLine.slice(to.ch).lastIndexOf(startString, firstEnd - to.ch);\n    lastStart = (firstEnd == -1 || almostLastStart == -1) ? -1 : to.ch + almostLastStart;\n    if (firstEnd != -1 && lastStart != -1 && lastStart != to.ch) return false;\n\n    self.operation(function() {\n      self.replaceRange(\"\", Pos(end, close - (pad && endLine.slice(close - pad.length, close) == pad ? pad.length : 0)),\n                        Pos(end, close + endString.length));\n      var openEnd = open + startString.length;\n      if (pad && startLine.slice(openEnd, openEnd + pad.length) == pad) openEnd += pad.length;\n      self.replaceRange(\"\", Pos(start, open), Pos(start, openEnd));\n      if (lead) for (var i = start + 1; i <= end; ++i) {\n        var line = self.getLine(i), found = line.indexOf(lead);\n        if (found == -1 || nonWS.test(line.slice(0, found))) continue;\n        var foundEnd = found + lead.length;\n        if (pad && line.slice(foundEnd, foundEnd + pad.length) == pad) foundEnd += pad.length;\n        self.replaceRange(\"\", Pos(i, found), Pos(i, foundEnd));\n      }\n    });\n    return true;\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/comment/comment.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var WORD = /[\\w$]+/, RANGE = 500;\n\n  CodeMirror.registerHelper(\"hint\", \"anyword\", function(editor, options) {\n    var word = options && options.word || WORD;\n    var range = options && options.range || RANGE;\n    var cur = editor.getCursor(), curLine = editor.getLine(cur.line);\n    var end = cur.ch, start = end;\n    while (start && word.test(curLine.charAt(start - 1))) --start;\n    var curWord = start != end && curLine.slice(start, end);\n\n    var list = options && options.list || [], seen = {};\n    var re = new RegExp(word.source, \"g\");\n    for (var dir = -1; dir <= 1; dir += 2) {\n      var line = cur.line, endLine = Math.min(Math.max(line + dir * range, editor.firstLine()), editor.lastLine()) + dir;\n      for (; line != endLine; line += dir) {\n        var text = editor.getLine(line), m;\n        while (m = re.exec(text)) {\n          if (line == cur.line && m[0] === curWord) continue;\n          if ((!curWord || m[0].lastIndexOf(curWord, 0) == 0) && !Object.prototype.hasOwnProperty.call(seen, m[0])) {\n            seen[m[0]] = true;\n            list.push(m[0]);\n          }\n        }\n      }\n    }\n    return {list: list, from: CodeMirror.Pos(cur.line, start), to: CodeMirror.Pos(cur.line, end)};\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/hint/anyword-hint.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\n\n  // This is the old interface, kept around for now to stay\n  // backwards-compatible.\n  CodeMirror.showHint = function(cm, getHints, options) {\n    if (!getHints) return cm.showHint(options);\n    if (options && options.async) getHints.async = true;\n    var newOpts = {hint: getHints};\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\n    return cm.showHint(newOpts);\n  };\n\n  CodeMirror.defineExtension(\"showHint\", function(options) {\n    options = parseOptions(this, this.getCursor(\"start\"), options);\n    var selections = this.listSelections()\n    if (selections.length > 1) return;\n    // By default, don't allow completion when something is selected.\n    // A hint function can have a `supportsSelection` property to\n    // indicate that it can handle selections.\n    if (this.somethingSelected()) {\n      if (!options.hint.supportsSelection) return;\n      // Don't try with cross-line selections\n      for (var i = 0; i < selections.length; i++)\n        if (selections[i].head.line != selections[i].anchor.line) return;\n    }\n\n    if (this.state.completionActive) this.state.completionActive.close();\n    var completion = this.state.completionActive = new Completion(this, options);\n    if (!completion.options.hint) return;\n\n    CodeMirror.signal(this, \"startCompletion\", this);\n    completion.update(true);\n  });\n\n  function Completion(cm, options) {\n    this.cm = cm;\n    this.options = options;\n    this.widget = null;\n    this.debounce = 0;\n    this.tick = 0;\n    this.startPos = this.cm.getCursor(\"start\");\n    this.startLen = this.cm.getLine(this.startPos.line).length - this.cm.getSelection().length;\n\n    var self = this;\n    cm.on(\"cursorActivity\", this.activityFunc = function() { self.cursorActivity(); });\n  }\n\n  var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\n    return setTimeout(fn, 1000/60);\n  };\n  var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n      this.tick = null;\n      this.cm.off(\"cursorActivity\", this.activityFunc);\n\n      if (this.widget && this.data) CodeMirror.signal(this.data, \"close\");\n      if (this.widget) this.widget.close();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i];\n      if (completion.hint) completion.hint(this.cm, data, completion);\n      else this.cm.replaceRange(getText(completion), completion.from || data.from,\n                                completion.to || data.to, \"complete\");\n      CodeMirror.signal(data, \"pick\", completion);\n      this.close();\n    },\n\n    cursorActivity: function() {\n      if (this.debounce) {\n        cancelAnimationFrame(this.debounce);\n        this.debounce = 0;\n      }\n\n      var pos = this.cm.getCursor(), line = this.cm.getLine(pos.line);\n      if (pos.line != this.startPos.line || line.length - pos.ch != this.startLen - this.startPos.ch ||\n          pos.ch < this.startPos.ch || this.cm.somethingSelected() ||\n          (!pos.ch || this.options.closeCharacters.test(line.charAt(pos.ch - 1)))) {\n        this.close();\n      } else {\n        var self = this;\n        this.debounce = requestAnimationFrame(function() {self.update();});\n        if (this.widget) this.widget.disable();\n      }\n    },\n\n    update: function(first) {\n      if (this.tick == null) return\n      var self = this, myTick = ++this.tick\n      fetchHints(this.options.hint, this.cm, this.options, function(data) {\n        if (self.tick == myTick) self.finishUpdate(data, first)\n      })\n    },\n\n    finishUpdate: function(data, first) {\n      if (this.data) CodeMirror.signal(this.data, \"update\");\n\n      var picked = (this.widget && this.widget.picked) || (first && this.options.completeSingle);\n      if (this.widget) this.widget.close();\n\n      this.data = data;\n\n      if (data && data.list.length) {\n        if (picked && data.list.length == 1) {\n          this.pick(data, 0);\n        } else {\n          this.widget = new Widget(this, data);\n          CodeMirror.signal(data, \"shown\");\n        }\n      }\n    }\n  };\n\n  function parseOptions(cm, pos, options) {\n    var editor = cm.options.hintOptions;\n    var out = {};\n    for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\n    if (editor) for (var prop in editor)\n      if (editor[prop] !== undefined) out[prop] = editor[prop];\n    if (options) for (var prop in options)\n      if (options[prop] !== undefined) out[prop] = options[prop];\n    if (out.hint.resolve) out.hint = out.hint.resolve(cm, pos)\n    return out;\n  }\n\n  function getText(completion) {\n    if (typeof completion == \"string\") return completion;\n    else return completion.text;\n  }\n\n  function buildKeyMap(completion, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length - 1);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n    var custom = completion.options.customKeys;\n    var ourMap = custom ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (custom)\n      for (var key in custom) if (custom.hasOwnProperty(key))\n        addBinding(key, custom[key]);\n    var extra = completion.options.extraKeys;\n    if (extra)\n      for (var key in extra) if (extra.hasOwnProperty(key))\n        addBinding(key, extra[key]);\n    return ourMap;\n  }\n\n  function getHintElement(hintsElement, el) {\n    while (el && el != hintsElement) {\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\n      el = el.parentNode;\n    }\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    this.picked = false;\n    var widget = this, cm = completion.cm;\n\n    var hints = this.hints = document.createElement(\"ul\");\n    var theme = completion.cm.options.theme;\n    hints.className = \"CodeMirror-hints \" + theme;\n    this.selectedHint = data.selectedHint || 0;\n\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(document.createElement(\"li\")), cur = completions[i];\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else elt.appendChild(document.createTextNode(cur.displayText || getText(cur)));\n      elt.hintId = i;\n    }\n\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    hints.style.left = left + \"px\";\n    hints.style.top = top + \"px\";\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);\n    var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);\n    (completion.options.container || document.body).appendChild(hints);\n    var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;\n    var scrolls = hints.scrollHeight > hints.clientHeight + 1\n    var startScroll = cm.getScrollInfo();\n\n    if (overlapY > 0) {\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\n      if (curTop - height > 0) { // Fits above cursor\n        hints.style.top = (top = pos.top - height) + \"px\";\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        hints.style.top = (top = pos.bottom - box.top) + \"px\";\n        var cursor = cm.getCursor();\n        if (data.from.ch != cursor.ch) {\n          pos = cm.cursorCoords(cursor);\n          hints.style.left = (left = pos.left) + \"px\";\n          box = hints.getBoundingClientRect();\n        }\n      }\n    }\n    var overlapX = box.right - winW;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX) + \"px\";\n    }\n    if (scrolls) for (var node = hints.firstChild; node; node = node.nextSibling)\n      node.style.paddingRight = cm.display.nativeBarWidth + \"px\"\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); },\n      data: data\n    }));\n\n    if (completion.options.closeOnUnfocus) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"dblclick\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {\n        widget.changeActive(t.hintId);\n        if (completion.options.completeOnSingleClick) widget.pick();\n      }\n    });\n\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n\n    CodeMirror.signal(data, \"select\", completions[this.selectedHint], hints.childNodes[this.selectedHint]);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    disable: function() {\n      this.completion.cm.removeKeyMap(this.keyMap);\n      var widget = this;\n      this.keyMap = {Enter: function() { widget.picked = true; }};\n      this.completion.cm.addKeyMap(this.keyMap);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i, avoidWrap) {\n      if (i >= this.data.list.length)\n        i = avoidWrap ? this.data.list.length - 1 : 0;\n      else if (i < 0)\n        i = avoidWrap ? 0  : this.data.list.length - 1;\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      if (node) node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\n      if (node.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node.offsetTop - 3;\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    }\n  };\n\n  function applicableHelpers(cm, helpers) {\n    if (!cm.somethingSelected()) return helpers\n    var result = []\n    for (var i = 0; i < helpers.length; i++)\n      if (helpers[i].supportsSelection) result.push(helpers[i])\n    return result\n  }\n\n  function fetchHints(hint, cm, options, callback) {\n    if (hint.async) {\n      hint(cm, callback, options)\n    } else {\n      var result = hint(cm, options)\n      if (result && result.then) result.then(callback)\n      else callback(result)\n    }\n  }\n\n  function resolveAutoHints(cm, pos) {\n    var helpers = cm.getHelpers(pos, \"hint\"), words\n    if (helpers.length) {\n      var resolved = function(cm, callback, options) {\n        var app = applicableHelpers(cm, helpers);\n        function run(i) {\n          if (i == app.length) return callback(null)\n          fetchHints(app[i], cm, options, function(result) {\n            if (result && result.list.length > 0) callback(result)\n            else run(i + 1)\n          })\n        }\n        run(0)\n      }\n      resolved.async = true\n      resolved.supportsSelection = true\n      return resolved\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\n      return function(cm) { return CodeMirror.hint.fromList(cm, {words: words}) }\n    } else if (CodeMirror.hint.anyword) {\n      return function(cm, options) { return CodeMirror.hint.anyword(cm, options) }\n    } else {\n      return function() {}\n    }\n  }\n\n  CodeMirror.registerHelper(\"hint\", \"auto\", {\n    resolve: resolveAutoHints\n  });\n\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur)\n    var term, from = CodeMirror.Pos(cur.line, token.start), to = cur\n    if (token.start < cur.ch && /\\w/.test(token.string.charAt(cur.ch - token.start - 1))) {\n      term = token.string.substr(0, cur.ch - token.start)\n    } else {\n      term = \"\"\n      from = cur\n    }\n    var found = [];\n    for (var i = 0; i < options.words.length; i++) {\n      var word = options.words[i];\n      if (word.slice(0, term.length) == term)\n        found.push(word);\n    }\n\n    if (found.length) return {list: found, from: from, to: to};\n  });\n\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\n\n  var defaultOptions = {\n    hint: CodeMirror.hint.auto,\n    completeSingle: true,\n    alignWithWord: true,\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\n    closeOnUnfocus: true,\n    completeOnSingleClick: true,\n    container: null,\n    customKeys: null,\n    extraKeys: null\n  };\n\n  CodeMirror.defineOption(\"hintOptions\", null);\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/hint/show-hint.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function (mod) {\n    if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n        mod(require(\"../../lib/codemirror\"));\n    else if (typeof define == \"function\" && define.amd) // AMD\n        define([\"../../lib/codemirror\"], mod);\n    else // Plain browser env\n        mod(CodeMirror);\n})(function (CodeMirror) {\n\n    function forEach(arr, f) {\n        for (var i = 0, e = arr.length; i < e; ++i) f(arr[i]);\n    }\n\n    function arrayContains(arr, item) {\n        if (!Array.prototype.indexOf) {\n            var i = arr.length;\n            while (i--) {\n                if (arr[i] === item) {\n                    return true;\n                }\n            }\n            return false;\n        }\n        return arr.indexOf(item) != -1;\n    }\n\n    var glslTypes = (\"float vec2 vec3 vec4 int ivec2 ivec3 ivec4 bool bvec2 bvec3 bvec4 mat2 mat3 mat4 \" +\n        \"void sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow\").split(\" \");\n\n    var glslTypesQualifiers = (\"uniform attribute varying const in out inout const\").split(\" \");\n    var glslPreProcessor = (\"#define #undef #if #ifdef #ifndef #else #elif #endif #error #pragma #line #version #extension\").split(\" \");\n\n    var glslKeywords = (\"break continue do for while if else true false \" +\n        \"lowp mediump highp precision invariant discard return \" +\n        \"gl_Position gl_PointSize gl_ClipVertex gl_Vertex gl_Normal gl_Color \" +\n        \"gl_SecondaryColor gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 \" +\n        \"gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 \" +\n        \"gl_MultiTexCoord7 gl_FogCoord gl_FrontColor gl_BackColor \" +\n        \"gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord \" +\n        \"gl_FragColor gl_FragData gl_FragDepth gl_Color gl_SecondaryColor gl_FogFragCoord \" +\n        \"gl_FragCoord gl_FrontFacing\").split(\" \");\n\n    var glslBuiltins = (\"sin cos tan asin acos atan atan radians degrees \" +\n        \"pow exp log exp2 log2 sqrt inversesqrt abs ceil \" +\n        \"clamp floor fract max min mix mod sign smoothstep \" +\n        \"step ftransform cross distance dot faceforward \" +\n        \"length normalize reflect refract dFdx dFdy fwidth \" +\n        \"matrixCompMult all any equal greaterThan greaterThanEqual \" +\n        \"lessThan lessThanEqual notEqual \" +\n        \"texture1D texture1DProj texture1DProj \" +\n        \"texture2D texture2DProj texture2DProj \" +\n        \"texture3D texture3DProj \" +\n        \"textureCube shadow1D shadow2D shadow1DProj shadow2DProj \" +\n        \"texture1DLod texture1DProjLod texture1DProjLod \" +\n        \"texture2DLod texture2DProjLod texture2DProjLod texture3DProjLod \" +\n        \"textureCubeLod shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod \" +\n        \"gl_ModelViewMatrix gl_ModelViewProjectionMatrix gl_ProjectionMatrix \" +\n        \"gl_TextureMatrix gl_ModelViewMatrixInverse gl_ModelViewProjectionMatrixInverse \" +\n        \"gl_ProjectionMatrixInverse gl_TextureMatrixInverse gl_ModelViewMatrixTranspose \" +\n        \"gl_ModelViewProjectionMatrixTranspose gl_ProjectionMatrixTranspose \" +\n        \"gl_TextureMatrixTranspose gl_ModelViewMatrixInverseTranspose \" +\n        \"gl_ModelViewProjectionMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose \" +\n        \"gl_TextureMatrixInverseTranspose gl_NormalMatrix gl_NormalScale \").split(\" \");\n\n    function scriptHint(editor, getToken, options) {\n        // Find the token at the cursor\n        var cur = editor.getCursor(), token = getToken(editor, cur), tprop = token;\n        // If it's not a 'word-style' token, ignore the token.\n        /*if (!/^[\\w$_]*$/.test(token.string)) {\n      token = tprop = {start: cur.ch, end: cur.ch, string: \"\", state: token.state,\n                       type: token.string == \".\" ? \"property\" : null};\n    }*/\n\n        var variableNames = [];\n        for (var line = 0; line < editor.lineCount() && line < editor.getCursor().line; line++) {\n            var lineContent = editor.getLine(line);\n            var containsType = false;\n            var typeIndex;\n\n            for (var i = 0, e = glslTypes.length; i < e; ++i) {\n                typeIndex = lineContent.indexOf(glslTypes[i]);\n                if (typeIndex != -1) {\n                    containsType = true;\n                    break;\n                }\n            }\n\n            if (containsType) {\n                var variableName = lineContent.substring(typeIndex);\n                variableName = variableName.substring(variableName.search(/\\s/));\n                variableName = variableName.replace(/\\s+/g, '');\n                variableName = variableName.substring(0, variableName.search(/[^A-Za-z]/));\n                if (variableName != \"main\")\n                    variableNames.push(variableName);\n            }\n\n        }\n\n        return {\n            list: getCompletions(token, variableNames, options),\n            from: { line: cur.line, ch: token.start },\n            to: { line: cur.line, ch: token.end }\n        };\n    }\n\n    CodeMirror.glslHint = function (editor, options) {\n        return scriptHint(editor,\n            function (e, cur) { return e.getTokenAt(cur); },\n            options);\n    };\n\n\n    function getCompletions(token, variableNames, options) {\n        var found = [], start = token.string;\n        function maybeAdd(str) {\n            if (str.indexOf(start) == 0 && !arrayContains(found, str)) found.push(str);\n        }\n        for (var i = 0; i < variableNames.length; i++) {\n            maybeAdd(variableNames[i]);\n        }\n\n        forEach(glslTypes, maybeAdd);\n        forEach(glslTypesQualifiers, maybeAdd);\n        forEach(glslPreProcessor, maybeAdd);\n        forEach(glslKeywords, maybeAdd);\n        forEach(glslBuiltins, maybeAdd);\n\n        return found;\n    }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/hint/glsl-hint.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// Open simple dialogs on top of an editor. Relies on dialog.css.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  function dialogDiv(cm, template, bottom) {\n    var wrap = cm.getWrapperElement();\n    var dialog;\n    dialog = wrap.appendChild(document.createElement(\"div\"));\n    if (bottom)\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-bottom\";\n    else\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-top\";\n\n    if (typeof template == \"string\") {\n      dialog.innerHTML = template;\n    } else { // Assuming it's a detached DOM element.\n      dialog.appendChild(template);\n    }\n    return dialog;\n  }\n\n  function closeNotification(cm, newVal) {\n    if (cm.state.currentNotificationClose)\n      cm.state.currentNotificationClose();\n    cm.state.currentNotificationClose = newVal;\n  }\n\n  CodeMirror.defineExtension(\"openDialog\", function(template, callback, options) {\n    if (!options) options = {};\n\n    closeNotification(this, null);\n\n    var dialog = dialogDiv(this, template, options.bottom);\n    var closed = false, me = this;\n    function close(newVal) {\n      if (typeof newVal == 'string') {\n        inp.value = newVal;\n      } else {\n        if (closed) return;\n        closed = true;\n        dialog.parentNode.removeChild(dialog);\n        me.focus();\n\n        if (options.onClose) options.onClose(dialog);\n      }\n    }\n\n    var inp = dialog.getElementsByTagName(\"input\")[0], button;\n    if (inp) {\n      inp.focus();\n\n      if (options.value) {\n        inp.value = options.value;\n        if (options.selectValueOnOpen !== false) {\n          inp.select();\n        }\n      }\n\n      if (options.onInput)\n        CodeMirror.on(inp, \"input\", function(e) { options.onInput(e, inp.value, close);});\n      if (options.onKeyUp)\n        CodeMirror.on(inp, \"keyup\", function(e) {options.onKeyUp(e, inp.value, close);});\n\n      CodeMirror.on(inp, \"keydown\", function(e) {\n        if (options && options.onKeyDown && options.onKeyDown(e, inp.value, close)) { return; }\n        if (e.keyCode == 27 || (options.closeOnEnter !== false && e.keyCode == 13)) {\n          inp.blur();\n          CodeMirror.e_stop(e);\n          close();\n        }\n        if (e.keyCode == 13) callback(inp.value, e);\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(inp, \"blur\", close);\n    } else if (button = dialog.getElementsByTagName(\"button\")[0]) {\n      CodeMirror.on(button, \"click\", function() {\n        close();\n        me.focus();\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(button, \"blur\", close);\n\n      button.focus();\n    }\n    return close;\n  });\n\n  CodeMirror.defineExtension(\"openConfirm\", function(template, callbacks, options) {\n    closeNotification(this, null);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var buttons = dialog.getElementsByTagName(\"button\");\n    var closed = false, me = this, blurring = 1;\n    function close() {\n      if (closed) return;\n      closed = true;\n      dialog.parentNode.removeChild(dialog);\n      me.focus();\n    }\n    buttons[0].focus();\n    for (var i = 0; i < buttons.length; ++i) {\n      var b = buttons[i];\n      (function(callback) {\n        CodeMirror.on(b, \"click\", function(e) {\n          CodeMirror.e_preventDefault(e);\n          close();\n          if (callback) callback(me);\n        });\n      })(callbacks[i]);\n      CodeMirror.on(b, \"blur\", function() {\n        --blurring;\n        setTimeout(function() { if (blurring <= 0) close(); }, 200);\n      });\n      CodeMirror.on(b, \"focus\", function() { ++blurring; });\n    }\n  });\n\n  /*\n   * openNotification\n   * Opens a notification, that can be closed with an optional timer\n   * (default 5000ms timer) and always closes on click.\n   *\n   * If a notification is opened while another is opened, it will close the\n   * currently opened one and open the new one immediately.\n   */\n  CodeMirror.defineExtension(\"openNotification\", function(template, options) {\n    closeNotification(this, close);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var closed = false, doneTimer;\n    var duration = options && typeof options.duration !== \"undefined\" ? options.duration : 5000;\n\n    function close() {\n      if (closed) return;\n      closed = true;\n      clearTimeout(doneTimer);\n      dialog.parentNode.removeChild(dialog);\n    }\n\n    CodeMirror.on(dialog, 'click', function(e) {\n      CodeMirror.e_preventDefault(e);\n      close();\n    });\n\n    if (duration)\n      doneTimer = setTimeout(close, duration);\n\n    return close;\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/dialog/dialog.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Define search commands. Depends on dialog.js or another\n// implementation of the openDialog method.\n\n// Replace works a little oddly -- it will do the replace on the next\n// Ctrl-G (or whatever is bound to findNext) press. You prevent a\n// replace by making sure the match is no longer selected when hitting\n// Ctrl-G.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./searchcursor\"), require(\"../dialog/dialog\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./searchcursor\", \"../dialog/dialog\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function searchOverlay(query, caseInsensitive) {\n    if (typeof query == \"string\")\n      query = new RegExp(query.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\"), caseInsensitive ? \"gi\" : \"g\");\n    else if (!query.global)\n      query = new RegExp(query.source, query.ignoreCase ? \"gi\" : \"g\");\n\n    return {token: function(stream) {\n      query.lastIndex = stream.pos;\n      var match = query.exec(stream.string);\n      if (match && match.index == stream.pos) {\n        stream.pos += match[0].length || 1;\n        return \"searching\";\n      } else if (match) {\n        stream.pos = match.index;\n      } else {\n        stream.skipToEnd();\n      }\n    }};\n  }\n\n  function SearchState() {\n    this.posFrom = this.posTo = this.lastQuery = this.query = null;\n    this.overlay = null;\n  }\n\n  function getSearchState(cm) {\n    return cm.state.search || (cm.state.search = new SearchState());\n  }\n\n  function queryCaseInsensitive(query) {\n    return typeof query == \"string\" && query == query.toLowerCase();\n  }\n\n  function getSearchCursor(cm, query, pos) {\n    // Heuristic: if the query string is all lowercase, do a case insensitive search.\n    return cm.getSearchCursor(query, pos, {caseFold: queryCaseInsensitive(query), multiline: true});\n  }\n\n  function persistentDialog(cm, text, deflt, onEnter, onKeyDown) {\n    cm.openDialog(text, onEnter, {\n      value: deflt,\n      selectValueOnOpen: true,\n      closeOnEnter: false,\n      onClose: function() { clearSearch(cm); },\n      onKeyDown: onKeyDown\n    });\n  }\n\n  function dialog(cm, text, shortText, deflt, f) {\n    if (cm.openDialog) cm.openDialog(text, f, {value: deflt, selectValueOnOpen: true});\n    else f(prompt(shortText, deflt));\n  }\n\n  function confirmDialog(cm, text, shortText, fs) {\n    if (cm.openConfirm) cm.openConfirm(text, fs);\n    else if (confirm(shortText)) fs[0]();\n  }\n\n  function parseString(string) {\n    return string.replace(/\\\\(.)/g, function(_, ch) {\n      if (ch == \"n\") return \"\\n\"\n      if (ch == \"r\") return \"\\r\"\n      return ch\n    })\n  }\n\n  function parseQuery(query) {\n    var isRE = query.match(/^\\/(.*)\\/([a-z]*)$/);\n    if (isRE) {\n      try { query = new RegExp(isRE[1], isRE[2].indexOf(\"i\") == -1 ? \"\" : \"i\"); }\n      catch(e) {} // Not a regular expression after all, do a string search\n    } else {\n      query = parseString(query)\n    }\n    if (typeof query == \"string\" ? query == \"\" : query.test(\"\"))\n      query = /x^/;\n    return query;\n  }\n\n  function startSearch(cm, state, query) {\n    state.queryText = query;\n    state.query = parseQuery(query);\n    cm.removeOverlay(state.overlay, queryCaseInsensitive(state.query));\n    state.overlay = searchOverlay(state.query, queryCaseInsensitive(state.query));\n    cm.addOverlay(state.overlay);\n    if (cm.showMatchesOnScrollbar) {\n      if (state.annotate) { state.annotate.clear(); state.annotate = null; }\n      state.annotate = cm.showMatchesOnScrollbar(state.query, queryCaseInsensitive(state.query));\n    }\n  }\n\n  function doSearch(cm, rev, persistent, immediate) {\n    var state = getSearchState(cm);\n    if (state.query) return findNext(cm, rev);\n    var q = cm.getSelection() || state.lastQuery;\n    if (q instanceof RegExp && q.source == \"x^\") q = null\n    if (persistent && cm.openDialog) {\n      var hiding = null\n      var searchNext = function(query, event) {\n        CodeMirror.e_stop(event);\n        if (!query) return;\n        if (query != state.queryText) {\n          startSearch(cm, state, query);\n          state.posFrom = state.posTo = cm.getCursor();\n        }\n        if (hiding) hiding.style.opacity = 1\n        findNext(cm, event.shiftKey, function(_, to) {\n          var dialog\n          if (to.line < 3 && document.querySelector &&\n              (dialog = cm.display.wrapper.querySelector(\".CodeMirror-dialog\")) &&\n              dialog.getBoundingClientRect().bottom - 4 > cm.cursorCoords(to, \"window\").top)\n            (hiding = dialog).style.opacity = .4\n        })\n      };\n      persistentDialog(cm, getQueryDialog(cm), q, searchNext, function(event, query) {\n        var keyName = CodeMirror.keyName(event)\n        var extra = cm.getOption('extraKeys'), cmd = (extra && extra[keyName]) || CodeMirror.keyMap[cm.getOption(\"keyMap\")][keyName]\n        if (cmd == \"findNext\" || cmd == \"findPrev\" ||\n          cmd == \"findPersistentNext\" || cmd == \"findPersistentPrev\") {\n          CodeMirror.e_stop(event);\n          startSearch(cm, getSearchState(cm), query);\n          cm.execCommand(cmd);\n        } else if (cmd == \"find\" || cmd == \"findPersistent\") {\n          CodeMirror.e_stop(event);\n          searchNext(query, event);\n        }\n      });\n      if (immediate && q) {\n        startSearch(cm, state, q);\n        findNext(cm, rev);\n      }\n    } else {\n      dialog(cm, getQueryDialog(cm), \"Search for:\", q, function(query) {\n        if (query && !state.query) cm.operation(function() {\n          startSearch(cm, state, query);\n          state.posFrom = state.posTo = cm.getCursor();\n          findNext(cm, rev);\n        });\n      });\n    }\n  }\n\n  function findNext(cm, rev, callback) {cm.operation(function() {\n    var state = getSearchState(cm);\n    var cursor = getSearchCursor(cm, state.query, rev ? state.posFrom : state.posTo);\n    if (!cursor.find(rev)) {\n      cursor = getSearchCursor(cm, state.query, rev ? CodeMirror.Pos(cm.lastLine()) : CodeMirror.Pos(cm.firstLine(), 0));\n      if (!cursor.find(rev)) return;\n    }\n    cm.setSelection(cursor.from(), cursor.to());\n    cm.scrollIntoView({from: cursor.from(), to: cursor.to()}, 20);\n    state.posFrom = cursor.from(); state.posTo = cursor.to();\n    if (callback) callback(cursor.from(), cursor.to())\n  });}\n\n  function clearSearch(cm) {cm.operation(function() {\n    var state = getSearchState(cm);\n    state.lastQuery = state.query;\n    if (!state.query) return;\n    state.query = state.queryText = null;\n    cm.removeOverlay(state.overlay);\n    if (state.annotate) { state.annotate.clear(); state.annotate = null; }\n  });}\n\n\n  function getQueryDialog(cm)  {\n    return '<span class=\"CodeMirror-search-label\">' + cm.phrase(\"Search:\") + '</span> <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">' + cm.phrase(\"(Use /re/ syntax for regexp search)\") + '</span>';\n  }\n  function getReplaceQueryDialog(cm) {\n    return ' <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">' + cm.phrase(\"(Use /re/ syntax for regexp search)\") + '</span>';\n  }\n  function getReplacementQueryDialog(cm) {\n    return '<span class=\"CodeMirror-search-label\">' + cm.phrase(\"With:\") + '</span> <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/>';\n  }\n  function getDoReplaceConfirm(cm) {\n    return '<span class=\"CodeMirror-search-label\">' + cm.phrase(\"Replace?\") + '</span> <button>' + cm.phrase(\"Yes\") + '</button> <button>' + cm.phrase(\"No\") + '</button> <button>' + cm.phrase(\"All\") + '</button> <button>' + cm.phrase(\"Stop\") + '</button> ';\n  }\n\n  function replaceAll(cm, query, text) {\n    cm.operation(function() {\n      for (var cursor = getSearchCursor(cm, query); cursor.findNext();) {\n        if (typeof query != \"string\") {\n          var match = cm.getRange(cursor.from(), cursor.to()).match(query);\n          cursor.replace(text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\n        } else cursor.replace(text);\n      }\n    });\n  }\n\n  function replace(cm, all) {\n    if (cm.getOption(\"readOnly\")) return;\n    var query = cm.getSelection() || getSearchState(cm).lastQuery;\n    var dialogText = '<span class=\"CodeMirror-search-label\">' + (all ? cm.phrase(\"Replace all:\") : cm.phrase(\"Replace:\")) + '</span>';\n    dialog(cm, dialogText + getReplaceQueryDialog(cm), dialogText, query, function(query) {\n      if (!query) return;\n      query = parseQuery(query);\n      dialog(cm, getReplacementQueryDialog(cm), cm.phrase(\"Replace with:\"), \"\", function(text) {\n        text = parseString(text)\n        if (all) {\n          replaceAll(cm, query, text)\n        } else {\n          clearSearch(cm);\n          var cursor = getSearchCursor(cm, query, cm.getCursor(\"from\"));\n          var advance = function() {\n            var start = cursor.from(), match;\n            if (!(match = cursor.findNext())) {\n              cursor = getSearchCursor(cm, query);\n              if (!(match = cursor.findNext()) ||\n                  (start && cursor.from().line == start.line && cursor.from().ch == start.ch)) return;\n            }\n            cm.setSelection(cursor.from(), cursor.to());\n            cm.scrollIntoView({from: cursor.from(), to: cursor.to()});\n            confirmDialog(cm, getDoReplaceConfirm(cm), cm.phrase(\"Replace?\"),\n                          [function() {doReplace(match);}, advance,\n                           function() {replaceAll(cm, query, text)}]);\n          };\n          var doReplace = function(match) {\n            cursor.replace(typeof query == \"string\" ? text :\n                           text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\n            advance();\n          };\n          advance();\n        }\n      });\n    });\n  }\n\n  CodeMirror.commands.find = function(cm) {clearSearch(cm); doSearch(cm);};\n  CodeMirror.commands.findPersistent = function(cm) {clearSearch(cm); doSearch(cm, false, true);};\n  CodeMirror.commands.findPersistentNext = function(cm) {doSearch(cm, false, true, true);};\n  CodeMirror.commands.findPersistentPrev = function(cm) {doSearch(cm, true, true, true);};\n  CodeMirror.commands.findNext = doSearch;\n  CodeMirror.commands.findPrev = function(cm) {doSearch(cm, true);};\n  CodeMirror.commands.clearSearch = clearSearch;\n  CodeMirror.commands.replace = replace;\n  CodeMirror.commands.replaceAll = function(cm) {replace(cm, true);};\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/search/search.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Defines jumpToLine command. Uses dialog.js if present.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"../dialog/dialog\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"../dialog/dialog\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function dialog(cm, text, shortText, deflt, f) {\n    if (cm.openDialog) cm.openDialog(text, f, {value: deflt, selectValueOnOpen: true});\n    else f(prompt(shortText, deflt));\n  }\n\n  function getJumpDialog(cm) {\n    return cm.phrase(\"Jump to line:\") + ' <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">' + cm.phrase(\"(Use line:column or scroll% syntax)\") + '</span>';\n  }\n\n  function interpretLine(cm, string) {\n    var num = Number(string)\n    if (/^[-+]/.test(string)) return cm.getCursor().line + num\n    else return num - 1\n  }\n\n  CodeMirror.commands.jumpToLine = function(cm) {\n    var cur = cm.getCursor();\n    dialog(cm, getJumpDialog(cm), cm.phrase(\"Jump to line:\"), (cur.line + 1) + \":\" + cur.ch, function(posStr) {\n      if (!posStr) return;\n\n      var match;\n      if (match = /^\\s*([\\+\\-]?\\d+)\\s*\\:\\s*(\\d+)\\s*$/.exec(posStr)) {\n        cm.setCursor(interpretLine(cm, match[1]), Number(match[2]))\n      } else if (match = /^\\s*([\\+\\-]?\\d+(\\.\\d+)?)\\%\\s*/.exec(posStr)) {\n        var line = Math.round(cm.lineCount() * Number(match[1]) / 100);\n        if (/^[-+]/.test(match[1])) line = cur.line + line + 1;\n        cm.setCursor(line - 1, cur.ch);\n      } else if (match = /^\\s*\\:?\\s*([\\+\\-]?\\d+)\\s*/.exec(posStr)) {\n        cm.setCursor(interpretLine(cm, match[1]), cur.ch);\n      }\n    });\n  };\n\n  CodeMirror.keyMap[\"default\"][\"Alt-G\"] = \"jumpToLine\";\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/search/jump-to-line.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"selectionPointer\", false, function(cm, val) {\n    var data = cm.state.selectionPointer;\n    if (data) {\n      CodeMirror.off(cm.getWrapperElement(), \"mousemove\", data.mousemove);\n      CodeMirror.off(cm.getWrapperElement(), \"mouseout\", data.mouseout);\n      CodeMirror.off(window, \"scroll\", data.windowScroll);\n      cm.off(\"cursorActivity\", reset);\n      cm.off(\"scroll\", reset);\n      cm.state.selectionPointer = null;\n      cm.display.lineDiv.style.cursor = \"\";\n    }\n    if (val) {\n      data = cm.state.selectionPointer = {\n        value: typeof val == \"string\" ? val : \"default\",\n        mousemove: function(event) { mousemove(cm, event); },\n        mouseout: function(event) { mouseout(cm, event); },\n        windowScroll: function() { reset(cm); },\n        rects: null,\n        mouseX: null, mouseY: null,\n        willUpdate: false\n      };\n      CodeMirror.on(cm.getWrapperElement(), \"mousemove\", data.mousemove);\n      CodeMirror.on(cm.getWrapperElement(), \"mouseout\", data.mouseout);\n      CodeMirror.on(window, \"scroll\", data.windowScroll);\n      cm.on(\"cursorActivity\", reset);\n      cm.on(\"scroll\", reset);\n    }\n  });\n\n  function mousemove(cm, event) {\n    var data = cm.state.selectionPointer;\n    if (event.buttons == null ? event.which : event.buttons) {\n      data.mouseX = data.mouseY = null;\n    } else {\n      data.mouseX = event.clientX;\n      data.mouseY = event.clientY;\n    }\n    scheduleUpdate(cm);\n  }\n\n  function mouseout(cm, event) {\n    if (!cm.getWrapperElement().contains(event.relatedTarget)) {\n      var data = cm.state.selectionPointer;\n      data.mouseX = data.mouseY = null;\n      scheduleUpdate(cm);\n    }\n  }\n\n  function reset(cm) {\n    cm.state.selectionPointer.rects = null;\n    scheduleUpdate(cm);\n  }\n\n  function scheduleUpdate(cm) {\n    if (!cm.state.selectionPointer.willUpdate) {\n      cm.state.selectionPointer.willUpdate = true;\n      setTimeout(function() {\n        update(cm);\n        cm.state.selectionPointer.willUpdate = false;\n      }, 50);\n    }\n  }\n\n  function update(cm) {\n    var data = cm.state.selectionPointer;\n    if (!data) return;\n    if (data.rects == null && data.mouseX != null) {\n      data.rects = [];\n      if (cm.somethingSelected()) {\n        for (var sel = cm.display.selectionDiv.firstChild; sel; sel = sel.nextSibling)\n          data.rects.push(sel.getBoundingClientRect());\n      }\n    }\n    var inside = false;\n    if (data.mouseX != null) for (var i = 0; i < data.rects.length; i++) {\n      var rect = data.rects[i];\n      if (rect.left <= data.mouseX && rect.right >= data.mouseX &&\n          rect.top <= data.mouseY && rect.bottom >= data.mouseY)\n        inside = true;\n    }\n    var cursor = inside ? data.value : \"\";\n    if (cm.display.lineDiv.style.cursor != cursor)\n      cm.display.lineDiv.style.cursor = cursor;\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/selection/selection-pointer.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Because sometimes you need to mark the selected *text*.\n//\n// Adds an option 'styleSelectedText' which, when enabled, gives\n// selected text the CSS class given as option value, or\n// \"CodeMirror-selectedtext\" when the value is not a string.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"styleSelectedText\", false, function(cm, val, old) {\n    var prev = old && old != CodeMirror.Init;\n    if (val && !prev) {\n      cm.state.markedSelection = [];\n      cm.state.markedSelectionStyle = typeof val == \"string\" ? val : \"CodeMirror-selectedtext\";\n      reset(cm);\n      cm.on(\"cursorActivity\", onCursorActivity);\n      cm.on(\"change\", onChange);\n    } else if (!val && prev) {\n      cm.off(\"cursorActivity\", onCursorActivity);\n      cm.off(\"change\", onChange);\n      clear(cm);\n      cm.state.markedSelection = cm.state.markedSelectionStyle = null;\n    }\n  });\n\n  function onCursorActivity(cm) {\n    if (cm.state.markedSelection)\n      cm.operation(function() { update(cm); });\n  }\n\n  function onChange(cm) {\n    if (cm.state.markedSelection && cm.state.markedSelection.length)\n      cm.operation(function() { clear(cm); });\n  }\n\n  var CHUNK_SIZE = 8;\n  var Pos = CodeMirror.Pos;\n  var cmp = CodeMirror.cmpPos;\n\n  function coverRange(cm, from, to, addAt) {\n    if (cmp(from, to) == 0) return;\n    var array = cm.state.markedSelection;\n    var cls = cm.state.markedSelectionStyle;\n    for (var line = from.line;;) {\n      var start = line == from.line ? from : Pos(line, 0);\n      var endLine = line + CHUNK_SIZE, atEnd = endLine >= to.line;\n      var end = atEnd ? to : Pos(endLine, 0);\n      var mark = cm.markText(start, end, {className: cls});\n      if (addAt == null) array.push(mark);\n      else array.splice(addAt++, 0, mark);\n      if (atEnd) break;\n      line = endLine;\n    }\n  }\n\n  function clear(cm) {\n    var array = cm.state.markedSelection;\n    for (var i = 0; i < array.length; ++i) array[i].clear();\n    array.length = 0;\n  }\n\n  function reset(cm) {\n    clear(cm);\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++)\n      coverRange(cm, ranges[i].from(), ranges[i].to());\n  }\n\n  function update(cm) {\n    if (!cm.somethingSelected()) return clear(cm);\n    if (cm.listSelections().length > 1) return reset(cm);\n\n    var from = cm.getCursor(\"start\"), to = cm.getCursor(\"end\");\n\n    var array = cm.state.markedSelection;\n    if (!array.length) return coverRange(cm, from, to);\n\n    var coverStart = array[0].find(), coverEnd = array[array.length - 1].find();\n    if (!coverStart || !coverEnd || to.line - from.line <= CHUNK_SIZE ||\n        cmp(from, coverEnd.to) >= 0 || cmp(to, coverStart.from) <= 0)\n      return reset(cm);\n\n    while (cmp(from, coverStart.from) > 0) {\n      array.shift().clear();\n      coverStart = array[0].find();\n    }\n    if (cmp(from, coverStart.from) < 0) {\n      if (coverStart.to.line - from.line < CHUNK_SIZE) {\n        array.shift().clear();\n        coverRange(cm, from, coverStart.to, 0);\n      } else {\n        coverRange(cm, from, coverStart.from, 0);\n      }\n    }\n\n    while (cmp(to, coverEnd.to) < 0) {\n      array.pop().clear();\n      coverEnd = array[array.length - 1].find();\n    }\n    if (cmp(to, coverEnd.to) > 0) {\n      if (to.line - coverEnd.from.line < CHUNK_SIZE) {\n        array.pop().clear();\n        coverRange(cm, coverEnd.from, to);\n      } else {\n        coverRange(cm, coverEnd.to, to);\n      }\n    }\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/selection/mark-selection.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function doFold(cm, pos, options, force) {\n    if (options && options.call) {\n      var finder = options;\n      options = null;\n    } else {\n      var finder = getOption(cm, options, \"rangeFinder\");\n    }\n    if (typeof pos == \"number\") pos = CodeMirror.Pos(pos, 0);\n    var minSize = getOption(cm, options, \"minFoldSize\");\n\n    function getRange(allowFolded) {\n      var range = finder(cm, pos);\n      if (!range || range.to.line - range.from.line < minSize) return null;\n      var marks = cm.findMarksAt(range.from);\n      for (var i = 0; i < marks.length; ++i) {\n        if (marks[i].__isFold && force !== \"fold\") {\n          if (!allowFolded) return null;\n          range.cleared = true;\n          marks[i].clear();\n        }\n      }\n      return range;\n    }\n\n    var range = getRange(true);\n    if (getOption(cm, options, \"scanUp\")) while (!range && pos.line > cm.firstLine()) {\n      pos = CodeMirror.Pos(pos.line - 1, 0);\n      range = getRange(false);\n    }\n    if (!range || range.cleared || force === \"unfold\") return;\n\n    var myWidget = makeWidget(cm, options);\n    CodeMirror.on(myWidget, \"mousedown\", function(e) {\n      myRange.clear();\n      CodeMirror.e_preventDefault(e);\n    });\n    var myRange = cm.markText(range.from, range.to, {\n      replacedWith: myWidget,\n      clearOnEnter: getOption(cm, options, \"clearOnEnter\"),\n      __isFold: true\n    });\n    myRange.on(\"clear\", function(from, to) {\n      CodeMirror.signal(cm, \"unfold\", cm, from, to);\n    });\n    CodeMirror.signal(cm, \"fold\", cm, range.from, range.to);\n  }\n\n  function makeWidget(cm, options) {\n    var widget = getOption(cm, options, \"widget\");\n    if (typeof widget == \"string\") {\n      var text = document.createTextNode(widget);\n      widget = document.createElement(\"span\");\n      widget.appendChild(text);\n      widget.className = \"CodeMirror-foldmarker\";\n    } else if (widget) {\n      widget = widget.cloneNode(true)\n    }\n    return widget;\n  }\n\n  // Clumsy backwards-compatible interface\n  CodeMirror.newFoldFunction = function(rangeFinder, widget) {\n    return function(cm, pos) { doFold(cm, pos, {rangeFinder: rangeFinder, widget: widget}); };\n  };\n\n  // New-style interface\n  CodeMirror.defineExtension(\"foldCode\", function(pos, options, force) {\n    doFold(this, pos, options, force);\n  });\n\n  CodeMirror.defineExtension(\"isFolded\", function(pos) {\n    var marks = this.findMarksAt(pos);\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold) return true;\n  });\n\n  CodeMirror.commands.toggleFold = function(cm) {\n    cm.foldCode(cm.getCursor());\n  };\n  CodeMirror.commands.fold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"fold\");\n  };\n  CodeMirror.commands.unfold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"unfold\");\n  };\n  CodeMirror.commands.foldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"fold\");\n    });\n  };\n  CodeMirror.commands.unfoldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"unfold\");\n    });\n  };\n\n  CodeMirror.registerHelper(\"fold\", \"combine\", function() {\n    var funcs = Array.prototype.slice.call(arguments, 0);\n    return function(cm, start) {\n      for (var i = 0; i < funcs.length; ++i) {\n        var found = funcs[i](cm, start);\n        if (found) return found;\n      }\n    };\n  });\n\n  CodeMirror.registerHelper(\"fold\", \"auto\", function(cm, start) {\n    var helpers = cm.getHelpers(start, \"fold\");\n    for (var i = 0; i < helpers.length; i++) {\n      var cur = helpers[i](cm, start);\n      if (cur) return cur;\n    }\n  });\n\n  var defaultOptions = {\n    rangeFinder: CodeMirror.fold.auto,\n    widget: \"\\u2194\",\n    minFoldSize: 0,\n    scanUp: false,\n    clearOnEnter: true\n  };\n\n  CodeMirror.defineOption(\"foldOptions\", null);\n\n  function getOption(cm, options, name) {\n    if (options && options[name] !== undefined)\n      return options[name];\n    var editorOptions = cm.options.foldOptions;\n    if (editorOptions && editorOptions[name] !== undefined)\n      return editorOptions[name];\n    return defaultOptions[name];\n  }\n\n  CodeMirror.defineExtension(\"foldOption\", function(options, name) {\n    return getOption(this, options, name);\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/fold/foldcode.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"./foldcode\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./foldcode\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"foldGutter\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.clearGutter(cm.state.foldGutter.options.gutter);\n      cm.state.foldGutter = null;\n      cm.off(\"gutterClick\", onGutterClick);\n      cm.off(\"change\", onChange);\n      cm.off(\"viewportChange\", onViewportChange);\n      cm.off(\"fold\", onFold);\n      cm.off(\"unfold\", onFold);\n      cm.off(\"swapDoc\", onChange);\n    }\n    if (val) {\n      cm.state.foldGutter = new State(parseOptions(val));\n      updateInViewport(cm);\n      cm.on(\"gutterClick\", onGutterClick);\n      cm.on(\"change\", onChange);\n      cm.on(\"viewportChange\", onViewportChange);\n      cm.on(\"fold\", onFold);\n      cm.on(\"unfold\", onFold);\n      cm.on(\"swapDoc\", onChange);\n    }\n  });\n\n  var Pos = CodeMirror.Pos;\n\n  function State(options) {\n    this.options = options;\n    this.from = this.to = 0;\n  }\n\n  function parseOptions(opts) {\n    if (opts === true) opts = {};\n    if (opts.gutter == null) opts.gutter = \"CodeMirror-foldgutter\";\n    if (opts.indicatorOpen == null) opts.indicatorOpen = \"CodeMirror-foldgutter-open\";\n    if (opts.indicatorFolded == null) opts.indicatorFolded = \"CodeMirror-foldgutter-folded\";\n    return opts;\n  }\n\n  function isFolded(cm, line) {\n    var marks = cm.findMarks(Pos(line, 0), Pos(line + 1, 0));\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold && marks[i].find().from.line == line) return marks[i];\n  }\n\n  function marker(spec) {\n    if (typeof spec == \"string\") {\n      var elt = document.createElement(\"div\");\n      elt.className = spec + \" CodeMirror-guttermarker-subtle\";\n      return elt;\n    } else {\n      return spec.cloneNode(true);\n    }\n  }\n\n  function updateFoldInfo(cm, from, to) {\n    var opts = cm.state.foldGutter.options, cur = from;\n    var minSize = cm.foldOption(opts, \"minFoldSize\");\n    var func = cm.foldOption(opts, \"rangeFinder\");\n    cm.eachLine(from, to, function(line) {\n      var mark = null;\n      if (isFolded(cm, cur)) {\n        mark = marker(opts.indicatorFolded);\n      } else {\n        var pos = Pos(cur, 0);\n        var range = func && func(cm, pos);\n        if (range && range.to.line - range.from.line >= minSize)\n          mark = marker(opts.indicatorOpen);\n      }\n      cm.setGutterMarker(line, opts.gutter, mark);\n      ++cur;\n    });\n  }\n\n  function updateInViewport(cm) {\n    var vp = cm.getViewport(), state = cm.state.foldGutter;\n    if (!state) return;\n    cm.operation(function() {\n      updateFoldInfo(cm, vp.from, vp.to);\n    });\n    state.from = vp.from; state.to = vp.to;\n  }\n\n  function onGutterClick(cm, line, gutter) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    if (gutter != opts.gutter) return;\n    var folded = isFolded(cm, line);\n    if (folded) folded.clear();\n    else cm.foldCode(Pos(line, 0), opts.rangeFinder);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    state.from = state.to = 0;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() { updateInViewport(cm); }, opts.foldOnChangeTimeSpan || 600);\n  }\n\n  function onViewportChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() {\n      var vp = cm.getViewport();\n      if (state.from == state.to || vp.from - state.to > 20 || state.from - vp.to > 20) {\n        updateInViewport(cm);\n      } else {\n        cm.operation(function() {\n          if (vp.from < state.from) {\n            updateFoldInfo(cm, vp.from, state.from);\n            state.from = vp.from;\n          }\n          if (vp.to > state.to) {\n            updateFoldInfo(cm, state.to, vp.to);\n            state.to = vp.to;\n          }\n        });\n      }\n    }, opts.updateViewportTimeSpan || 400);\n  }\n\n  function onFold(cm, from) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var line = from.line;\n    if (line >= state.from && line < state.to)\n      updateFoldInfo(cm, line, line + 1);\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/fold/foldgutter.js","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.registerHelper(\"fold\", \"brace\", function(cm, start) {\n  var line = start.line, lineText = cm.getLine(line);\n  var tokenType;\n\n  function findOpening(openCh) {\n    for (var at = start.ch, pass = 0;;) {\n      var found = at <= 0 ? -1 : lineText.lastIndexOf(openCh, at - 1);\n      if (found == -1) {\n        if (pass == 1) break;\n        pass = 1;\n        at = lineText.length;\n        continue;\n      }\n      if (pass == 1 && found < start.ch) break;\n      tokenType = cm.getTokenTypeAt(CodeMirror.Pos(line, found + 1));\n      if (!/^(comment|string)/.test(tokenType)) return found + 1;\n      at = found - 1;\n    }\n  }\n\n  var startToken = \"{\", endToken = \"}\", startCh = findOpening(\"{\");\n  if (startCh == null) {\n    startToken = \"[\", endToken = \"]\";\n    startCh = findOpening(\"[\");\n  }\n\n  if (startCh == null) return;\n  var count = 1, lastLine = cm.lastLine(), end, endCh;\n  outer: for (var i = line; i <= lastLine; ++i) {\n    var text = cm.getLine(i), pos = i == line ? startCh : 0;\n    for (;;) {\n      var nextOpen = text.indexOf(startToken, pos), nextClose = text.indexOf(endToken, pos);\n      if (nextOpen < 0) nextOpen = text.length;\n      if (nextClose < 0) nextClose = text.length;\n      pos = Math.min(nextOpen, nextClose);\n      if (pos == text.length) break;\n      if (cm.getTokenTypeAt(CodeMirror.Pos(i, pos + 1)) == tokenType) {\n        if (pos == nextOpen) ++count;\n        else if (!--count) { end = i; endCh = pos; break outer; }\n      }\n      ++pos;\n    }\n  }\n  if (end == null || line == end && endCh == startCh) return;\n  return {from: CodeMirror.Pos(line, startCh),\n          to: CodeMirror.Pos(end, endCh)};\n});\n\nCodeMirror.registerHelper(\"fold\", \"import\", function(cm, start) {\n  function hasImport(line) {\n    if (line < cm.firstLine() || line > cm.lastLine()) return null;\n    var start = cm.getTokenAt(CodeMirror.Pos(line, 1));\n    if (!/\\S/.test(start.string)) start = cm.getTokenAt(CodeMirror.Pos(line, start.end + 1));\n    if (start.type != \"keyword\" || start.string != \"import\") return null;\n    // Now find closing semicolon, return its position\n    for (var i = line, e = Math.min(cm.lastLine(), line + 10); i <= e; ++i) {\n      var text = cm.getLine(i), semi = text.indexOf(\";\");\n      if (semi != -1) return {startCh: start.end, end: CodeMirror.Pos(i, semi)};\n    }\n  }\n\n  var startLine = start.line, has = hasImport(startLine), prev;\n  if (!has || hasImport(startLine - 1) || ((prev = hasImport(startLine - 2)) && prev.end.line == startLine - 1))\n    return null;\n  for (var end = has.end;;) {\n    var next = hasImport(end.line + 1);\n    if (next == null) break;\n    end = next.end;\n  }\n  return {from: cm.clipPos(CodeMirror.Pos(startLine, has.startCh + 1)), to: end};\n});\n\nCodeMirror.registerHelper(\"fold\", \"include\", function(cm, start) {\n  function hasInclude(line) {\n    if (line < cm.firstLine() || line > cm.lastLine()) return null;\n    var start = cm.getTokenAt(CodeMirror.Pos(line, 1));\n    if (!/\\S/.test(start.string)) start = cm.getTokenAt(CodeMirror.Pos(line, start.end + 1));\n    if (start.type == \"meta\" && start.string.slice(0, 8) == \"#include\") return start.start + 8;\n  }\n\n  var startLine = start.line, has = hasInclude(startLine);\n  if (has == null || hasInclude(startLine - 1) != null) return null;\n  for (var end = startLine;;) {\n    var next = hasInclude(end + 1);\n    if (next == null) break;\n    ++end;\n  }\n  return {from: CodeMirror.Pos(startLine, has + 1),\n          to: cm.clipPos(CodeMirror.Pos(end))};\n});\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/codemirror/addon/fold/brace-fold.js","//\n//   _   _  _       _   \n//  ( ) ( )( )_  _ (_ ) \n//  | | | || ,_)(_) | | \n//  | | | || |  | | | | \n//  | (_) || |_ | | | | \n//  (_____)`\\__)(_)(___)\n//                      \n//                      \n\nimport ShaderBoy from './shaderboy';\n\nexport default ShaderBoy.util={\n\t//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\tdeepcopy: function (str) {\n\t\tlet newstr = str;\n\t\treturn (' ' + newstr).slice(1);\n\t},\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/util.js","//\n//   ___             ___   ___                ___           _          \n//  (  _`\\         /'___)/'___)              (  _`\\        ( )_        \n//  | (_) ) _   _ | (__ | (__   __   _ __    | | ) |   _ _ | ,_)   _ _ \n//  |  _ <'( ) ( )| ,__)| ,__)/'__`\\( '__)   | | | ) /'_` )| |   /'_` )\n//  | (_) )| (_) || |   | |  (  ___/| |      | |_) |( (_| || |_ ( (_| |\n//  (____/'`\\___/'(_)   (_)  `\\____)(_)      (____/'`\\__,_)`\\__)`\\__,_)\n//   ___                  _                                            \n//  (  _`\\               ( )_         _                                \n//  | ( (_)   _     ___  | ,_)   _ _ (_)  ___     __   _ __            \n//  | |  _  /'_`\\ /' _ `\\| |   /'_` )| |/' _ `\\ /'__`\\( '__)           \n//  | (_( )( (_) )| ( ) || |_ ( (_| || || ( ) |(  ___/| |              \n//  (____/'`\\___/'(_) (_)`\\__)`\\__,_)(_)(_) (_)`\\____)(_)              \n//                                                                     \n//                                                                     \n\nexport default class BufferDataContainer {\n\n    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    constructor(isCommon) {\n        this.active = false;\n        this.textData = '';\n        this.loaded = false;\n        this.textures = [];\n        this.framebuffer = null;\n        this.shader = null;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/buffer_data_container.js","let ShaderList = [\n\t{\n\t\tname: 'commonVS',\n\t\turl: './shader/_common.vs',\n\t},\n\t{\n\t\tname: 'uniformFS',\n\t\turl: './shader/_uniform.fs',\n\t},\n\t{\n\t\tname: 'commonFS',\n\t\turl: './shader/common.fs',\n\t},\n\t{\n\t\tname: 'buf_aFS',\n\t\turl: './shader/buf_a.fs',\n\t},\n\t{\n\t\tname: 'buf_bFS',\n\t\turl: './shader/buf_b.fs',\n\t},\n\t{\n\t\tname: 'buf_cFS',\n\t\turl: './shader/buf_c.fs',\n\t},\n\t{\n\t\tname: 'buf_dFS',\n\t\turl: './shader/buf_d.fs',\n\t},\n\t{\n\t\tname: 'imageFS',\n\t\turl: './shader/image.fs',\n\t},\n\t{\n\t\tname: 'screenFS',\n\t\turl: './shader/screen.fs',\n\t},\n\t{\n\t\tname: 'commonfooterFS',\n\t\turl: './shader/_commonfooter.fs',\n\t},\n];\nexport default ShaderList;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/shader/shaderlist.js"],"sourceRoot":""}